

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ibeis.control.manual_annot_funcs &mdash; ibeis 1.4.4 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ibeis 1.4.4 documentation" href="../../../index.html"/>
        <link rel="up" title="ibeis.control" href="../control.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> ibeis
          

          
          </a>

          
            
            
              <div class="version">
                1.4.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../ibeis.html">ibeis package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">ibeis</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      
          <li><a href="../../ibeis.html">ibeis</a> &raquo;</li>
      
          <li><a href="../control.html">ibeis.control</a> &raquo;</li>
      
    <li>ibeis.control.manual_annot_funcs</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for ibeis.control.manual_annot_funcs</h1><div class="highlight"><pre>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Autogen:</span>
<span class="sd">    python -c &quot;import utool as ut; ut.write_modscript_alias(&#39;Tgen.sh&#39;, &#39;ibeis.templates.template_generator&#39;)&quot;  # NOQA</span>
<span class="sd">    sh Tgen.sh --key annot --invert --Tcfg with_getters=True with_setters=True --modfname manual_annot_funcs --funcname-filter=age_m  # NOQA</span>
<span class="sd">    sh Tgen.sh --key annot --invert --Tcfg with_getters=True with_setters=True --modfname manual_annot_funcs --funcname-filter=is_  # NOQA</span>
<span class="sd">    sh Tgen.sh --key annot --invert --Tcfg with_getters=True with_setters=True --modfname manual_annot_funcs --funcname-filter=is_ --diff  # NOQA</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">unicode_literals</span>
<span class="kn">import</span> <span class="nn">six</span>  <span class="c"># NOQA</span>
<span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>  <span class="c"># NOQA</span>
<span class="kn">from</span> <span class="nn">ibeis</span> <span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>
<span class="kn">from</span> <span class="nn">ibeis.control</span> <span class="kn">import</span> <span class="n">accessor_decors</span><span class="p">,</span> <span class="n">controller_inject</span>
<span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="kn">from</span> <span class="nn">ibeis</span> <span class="kn">import</span> <span class="n">ibsfuncs</span>
<span class="kn">from</span> <span class="nn">ibeis.control.controller_inject</span> <span class="kn">import</span> <span class="n">make_ibs_register_decorator</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="k">print</span><span class="p">,</span> <span class="n">print_</span><span class="p">,</span> <span class="n">printDBG</span><span class="p">,</span> <span class="n">rrr</span><span class="p">,</span> <span class="n">profile</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="n">__name__</span><span class="p">,</span> <span class="s">&#39;[manual_annot]&#39;</span><span class="p">)</span>


<span class="n">CLASS_INJECT_KEY</span><span class="p">,</span> <span class="n">register_ibs_method</span> <span class="o">=</span> <span class="n">make_ibs_register_decorator</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>


<span class="n">register_api</span>   <span class="o">=</span> <span class="n">controller_inject</span><span class="o">.</span><span class="n">get_ibeis_flask_api</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">register_route</span> <span class="o">=</span> <span class="n">controller_inject</span><span class="o">.</span><span class="n">get_ibeis_flask_route</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>


<span class="n">ANNOT_AGE_MONTHS_EST_MAX</span> <span class="o">=</span> <span class="s">&#39;annot_age_months_est_max&#39;</span>
<span class="n">ANNOT_AGE_MONTHS_EST_MIN</span> <span class="o">=</span> <span class="s">&#39;annot_age_months_est_min&#39;</span>
<span class="n">ANNOT_NOTE</span>               <span class="o">=</span> <span class="s">&#39;annot_note&#39;</span>
<span class="n">ANNOT_NUM_VERTS</span>          <span class="o">=</span> <span class="s">&#39;annot_num_verts&#39;</span>
<span class="n">ANNOT_PARENT_ROWID</span>       <span class="o">=</span> <span class="s">&#39;annot_parent_rowid&#39;</span>
<span class="n">ANNOT_ROWID</span>              <span class="o">=</span> <span class="s">&#39;annot_rowid&#39;</span>
<span class="n">ANNOT_TAGS</span>               <span class="o">=</span> <span class="s">&#39;annot_tags&#39;</span>
<span class="n">ANNOT_SEMANTIC_UUID</span>      <span class="o">=</span> <span class="s">&#39;annot_semantic_uuid&#39;</span>
<span class="n">ANNOT_THETA</span>              <span class="o">=</span> <span class="s">&#39;annot_theta&#39;</span>
<span class="n">ANNOT_VERTS</span>              <span class="o">=</span> <span class="s">&#39;annot_verts&#39;</span>
<span class="n">ANNOT_UUID</span>               <span class="o">=</span> <span class="s">&#39;annot_uuid&#39;</span>
<span class="n">ANNOT_YAW</span>                <span class="o">=</span> <span class="s">&#39;annot_yaw&#39;</span>
<span class="n">ANNOT_VISUAL_UUID</span>        <span class="o">=</span> <span class="s">&#39;annot_visual_uuid&#39;</span>
<span class="n">CONFIG_ROWID</span>             <span class="o">=</span> <span class="s">&#39;config_rowid&#39;</span>
<span class="n">FEATWEIGHT_ROWID</span>         <span class="o">=</span> <span class="s">&#39;featweight_rowid&#39;</span>
<span class="n">IMAGE_ROWID</span>              <span class="o">=</span> <span class="s">&#39;image_rowid&#39;</span>
<span class="n">NAME_ROWID</span>               <span class="o">=</span> <span class="s">&#39;name_rowid&#39;</span>
<span class="n">SPECIES_ROWID</span>            <span class="o">=</span> <span class="s">&#39;species_rowid&#39;</span>
<span class="n">ANNOT_EXEMPLAR_FLAG</span>      <span class="o">=</span> <span class="s">&#39;annot_exemplar_flag&#39;</span>
<span class="n">ANNOT_QUALITY</span>            <span class="o">=</span> <span class="s">&#39;annot_quality&#39;</span>
<span class="n">ANNOT_ROWIDS</span>             <span class="o">=</span> <span class="s">&#39;annot_rowids&#39;</span>
<span class="n">GAR_ROWID</span>                <span class="o">=</span> <span class="s">&#39;gar_rowid&#39;</span>

<span class="n">SemanticInfoTup</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;SemanticInfoTup&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;image_uuid&#39;</span><span class="p">,</span> <span class="s">&#39;verts&#39;</span><span class="p">,</span>
                                                 <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;yaw&#39;</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">,</span>
                                                 <span class="s">&#39;species&#39;</span><span class="p">))</span>


<span class="c"># ==========</span>
<span class="c"># IDERS</span>
<span class="c"># ==========</span>

<span class="c"># TODO CACHE THIS AND FIND WHAT IT SHOULD INVALIDATE IT</span>
<span class="c"># ADD ANNOTS, DELETE ANNOTS ANYTHING ELSE?</span>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.ider</span>
<span class="k">def</span> <span class="nf">_get_all_aids</span><span class="p">(</span><span class="n">ibs</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        list_ (list):  all unfiltered aids (annotation rowids)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_aids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_all_rowids</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">all_aids</span>


<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/numations/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_num_annotations"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_num_annotations">[docs]</a><span class="k">def</span> <span class="nf">get_num_annotations</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Number of valid annotations</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/numations/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.ider</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_valid_aids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_valid_aids">[docs]</a><span class="k">def</span> <span class="nf">get_valid_aids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">eid</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">include_only_gid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">yaw</span><span class="o">=</span><span class="s">&#39;no-filter&#39;</span><span class="p">,</span>
                   <span class="n">is_exemplar</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">species</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">is_known</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">hasgt</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">minqual</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">has_timestamp</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">min_timedelta</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    High level function for getting all annotation ids according a set of filters.</span>

<span class="sd">    Note: The yaw value cannot be None as a default because None is used as a</span>
<span class="sd">          filtering value</span>

<span class="sd">    Args:</span>
<span class="sd">        ibs (IBEISController):  ibeis controller object</span>
<span class="sd">        eid (int): encounter id (default = None)</span>
<span class="sd">        include_only_gid_list (list): if specified filters annots not in these gids (default = None)</span>
<span class="sd">        yaw (str): (default = &#39;no-filter&#39;)</span>
<span class="sd">        is_exemplar (bool): if specified filters annots to either be or not be exemplars (default = None)</span>
<span class="sd">        species (str): (default = None)</span>
<span class="sd">        is_known (bool): (default = None)</span>
<span class="sd">        min_timedelta (int): minimum timedelta between annots of known individuals</span>
<span class="sd">        hasgt (bool): (default = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: aid_list - a list of valid ANNOTATION unique ids</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_valid_aids</span>

<span class="sd">    Ignore:</span>
<span class="sd">        ibs.print_annotation_table()</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; from ibeis import constants as const</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; eid = 1</span>
<span class="sd">        &gt;&gt;&gt; ibs.delete_all_encounters()</span>
<span class="sd">        &gt;&gt;&gt; ibs.compute_encounters()</span>
<span class="sd">        &gt;&gt;&gt; include_only_gid_list = None</span>
<span class="sd">        &gt;&gt;&gt; yaw = &#39;no-filter&#39;</span>
<span class="sd">        &gt;&gt;&gt; is_exemplar = None</span>
<span class="sd">        &gt;&gt;&gt; species = const.Species.ZEB_PLAIN</span>
<span class="sd">        &gt;&gt;&gt; is_known = False</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; aid_list = get_valid_aids(ibs, eid, include_only_gid_list, yaw, is_exemplar, species, is_known)</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(ibs.get_annot_names(aid_list), [const.UNKNOWN] * 2, &#39;bad name&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(ibs.get_annot_species(aid_list), [const.Species.ZEB_PLAIN] * 2, &#39;bad species&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(ibs.get_annot_exemplar_flags(aid_list), [False] * 2, &#39;bad exemplar&#39;)</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; result = str(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [1, 4]</span>

<span class="sd">    Example1:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; aid_list1 = get_valid_aids(ibs, is_exemplar=True)</span>
<span class="sd">        &gt;&gt;&gt; aid_list2 = get_valid_aids(ibs, is_exemplar=False)</span>
<span class="sd">        &gt;&gt;&gt; intersect_aids = set(aid_list1).intersection(aid_list2)</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(len(aid_list1), 9)</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(len(aid_list2), 4)</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(len(intersect_aids), 0)</span>

<span class="sd">    Ignore:</span>
<span class="sd">        import utool as ut</span>
<span class="sd">        setup = ut.codeblock(</span>
<span class="sd">            &#39;&#39;&#39;</span>
<span class="sd">            import ibeis</span>
<span class="sd">            ibs = ibeis.opendb(&#39;PZ_Master1&#39;)</span>
<span class="sd">            &#39;&#39;&#39;</span>
<span class="sd">        )</span>
<span class="sd">        stmt_list = [</span>
<span class="sd">            ut.codeblock(</span>
<span class="sd">                &#39;&#39;&#39;</span>
<span class="sd">                ibs.db.get_all_rowids_where(ibs.const.ANNOTATION_TABLE, ibeis.control.DB_SCHEMA.ANNOT_PARENT_ROWID + &quot; IS NULL&quot;, tuple())</span>
<span class="sd">                &#39;&#39;&#39;),</span>
<span class="sd">            ut.codeblock(</span>
<span class="sd">                &#39;&#39;&#39;</span>
<span class="sd">                ibs.db.get_all_rowids(ibs.const.ANNOTATION_TABLE)</span>
<span class="sd">                &#39;&#39;&#39;),</span>
<span class="sd">        ]</span>
<span class="sd">        iterations = 100</span>
<span class="sd">        verbose = True</span>
<span class="sd">        _ = ut.timeit_compare(stmt_list, setup=setup, iterations=iterations, verbose=verbose)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># getting encounter aid</span>
    <span class="k">if</span> <span class="n">eid</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_exemplar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c"># Optimization Hack</span>
            <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_all_rowids_where</span><span class="p">(</span>
                <span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="s">&#39;annot_exemplar_flag=?&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">is_exemplar</span><span class="p">,))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">_get_all_aids</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c"># HACK: Check to see if you want the</span>
        <span class="c"># exemplar &quot;encounter&quot; (image group)</span>
        <span class="n">enctext</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_encounter_text</span><span class="p">(</span><span class="n">eid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">enctext</span> <span class="o">==</span> <span class="n">const</span><span class="o">.</span><span class="n">EXEMPLAR_ENCTEXT</span><span class="p">:</span>
            <span class="n">is_exemplar</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_encounter_aids</span><span class="p">(</span><span class="n">eid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_exemplar</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c"># corresponding unoptimized hack for is_exemplar</span>
            <span class="n">flag_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_exemplar_flags</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
            <span class="n">aid_list</span>  <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_compress</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">is_exemplar</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">flag_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_exemplar_flags</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
            <span class="n">aid_list</span>  <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">filterfalse_items</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">)</span>
    <span class="n">aid_list</span> <span class="o">=</span> <span class="n">filter_annotation_set</span><span class="p">(</span>
        <span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">include_only_gid_list</span><span class="o">=</span><span class="n">include_only_gid_list</span><span class="p">,</span> <span class="n">yaw</span><span class="o">=</span><span class="n">yaw</span><span class="p">,</span>
        <span class="n">is_exemplar</span><span class="o">=</span><span class="n">is_exemplar</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="n">species</span><span class="p">,</span> <span class="n">is_known</span><span class="o">=</span><span class="n">is_known</span><span class="p">,</span>
        <span class="n">hasgt</span><span class="o">=</span><span class="n">hasgt</span><span class="p">,</span> <span class="n">minqual</span><span class="o">=</span><span class="n">minqual</span><span class="p">,</span> <span class="n">has_timestamp</span><span class="o">=</span><span class="n">has_timestamp</span><span class="p">,</span>
        <span class="n">min_timedelta</span><span class="o">=</span><span class="n">min_timedelta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">aid_list</span>

</div>
<div class="viewcode-block" id="filter_annotation_set"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.filter_annotation_set">[docs]</a><span class="k">def</span> <span class="nf">filter_annotation_set</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">include_only_gid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">yaw</span><span class="o">=</span><span class="s">&#39;no-filter&#39;</span><span class="p">,</span> <span class="n">is_exemplar</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">is_known</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">hasgt</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">minqual</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">has_timestamp</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">min_timedelta</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c"># -- valid aid filtering --</span>
    <span class="k">if</span> <span class="n">include_only_gid_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">gid_list</span>     <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
        <span class="n">is_valid_gid</span> <span class="o">=</span> <span class="p">[</span><span class="n">gid</span> <span class="ow">in</span> <span class="n">include_only_gid_list</span> <span class="k">for</span> <span class="n">gid</span> <span class="ow">in</span> <span class="n">gid_list</span><span class="p">]</span>
        <span class="n">aid_list</span>     <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_compress</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">is_valid_gid</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">yaw</span> <span class="o">!=</span> <span class="s">&#39;no-filter&#39;</span><span class="p">:</span>
        <span class="n">yaw_list</span>     <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_yaws</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
        <span class="n">is_valid_yaw</span> <span class="o">=</span> <span class="p">[</span><span class="n">yaw</span> <span class="o">==</span> <span class="n">flag</span> <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">yaw_list</span><span class="p">]</span>
        <span class="n">aid_list</span>     <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_compress</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">is_valid_yaw</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">species</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">filter_aids_to_species</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">species</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_known</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">filter_aids_without_name</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="ow">not</span> <span class="n">is_known</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">minqual</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">filter_aids_to_quality</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">minqual</span><span class="p">,</span> <span class="n">unknown_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">has_timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">filter_aids_without_timestamps</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="ow">not</span> <span class="n">has_timestamp</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">min_timedelta</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">filter_annots_using_minimum_timedelta</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">min_timedelta</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hasgt</span><span class="p">:</span>
        <span class="n">hasgt_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_has_groundtruth</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
        <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_compress</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">hasgt_list</span><span class="p">)</span>
    <span class="n">aid_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">aid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<div class="viewcode-block" id="get_annot_aid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_aid">[docs]</a><span class="k">def</span> <span class="nf">get_annot_aid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; self verifier</span>
<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.IBEISControl import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids() + [None, -1, 10434320432]</span>
<span class="sd">        &gt;&gt;&gt; aid_list_ = ibs.get_annot_aid(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; assert [r is None for r in aid_list_[-3:]]</span>
<span class="sd">        &gt;&gt;&gt; assert [r is not None for r in aid_list_[0:-3]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">ANNOT_ROWID</span><span class="p">,)</span>
    <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span>
                          <span class="n">id_iter</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="s">&#39;rowid&#39;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="n">eager</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">aid_list</span>


<span class="c"># ==========</span>
<span class="c"># ADDERS</span>
<span class="c"># ==========</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.adder</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">IMAGE_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="p">[</span><span class="n">ANNOT_ROWIDS</span><span class="p">],</span> <span class="n">rowidx</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">NAME_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="p">[</span><span class="n">ANNOT_ROWIDS</span><span class="p">])</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ENCOUNTER_TABLE</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;percent_names_with_exemplar_str&#39;</span><span class="p">])</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;POST&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="add_annots"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.add_annots">[docs]</a><span class="k">def</span> <span class="nf">add_annots</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">gid_list</span><span class="p">,</span> <span class="n">bbox_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">theta_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">species_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">nid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">detect_confidence_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">notes_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">vert_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">annot_uuid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">yaw_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">annot_visual_uuid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">annot_semantic_uuid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">species_rowid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">quiet_delete_thumbs</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                <span class="n">prevent_visual_duplicates</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Adds an annotation to images</span>

<span class="sd">    Args:</span>
<span class="sd">        gid_list                 (list): image rowids to add annotation to</span>
<span class="sd">        bbox_list                (list): of [x, y, w, h] bounding boxes for each image (supply verts instead)</span>
<span class="sd">        theta_list               (list): orientations of annotations</span>
<span class="sd">        species_list             (list):</span>
<span class="sd">        nid_list                 (list):</span>
<span class="sd">        name_list                (list):</span>
<span class="sd">        detect_confidence_list   (list):</span>
<span class="sd">        notes_list               (list):</span>
<span class="sd">        vert_list                (list): alternative to bounding box</span>
<span class="sd">        annot_uuid_list          (list):</span>
<span class="sd">        yaw_list           (list):</span>
<span class="sd">        annot_visual_uuid_list   (list):</span>
<span class="sd">        annot_semantic_uuid_list (list):</span>
<span class="sd">        quiet_delete_thumbs      (bool):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: aid_list</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-add_annots</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-add_annots --verbose --print-caller</span>

<span class="sd">    Ignore:</span>
<span class="sd">       theta_list = None</span>
<span class="sd">       species_list = None</span>
<span class="sd">       nid_list = None</span>
<span class="sd">       name_list = None</span>
<span class="sd">       detect_confidence_list = None</span>
<span class="sd">       notes_list = None</span>
<span class="sd">       vert_list = None</span>
<span class="sd">       annot_uuid_list = None</span>
<span class="sd">       yaw_list = None</span>
<span class="sd">       quiet_delete_thumbs = False</span>
<span class="sd">       prevent_visual_duplicates = False</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: POST</span>
<span class="sd">        URL:    /api/annot/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.IBEISControl import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; prevalid = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; num_add = 2</span>
<span class="sd">        &gt;&gt;&gt; gid_list = ibs.get_valid_gids()[0:num_add]</span>
<span class="sd">        &gt;&gt;&gt; bbox_list = [(int(w * .1), int(h * .6), int(w * .5), int(h *  .3))</span>
<span class="sd">        ...              for (w, h) in ibs.get_image_sizes(gid_list)]</span>
<span class="sd">        &gt;&gt;&gt; # Add a test annotation</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;Testing add_annots&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.add_annots(gid_list, bbox_list=bbox_list)</span>
<span class="sd">        &gt;&gt;&gt; bbox_list2 = ibs.get_annot_bboxes(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; vert_list2 = ibs.get_annot_verts(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; theta_list2 = ibs.get_annot_thetas(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; name_list2 = ibs.get_annot_names(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;Ensure=False. Should get back None chip fpaths&#39;)</span>
<span class="sd">        &gt;&gt;&gt; chip_fpaths2 = ibs.get_annot_chip_fpath(aid_list, ensure=False)</span>
<span class="sd">        &gt;&gt;&gt; assert [fpath is None for fpath in chip_fpaths2]</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;Ensure=True. Should get back None chip fpaths&#39;)</span>
<span class="sd">        &gt;&gt;&gt; chip_fpaths = ibs.get_annot_chip_fpath(aid_list, ensure=True)</span>
<span class="sd">        &gt;&gt;&gt; assert all([ut.checkpath(fpath, verbose=True) for fpath in chip_fpaths])</span>
<span class="sd">        &gt;&gt;&gt; assert len(aid_list) == num_add</span>
<span class="sd">        &gt;&gt;&gt; assert len(vert_list2[0]) == 4</span>
<span class="sd">        &gt;&gt;&gt; assert bbox_list2 == bbox_list</span>
<span class="sd">        &gt;&gt;&gt; # Be sure to remove test annotation</span>
<span class="sd">        &gt;&gt;&gt; # if this test fails a resetdbs might be nessary</span>
<span class="sd">        &gt;&gt;&gt; result = &#39;&#39;</span>
<span class="sd">        &gt;&gt;&gt; visual_uuid_list = ibs.get_annot_visual_uuids(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; semantic_uuid_list = ibs.get_annot_semantic_uuids(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; result += str(visual_uuid_list) + &#39;\n&#39;</span>
<span class="sd">        &gt;&gt;&gt; result += str(semantic_uuid_list) + &#39;\n&#39;</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;Cleaning up. Removing added annotations&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ibs.delete_annots(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; assert not any([ut.checkpath(fpath, verbose=True) for fpath in chip_fpaths])</span>
<span class="sd">        &gt;&gt;&gt; postvalid = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; assert prevalid == postvalid</span>
<span class="sd">        &gt;&gt;&gt; result += str(postvalid)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [UUID(&#39;30f7639b-5161-a561-2c4f-41aed64e5b65&#39;), UUID(&#39;5ccbb26d-104f-e655-cf2b-cf92e0ad2fd2&#39;)]</span>
<span class="sd">        [UUID(&#39;3e3e9c98-e47c-f153-7101-f3d4fdadfb90&#39;), UUID(&#39;dbf3b1a2-2188-75b4-07d4-0ef7e4787d23&#39;)]</span>
<span class="sd">        [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]</span>

<span class="sd">        # semantic uuids change when hashing is different</span>

<span class="sd">        [UUID(&#39;30f7639b-5161-a561-2c4f-41aed64e5b65&#39;), UUID(&#39;5ccbb26d-104f-e655-cf2b-cf92e0ad2fd2&#39;)]</span>
<span class="sd">        [UUID(&#39;68160c90-4b82-dc96-dafa-b12948739577&#39;), UUID(&#39;03e74d19-1bf7-bc43-a291-8ee06a44da2e&#39;)]</span>
<span class="sd">        [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]</span>

<span class="sd">    Example2:</span>
<span class="sd">        &gt;&gt;&gt; # Test with prevent_visual_duplicates on</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.IBEISControl import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; prevalid = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; num_add = 1</span>
<span class="sd">        &gt;&gt;&gt; gid_list = ibs.get_valid_gids()[0:1] * num_add</span>
<span class="sd">        &gt;&gt;&gt; bbox_list = [(int(w * .1), int(h * .6), int(w * .5), int(h *  .3))</span>
<span class="sd">        ...              for (w, h) in ibs.get_image_sizes(gid_list)]</span>
<span class="sd">        &gt;&gt;&gt; bbox_list2 = [(int(w * .2), int(h * .6), int(w * .5), int(h *  .3))</span>
<span class="sd">        ...              for (w, h) in ibs.get_image_sizes(gid_list)]</span>
<span class="sd">        &gt;&gt;&gt; # Add a test annotation</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;Testing add_annots&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list1 = ibs.add_annots(gid_list, bbox_list=bbox_list, prevent_visual_duplicates=True)</span>
<span class="sd">        &gt;&gt;&gt; aid_list2 = ibs.add_annots(gid_list, bbox_list=bbox_list, prevent_visual_duplicates=True)</span>
<span class="sd">        &gt;&gt;&gt; aid_list3 = ibs.add_annots(gid_list, bbox_list=bbox_list2, prevent_visual_duplicates=True)</span>
<span class="sd">        &gt;&gt;&gt; assert aid_list1 == aid_list2</span>
<span class="sd">        &gt;&gt;&gt; assert aid_list1 != aid_list3</span>
<span class="sd">        &gt;&gt;&gt; aid_list_new = aid_list1 + aid_list3</span>
<span class="sd">        &gt;&gt;&gt; result = aid_list_new</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;Cleaning up. Removing added annotations&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ibs.delete_annots(aid_list_new)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [14, 15]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#ut.embed()</span>
    <span class="kn">from</span> <span class="nn">ibeis.model.preproc</span> <span class="kn">import</span> <span class="n">preproc_annot</span>
    <span class="kn">from</span> <span class="nn">vtool</span> <span class="kn">import</span> <span class="n">geometry</span>
    <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[ibs] adding annotations&#39;</span><span class="p">)</span>
    <span class="c"># Prepare the SQL input</span>
    <span class="k">assert</span> <span class="n">name_list</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">nid_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;cannot specify both names and nids&#39;</span>
    <span class="c"># For import only, we can specify both by setting import_override to True</span>
    <span class="k">assert</span> <span class="nb">bool</span><span class="p">(</span><span class="n">bbox_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">vert_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span>
        <span class="s">&#39;must specify exactly one of bbox_list or vert_list&#39;</span><span class="p">)</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">assert_all_not_None</span><span class="p">(</span><span class="n">gid_list</span><span class="p">,</span> <span class="s">&#39;gid_list&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">theta_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">theta_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">))]</span>
    <span class="k">if</span> <span class="n">name_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">nid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">add_names</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">nid_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">nid_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ibs</span><span class="o">.</span><span class="n">UNKNOWN_NAME_ROWID</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">))]</span>
        <span class="n">name_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_name_texts</span><span class="p">(</span><span class="n">nid_list</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">species_rowid_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">species_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;cannot mix species_rowid and species&#39;</span>
        <span class="n">species_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_species_texts</span><span class="p">(</span><span class="n">species_rowid_list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">species_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">species_rowid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">add_species</span><span class="p">(</span><span class="n">species_list</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">species_rowid_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ibs</span><span class="o">.</span><span class="n">UNKNOWN_SPECIES_ROWID</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">))]</span>
            <span class="n">species_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_species_texts</span><span class="p">(</span><span class="n">species_rowid_list</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">detect_confidence_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">detect_confidence_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">))]</span>
    <span class="k">if</span> <span class="n">notes_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">notes_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">))]</span>

    <span class="k">if</span> <span class="n">vert_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">vert_list</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">verts_list_from_bboxes_list</span><span class="p">(</span><span class="n">bbox_list</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">bbox_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bbox_list</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">bboxes_from_vert_list</span><span class="p">(</span><span class="n">vert_list</span><span class="p">)</span>

    <span class="n">len_bbox</span>    <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bbox_list</span><span class="p">)</span>
    <span class="n">len_vert</span>    <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vert_list</span><span class="p">)</span>
    <span class="n">len_gid</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="n">len_notes</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">notes_list</span><span class="p">)</span>
    <span class="n">len_theta</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta_list</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">len_vert</span> <span class="o">==</span> <span class="n">len_bbox</span><span class="p">,</span> <span class="s">&#39;bbox and verts are not of same size&#39;</span>
        <span class="k">assert</span> <span class="n">len_gid</span>  <span class="o">==</span> <span class="n">len_bbox</span><span class="p">,</span> <span class="s">&#39;bbox and gid are not of same size&#39;</span>
        <span class="k">assert</span> <span class="n">len_gid</span>  <span class="o">==</span> <span class="n">len_theta</span><span class="p">,</span> <span class="s">&#39;bbox and gid are not of same size&#39;</span>
        <span class="k">assert</span> <span class="n">len_notes</span> <span class="o">==</span> <span class="n">len_gid</span><span class="p">,</span> <span class="s">&#39;notes and gids are not of same size&#39;</span>
    <span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">printex</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">key_list</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;len_vert&#39;</span><span class="p">,</span> <span class="s">&#39;len_gid&#39;</span><span class="p">,</span> <span class="s">&#39;len_bbox&#39;</span>
                                    <span class="s">&#39;len_theta&#39;</span><span class="p">,</span> <span class="s">&#39;len_notes&#39;</span><span class="p">])</span>
        <span class="k">raise</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c"># nothing is being added</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[ibs] WARNING: 0 annotations are beign added!&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="nb">locals</span><span class="p">()))</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">yaw_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">yaw_list</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="n">nVert_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">verts</span><span class="p">)</span> <span class="k">for</span> <span class="n">verts</span> <span class="ow">in</span> <span class="n">vert_list</span><span class="p">]</span>
    <span class="n">vertstr_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">const</span><span class="o">.</span><span class="n">__STR__</span><span class="p">(</span><span class="n">verts</span><span class="p">)</span> <span class="k">for</span> <span class="n">verts</span> <span class="ow">in</span> <span class="n">vert_list</span><span class="p">]</span>
    <span class="n">xtl_list</span><span class="p">,</span> <span class="n">ytl_list</span><span class="p">,</span> <span class="n">width_list</span><span class="p">,</span> <span class="n">height_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">bbox_list</span><span class="p">))</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nVert_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertstr_list</span><span class="p">)</span>

    <span class="c"># Build ~~deterministic?~~ random and unique ANNOTATION ids</span>
    <span class="n">image_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_image_uuids</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">annot_uuid_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">annot_uuid_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">))]</span>

    <span class="c"># Careful this code is very fragile. It might go out of sync</span>
    <span class="c"># with the updating of the determenistic uuids. Find a way to</span>
    <span class="c"># integrate both pieces of code without too much reundancy.</span>
    <span class="c"># Make sure these tuples are constructed correctly</span>
    <span class="k">if</span> <span class="n">annot_visual_uuid_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">visual_infotup</span> <span class="o">=</span> <span class="p">(</span><span class="n">image_uuid_list</span><span class="p">,</span> <span class="n">vert_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">)</span>
        <span class="n">annot_visual_uuid_list</span> <span class="o">=</span> <span class="n">preproc_annot</span><span class="o">.</span><span class="n">make_annot_visual_uuid</span><span class="p">(</span><span class="n">visual_infotup</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">annot_semantic_uuid_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">semantic_infotup</span> <span class="o">=</span> <span class="p">(</span><span class="n">image_uuid_list</span><span class="p">,</span> <span class="n">vert_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">,</span> <span class="n">yaw_list</span><span class="p">,</span>
                            <span class="n">name_list</span><span class="p">,</span> <span class="n">species_list</span><span class="p">)</span>
        <span class="n">annot_semantic_uuid_list</span> <span class="o">=</span> <span class="n">preproc_annot</span><span class="o">.</span><span class="n">make_annot_semantic_uuid</span><span class="p">(</span><span class="n">semantic_infotup</span><span class="p">)</span>

    <span class="c"># Define arguments to insert</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;annot_uuid&#39;</span><span class="p">,</span> <span class="s">&#39;image_rowid&#39;</span><span class="p">,</span> <span class="s">&#39;annot_xtl&#39;</span><span class="p">,</span> <span class="s">&#39;annot_ytl&#39;</span><span class="p">,</span>
                <span class="s">&#39;annot_width&#39;</span><span class="p">,</span> <span class="s">&#39;annot_height&#39;</span><span class="p">,</span> <span class="s">&#39;annot_theta&#39;</span><span class="p">,</span> <span class="s">&#39;annot_num_verts&#39;</span><span class="p">,</span>
                <span class="s">&#39;annot_verts&#39;</span><span class="p">,</span> <span class="n">ANNOT_YAW</span><span class="p">,</span> <span class="s">&#39;annot_detect_confidence&#39;</span><span class="p">,</span>
                <span class="s">&#39;annot_note&#39;</span><span class="p">,</span> <span class="s">&#39;name_rowid&#39;</span><span class="p">,</span> <span class="s">&#39;species_rowid&#39;</span><span class="p">,</span>
                <span class="s">&#39;annot_visual_uuid&#39;</span><span class="p">,</span> <span class="s">&#39;annot_semantic_uuid&#39;</span><span class="p">)</span>

    <span class="n">params_iter</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">annot_uuid_list</span><span class="p">,</span> <span class="n">gid_list</span><span class="p">,</span> <span class="n">xtl_list</span><span class="p">,</span> <span class="n">ytl_list</span><span class="p">,</span>
                            <span class="n">width_list</span><span class="p">,</span> <span class="n">height_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">,</span> <span class="n">nVert_list</span><span class="p">,</span>
                            <span class="n">vertstr_list</span><span class="p">,</span> <span class="n">yaw_list</span><span class="p">,</span> <span class="n">detect_confidence_list</span><span class="p">,</span>
                            <span class="n">notes_list</span><span class="p">,</span> <span class="n">nid_list</span><span class="p">,</span> <span class="n">species_rowid_list</span><span class="p">,</span>
                           <span class="n">annot_visual_uuid_list</span><span class="p">,</span> <span class="n">annot_semantic_uuid_list</span><span class="p">))</span>

    <span class="c"># Execute add ANNOTATIONs SQL</span>
    <span class="k">if</span> <span class="n">prevent_visual_duplicates</span><span class="p">:</span>
        <span class="n">superkey_paramx</span> <span class="o">=</span> <span class="p">(</span><span class="mi">14</span><span class="p">,)</span>
        <span class="n">get_rowid_from_superkey</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_aids_from_visual_uuid</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">superkey_paramx</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,)</span>
        <span class="n">get_rowid_from_superkey</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_aids_from_uuid</span>
    <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">add_cleanly</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">params_iter</span><span class="p">,</span>
                                  <span class="n">get_rowid_from_superkey</span><span class="p">,</span> <span class="n">superkey_paramx</span><span class="p">)</span>
    <span class="c">#ibs.update_annot_visual_uuids(aid_list)</span>

    <span class="c"># Invalidate image thumbnails, quiet_delete_thumbs causes no output on deletion from ut</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">delete_image_thumbs</span><span class="p">(</span><span class="n">gid_list</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="n">quiet_delete_thumbs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">aid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/rows/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_rows"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_rows">[docs]</a><span class="k">def</span> <span class="nf">get_annot_rows</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Auto-docstr for &#39;get_annot_rows&#39;</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/rows/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;annot_uuid&#39;</span><span class="p">,</span> <span class="s">&#39;image_rowid&#39;</span><span class="p">,</span> <span class="s">&#39;annot_xtl&#39;</span><span class="p">,</span> <span class="s">&#39;annot_ytl&#39;</span><span class="p">,</span>
                <span class="s">&#39;annot_width&#39;</span><span class="p">,</span> <span class="s">&#39;annot_height&#39;</span><span class="p">,</span> <span class="s">&#39;annot_theta&#39;</span><span class="p">,</span> <span class="s">&#39;annot_num_verts&#39;</span><span class="p">,</span>
                <span class="s">&#39;annot_verts&#39;</span><span class="p">,</span> <span class="n">ANNOT_YAW</span><span class="p">,</span> <span class="s">&#39;annot_detect_confidence&#39;</span><span class="p">,</span>
                <span class="s">&#39;annot_note&#39;</span><span class="p">,</span> <span class="s">&#39;name_rowid&#39;</span><span class="p">,</span> <span class="s">&#39;species_rowid&#39;</span><span class="p">,</span>
                <span class="s">&#39;annot_visual_uuid&#39;</span><span class="p">,</span> <span class="s">&#39;annot_semantic_uuid&#39;</span><span class="p">)</span>
    <span class="n">rows_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">unpack_scalars</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rows_list</span>


<span class="c"># ==========</span>
<span class="c"># DELETERS</span>
<span class="c"># ==========</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.deleter</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/nids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;DELETE&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="delete_annot_nids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.delete_annot_nids">[docs]</a><span class="k">def</span> <span class="nf">delete_annot_nids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Remove name assocation from the list of input aids.</span>
<span class="sd">    Does this by setting each annotations nid to the UNKNOWN name rowid</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: DELETE</span>
<span class="sd">        URL:    /api/annot/nids/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># FIXME: This should be implicit by setting the anotation name to the</span>
    <span class="c"># unknown name</span>
    <span class="c">#ibs.delete_annot_relations_oftype(aid_list, const.INDIVIDUAL_KEY)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">set_annot_name_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="p">[</span><span class="n">ibs</span><span class="o">.</span><span class="n">UNKNOWN_NAME_ROWID</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid_list</span><span class="p">))</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.deleter</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/speciesids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;DELETE&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="delete_annot_speciesids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.delete_annot_speciesids">[docs]</a><span class="k">def</span> <span class="nf">delete_annot_speciesids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Deletes nids of a list of annotations</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: DELETE</span>
<span class="sd">        URL:    /api/annot/speciesids/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># FIXME: This should be implicit by setting the anotation name to the</span>
    <span class="c"># unknown species</span>
    <span class="c">#ibs.delete_annot_relations_oftype(aid_list, const.SPECIES_KEY)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">set_annot_species_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="p">[</span><span class="n">ibs</span><span class="o">.</span><span class="n">UNKNOWN_SPECIES_ROWID</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid_list</span><span class="p">))</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.deleter</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">rowidx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">IMAGE_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="p">[</span><span class="n">ANNOT_ROWIDS</span><span class="p">],</span> <span class="n">rowidx</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">NAME_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="p">[</span><span class="n">ANNOT_ROWIDS</span><span class="p">],</span> <span class="n">rowidx</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ENCOUNTER_TABLE</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;percent_names_with_exemplar_str&#39;</span><span class="p">])</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;DELETE&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="delete_annots"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.delete_annots">[docs]</a><span class="k">def</span> <span class="nf">delete_annots</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    deletes annotations from the database</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: DELETE</span>
<span class="sd">        URL:    /api/annot/</span>

<span class="sd">    Args:</span>
<span class="sd">        ibs (IBEISController):  ibeis controller object</span>
<span class="sd">        aid_list (int):  list of annotation ids</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-delete_annots</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-delete_annots --debug-api-cache</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-delete_annots</span>

<span class="sd">    SeeAlso:</span>
<span class="sd">        back.delete_annot</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(defaultdb=&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ibs.delete_empty_nids()</span>
<span class="sd">        &gt;&gt;&gt; # Add some annotations to delete</span>
<span class="sd">        &gt;&gt;&gt; num_add = 2</span>
<span class="sd">        &gt;&gt;&gt; gid_list = ibs.get_valid_gids()[0:num_add]</span>
<span class="sd">        &gt;&gt;&gt; nid = ibs.make_next_nids(1)[0]</span>
<span class="sd">        &gt;&gt;&gt; nid_list = [nid] * num_add</span>
<span class="sd">        &gt;&gt;&gt; bbox_list = [(int(w * .1), int(h * .6), int(w * .5), int(h *  .3))</span>
<span class="sd">        ...              for (w, h) in ibs.get_image_sizes(gid_list)]</span>
<span class="sd">        &gt;&gt;&gt; new_aid_list = ibs.add_annots(gid_list, bbox_list=bbox_list, nid_list=nid_list)</span>
<span class="sd">        &gt;&gt;&gt; ibs.get_annot_nids(new_aid_list)</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_lists_eq(ibs.get_annot_nids(new_aid_list), nid_list)</span>
<span class="sd">        &gt;&gt;&gt; assert ibs.get_name_aids(nid) == new_aid_list, &#39;annots should all have same name&#39;</span>
<span class="sd">        &gt;&gt;&gt; assert new_aid_list == ibs.get_name_aids(nid), &#39;inverse name mapping should work&#39;</span>
<span class="sd">        &gt;&gt;&gt; before_gids = ibs.get_image_aids(gid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;BEFORE gids: &#39; + str(before_gids))</span>
<span class="sd">        &gt;&gt;&gt; result = ibs.delete_annots(new_aid_list)</span>
<span class="sd">        &gt;&gt;&gt; assert ibs.get_name_aids(nid) == [], &#39;annots should be removed&#39;</span>
<span class="sd">        &gt;&gt;&gt; after_gids = ibs.get_image_aids(gid_list)</span>
<span class="sd">        &gt;&gt;&gt; assert after_gids != before_gids, &#39;the invalidators must have bugs&#39;</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;AFTER gids: &#39; + str(after_gids))</span>
<span class="sd">        &gt;&gt;&gt; valid_aids = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; assert  [aid not in valid_aids for aid in new_aid_list], &#39;should no longer be valid aids&#39;</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        &gt;&gt;&gt; ibs.delete_empty_nids()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[ibs] deleting </span><span class="si">%d</span><span class="s"> annotations&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid_list</span><span class="p">))</span>
    <span class="c"># Delete chips and features first</span>
    <span class="kn">from</span> <span class="nn">ibeis.model.preproc</span> <span class="kn">import</span> <span class="n">preproc_annot</span>
    <span class="n">preproc_annot</span><span class="o">.</span><span class="n">on_delete</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="c"># TODO:</span>
    <span class="c"># delete parent rowid column if exists in annot table</span>
    <span class="k">return</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">delete_rowids</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)</span>


<span class="c"># ==========</span>
<span class="c"># GETTERS</span>
<span class="c"># ==========</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/aids_from_semantic_uuid/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_aids_from_semantic_uuid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_aids_from_semantic_uuid">[docs]</a><span class="k">def</span> <span class="nf">get_annot_aids_from_semantic_uuid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">semantic_uuid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        semantic_uuid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot rowids</span>


<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/aids_from_semantic_uuid/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">aids_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_ROWID</span><span class="p">,),</span>
                           <span class="n">semantic_uuid_list</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="n">ANNOT_SEMANTIC_UUID</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">aids_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/aids_from_uuid/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_aids_from_uuid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_aids_from_uuid">[docs]</a><span class="k">def</span> <span class="nf">get_annot_aids_from_uuid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">uuid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        list_ (list): annot rowids</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/aids_from_uuid/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># FIXME: MAKE SQL-METHOD FOR NON-ROWID GETTERS</span>
    <span class="n">aids_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_ROWID</span><span class="p">,),</span> <span class="n">uuid_list</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="n">ANNOT_UUID</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">aids_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/aids_from_visual_uuid/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_aids_from_visual_uuid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_aids_from_visual_uuid">[docs]</a><span class="k">def</span> <span class="nf">get_annot_aids_from_visual_uuid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">visual_uuid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        visual_uuid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot rowids</span>


<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/aids_from_visual_uuid/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">aids_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_ROWID</span><span class="p">,),</span>
                           <span class="n">visual_uuid_list</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="n">ANNOT_VISUAL_UUID</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">aids_list</span>
</div>
<span class="n">get_annot_rowids_from_visual_uuid</span> <span class="o">=</span> <span class="n">get_annot_aids_from_visual_uuid</span>


<span class="nd">@register_ibs_method</span>
<span class="nd">@ut.accepts_numpy</span>
<span class="nd">@accessor_decors.getter_1toM</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/bboxes/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_bboxes"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_bboxes">[docs]</a><span class="k">def</span> <span class="nf">get_annot_bboxes</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        bbox_list (list):  annotation bounding boxes in image space</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/bboxes/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;annot_xtl&#39;</span><span class="p">,</span> <span class="s">&#39;annot_ytl&#39;</span><span class="p">,</span> <span class="s">&#39;annot_width&#39;</span><span class="p">,</span> <span class="s">&#39;annot_height&#39;</span><span class="p">,)</span>
    <span class="n">bbox_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bbox_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/class_labels/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_class_labels"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_class_labels">[docs]</a><span class="k">def</span> <span class="nf">get_annot_class_labels</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    DEPRICATE?</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of tuples: identifying animal name and view</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/class_labels/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="c"># TODO: use yaw?</span>
    <span class="n">yaw_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">name_list</span><span class="p">]</span>
    <span class="n">classlabel_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span> <span class="n">yaw_list</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">classlabel_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/detect_confidence/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_detect_confidence"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_detect_confidence">[docs]</a><span class="k">def</span> <span class="nf">get_annot_detect_confidence</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        list_ (list): a list confidences that the annotations is a valid detection</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/detect_confidence/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">annot_detect_confidence_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span>
                                              <span class="p">(</span><span class="s">&#39;annot_detect_confidence&#39;</span><span class="p">,),</span>
                                              <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_detect_confidence_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/exemplar_flags/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_exemplar_flags"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_exemplar_flags">[docs]</a><span class="k">def</span> <span class="nf">get_annot_exemplar_flags</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    returns if an annotation is an exemplar</span>

<span class="sd">    Args:</span>
<span class="sd">        ibs (IBEISController):  ibeis controller object</span>
<span class="sd">        aid_list (int):  list of annotation ids</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot_exemplar_flag_list - True if annotation is an exemplar</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_exemplar_flags</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/exemplar_flags/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; gid_list = get_annot_exemplar_flags(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; result = str(gid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">annot_exemplar_flag_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span>
                                          <span class="p">(</span><span class="s">&#39;annot_exemplar_flag&#39;</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_exemplar_flag_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@ut.accepts_numpy</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="c">#@cache_getter(const.ANNOTATION_TABLE, &#39;image_rowid&#39;)</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/gids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_gids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_gids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_gids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Get parent image rowids of annotations</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        gid_list (list):  image rowids</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/gids/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; result = get_annot_gids(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;image_rowid&#39;</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<div class="viewcode-block" id="get_annot_image_rowids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_image_rowids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_image_rowids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@ut.accepts_numpy</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="c">#@cache_getter(const.ANNOTATION_TABLE, &#39;image_rowid&#39;)</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/eids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_eids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_eids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_eids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Get parent image rowids of annotations</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        eid_list (list):  encounter rowids</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/eids/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; result = get_annot_gids(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;image_rowid&#39;</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">eids_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_image_eids</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">eids_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1toM</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/otherimage_aids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_otherimage_aids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_otherimage_aids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_otherimage_aids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Auto-docstr for &#39;get_annot_otherimage_aids&#39;</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/otherimage_aids/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">image_aids_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_image_aids</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="c"># Remove self from list</span>
    <span class="n">other_aids_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">aids</span><span class="p">)</span> <span class="o">-</span> <span class="p">{</span><span class="n">aid</span><span class="p">})</span>
                       <span class="k">for</span> <span class="n">aids</span><span class="p">,</span> <span class="n">aid</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">image_aids_list</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">other_aids_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1toM</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/gar_rowids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_gar_rowids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_gar_rowids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_gar_rowids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Auto-docstr for &#39;get_annot_otherimage_aids&#39;</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/gar_rowids/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">GAR_ROWID</span><span class="p">,)</span>
    <span class="n">gar_rowid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">GA_RELATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span>
                                <span class="n">id_colname</span><span class="o">=</span><span class="n">ANNOT_ROWID</span><span class="p">,</span> <span class="n">unpack_scalars</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gar_rowid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1toM</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/contact_aids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_contact_aids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_contact_aids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_contact_aids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns the other aids that appear in the same image that this</span>
<span class="sd">    annotation is from.</span>

<span class="sd">    Args:</span>
<span class="sd">        ibs (IBEISController):  ibeis controller object</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_contact_aids</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/contact_aids/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; contact_aids = ibs.get_annot_contact_aids(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; contact_gids = ibs.unflat_map(ibs.get_annot_gids, contact_aids)</span>
<span class="sd">        &gt;&gt;&gt; gid_list = ibs.get_annot_gids(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; for gids, gid, aids, aid in zip(contact_gids, gid_list, contact_aids, aid_list):</span>
<span class="sd">        ...     assert ut.list_allsame(gids), &#39;annots should be from same image&#39;</span>
<span class="sd">        ...     assert len(gids) == 0 or gids[0] == gid, &#39;and same image as parent annot&#39;</span>
<span class="sd">        ...     assert aid not in aids, &#39;should not include self&#39;</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; contact_aids = ibs.get_annot_contact_aids(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; contact_gids = ibs.unflat_map(ibs.get_annot_gids, contact_aids)</span>
<span class="sd">        &gt;&gt;&gt; gid_list = ibs.get_annot_gids(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; for gids, gid, aids, aid in zip(contact_gids, gid_list, contact_aids, aid_list):</span>
<span class="sd">        ...     assert ut.list_allsame(gids), &#39;annots should be from same image&#39;</span>
<span class="sd">        ...     assert len(gids) == 0 or gids[0] == gid, &#39;and same image as parent annot&#39;</span>
<span class="sd">        ...     assert aid not in aids, &#39;should not include self&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">other_aids_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_otherimage_aids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">check_intersection</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="n">check_intersection</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">shapely.geometry</span>
        <span class="c"># TODO: might not be accounting for rotated verticies</span>
        <span class="n">verts_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_verts</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
        <span class="n">other_verts_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">unflat_map</span><span class="p">(</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_verts</span><span class="p">,</span> <span class="n">other_aids_list</span><span class="p">)</span>
        <span class="n">poly_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span><span class="n">verts</span><span class="p">)</span> <span class="k">for</span> <span class="n">verts</span> <span class="ow">in</span> <span class="n">verts_list</span><span class="p">]</span>
        <span class="n">other_polys_list</span> <span class="o">=</span> <span class="p">[[</span><span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span><span class="n">verts</span><span class="p">)</span> <span class="k">for</span> <span class="n">verts</span> <span class="ow">in</span> <span class="n">_</span><span class="p">]</span>
                            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">other_verts_list</span><span class="p">]</span>
        <span class="n">flags_list</span> <span class="o">=</span> <span class="p">[[</span><span class="n">p1</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span> <span class="k">for</span> <span class="n">p2</span> <span class="ow">in</span> <span class="n">p2_list</span><span class="p">]</span>
                      <span class="k">for</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">poly_list</span><span class="p">,</span> <span class="n">other_polys_list</span><span class="p">)]</span>
        <span class="n">contact_aids</span> <span class="o">=</span> <span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">list_compress</span><span class="p">(</span><span class="n">other_aids</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">other_aids</span><span class="p">,</span> <span class="n">flags</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">other_aids_list</span><span class="p">,</span> <span class="n">flags_list</span><span class="p">)]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">contact_aids</span> <span class="o">=</span> <span class="n">other_aids_list</span>
    <span class="k">return</span> <span class="n">contact_aids</span>


<span class="c">#@register_ibs_method</span>
<span class="c">#@accessor_decors.getter_1toM</span>
<span class="c">#def get_annot_intersecting_aids(ibs, aid_list):</span>
<span class="c">#    pass</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/num_contact_aids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_num_contact_aids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_num_contact_aids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_num_contact_aids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Auto-docstr for &#39;get_annot_num_contact_aids&#39;</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/num_contact_aids/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nOther_aids_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_contact_aids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">nOther_aids_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1toM</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/groundfalse/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_groundfalse"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_groundfalse">[docs]</a><span class="k">def</span> <span class="nf">get_annot_groundfalse</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">is_exemplar</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">valid_aids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">filter_unknowns</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">daid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    gets all annotations with different names</span>

<span class="sd">    Returns:</span>
<span class="sd">        groundfalse_list (list): a list of aids which are known to be different for each</span>

<span class="sd">    #Example:</span>
<span class="sd">    #    &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">    #    &gt;&gt;&gt; import ibeis</span>
<span class="sd">    #    &gt;&gt;&gt; ibs = ibeis.opendb(&#39;PZ_MTEST&#39;)</span>
<span class="sd">    #    &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">    #    &gt;&gt;&gt; is_exemplar, noself, daid_list = None, True, None</span>
<span class="sd">    #    &gt;&gt;&gt; groundfalse_list = ibs.get_annot_groundfalse(aid_list)</span>
<span class="sd">    #    &gt;&gt;&gt; result = str(groundtruth_list)</span>
<span class="sd">    #    &gt;&gt;&gt; print(result)</span>


<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/groundfalse/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">valid_aids</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c"># get all valid aids if not specified</span>
        <span class="c"># really the examplar flag should not be allowed and only daids</span>
        <span class="c"># should be taken as input</span>
        <span class="n">valid_aids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">is_exemplar</span><span class="o">=</span><span class="n">is_exemplar</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">daid_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">valid_aids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">daid_list</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">valid_aids</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">filter_unknowns</span><span class="p">:</span>
        <span class="c"># Remove aids which do not have a name</span>
        <span class="n">isunknown_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">is_aid_unknown</span><span class="p">(</span><span class="n">valid_aids</span><span class="p">)</span>
        <span class="n">valid_aids_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">filterfalse_items</span><span class="p">(</span><span class="n">valid_aids</span><span class="p">,</span> <span class="n">isunknown_list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">valid_aids_</span> <span class="o">=</span> <span class="n">valid_aids</span>
    <span class="c"># Build the set of groundfalse annotations</span>
    <span class="n">nid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">aids_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_name_aids</span><span class="p">(</span><span class="n">nid_list</span><span class="p">,</span> <span class="n">enable_unknown_fix</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">aids_setlist</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="n">aids_list</span><span class="p">)</span>
    <span class="n">valid_aids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">valid_aids_</span><span class="p">)</span>
    <span class="n">groundfalse_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">valid_aids</span> <span class="o">-</span> <span class="n">aids</span><span class="p">)</span> <span class="k">for</span> <span class="n">aids</span> <span class="ow">in</span> <span class="n">aids_setlist</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">groundfalse_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1toM</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/groundtruth/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_groundtruth"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_groundtruth">[docs]</a><span class="k">def</span> <span class="nf">get_annot_groundtruth</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">is_exemplar</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">noself</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                          <span class="n">daid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    gets all annotations with the same names</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list    (list): list of annotation rowids to get groundtruth of</span>
<span class="sd">        is_exemplar (None):</span>
<span class="sd">        noself      (bool):</span>
<span class="sd">        daid_list   (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        groundtruth_list (list): a list of aids with the same name foreach</span>
<span class="sd">        aid in aid_list.  a set of aids belonging to the same name is called</span>
<span class="sd">        a groundtruth.  A list of these is called a groundtruth_list.</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_groundtruth:0</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_groundtruth:1</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_groundtruth:2</span>
<span class="sd">        python -m --tf get_annot_groundtruth:0 --db=PZ_Master0 --aids=97 --exec-mode</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/groundtruth/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(defaultdb=&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ut.get_argval(&#39;--aids&#39;, list, ibs.get_valid_aids())</span>
<span class="sd">        &gt;&gt;&gt; is_exemplar, noself, daid_list = None, True, None</span>
<span class="sd">        &gt;&gt;&gt; groundtruth_list = ibs.get_annot_groundtruth(aid_list, is_exemplar, noself, daid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = &#39;groundtruth_list = &#39; + str(groundtruth_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        groundtruth_list = [[], [3], [2], [], [6], [5], [], [], [], [], [], [], []]</span>

<span class="sd">    Example1:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; is_exemplar, noself, daid_list = True, True, None</span>
<span class="sd">        &gt;&gt;&gt; groundtruth_list = ibs.get_annot_groundtruth(aid_list, is_exemplar, noself, daid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = str(groundtruth_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [[], [3], [2], [], [6], [5], [], [], [], [], [], [], []]</span>

<span class="sd">    Example2:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; is_exemplar, noself, daid_list = False, False, aid_list</span>
<span class="sd">        &gt;&gt;&gt; groundtruth_list = ibs.get_annot_groundtruth(aid_list, is_exemplar, noself, daid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = str(groundtruth_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [[1], [], [], [4], [], [], [], [], [9], [], [11], [], []]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO: Optimize</span>
    <span class="n">nid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="c">#if daid_list is not None:</span>
    <span class="c">#    # when given a valid pool try to skip the get_name_aids call</span>
    <span class="c">#    aids_list_, nid_list_ = ibs.group_annots_by_name(daid_list, distinguish_unknowns=True)</span>
    <span class="c">#    nid2_aids = dict(zip(nid_list_, aids_list_))</span>
    <span class="c">#    aids_list = ut.dict_take(nid2_aids, nid_list, [])</span>
    <span class="c">#else:</span>
    <span class="n">aids_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_name_aids</span><span class="p">(</span><span class="n">nid_list</span><span class="p">,</span> <span class="n">enable_unknown_fix</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_exemplar</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">groundtruth_list_</span> <span class="o">=</span> <span class="n">aids_list</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c"># Filter out non-exemplars</span>
        <span class="n">exemplar_flags_list</span> <span class="o">=</span> <span class="n">ibsfuncs</span><span class="o">.</span><span class="n">unflat_map</span><span class="p">(</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_exemplar_flags</span><span class="p">,</span> <span class="n">aids_list</span><span class="p">)</span>
        <span class="n">isvalids_list</span> <span class="o">=</span> <span class="p">[[</span><span class="n">flag</span> <span class="o">==</span> <span class="n">is_exemplar</span> <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">flags</span><span class="p">]</span> <span class="k">for</span> <span class="n">flags</span> <span class="ow">in</span> <span class="n">exemplar_flags_list</span><span class="p">]</span>
        <span class="n">groundtruth_list_</span> <span class="o">=</span> <span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">list_compress</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">isvalids</span><span class="p">)</span>
                             <span class="k">for</span> <span class="n">aids</span><span class="p">,</span> <span class="n">isvalids</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">aids_list</span><span class="p">,</span> <span class="n">isvalids_list</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">noself</span><span class="p">:</span>
        <span class="c"># Remove yourself from the set</span>
        <span class="n">groundtruth_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">aids</span><span class="p">)</span> <span class="o">-</span> <span class="p">{</span><span class="n">aid</span><span class="p">})</span>
                            <span class="k">for</span> <span class="n">aids</span><span class="p">,</span> <span class="n">aid</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">groundtruth_list_</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">groundtruth_list</span> <span class="o">=</span> <span class="n">groundtruth_list_</span>

    <span class="k">if</span> <span class="n">daid_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c"># filter out any groundtruth that isn&#39;t allowed</span>
        <span class="n">daid_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">daid_list</span><span class="p">)</span>
        <span class="n">groundtruth_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">daid_set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">aids</span><span class="p">)))</span> <span class="k">for</span> <span class="n">aids</span> <span class="ow">in</span> <span class="n">groundtruth_list</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">groundtruth_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/has_groundtruth/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_has_groundtruth"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_has_groundtruth">[docs]</a><span class="k">def</span> <span class="nf">get_annot_has_groundtruth</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">is_exemplar</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">noself</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">daid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list    (list):</span>
<span class="sd">        is_exemplar (None):</span>
<span class="sd">        noself      (bool):</span>
<span class="sd">        daid_list   (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: has_gt_list</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_has_groundtruth</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/has_groundtruth/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; is_exemplar = None</span>
<span class="sd">        &gt;&gt;&gt; noself = True</span>
<span class="sd">        &gt;&gt;&gt; daid_list = None</span>
<span class="sd">        &gt;&gt;&gt; has_gt_list = get_annot_has_groundtruth(ibs, aid_list, is_exemplar, noself, daid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = str(has_gt_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO: Optimize</span>
    <span class="n">numgts_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_num_groundtruth</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">is_exemplar</span><span class="o">=</span><span class="n">is_exemplar</span><span class="p">,</span>
                                                <span class="n">noself</span><span class="o">=</span><span class="n">noself</span><span class="p">,</span>
                                                <span class="n">daid_list</span><span class="o">=</span><span class="n">daid_list</span><span class="p">)</span>
    <span class="n">has_gt_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">num_gts</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">num_gts</span> <span class="ow">in</span> <span class="n">numgts_list</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">has_gt_list</span>


<span class="c">#@register_ibs_method</span>
<span class="c">#def get_annot_hashid_rowid(ibs, aid_list, prefix=&#39;&#39;):</span>
<span class="c">#    raise AssertionError(&#39;You probably want to call a uuid hash id method&#39;)</span>
<span class="c">#    label = &#39;&#39;.join((&#39;_&#39;, prefix, &#39;UUIDS&#39;))</span>
<span class="c">#    aids_hashid = ut.hashstr_arr(aid_list, label)</span>
<span class="c">#    return aids_hashid</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/hashid_uuid/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_hashid_uuid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_hashid_uuid">[docs]</a><span class="k">def</span> <span class="nf">get_annot_hashid_uuid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    builds an aggregate random hash id for a list of aids</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/hashid_uuid/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">uuid_list</span>    <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s">&#39;_&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="s">&#39;UUIDS&#39;</span><span class="p">))</span>
    <span class="n">uuid_hashid</span>  <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr_arr</span><span class="p">(</span><span class="n">uuid_list</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">uuid_hashid</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/hashid_visual_uuid/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_hashid_visual_uuid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_hashid_visual_uuid">[docs]</a><span class="k">def</span> <span class="nf">get_annot_hashid_visual_uuid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">_new</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    builds an aggregate visual hash id for a list of aids</span>

<span class="sd">    Args:</span>
<span class="sd">        _new (bool): Eventually we will change the hashing scheme and all old</span>
<span class="sd">            data will be invalidated. (default=False)</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/hashid_visual_uuid/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">visual_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_visual_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s">&#39;_&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="s">&#39;VUUIDS&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">_new</span><span class="p">:</span>
        <span class="n">visual_uuid_hashid</span>  <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr_arr27</span><span class="p">(</span><span class="n">visual_uuid_list</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">pathsafe</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">visual_uuid_hashid</span>  <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr_arr</span><span class="p">(</span><span class="n">visual_uuid_list</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">visual_uuid_hashid</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/hashid_semantic_uuid/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_hashid_semantic_uuid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_hashid_semantic_uuid">[docs]</a><span class="k">def</span> <span class="nf">get_annot_hashid_semantic_uuid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">_new</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    builds an aggregate semantic hash id for a list of aids</span>

<span class="sd">    Args:</span>
<span class="sd">        _new (bool): Eventually we will change the hashing scheme and all old</span>
<span class="sd">            data will be invalidated. (default=False)</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/hashid_semantic_uuid/</span>


<span class="sd">    Args:</span>
<span class="sd">        ibs (IBEISController):  ibeis controller object</span>
<span class="sd">        aid_list (list):  list of annotation rowids</span>
<span class="sd">        prefix (str): (default = &#39;&#39;)</span>
<span class="sd">        _new (bool): (default = False)</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: semantic_uuid_hashid</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --exec-get_annot_hashid_semantic_uuid</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(defaultdb=&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[0:2]</span>
<span class="sd">        &gt;&gt;&gt; prefix = &#39;&#39;</span>
<span class="sd">        &gt;&gt;&gt; _new = False</span>
<span class="sd">        &gt;&gt;&gt; semantic_uuid_hashid = get_annot_hashid_semantic_uuid(ibs, aid_list, prefix, _new)</span>
<span class="sd">        &gt;&gt;&gt; result = ut.list_str(ibs.get_annot_semantic_uuids(aid_list)) + &#39;\n&#39;</span>
<span class="sd">        &gt;&gt;&gt; result += (&#39;semantic_uuid_hashid = %s&#39; % (str(semantic_uuid_hashid),))</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [</span>
<span class="sd">            UUID(&#39;bf774bf3-582d-dbce-6ca6-329adeb086a6&#39;),</span>
<span class="sd">            UUID(&#39;60f10a02-1bd1-c2b4-75bb-a34c0a4b6867&#39;),</span>
<span class="sd">        ]</span>
<span class="sd">        semantic_uuid_hashid = _SUUIDS((2)49@orjsiy@lbibo6)</span>

<span class="sd">        [</span>
<span class="sd">            UUID(&#39;215ab5f9-fe53-d7d1-59b8-d6b5ce7e6ca6&#39;),</span>
<span class="sd">            UUID(&#39;60f10a02-1bd1-c2b4-75bb-a34c0a4b6867&#39;),</span>
<span class="sd">        ]</span>
<span class="sd">        semantic_uuid_hashid = _SUUIDS((2)w9l23schf96c2n63)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">semantic_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_semantic_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s">&#39;_&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="s">&#39;SUUIDS&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">_new</span><span class="p">:</span>
        <span class="n">semantic_uuid_hashid</span>  <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr_arr27</span><span class="p">(</span><span class="n">semantic_uuid_list</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">pathsafe</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">semantic_uuid_hashid</span>  <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr_arr</span><span class="p">(</span><span class="n">semantic_uuid_list</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">semantic_uuid_hashid</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/thetas/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_thetas"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_thetas">[docs]</a><span class="k">def</span> <span class="nf">get_annot_thetas</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        theta_list (list): a list of floats describing the angles of each chip</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_thetas</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/thetas/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;NAUT_test&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; result = get_annot_thetas(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [2.75742, 0.792917, 2.53605, 2.67795, 0.946773, 2.56729]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">theta_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;annot_theta&#39;</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">theta_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/uuids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_uuids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_uuids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_uuids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        list: annot_uuid_list a list of image uuids by aid</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/uuids/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">annot_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;annot_uuid&#39;</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_uuid_list</span>


<span class="c"># It is a good idea to have the cache on for the annot uuids, they are quite slow to load</span></div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@accessor_decors.cache_getter</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">ANNOT_SEMANTIC_UUID</span><span class="p">)</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/semantic_uuids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_semantic_uuids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_semantic_uuids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_semantic_uuids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    annot_semantic_uuid_list &lt;- annot.annot_semantic_uuid[aid_list]</span>

<span class="sd">    gets data from the &quot;native&quot; column &quot;annot_semantic_uuid&quot; in the &quot;annot&quot; table</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot_semantic_uuid_list</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_semantic_uuids</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/semantic_uuids/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; ibs, qreq_ = testdata_ibs()</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs._get_all_aids()[0:1]</span>
<span class="sd">        &gt;&gt;&gt; annot_semantic_uuid_list = ibs.get_annot_semantic_uuids(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; assert len(aid_list) == len(annot_semantic_uuid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = annot_semantic_uuid_list</span>
<span class="sd">        [UUID(&#39;bf774bf3-582d-dbce-6ca6-329adeb086a6&#39;)]</span>

<span class="sd">        [UUID(&#39;215ab5f9-fe53-d7d1-59b8-d6b5ce7e6ca6&#39;)]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">ANNOT_SEMANTIC_UUID</span><span class="p">,)</span>
    <span class="n">annot_semantic_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="s">&#39;rowid&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_semantic_uuid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@accessor_decors.cache_getter</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">ANNOT_VISUAL_UUID</span><span class="p">)</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/visual_uuids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_visual_uuids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_visual_uuids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_visual_uuids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    The image uuid, annotation verticies, are theta is hashted together to</span>
<span class="sd">    compute the visual uuid.  The visual uuid does not include name or species</span>
<span class="sd">    information.</span>

<span class="sd">    annot_visual_uuid_list &lt;- annot.annot_visual_uuid[aid_list]</span>

<span class="sd">    gets data from the &quot;native&quot; column &quot;annot_visual_uuid&quot; in the &quot;annot&quot; table</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot_visual_uuid_list</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_visual_uuids</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/visual_uuids/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; ibs, qreq_ = testdata_ibs()</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs._get_all_aids()[0:1]</span>
<span class="sd">        &gt;&gt;&gt; annot_visual_uuid_list = ibs.get_annot_visual_uuids(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; assert len(aid_list) == len(annot_visual_uuid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = annot_visual_uuid_list</span>
<span class="sd">        [UUID(&#39;8687dcb6-1f1f-fdd3-8b72-8f36f9f41905&#39;)]</span>

<span class="sd">        [UUID(&#39;76de0416-7c92-e1b3-4a17-25df32e9c2b4&#39;)]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">ANNOT_VISUAL_UUID</span><span class="p">,)</span>
    <span class="n">annot_visual_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="s">&#39;rowid&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_visual_uuid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/verts/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_verts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_verts">[docs]</a><span class="k">def</span> <span class="nf">get_annot_verts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        vert_list (list): the vertices that form the polygon of each chip</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/verts/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ibeis.model.preproc</span> <span class="kn">import</span> <span class="n">preproc_annot</span>
    <span class="n">vertstr_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;annot_verts&#39;</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">vert_list</span> <span class="o">=</span> <span class="n">preproc_annot</span><span class="o">.</span><span class="n">postget_annot_verts</span><span class="p">(</span><span class="n">vertstr_list</span><span class="p">)</span>
    <span class="c">#vert_list = [eval(vertstr, {}, {}) for vertstr in vertstr_list]</span>
    <span class="k">return</span> <span class="n">vert_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/rotated_verts/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_rotated_verts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_rotated_verts">[docs]</a><span class="k">def</span> <span class="nf">get_annot_rotated_verts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        rotated_vert_list (list): verticies after rotation by theta.</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/rotated_verts/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
    <span class="n">vert_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_verts</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">theta_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_thetas</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="c"># Convex bounding boxes for verticies</span>
    <span class="n">bbox_list</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">bboxes_from_vert_list</span><span class="p">(</span><span class="n">vert_list</span><span class="p">)</span>
    <span class="n">rot_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">vt</span><span class="o">.</span><span class="n">rotation_around_bbox_mat3x3</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">bbox</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">theta</span><span class="p">,</span> <span class="n">bbox</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">theta_list</span><span class="p">,</span> <span class="n">bbox_list</span><span class="p">)]</span>
    <span class="n">rotated_vert_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">vt</span><span class="o">.</span><span class="n">transform_points_with_homography</span><span class="p">(</span><span class="n">rot</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">verts</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                         <span class="k">for</span> <span class="n">rot</span><span class="p">,</span> <span class="n">verts</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rot_list</span><span class="p">,</span> <span class="n">vert_list</span><span class="p">)]</span>
    <span class="c">#vert_list = [eval(vertstr, {}, {}) for vertstr in vertstr_list]</span>
    <span class="k">return</span> <span class="n">rotated_vert_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@accessor_decors.cache_getter</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">ANNOT_YAW</span><span class="p">)</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/yaws/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_yaws"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_yaws">[docs]</a><span class="k">def</span> <span class="nf">get_annot_yaws</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    A yaw is the yaw of the annotation in radians</span>
<span class="sd">    Viewpoint yaw is inverted. Will be fixed soon.</span>

<span class="sd">    The following views have these angles of yaw:</span>
<span class="sd">        left side  - 0.50 tau radians</span>
<span class="sd">        front side - 0.25 tau radians</span>
<span class="sd">        right side - 0.00 tau radians</span>
<span class="sd">        back side  - 0.75 tau radians</span>

<span class="sd">        tau = 2 * pi</span>

<span class="sd">    SeeAlso:</span>
<span class="sd">        ibies.const.VIEWTEXT_TO_YAW_RADIANS</span>

<span class="sd">    Returns:</span>
<span class="sd">        yaw_list (list): the yaw (in radians) for the annotation</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_yaws</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/yaws/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[::3]</span>
<span class="sd">        &gt;&gt;&gt; result = get_annot_yaws(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [None, None, None, None, None]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#from ibeis.model.preproc import preproc_annot</span>
    <span class="n">yaw_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_YAW</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">yaw_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">yaw</span> <span class="k">if</span> <span class="n">yaw</span> <span class="o">&gt;=</span> <span class="mf">0.0</span> <span class="k">else</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">yaw</span> <span class="ow">in</span> <span class="n">yaw_list</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">yaw_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<div class="viewcode-block" id="get_annot_yaws_asfloat"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_yaws_asfloat">[docs]</a><span class="k">def</span> <span class="nf">get_annot_yaws_asfloat</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Ensures that Nones are returned as nans</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">yaw_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_yaws</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">yaw_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">replace_nones</span><span class="p">(</span><span class="n">yaw_list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">yaw_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.setter</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">[</span><span class="n">ANNOT_YAW</span><span class="p">],</span> <span class="n">rowidx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/yaws/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_yaws"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_yaws">[docs]</a><span class="k">def</span> <span class="nf">set_annot_yaws</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">yaw_list</span><span class="p">,</span> <span class="n">input_is_degrees</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Sets the  yaw of a list of chips by aid</span>

<span class="sd">    A yaw is the yaw of the annotation in radians</span>
<span class="sd">    Viewpoint yaw is inverted. Will be fixed soon.</span>

<span class="sd">    Note:</span>
<span class="sd">        The following views have these angles of yaw:</span>
<span class="sd">            left side  - 0.00 tau radians</span>
<span class="sd">            front side - 0.25 tau radians</span>
<span class="sd">            right side - 0.50 tau radians</span>
<span class="sd">            back side  - 0.75 tau radians</span>
<span class="sd">            (tau = 2 * pi)</span>

<span class="sd">    SeeAlso:</span>
<span class="sd">        ibies.const.VIEWTEXT_TO_YAW_RADIANS</span>

<span class="sd">    References:</span>
<span class="sd">        http://upload.wikimedia.org/wikipedia/commons/7/7e/Rollpitchyawplain.png</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/yaws/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="c">#yaw_list = [-1 if yaw is None else yaw for yaw in yaw_list]</span>
    <span class="k">if</span> <span class="n">input_is_degrees</span><span class="p">:</span>
        <span class="n">yaw_list</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">yaw</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">ut</span><span class="o">.</span><span class="n">deg_to_rad</span><span class="p">(</span><span class="n">yaw</span><span class="p">)</span> <span class="k">for</span> <span class="n">yaw</span> <span class="ow">in</span> <span class="n">yaw_list</span><span class="p">]</span>
    <span class="c">#assert all([0.0 &lt;= yaw &lt; 2 * np.pi or yaw == -1.0 for yaw in yaw_list])</span>
    <span class="n">val_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">yaw</span><span class="p">,</span> <span class="p">)</span> <span class="k">for</span> <span class="n">yaw</span> <span class="ow">in</span> <span class="n">yaw_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_YAW</span><span class="p">,),</span> <span class="n">val_iter</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">update_annot_visual_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/notes/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_notes"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_notes">[docs]</a><span class="k">def</span> <span class="nf">get_annot_notes</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        annotation_notes_list (list): a list of annotation notes</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/notes/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">annotation_notes_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_NOTE</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annotation_notes_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/num_groundtruth/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_num_groundtruth"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_num_groundtruth">[docs]</a><span class="k">def</span> <span class="nf">get_annot_num_groundtruth</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">is_exemplar</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">noself</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                              <span class="n">daid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        list_ (list): number of other chips with the same name</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/num_groundtruth/</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_num_groundtruth</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_num_groundtruth:0</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_num_groundtruth:1</span>

<span class="sd">    Example1:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; noself = True</span>
<span class="sd">        &gt;&gt;&gt; result = get_annot_num_groundtruth(ibs, aid_list, noself=noself)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0]</span>

<span class="sd">    Example2:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; noself = False</span>
<span class="sd">        &gt;&gt;&gt; result = get_annot_num_groundtruth(ibs, aid_list, noself=noself)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [1, 2, 2, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO: Optimize</span>
    <span class="n">groundtruth_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_groundtruth</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span>
                                                 <span class="n">is_exemplar</span><span class="o">=</span><span class="n">is_exemplar</span><span class="p">,</span>
                                                 <span class="n">noself</span><span class="o">=</span><span class="n">noself</span><span class="p">,</span>
                                                 <span class="n">daid_list</span><span class="o">=</span><span class="n">daid_list</span><span class="p">)</span>
    <span class="n">nGt_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">groundtruth_list</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">nGt_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/num_verts/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_num_verts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_num_verts">[docs]</a><span class="k">def</span> <span class="nf">get_annot_num_verts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        nVerts_list (list): the number of vertices that form the polygon of each chip</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/num_verts/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nVerts_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_NUM_VERTS</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nVerts_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/parent_aid/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_parent_aid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_parent_aid">[docs]</a><span class="k">def</span> <span class="nf">get_annot_parent_aid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        list_ (list): a list of parent (in terms of parts) annotation rowids.</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/parent_aid/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">annot_parent_rowid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_PARENT_ROWID</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_parent_rowid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@ut.accepts_numpy</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@accessor_decors.cache_getter</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">NAME_ROWID</span><span class="p">,</span> <span class="n">cfgkeys</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;distinguish_unknowns&#39;</span><span class="p">])</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/name_rowids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_name_rowids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_name_rowids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_name_rowids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">distinguish_unknowns</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        list_ (list): the name id of each annotation.</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/name_rowids/</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --exec-get_annot_name_rowids</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; distinguish_unknowns = True</span>
<span class="sd">        &gt;&gt;&gt; nid_arr1 = np.array(ibs.get_annot_name_rowids(aid_list, distinguish_unknowns=distinguish_unknowns))</span>
<span class="sd">        &gt;&gt;&gt; nid_arr2 = np.array(ibs.get_annot_name_rowids(aid_list, distinguish_unknowns=False))</span>
<span class="sd">        &gt;&gt;&gt; nid_arr2 = np.array(ibs.get_annot_name_rowids(None, distinguish_unknowns=True))</span>
<span class="sd">        &gt;&gt;&gt; assert ibs.UNKNOWN_LBLANNOT_ROWID == 0</span>
<span class="sd">        &gt;&gt;&gt; assert np.all(nid_arr1[np.where(ibs.UNKNOWN_LBLANNOT_ROWID == nid_arr2)[0]] &lt; 0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">NAME_ROWID</span><span class="p">,)</span>
    <span class="n">nid_list_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="s">&#39;rowid&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">distinguish_unknowns</span><span class="p">:</span>
        <span class="c">#from ibeis.model.preproc import preproc_annot</span>
        <span class="c">#nid_list = preproc_annot.distinguish_unknown_nids(ibs, aid_list, nid_list_)</span>
        <span class="n">nid_list</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">None</span> <span class="k">if</span> <span class="n">aid</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="o">-</span><span class="n">aid</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">nid</span> <span class="o">==</span> <span class="n">ibs</span><span class="o">.</span><span class="n">UNKNOWN_LBLANNOT_ROWID</span> <span class="ow">or</span> <span class="n">nid</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">nid</span>
                    <span class="k">for</span> <span class="n">nid</span><span class="p">,</span> <span class="n">aid</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nid_list_</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nid_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ibs</span><span class="o">.</span><span class="n">UNKNOWN_LBLANNOT_ROWID</span> <span class="k">if</span> <span class="n">nid</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">nid</span> <span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="n">nid_list_</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">nid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/nids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_nids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_nids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_nids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">distinguish_unknowns</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    alias</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/nids/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">distinguish_unknowns</span><span class="o">=</span><span class="n">distinguish_unknowns</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/names/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_names"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_names">[docs]</a><span class="k">def</span> <span class="nf">get_annot_names</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    alias</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/names/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_texts</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/name_texts/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_name_texts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_name_texts">[docs]</a><span class="k">def</span> <span class="nf">get_annot_name_texts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list or strs: name_list. e.g: [&#39;fred&#39;, &#39;sue&#39;, ...]</span>
<span class="sd">             for each annotation identifying the individual</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/name_texts/</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_name_texts</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[::2]</span>
<span class="sd">        &gt;&gt;&gt; result = ut.list_str(get_annot_name_texts(ibs, aid_list), nl=False)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [&#39;____&#39;, &#39;easy&#39;, &#39;hard&#39;, &#39;jeff&#39;, &#39;____&#39;, &#39;____&#39;, &#39;zebra&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">name_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_name_texts</span><span class="p">(</span><span class="n">nid_list</span><span class="p">)</span>
    <span class="c">#name_list = ibs.get_annot_lblannot_value_of_lbltype(aid_list,</span>
    <span class="c">#const.INDIVIDUAL_KEY, ibs.get_name_texts)</span>
    <span class="k">return</span> <span class="n">name_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/species/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_species"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_species">[docs]</a><span class="k">def</span> <span class="nf">get_annot_species</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    alias</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/species/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_species_texts</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/species_texts/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_species_texts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_species_texts">[docs]</a><span class="k">def</span> <span class="nf">get_annot_species_texts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list : species_list - a list of strings [&#39;plains_zebra&#39;,</span>
<span class="sd">        &#39;grevys_zebra&#39;, ...] for each annotation</span>
<span class="sd">        identifying the species</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_species_texts</span>

<span class="sd">    Example1:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[1::3]</span>
<span class="sd">        &gt;&gt;&gt; result = ut.list_str(get_annot_species_texts(ibs, aid_list), nl=False)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [&#39;zebra_plains&#39;, &#39;zebra_plains&#39;, &#39;____&#39;, &#39;bear_polar&#39;]</span>

<span class="sd">    Example2:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;PZ_MTEST&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; species_list = get_annot_species_texts(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = ut.list_str(list(set(species_list)), nl=False)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [&#39;zebra_plains&#39;]</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/species_texts/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">species_rowid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_species_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">speceis_text_list</span>  <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_species_texts</span><span class="p">(</span><span class="n">species_rowid_list</span><span class="p">)</span>
    <span class="c">#speceis_text_list = ibs.get_annot_lblannot_value_of_lbltype(</span>
    <span class="c">#    aid_list, const.SPECIES_KEY, ibs.get_species)</span>
    <span class="k">return</span> <span class="n">speceis_text_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@ut.accepts_numpy</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@accessor_decors.cache_getter</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">SPECIES_ROWID</span><span class="p">)</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/species_rowids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_species_rowids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_species_rowids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_species_rowids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    species_rowid_list &lt;- annot.species_rowid[aid_list]</span>

<span class="sd">    gets data from the &quot;native&quot; column &quot;species_rowid&quot; in the &quot;annot&quot; table</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: species_rowid_list</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/species_rowids/</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">SPECIES_ROWID</span><span class="p">,)</span>
    <span class="n">species_rowid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="s">&#39;rowid&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">species_rowid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/image_names/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_image_names"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_image_names">[docs]</a><span class="k">def</span> <span class="nf">get_annot_image_names</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of strs: gname_list the image names of each annotation</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/image_names/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">gname_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_image_gnames</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gname_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/image_unixtimes/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_image_unixtimes"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_image_unixtimes">[docs]</a><span class="k">def</span> <span class="nf">get_annot_image_unixtimes</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: unixtime_list</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/image_unixtimes/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">unixtime_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_image_unixtime</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">unixtime_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/image_unixtimes/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_image_unixtimes_asfloat"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_image_unixtimes_asfloat">[docs]</a><span class="k">def</span> <span class="nf">get_annot_image_unixtimes_asfloat</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="n">unixtime_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_image_unixtimes</span><span class="p">(</span><span class="n">aid_list</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
    <span class="n">unixtime_list</span><span class="p">[</span><span class="n">unixtime_list</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="n">unixtime_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<div class="viewcode-block" id="get_annot_image_datetime"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_image_datetime">[docs]</a><span class="k">def</span> <span class="nf">get_annot_image_datetime</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        ibs (IBEISController):  ibeis controller object</span>
<span class="sd">        aid_list (int):  list of annotation ids</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: datetime_list</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_image_datetime</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; datetime_list = get_annot_image_datetime(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; result = str(datetime_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">datetime_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_image_datetime</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">datetime_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/image_gps/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_image_gps"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_image_gps">[docs]</a><span class="k">def</span> <span class="nf">get_annot_image_gps</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: unixtime_list</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/image_gps/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">gps_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_image_gps</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gps_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/image_paths/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_image_paths"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_image_paths">[docs]</a><span class="k">def</span> <span class="nf">get_annot_image_paths</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of strs: gpath_list the image paths of each annotation</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/image_paths/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">assert_all_not_None</span><span class="p">(</span><span class="n">gid_list</span><span class="p">,</span> <span class="s">&#39;gid_list&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[!get_annot_image_paths] &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_dbgstr</span><span class="p">(</span><span class="s">&#39;aid_list&#39;</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[!get_annot_image_paths] &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_dbgstr</span><span class="p">(</span><span class="s">&#39;gid_list&#39;</span><span class="p">))</span>
        <span class="k">raise</span>
    <span class="n">gpath_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_image_paths</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">assert_all_not_None</span><span class="p">(</span><span class="n">gpath_list</span><span class="p">,</span> <span class="s">&#39;gpath_list&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gpath_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/image_uuids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_image_uuids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_image_uuids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_image_uuids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: image_uuid_list</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_image_uuids --enableall</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/image_uuids/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[0:1]</span>
<span class="sd">        &gt;&gt;&gt; result = get_annot_image_uuids(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [UUID(&#39;66ec193a-1619-b3b6-216d-1784b4833b61&#39;)]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">assert_all_not_None</span><span class="p">(</span><span class="n">gid_list</span><span class="p">,</span> <span class="s">&#39;gid_list&#39;</span><span class="p">)</span>
    <span class="n">image_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_image_uuids</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">image_uuid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/images/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_images"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_images">[docs]</a><span class="k">def</span> <span class="nf">get_annot_images</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of ndarrays: the images of each annotation</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_images</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/images/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[0:1]</span>
<span class="sd">        &gt;&gt;&gt; image_list = ibs.get_annot_images(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = str(map(np.shape, image_list))</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [(715, 1047, 3)]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">image_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_images</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">image_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/visual_uuid_info/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_visual_uuid_info"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_visual_uuid_info">[docs]</a><span class="k">def</span> <span class="nf">get_annot_visual_uuid_info</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>

<span class="sd">    Returns information used to compute annotation UUID.</span>
<span class="sd">    The image uuid, annotation verticies, are theta is hashted together to</span>
<span class="sd">      compute the visual uuid.</span>
<span class="sd">     The visual uuid does not include name or species information.</span>

<span class="sd">    get_annot_visual_uuid_info</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: visual_infotup (image_uuid_list, verts_list, theta_list)</span>

<span class="sd">    SeeAlso:</span>
<span class="sd">        get_annot_visual_uuids</span>
<span class="sd">        get_annot_semantic_uuid_info</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_visual_uuid_info</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/visual_uuid_info/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.model.preproc.preproc_annot import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[0:2]</span>
<span class="sd">        &gt;&gt;&gt; visual_infotup = ibs.get_annot_visual_uuid_info(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = str(list(zip(*visual_infotup))[0])</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        (UUID(&#39;66ec193a-1619-b3b6-216d-1784b4833b61&#39;), ((0, 0), (1047, 0), (1047, 715), (0, 715)), 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">image_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_image_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">verts_list</span>      <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_verts</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">theta_list</span>      <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_thetas</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="c">#visual_info_iter = zip(image_uuid_list, verts_list, theta_list, yaw_list)</span>
    <span class="c">#visual_info_list = list(visual_info_iter)</span>
    <span class="n">visual_infotup</span> <span class="o">=</span> <span class="p">(</span><span class="n">image_uuid_list</span><span class="p">,</span> <span class="n">verts_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">visual_infotup</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/semantic_uuid_info/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_semantic_uuid_info"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_semantic_uuid_info">[docs]</a><span class="k">def</span> <span class="nf">get_annot_semantic_uuid_info</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">_visual_infotup</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Semenatic uuids are made up of visual and semantic information. Semantic</span>
<span class="sd">    information is name, species, viewpoint.  Visual info is image uuid, verts,</span>
<span class="sd">    and theta</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>
<span class="sd">        _visual_infotup (tuple) : internal use only</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple:  semantic_infotup (image_uuid_list, verts_list, theta_list, yaw_list, name_list, species_list)</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_semantic_uuid_info</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/semantic_uuid_info/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.model.preproc.preproc_annot import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[0:2]</span>
<span class="sd">        &gt;&gt;&gt; semantic_infotup = ibs.get_annot_semantic_uuid_info(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = str(list(zip(*semantic_infotup))[1])</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        (UUID(&#39;d8903434-942f-e0f5-d6c2-0dcbe3137bf7&#39;), ((0, 0), (1035, 0), (1035, 576), (0, 576)), 0.0, None, u&#39;easy&#39;, u&#39;zebra_plains&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Semantic info depends on visual info</span>
    <span class="k">if</span> <span class="n">_visual_infotup</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">visual_infotup</span> <span class="o">=</span> <span class="n">get_annot_visual_uuid_info</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">visual_infotup</span> <span class="o">=</span> <span class="n">_visual_infotup</span>
    <span class="n">image_uuid_list</span><span class="p">,</span> <span class="n">verts_list</span><span class="p">,</span> <span class="n">theta_list</span> <span class="o">=</span> <span class="n">visual_infotup</span>
    <span class="c"># It is visual info augmented with name and species</span>
    <span class="n">yaw_list</span>        <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_yaws</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">name_list</span>       <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_names</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">species_list</span>    <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_species_texts</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">semantic_infotup</span> <span class="o">=</span> <span class="n">SemanticInfoTup</span><span class="p">(</span><span class="n">image_uuid_list</span><span class="p">,</span> <span class="n">verts_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">,</span>
                                       <span class="n">yaw_list</span><span class="p">,</span> <span class="n">name_list</span><span class="p">,</span> <span class="n">species_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">semantic_infotup</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">[</span><span class="n">ANNOT_SEMANTIC_UUID</span><span class="p">],</span> <span class="n">rowidx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/semantic_uuids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="update_annot_semantic_uuids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.update_annot_semantic_uuids">[docs]</a><span class="k">def</span> <span class="nf">update_annot_semantic_uuids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">_visual_infotup</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Ensures that annots have the proper semantic uuids</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/semantic_uuids/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ibeis.model.preproc</span> <span class="kn">import</span> <span class="n">preproc_annot</span>
    <span class="n">semantic_infotup</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_semantic_uuid_info</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">_visual_infotup</span><span class="p">)</span>
    <span class="n">annot_semantic_uuid_list</span> <span class="o">=</span> <span class="n">preproc_annot</span><span class="o">.</span><span class="n">make_annot_semantic_uuid</span><span class="p">(</span><span class="n">semantic_infotup</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_SEMANTIC_UUID</span><span class="p">,),</span> <span class="n">annot_semantic_uuid_list</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span>
                                   <span class="p">[</span><span class="n">ANNOT_VISUAL_UUID</span><span class="p">,</span> <span class="n">ANNOT_SEMANTIC_UUID</span><span class="p">],</span> <span class="n">rowidx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/visual_uuids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="update_annot_visual_uuids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.update_annot_visual_uuids">[docs]</a><span class="k">def</span> <span class="nf">update_annot_visual_uuids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Ensures that annots have the proper visual uuids</span>

<span class="sd">    Args:</span>
<span class="sd">        ibs (IBEISController):  ibeis controller object</span>
<span class="sd">        aid_list (list):  list of annotation rowids</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/visual_uuids/</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --exec-update_annot_visual_uuids --db PZ_Master1</span>
<span class="sd">        python -m ibeis --tf update_annot_visual_uuids --db PZ_Master1</span>
<span class="sd">        python -m ibeis --tf update_annot_visual_uuids --db PZ_Master0</span>
<span class="sd">        python -m ibeis --tf update_annot_visual_uuids --db PZ_MTEST</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # SCRIPT</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(defaultdb=&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs._get_all_aids()</span>
<span class="sd">        &gt;&gt;&gt; update_annot_visual_uuids(ibs, aid_list)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ibeis.model.preproc</span> <span class="kn">import</span> <span class="n">preproc_annot</span>
    <span class="n">visual_infotup</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_visual_uuid_info</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">annot_visual_uuid_list</span> <span class="o">=</span> <span class="n">preproc_annot</span><span class="o">.</span><span class="n">make_annot_visual_uuid</span><span class="p">(</span><span class="n">visual_infotup</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_VISUAL_UUID</span><span class="p">,),</span> <span class="n">annot_visual_uuid_list</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="c"># If visual uuids are changes semantic ones are also changed</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">update_annot_semantic_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">_visual_infotup</span><span class="o">=</span><span class="n">visual_infotup</span><span class="p">)</span>


<span class="c">#### SETTERS ###</span>
</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.setter</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/bboxes/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_bboxes"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_bboxes">[docs]</a><span class="k">def</span> <span class="nf">set_annot_bboxes</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">bbox_list</span><span class="p">,</span> <span class="n">delete_thumbs</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Sets bboxes of a list of annotations by aid,</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list of rowids): list of annotation rowids</span>
<span class="sd">        bbox_list (list of (x, y, w, h)): new bounding boxes for each aid</span>

<span class="sd">    Note:</span>
<span class="sd">        set_annot_bboxes is a proxy for set_annot_verts</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/bboxes/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">vtool</span> <span class="kn">import</span> <span class="n">geometry</span>
    <span class="c"># changing the bboxes also changes the bounding polygon</span>
    <span class="n">vert_list</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">verts_list_from_bboxes_list</span><span class="p">(</span><span class="n">bbox_list</span><span class="p">)</span>
    <span class="c"># naively overwrite the bounding polygon with a rectangle - for now trust the user!</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">set_annot_verts</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">vert_list</span><span class="p">,</span> <span class="n">delete_thumbs</span><span class="o">=</span><span class="n">delete_thumbs</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.setter</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/detect_confidence/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_detect_confidence"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_detect_confidence">[docs]</a><span class="k">def</span> <span class="nf">set_annot_detect_confidence</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">confidence_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Sets annotation notes</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/detect_confidence/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">val_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">confidence</span><span class="p">,)</span> <span class="k">for</span> <span class="n">confidence</span> <span class="ow">in</span> <span class="n">confidence_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;annot_detect_confidence&#39;</span><span class="p">,),</span> <span class="n">val_iter</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.setter</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">[</span><span class="n">ANNOT_EXEMPLAR_FLAG</span><span class="p">],</span> <span class="n">rowidx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ENCOUNTER_TABLE</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;percent_names_with_exemplar_str&#39;</span><span class="p">])</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/exemplar_flags/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_exemplar_flags"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_exemplar_flags">[docs]</a><span class="k">def</span> <span class="nf">set_annot_exemplar_flags</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Sets if an annotation is an exemplar</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/exemplar_flags/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">val_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">flag</span><span class="p">,)</span> <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">flag_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_EXEMPLAR_FLAG</span><span class="p">,),</span> <span class="n">val_iter</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.setter</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">[</span><span class="n">NAME_ROWID</span><span class="p">],</span> <span class="n">rowidx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ENCOUNTER_TABLE</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;percent_names_with_exemplar_str&#39;</span><span class="p">])</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/name_rowids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_name_rowids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_name_rowids">[docs]</a><span class="k">def</span> <span class="nf">set_annot_name_rowids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">name_rowid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    name_rowid_list -&gt; annot.name_rowid[aid_list]</span>

<span class="sd">    Sets names/nids of a list of annotations.</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>
<span class="sd">        name_rowid_list (list):</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/name_rowids/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[0:2]</span>
<span class="sd">        &gt;&gt;&gt; # check clean state</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(ibs.get_annot_names(aid_list), [&#39;____&#39;, &#39;easy&#39;])</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(ibs.get_annot_exemplar_flags(aid_list), [0, 1])</span>
<span class="sd">        &gt;&gt;&gt; # run function</span>
<span class="sd">        &gt;&gt;&gt; name_list = [&#39;easy&#39;, &#39;____&#39;]</span>
<span class="sd">        &gt;&gt;&gt; name_rowid_list = ibs.get_name_rowids_from_text(name_list)</span>
<span class="sd">        &gt;&gt;&gt; ibs.set_annot_name_rowids(aid_list, name_rowid_list)</span>
<span class="sd">        &gt;&gt;&gt; # check results</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(ibs.get_annot_names(aid_list), [&#39;easy&#39;, &#39;____&#39;])</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(ibs.get_annot_exemplar_flags(aid_list), [0, 0])</span>
<span class="sd">        &gt;&gt;&gt; # restore database state</span>
<span class="sd">        &gt;&gt;&gt; ibs.set_annot_names(aid_list, [&#39;____&#39;, &#39;easy&#39;])</span>
<span class="sd">        &gt;&gt;&gt; ibs.set_annot_exemplar_flags(aid_list, [0, 1])</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(ibs.get_annot_names(aid_list), [&#39;____&#39;, &#39;easy&#39;])</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(ibs.get_annot_exemplar_flags(aid_list), [0, 1])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#ibsfuncs.assert_lblannot_rowids_are_type(ibs, name_rowid_list,</span>
    <span class="c">#ibs.lbltype_ids[const.INDIVIDUAL_KEY])</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">NAME_ROWID</span><span class="p">,)</span>
    <span class="c"># WE NEED TO PERFORM A SPECIAL CHECK. ANY ANIMAL WHICH IS GIVEN AN UNKONWN</span>
    <span class="c"># NAME MUST HAVE ITS EXEMPLAR FLAG SET TO FALSE</span>
    <span class="n">will_be_unknown_flag_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">nid</span> <span class="o">==</span> <span class="n">const</span><span class="o">.</span><span class="n">UNKNOWN_NAME_ROWID</span> <span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="n">name_rowid_list</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">will_be_unknown_flag_list</span><span class="p">):</span>
        <span class="c"># remove exemplar status from any annotations that will become unknown</span>
        <span class="n">will_be_unknown_aids</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_compress</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">will_be_unknown_flag_list</span><span class="p">)</span>
        <span class="n">ibs</span><span class="o">.</span><span class="n">set_annot_exemplar_flags</span><span class="p">(</span><span class="n">will_be_unknown_aids</span><span class="p">,</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">will_be_unknown_aids</span><span class="p">))</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">name_rowid_list</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>
    <span class="c"># postset nids</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">update_annot_semantic_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="c"># TODO: flag name rowid update</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.setter</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/names/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_names"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_names">[docs]</a><span class="k">def</span> <span class="nf">set_annot_names</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">name_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Sets the attrlbl_value of type(INDIVIDUAL_KEY) Sets names/nids of a</span>
<span class="sd">    list of annotations.</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-set_annot_names --enableall</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/names/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; name_list1 = get_annot_names(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; name_list2 = [name + &#39;_TESTAUG&#39; for name in name_list1]</span>
<span class="sd">        &gt;&gt;&gt; set_annot_names(ibs, aid_list, name_list2)</span>
<span class="sd">        &gt;&gt;&gt; name_list3 = get_annot_names(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; set_annot_names(ibs, aid_list, name_list1)</span>
<span class="sd">        &gt;&gt;&gt; name_list4 = get_annot_names(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; assert name_list2 == name_list3</span>
<span class="sd">        &gt;&gt;&gt; assert name_list4 == name_list1</span>
<span class="sd">        &gt;&gt;&gt; assert name_list4 != name_list2</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#ibs.get_nids_from_text</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">)</span>
    <span class="c">#name_rowid_list = ibs.get_name_rowids_from_text(name_list, ensure=True)</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">([</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;&#39;</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">name_list</span><span class="p">]),</span> <span class="s">&#39;cannot change name to empty string use ____ for unknown.&#39;</span>
    <span class="n">name_rowid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">add_names</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">set_annot_name_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">name_rowid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.setter</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/species/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_species"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_species">[docs]</a><span class="k">def</span> <span class="nf">set_annot_species</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">species_text_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Sets species/speciesids of a list of annotations.</span>
<span class="sd">    Convenience function for set_annot_lblannot_from_value</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/species/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#ibs.get_nids_from_text</span>
    <span class="n">species_rowid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_species_rowids_from_text</span><span class="p">(</span><span class="n">species_text_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">set_annot_species_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">species_rowid_list</span><span class="p">)</span>
    <span class="c">#ibs.set_annot_lblannot_from_value(aid_list, species_text_list, const.SPECIES_KEY)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">update_annot_semantic_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.setter</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">[</span><span class="n">SPECIES_ROWID</span><span class="p">],</span> <span class="n">rowidx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/species_rowids/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_species_rowids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_species_rowids">[docs]</a><span class="k">def</span> <span class="nf">set_annot_species_rowids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">species_rowid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    species_rowid_list -&gt; annot.species_rowid[aid_list]</span>

<span class="sd">    Sets species/speciesids of a list of annotations.</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list</span>
<span class="sd">        species_rowid_list</span>


<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/species_rowids/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#ibs.set_annot_lblannot_from_rowid(aid_list, speciesid_list, const.SPECIES_KEY)</span>
    <span class="c">#ibsfuncs.assert_lblannot_rowids_are_type(ibs, species_rowid_list,</span>
    <span class="c">#ibs.lbltype_ids[const.SPECIES_KEY])</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">SPECIES_ROWID</span><span class="p">,)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">species_rowid_list</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.setter</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/notes/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_notes"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_notes">[docs]</a><span class="k">def</span> <span class="nf">set_annot_notes</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">notes_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Sets annotation notes</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/notes/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">val_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">notes</span><span class="p">,)</span> <span class="k">for</span> <span class="n">notes</span> <span class="ow">in</span> <span class="n">notes_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_NOTE</span><span class="p">,),</span> <span class="n">val_iter</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.setter</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/parent_rowid/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_parent_rowid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_parent_rowid">[docs]</a><span class="k">def</span> <span class="nf">set_annot_parent_rowid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">parent_aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Sets the annotation&#39;s parent aid.</span>
<span class="sd">    TODO DEPRICATE IN FAVOR OF SEPARATE PARTS TABLE</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/parent_rowid/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">val_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">parent_aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">parent_aid</span> <span class="ow">in</span> <span class="n">parent_aid_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_PARENT_ROWID</span><span class="p">,),</span> <span class="n">val_iter</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.setter</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/thetas/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_thetas"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_thetas">[docs]</a><span class="k">def</span> <span class="nf">set_annot_thetas</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">,</span> <span class="n">delete_thumbs</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Sets thetas of a list of chips by aid</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/thetas/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">val_list</span> <span class="o">=</span> <span class="p">((</span><span class="n">theta</span><span class="p">,)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">theta_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_THETA</span><span class="p">,),</span> <span class="n">val_list</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">delete_thumbs</span><span class="p">:</span>
        <span class="n">ibs</span><span class="o">.</span><span class="n">delete_annot_chips</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>  <span class="c"># Changing theta redefines the chips</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">update_annot_visual_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.setter</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/verts/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_verts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_verts">[docs]</a><span class="k">def</span> <span class="nf">set_annot_verts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">verts_list</span><span class="p">,</span> <span class="n">delete_thumbs</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Sets the vertices [(x, y), ...] of a list of chips by aid</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/verts/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">vtool</span> <span class="kn">import</span> <span class="n">geometry</span>
    <span class="n">nInput</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="c"># Compute data to set</span>
    <span class="n">num_verts_list</span>   <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">verts_list</span><span class="p">))</span>
    <span class="n">verts_as_strings</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">__STR__</span><span class="p">,</span> <span class="n">verts_list</span><span class="p">))</span>
    <span class="n">id_iter1</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="c"># also need to set the internal number of vertices</span>
    <span class="n">val_iter1</span> <span class="o">=</span> <span class="p">((</span><span class="n">num_verts</span><span class="p">,</span> <span class="n">verts</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">num_verts</span><span class="p">,</span> <span class="n">verts</span><span class="p">)</span>
                 <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">num_verts_list</span><span class="p">,</span> <span class="n">verts_as_strings</span><span class="p">))</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">ANNOT_NUM_VERTS</span><span class="p">,</span> <span class="n">ANNOT_VERTS</span><span class="p">,)</span>
    <span class="c"># SET VERTS in ANNOTATION_TABLE</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">val_iter1</span><span class="p">,</span> <span class="n">id_iter1</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="c"># changing the vertices also changes the bounding boxes</span>
    <span class="n">bbox_list</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">bboxes_from_vert_list</span><span class="p">(</span><span class="n">verts_list</span><span class="p">)</span>      <span class="c"># new bboxes</span>
    <span class="n">xtl_list</span><span class="p">,</span> <span class="n">ytl_list</span><span class="p">,</span> <span class="n">width_list</span><span class="p">,</span> <span class="n">height_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">bbox_list</span><span class="p">))</span>
    <span class="n">val_iter2</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xtl_list</span><span class="p">,</span> <span class="n">ytl_list</span><span class="p">,</span> <span class="n">width_list</span><span class="p">,</span> <span class="n">height_list</span><span class="p">)</span>
    <span class="n">id_iter2</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;annot_xtl&#39;</span><span class="p">,</span> <span class="s">&#39;annot_ytl&#39;</span><span class="p">,</span> <span class="s">&#39;annot_width&#39;</span><span class="p">,</span> <span class="s">&#39;annot_height&#39;</span><span class="p">,)</span>
    <span class="c"># SET BBOX in ANNOTATION_TABLE</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">val_iter2</span><span class="p">,</span> <span class="n">id_iter2</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">delete_thumbs</span><span class="p">:</span>
        <span class="n">ibs</span><span class="o">.</span><span class="n">delete_annot_chips</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>  <span class="c"># INVALIDATE THUMBNAILS</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">update_annot_visual_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>


<span class="c"># PROBCHIP</span>
<span class="c"># TODO: autogenerate probchip stuff</span>
</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/probchip_fpath/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_probchip_fpath"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_probchip_fpath">[docs]</a><span class="k">def</span> <span class="nf">get_annot_probchip_fpath</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns paths to probability images.</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/probchip_fpath/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># FIXME: this is implemented very poorly. Caches not robust. IE they are</span>
    <span class="c"># never invalidated. Not all config information is passed through</span>
    <span class="kn">from</span> <span class="nn">ibeis.model.preproc</span> <span class="kn">import</span> <span class="n">preproc_probchip</span>
    <span class="n">probchip_fpath_list</span> <span class="o">=</span> <span class="n">preproc_probchip</span><span class="o">.</span><span class="n">compute_and_write_probchip</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span>
                                                                      <span class="n">aid_list</span><span class="p">,</span>
                                                                      <span class="n">config2_</span><span class="o">=</span><span class="n">config2_</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">probchip_fpath_list</span>


<span class="c"># ---</span>
<span class="c"># NEW</span>
<span class="c"># ---</span>
</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@accessor_decors.cache_getter</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">ANNOT_QUALITY</span><span class="p">)</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/qualities/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_qualities"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_qualities">[docs]</a><span class="k">def</span> <span class="nf">get_annot_qualities</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    annot_quality_list &lt;- annot.annot_quality[aid_list]</span>

<span class="sd">    gets data from the &quot;native&quot; column &quot;annot_quality&quot; in the &quot;annot&quot; table</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot_quality_list</span>

<span class="sd">    TemplateInfo:</span>
<span class="sd">        Tgetter_table_column</span>
<span class="sd">        col = annot_quality</span>
<span class="sd">        tbl = annot</span>

<span class="sd">    SeeAlso:</span>
<span class="sd">        ibeis.const.QUALITY_INT_TO_TEXT</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/qualities/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; ibs, qreq_ = testdata_ibs()</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs._get_all_aids()</span>
<span class="sd">        &gt;&gt;&gt; eager = True</span>
<span class="sd">        &gt;&gt;&gt; annot_quality_list = ibs.get_annot_qualities(aid_list, eager=eager)</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;annot_quality_list = %r&#39; % (annot_quality_list,))</span>
<span class="sd">        &gt;&gt;&gt; assert len(aid_list) == len(annot_quality_list)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">ANNOT_QUALITY</span><span class="p">,)</span>
    <span class="n">annot_quality_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="s">&#39;rowid&#39;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="n">eager</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_quality_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.setter</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">[</span><span class="n">ANNOT_QUALITY</span><span class="p">],</span> <span class="n">rowidx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/qualities/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_qualities"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_qualities">[docs]</a><span class="k">def</span> <span class="nf">set_annot_qualities</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">annot_quality_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    annot_quality_list -&gt; annot.annot_quality[aid_list]</span>

<span class="sd">    A quality is an integer representing the following types:</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list</span>
<span class="sd">        annot_quality_list</span>

<span class="sd">    SeeAlso:</span>
<span class="sd">        ibeis.const.QUALITY_INT_TO_TEXT</span>

<span class="sd">    TemplateInfo:</span>
<span class="sd">        Tsetter_native_column</span>
<span class="sd">        tbl = annot</span>
<span class="sd">        col = annot_quality</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/qualities/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">ANNOT_QUALITY</span><span class="p">,)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">annot_quality_list</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/quality_texts/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_quality_texts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_quality_texts">[docs]</a><span class="k">def</span> <span class="nf">get_annot_quality_texts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Auto-docstr for &#39;get_annot_quality_texts&#39;</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/quality_texts/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">quality_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_qualities</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">quality_text_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_take</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">QUALITY_INT_TO_TEXT</span><span class="p">,</span> <span class="n">quality_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">quality_text_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/isjunk/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_isjunk"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_isjunk">[docs]</a><span class="k">def</span> <span class="nf">get_annot_isjunk</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Auto-docstr for &#39;get_annot_isjunk&#39;</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/isjunk/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">qual_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_qualities</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="c">#isjunk_list = [qual == const.QUALITY_TEXT_TO_INT[&#39;junk&#39;] for qual in qual_list]</span>
    <span class="n">isjunk_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">qual</span> <span class="ow">in</span> <span class="n">const</span><span class="o">.</span><span class="n">QUALITY_TEXT_TO_INTS</span><span class="p">[</span><span class="s">&#39;junk&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">qual</span> <span class="ow">in</span> <span class="n">qual_list</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">isjunk_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/yaw_texts/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_yaw_texts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_yaw_texts">[docs]</a><span class="k">def</span> <span class="nf">get_annot_yaw_texts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Auto-docstr for &#39;get_annot_yaw_texts&#39;</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/yaw_texts/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">yaw_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_yaws</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">yaw_text_list</span> <span class="o">=</span> <span class="n">ibsfuncs</span><span class="o">.</span><span class="n">get_yaw_viewtexts</span><span class="p">(</span><span class="n">yaw_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaw_text_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/quality_texts/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_quality_texts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_quality_texts">[docs]</a><span class="k">def</span> <span class="nf">set_annot_quality_texts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">quality_text_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Auto-docstr for &#39;set_annot_quality_texts&#39;</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/quality_texts/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">isiterable</span><span class="p">(</span><span class="n">aid_list</span><span class="p">):</span>
        <span class="n">aid_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">aid_list</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">quality_text_list</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
        <span class="n">quality_text_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">quality_text_list</span><span class="p">]</span>
    <span class="n">quality_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_take</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">QUALITY_TEXT_TO_INT</span><span class="p">,</span> <span class="n">quality_text_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">set_annot_qualities</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">quality_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/yaw_texts/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_yaw_texts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_yaw_texts">[docs]</a><span class="k">def</span> <span class="nf">set_annot_yaw_texts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">yaw_text_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Auto-docstr for &#39;set_annot_yaw_texts&#39;</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/yaw_texts/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">isiterable</span><span class="p">(</span><span class="n">aid_list</span><span class="p">):</span>
        <span class="n">aid_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">aid_list</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">yaw_text_list</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
        <span class="n">yaw_text_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">yaw_text_list</span><span class="p">]</span>
    <span class="n">yaw_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_take</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">VIEWTEXT_TO_YAW_RADIANS</span><span class="p">,</span> <span class="n">yaw_text_list</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">set_annot_yaws</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">yaw_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/sex/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_sex"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_sex">[docs]</a><span class="k">def</span> <span class="nf">get_annot_sex</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Auto-docstr for &#39;get_annot_sex&#39;</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/sex/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_nids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">sex_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_name_sex</span><span class="p">(</span><span class="n">nid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sex_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/sex_texts/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_sex_texts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_sex_texts">[docs]</a><span class="k">def</span> <span class="nf">get_annot_sex_texts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Auto-docstr for &#39;get_annot_sex_texts&#39;</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/sex_texts/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_nids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">sex_text_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_name_sex_text</span><span class="p">(</span><span class="n">nid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sex_text_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/sex/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_sex"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_sex">[docs]</a><span class="k">def</span> <span class="nf">set_annot_sex</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">name_sex_list</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Auto-docstr for &#39;set_annot_sex&#39;</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/sex/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_nids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">flag_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">nid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="n">nid_list</span> <span class="p">]</span>
    <span class="n">nid_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_compress</span><span class="p">(</span><span class="n">nid_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">)</span>
    <span class="n">name_sex_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_compress</span><span class="p">(</span><span class="n">name_sex_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">set_name_sex</span><span class="p">(</span><span class="n">nid_list</span><span class="p">,</span> <span class="n">name_sex_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/sex_texts/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_sex_texts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_sex_texts">[docs]</a><span class="k">def</span> <span class="nf">set_annot_sex_texts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">name_sex_text_list</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Auto-docstr for &#39;set_annot_sex_texts&#39;</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/sex_texts/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_nids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">flag_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">nid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="n">nid_list</span> <span class="p">]</span>
    <span class="n">nid_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_compress</span><span class="p">(</span><span class="n">nid_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">)</span>
    <span class="n">name_sex_text_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_compress</span><span class="p">(</span><span class="n">name_sex_text_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">set_name_sex_text</span><span class="p">(</span><span class="n">nid_list</span><span class="p">,</span> <span class="n">name_sex_text_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/age_months_est_min/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_age_months_est_min"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_age_months_est_min">[docs]</a><span class="k">def</span> <span class="nf">get_annot_age_months_est_min</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    annot_age_months_est_min_list &lt;- annot.annot_age_months_est_min[aid_list]</span>

<span class="sd">    gets data from the &quot;native&quot; column &quot;annot_age_months_est_min&quot; in the &quot;annot&quot; table</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot_age_months_est_min_list</span>

<span class="sd">    TemplateInfo:</span>
<span class="sd">        Tgetter_table_column</span>
<span class="sd">        col = annot_age_months_est_min</span>
<span class="sd">        tbl = annot</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/age_months_est_min/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; ibs, config2_ = testdata_ibs()</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs._get_all_aids()</span>
<span class="sd">        &gt;&gt;&gt; eager = True</span>
<span class="sd">        &gt;&gt;&gt; annot_age_months_est_min_list = ibs.get_annot_age_months_est_min(aid_list, eager=eager)</span>
<span class="sd">        &gt;&gt;&gt; assert len(aid_list) == len(annot_age_months_est_min_list)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">ANNOT_AGE_MONTHS_EST_MIN</span><span class="p">,)</span>
    <span class="n">annot_age_months_est_min_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="s">&#39;rowid&#39;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="n">eager</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_age_months_est_min_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/age_months_est_max/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_age_months_est_max"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_age_months_est_max">[docs]</a><span class="k">def</span> <span class="nf">get_annot_age_months_est_max</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    annot_age_months_est_max_list &lt;- annot.annot_age_months_est_max[aid_list]</span>

<span class="sd">    gets data from the &quot;native&quot; column &quot;annot_age_months_est_max&quot; in the &quot;annot&quot; table</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot_age_months_est_max_list</span>

<span class="sd">    TemplateInfo:</span>
<span class="sd">        Tgetter_table_column</span>
<span class="sd">        col = annot_age_months_est_max</span>
<span class="sd">        tbl = annot</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/age_months_est_max/</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; ibs, config2_ = testdata_ibs()</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs._get_all_aids()</span>
<span class="sd">        &gt;&gt;&gt; eager = True</span>
<span class="sd">        &gt;&gt;&gt; annot_age_months_est_max_list = ibs.get_annot_age_months_est_max(aid_list, eager=eager)</span>
<span class="sd">        &gt;&gt;&gt; assert len(aid_list) == len(annot_age_months_est_max_list)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">ANNOT_AGE_MONTHS_EST_MAX</span><span class="p">,)</span>
    <span class="n">annot_age_months_est_max_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="s">&#39;rowid&#39;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="n">eager</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_age_months_est_max_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/age_months_est/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_age_months_est"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_age_months_est">[docs]</a><span class="k">def</span> <span class="nf">get_annot_age_months_est</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    annot_age_months_est_list &lt;- annot.annot_age_months_est[aid_list]</span>

<span class="sd">    gets data from the annotation&#39;s native age in months</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot_age_months_est_list</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/age_months_est/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">annot_age_months_est_min_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_age_months_est_min</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">annot_age_months_est_max_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_age_months_est_max</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">annot_age_months_est_list</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">annot_age_months_est_min_list</span><span class="p">,</span>
        <span class="n">annot_age_months_est_max_list</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_age_months_est_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/age_months_est_min_texts/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_age_months_est_min_texts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_age_months_est_min_texts">[docs]</a><span class="k">def</span> <span class="nf">get_annot_age_months_est_min_texts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    annot_age_months_est_min_texts_list &lt;- annot.annot_age_months_est_min_texts[aid_list]</span>

<span class="sd">    gets string versions of the annotation&#39;s native min age in months</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot_age_months_est_min_list</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/age_months_est_min_texts/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">annot_age_months_est_min_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_age_months_est_min</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">annot_age_months_est_min_text_list</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">&#39;</span><span class="si">%d</span><span class="s"> Months&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">age_min</span><span class="p">,</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">age_min</span> <span class="ow">in</span> <span class="n">annot_age_months_est_min_list</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">annot_age_months_est_min_text_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/age_months_est_max_texts/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_age_months_est_max_texts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_age_months_est_max_texts">[docs]</a><span class="k">def</span> <span class="nf">get_annot_age_months_est_max_texts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    annot_age_months_est_max_texts_list &lt;- annot.annot_age_months_est_max_texts[aid_list]</span>

<span class="sd">    gets string versions of the annotation&#39;s native max age in months</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot_age_months_est_max_list</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/age_months_est_max_texts/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">annot_age_months_est_max_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_age_months_est_max</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">annot_age_months_est_max_text_list</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">&#39;</span><span class="si">%d</span><span class="s"> Months&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">age_max</span><span class="p">,</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">age_max</span> <span class="ow">in</span> <span class="n">annot_age_months_est_max_list</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">annot_age_months_est_max_text_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/age_months_est_texts/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_age_months_est_texts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_age_months_est_texts">[docs]</a><span class="k">def</span> <span class="nf">get_annot_age_months_est_texts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    annot_age_months_est_texts_list &lt;- annot.annot_age_months_est_texts[aid_list]</span>

<span class="sd">    gets string versions of the annotation&#39;s native combined age in months</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot_age_months_est_text_list</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/age_months_est_texts/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">annot_age_months_est_min_text_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_age_months_est_min_texts</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">annot_age_months_est_max_text_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_age_months_est_max_texts</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">annot_age_months_est_text_list</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">&#39;</span><span class="si">%s</span><span class="s"> to </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">age_min_text</span><span class="p">,</span> <span class="n">age_max_text</span><span class="p">,</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">age_min_text</span><span class="p">,</span> <span class="n">age_max_text</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">annot_age_months_est_min_text_list</span><span class="p">,</span>
            <span class="n">annot_age_months_est_max_text_list</span>
        <span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">annot_age_months_est_text_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/age_months_est_min/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_age_months_est_min"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_age_months_est_min">[docs]</a><span class="k">def</span> <span class="nf">set_annot_age_months_est_min</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">annot_age_months_est_min_list</span><span class="p">,</span>
                                 <span class="n">duplicate_behavior</span><span class="o">=</span><span class="s">&#39;error&#39;</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    annot_age_months_est_min_list -&gt; annot.annot_age_months_est_min[aid_list]</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list</span>
<span class="sd">        annot_age_months_est_min_list</span>

<span class="sd">    TemplateInfo:</span>
<span class="sd">        Tsetter_native_column</span>
<span class="sd">        tbl = annot</span>
<span class="sd">        col = annot_age_months_est_min</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/age_months_est_min/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">ANNOT_AGE_MONTHS_EST_MIN</span><span class="p">,)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">annot_age_months_est_min_list</span><span class="p">,</span>
               <span class="n">id_iter</span><span class="p">,</span> <span class="n">duplicate_behavior</span><span class="o">=</span><span class="n">duplicate_behavior</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/age_months_est_max/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;PUT&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="set_annot_age_months_est_max"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_age_months_est_max">[docs]</a><span class="k">def</span> <span class="nf">set_annot_age_months_est_max</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">annot_age_months_est_max_list</span><span class="p">,</span>
                                 <span class="n">duplicate_behavior</span><span class="o">=</span><span class="s">&#39;error&#39;</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    annot_age_months_est_max_list -&gt; annot.annot_age_months_est_max[aid_list]</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list</span>
<span class="sd">        annot_age_months_est_max_list</span>

<span class="sd">    TemplateInfo:</span>
<span class="sd">        Tsetter_native_column</span>
<span class="sd">        tbl = annot</span>
<span class="sd">        col = annot_age_months_est_max</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: PUT</span>
<span class="sd">        URL:    /api/annot/age_months_est_max/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">ANNOT_AGE_MONTHS_EST_MAX</span><span class="p">,)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">annot_age_months_est_max_list</span><span class="p">,</span>
               <span class="n">id_iter</span><span class="p">,</span> <span class="n">duplicate_behavior</span><span class="o">=</span><span class="n">duplicate_behavior</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter</span>
<span class="nd">@register_api</span><span class="p">(</span><span class="s">&#39;/api/annot/image_contributor_tag/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">])</span>
<div class="viewcode-block" id="get_annot_image_contributor_tag"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_image_contributor_tag">[docs]</a><span class="k">def</span> <span class="nf">get_annot_image_contributor_tag</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Auto-docstr for &#39;get_annot_image_contributor_tag&#39;</span>

<span class="sd">    RESTful:</span>
<span class="sd">        Method: GET</span>
<span class="sd">        URL:    /api/annot/image_contributor_tag/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">contrib_tag_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_image_contributor_tag</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">contrib_tag_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter</span>
<div class="viewcode-block" id="get_annot_rowids_from_partial_vuuids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_rowids_from_partial_vuuids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_rowids_from_partial_vuuids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">partial_vuuid_strs</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        ibs (IBEISController):  ibeis controller object</span>
<span class="sd">        partial_uuid_list (list):</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annots_from_partial_uuids</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[::2]</span>
<span class="sd">        &gt;&gt;&gt; vuuids = ibs.get_annot_visual_uuids(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; partial_vuuid_strs = [u[0:4] for u in map(str, vuuids)]</span>
<span class="sd">        &gt;&gt;&gt; aids_list = get_annot_rowids_from_partial_vuuids(ibs, partial_uuid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [[1], [3], [5], [7], [9], [11], [13]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Hackyway because I can&#39;t figure out startswith in sqlite for UUID blobs</span>
    <span class="c"># just need to figure out how to convert a string into its corresponding byte</span>
    <span class="c"># value, then I can do it with the referecence provided</span>
    <span class="c"># References:</span>
    <span class="c"># # search like with blobs</span>
    <span class="c"># http://sqlite.1065341.n5.nabble.com/LIKE-with-BLOB-td48050.html</span>
    <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
    <span class="n">vuuids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_visual_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">vuuid_strs</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">vuuids</span><span class="p">)]</span>
    <span class="n">aids_list</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="n">aid</span> <span class="k">for</span> <span class="n">aid</span><span class="p">,</span> <span class="n">vuuid</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">vuuid_strs</span><span class="p">)</span> <span class="k">if</span> <span class="n">vuuid</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">partial_vuuid</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">partial_vuuid</span> <span class="ow">in</span> <span class="n">partial_vuuid_strs</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">aids_list</span>

    <span class="c">#partial_vuuid = partial_vuuid_strs[0]</span>

    <span class="c">#res = ibs.db.cur.execute(</span>
    <span class="c">#    &#39;&#39;&#39;</span>
    <span class="c">#    SELECT annot_rowid from ANNOTATIONS</span>
    <span class="c">#    WHERE annot_visual_uuid LIKE ? || &#39;%&#39;</span>
    <span class="c">#    &#39;&#39;&#39;, (bytes(partial_vuuid),))</span>
    <span class="c">#print(res.fetchall())</span>

    <span class="c">#res = ibs.db.cur.execute(</span>
    <span class="c">#    &#39;&#39;&#39;</span>
    <span class="c">#    SELECT annot_rowid from ANNOTATIONS</span>
    <span class="c">#    WHERE annot_visual_uuid LIKE ? || &#39;%&#39;</span>
    <span class="c">#    &#39;&#39;&#39;, (partial_vuuid,))</span>
    <span class="c">#print(res.fetchall())</span>

    <span class="c">#res = ibs.db.cur.execute(</span>
    <span class="c">#    &#39;&#39;&#39;</span>
    <span class="c">#    SELECT annot_rowid from ANNOTATIONS</span>
    <span class="c">#    WHERE annot_visual_uuid LIKE ? || &#39;%&#39;</span>
    <span class="c">#    &#39;&#39;&#39;, (bytes(partial_vuuid),))</span>
    <span class="c">#print(res.fetchall())</span>

    <span class="c">## || - is used to concat strings</span>

    <span class="c">#res = ibs.db.cur.execute(</span>
    <span class="c">#    &#39;&#39;&#39;</span>
    <span class="c">#    SELECT annot_rowid from ANNOTATIONS</span>
    <span class="c">#    WHERE annot_note LIKE ? || &#39;%&#39;</span>
    <span class="c">#    &#39;&#39;&#39;, (&#39;very&#39;,))</span>
    <span class="c">#print(res.fetchall())</span>
    <span class="c">#pass</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.getter_1to1</span>
<div class="viewcode-block" id="get_annot_tags"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_tags">[docs]</a><span class="k">def</span> <span class="nf">get_annot_tags</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot; annot_tags_list &lt;- annot.annot_tags[aid_list]</span>

<span class="sd">    gets data from the &quot;native&quot; column &quot;annot_tags&quot; in the &quot;annot&quot; table</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot_tags_list</span>

<span class="sd">    TemplateInfo:</span>
<span class="sd">        Tgetter_table_column</span>
<span class="sd">        col = annot_tags</span>
<span class="sd">        tbl = annot</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; ibs, config2_ = testdata_ibs()</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs._get_all_aids()</span>
<span class="sd">        &gt;&gt;&gt; eager = True</span>
<span class="sd">        &gt;&gt;&gt; annot_tags_list = ibs.get_annot_tags(aid_list, eager=eager)</span>
<span class="sd">        &gt;&gt;&gt; assert len(aid_list) == len(annot_tags_list)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">ANNOT_TAGS</span><span class="p">,)</span>
    <span class="n">annot_tags_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="s">&#39;rowid&#39;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="n">eager</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_tags_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.setter</span>
<div class="viewcode-block" id="set_annot_tags"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_tags">[docs]</a><span class="k">def</span> <span class="nf">set_annot_tags</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">annot_tags_list</span><span class="p">,</span> <span class="n">duplicate_behavior</span><span class="o">=</span><span class="s">&#39;error&#39;</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot; annot_tags_list -&gt; annot.annot_tags[aid_list]</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list</span>
<span class="sd">        annot_tags_list</span>

<span class="sd">    TemplateInfo:</span>
<span class="sd">        Tsetter_native_column</span>
<span class="sd">        tbl = annot</span>
<span class="sd">        col = annot_tags</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">ANNOT_TAGS</span><span class="p">,)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">annot_tags_list</span><span class="p">,</span>
               <span class="n">id_iter</span><span class="p">,</span> <span class="n">duplicate_behavior</span><span class="o">=</span><span class="n">duplicate_behavior</span><span class="p">)</span>


<span class="c">#==========</span>
<span class="c"># Testdata</span>
<span class="c">#==========</span>

</div>
<div class="viewcode-block" id="testdata_ibs"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.testdata_ibs">[docs]</a><span class="k">def</span> <span class="nf">testdata_ibs</span><span class="p">():</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Auto-docstr for &#39;testdata_ibs&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">ibeis</span>
    <span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
    <span class="n">qreq_</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">return</span> <span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span>

</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --allexamples</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --allexamples --noface --nosrc</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">multiprocessing</span>
    <span class="n">multiprocessing</span><span class="o">.</span><span class="n">freeze_support</span><span class="p">()</span>  <span class="c"># for win32</span>
    <span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>  <span class="c"># NOQA</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">doctest_funcs</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Jon Crall.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.4.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>