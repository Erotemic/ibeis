<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ibeis.model.hots package &mdash; ibeis 0.1.0.dev1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0.dev1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ibeis 0.1.0.dev1 documentation" href="index.html" />
    <link rel="up" title="ibeis.model package" href="ibeis.model.html" />
    <link rel="next" title="ibeis.model.hots.smk package" href="ibeis.model.hots.smk.html" />
    <link rel="prev" title="ibeis.model.detect package" href="ibeis.model.detect.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ibeis.model.hots.smk.html" title="ibeis.model.hots.smk package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ibeis.model.detect.html" title="ibeis.model.detect package"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">ibeis 0.1.0.dev1 documentation</a> &raquo;</li>
          <li><a href="ibeis.html" >ibeis package</a> &raquo;</li>
          <li><a href="ibeis.model.html" accesskey="U">ibeis.model package</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="ibeis-model-hots-package">
<h1>ibeis.model.hots package<a class="headerlink" href="#ibeis-model-hots-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="ibeis.model.hots.smk.html">ibeis.model.hots.smk package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.smk_core">ibeis.model.hots.smk.smk_core module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.smk_debug">ibeis.model.hots.smk.smk_debug module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.smk_index">ibeis.model.hots.smk.smk_index module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.smk_match">ibeis.model.hots.smk.smk_match module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.smk_plots">ibeis.model.hots.smk.smk_plots module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.smk_repr">ibeis.model.hots.smk.smk_repr module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.smk_residuals">ibeis.model.hots.smk.smk_residuals module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.smk_scoring">ibeis.model.hots.smk.smk_scoring module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.tmp">ibeis.model.hots.smk.tmp module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-ibeis.model.hots.automated_helpers">
<span id="ibeis-model-hots-automated-helpers-module"></span><h2>ibeis.model.hots.automated_helpers module<a class="headerlink" href="#module-ibeis.model.hots.automated_helpers" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.model.hots.automated_helpers.add_annot_chunk">
<tt class="descclassname">ibeis.model.hots.automated_helpers.</tt><tt class="descname">add_annot_chunk</tt><big>(</big><em>ibs_gt</em>, <em>ibs2</em>, <em>aids_chunk1</em>, <em>aid1_to_aid2</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_helpers.html#add_annot_chunk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_helpers.add_annot_chunk" title="Permalink to this definition">¶</a></dt>
<dd><p>adds annotations to the tempoarary database and prevents duplicate
additions.</p>
<p>aids_chunk1 = aid_list1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">aids_chunk2</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_helpers.annot_consistency_checks">
<tt class="descclassname">ibeis.model.hots.automated_helpers.</tt><tt class="descname">annot_consistency_checks</tt><big>(</big><em>ibs_gt</em>, <em>ibs2</em>, <em>aid_list1</em>, <em>aid_list2</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_helpers.html#annot_consistency_checks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_helpers.annot_consistency_checks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_helpers.assert_annot_consistency">
<tt class="descclassname">ibeis.model.hots.automated_helpers.</tt><tt class="descname">assert_annot_consistency</tt><big>(</big><em>ibs_gt</em>, <em>ibs2</em>, <em>aid_list1</em>, <em>aid_list2</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_helpers.html#assert_annot_consistency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_helpers.assert_annot_consistency" title="Permalink to this definition">¶</a></dt>
<dd><p>just tests uuids</p>
<dl class="docutils">
<dt>if anything goes wrong this should fix it:</dt>
<dd>ibs_gt.update_annot_visual_uuids(aid_list1)
ibs2.update_annot_visual_uuids(aid_list2)
ibsfuncs.fix_remove_visual_dupliate_annotations(ibs_gt)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_helpers.check_results">
<tt class="descclassname">ibeis.model.hots.automated_helpers.</tt><tt class="descname">check_results</tt><big>(</big><em>ibs_gt</em>, <em>ibs2</em>, <em>aid1_to_aid2</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_helpers.html#check_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_helpers.check_results" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_helpers.ensure_clean_data">
<tt class="descclassname">ibeis.model.hots.automated_helpers.</tt><tt class="descname">ensure_clean_data</tt><big>(</big><em>ibs_gt</em>, <em>ibs2</em>, <em>aid_list1</em>, <em>aid_list2</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_helpers.html#ensure_clean_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_helpers.ensure_clean_data" title="Permalink to this definition">¶</a></dt>
<dd><p>removes previously set names and exemplars</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_helpers.interactive_commandline_prompt">
<tt class="descclassname">ibeis.model.hots.automated_helpers.</tt><tt class="descname">interactive_commandline_prompt</tt><big>(</big><em>msg</em>, <em>decisiontype</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_helpers.html#interactive_commandline_prompt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_helpers.interactive_commandline_prompt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_helpers.interactive_msgbox_prompt">
<tt class="descclassname">ibeis.model.hots.automated_helpers.</tt><tt class="descname">interactive_msgbox_prompt</tt><big>(</big><em>ibs2</em>, <em>decisiontype</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_helpers.html#interactive_msgbox_prompt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_helpers.interactive_msgbox_prompt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_helpers.setup_incremental_test">
<tt class="descclassname">ibeis.model.hots.automated_helpers.</tt><tt class="descname">setup_incremental_test</tt><big>(</big><em>ibs_gt</em>, <em>num_initial=0</em>, <em>clear_names=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_helpers.html#setup_incremental_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_helpers.setup_incremental_test" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd><p class="first">python -m ibeis.model.hots.automated_helpers &#8211;test-setup_incremental_test:0</p>
<p class="last">python dev.py -t custom &#8211;cfg codename:vsone_unnorm &#8211;db PZ_MTEST &#8211;allgt &#8211;vf &#8211;va
python dev.py -t custom &#8211;cfg codename:vsone_unnorm &#8211;db PZ_MTEST &#8211;allgt &#8211;vf &#8211;va &#8211;index 0 4 8 &#8211;verbose</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.automated_helpers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs_gt</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_initial</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs2</span><span class="p">,</span> <span class="n">aid_list1</span><span class="p">,</span> <span class="n">aid1_to_aid2</span> <span class="o">=</span> <span class="n">setup_incremental_test</span><span class="p">(</span><span class="n">ibs_gt</span><span class="p">,</span> <span class="n">num_initial</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.automated_helpers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs_gt</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;GZ_ALL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_initial</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs2</span><span class="p">,</span> <span class="n">aid_list1</span><span class="p">,</span> <span class="n">aid1_to_aid2</span> <span class="o">=</span> <span class="n">setup_incremental_test</span><span class="p">(</span><span class="n">ibs_gt</span><span class="p">,</span> <span class="n">num_initial</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.automated_matcher">
<span id="ibeis-model-hots-automated-matcher-module"></span><h2>ibeis.model.hots.automated_matcher module<a class="headerlink" href="#module-ibeis.model.hots.automated_matcher" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>Idea:</dt>
<dd>what about the probability of a descriptor match being a score like in SIFT.
we can learn that too.</dd>
<dt>Have:</dt>
<dd><ul class="first last simple">
<li>semantic and visual uuids</li>
<li>Test that accepts unknown annotations one at a time and
for each runs query, makes decision about name, and executes decision.</li>
<li>As a placeholder for exemplar decisions  an exemplar is added if
number of exemplars per name is less than threshold.</li>
<li>vs-one reranking query mode</li>
<li>test harness but start with larger test set</li>
<li>vs-one score normalizer ~~/ score normalizer for different values of K * / different params~~
vs-many score normalization doesnt actually matter. We just need the ranking.</li>
<li>need to add in the multi-indexer code into the pipeline. Need to
decide which subindexers to load given a set of daids</li>
<li>need to use set query as an exemplar if its vs-one reranking scores
are below a threshold</li>
<li>flip the vsone ratio score so its &lt; .8 rather than &gt; 1.2 or whatever</li>
<li>start from nothing and let the system make the first few decisions correctly</li>
<li>tell me the correct answer in the automated test</li>
<li>turn on multi-indexing. (should just work..., probably bugs though. Just need to throw the switch)</li>
<li>paramater to only add exemplar if post-normlized score is above a threshold</li>
<li>ensure vsone ratio test is happening correctly</li>
<li>normalization gets a cfgstr based on the query</li>
<li>need to allow for scores to be un-invalidatd post spatial verification
e.g. when the first match initially is invalidated through
spatial verification but the next matches survive.</li>
<li>keep distinctiveness weights from vsmany for vsone weighting
basically involves keeping weights from different filters and not
aggregating match weights until the end.</li>
</ul>
</dd>
<dt>TODO:</dt>
<dd><ul class="first simple">
<li>update normalizer (have setup the datastructure to allow for it need to integrate it seemlessly)</li>
<li>Improve vsone scoring.</li>
<li>score normalization update. on add the new support data, reapply bayes</li>
</ul>
<blockquote>
<div>rule, and save to the current cache for a given algorithm configuration.</div></blockquote>
<ul class="last simple">
<li>test case where there is a 360 view that is linkable from the tests case</li>
<li>Put test query mode into the main application and work on the interface for it.</li>
<li>spawn background process to reindex chunks of data</li>
<li>~~Remember name_confidence of decisions for manual review~~ Defer</li>
<li>add matches to multiple animals (merge)</li>
</ul>
</dd>
</dl>
<p>Tasks:</p>
<blockquote>
<div><dl class="docutils">
<dt>Algorithm::</dt>
<dd><blockquote class="first">
<div><ul>
<li><dl class="first docutils">
<dt>Incremental query needs to handle</dt>
<dd><ul class="first last">
<li><p class="first">test mode and live mode</p>
</li>
<li><p class="first">normalizer update</p>
</li>
<li><p class="first">use correct distinctivenes score in vsone</p>
</li>
<li><dl class="first docutils">
<dt>tested application of distinctiveness, foreground, ratio,</dt>
<dd><p class="first last">spatial_verification, vsone verification, and score
normalization.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Mathematically formal description of the space of choices</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>getting the proability of each choice will give us a much better</dt>
<dd><p class="first last">confidence measure for our decision. An example of a probability
partition might be .2 - merge with rank1.  .2 merge with rank 2, .5
merge with rank1 and rank2, .1 others</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Improved automated exemplar decision mechanism</p>
</li>
<li><p class="first">Improved automated name decision mechanism</p>
</li>
</ul>
</div></blockquote>
<dl class="last docutils">
<dt>SQL::</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>New Image Columns</dt>
<dd><ul class="first last simple">
<li>image_posix_timedelta</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>New Name Columns</dt>
<dd><ul class="first last simple">
<li>name_temp_flag</li>
<li>name_alias_text</li>
<li>name_uuid</li>
<li>name_visual_uuid</li>
<li>name_member_annot_rowids_evalstr</li>
<li>name_member_num_annot_rowids</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>New Encounter Columns</dt>
<dd><ul class="first last simple">
<li>encounter_start_time</li>
<li>encounter_end_time</li>
<li>encounter_lat</li>
<li>encounter_lon</li>
<li>encounter_processed_flag</li>
<li>encounter_shipped_flag</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
<dt>Decision UIs::</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>Query versus top N results</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>ability to draw an undirected edge between the query and any number of</dt>
<dd><p class="first last">results. ie create a match any of the top results</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>a match to more than one results should by default merge the two names</dt>
<dd><p class="first last">(this involves a name enhancement subtask). trigger a split / merge dialog</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Is Exemplar</dt>
<dd><ul class="first last simple">
<li>allows for user to set the exemplars for a given name</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Name Progress</dt>
<dd><ul class="first last simple">
<li>Shows the current name matching progress</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Split</dt>
<dd><ul class="first last simple">
<li>Allows a user to split off some images from a name into a new name
or some other name.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Merge</dt>
<dd><ul class="first last simple">
<li>Allows a user to join two names.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>GUI::</dt>
<dd><ul class="first last">
<li><p class="first">NameTree needs to not refresh unless absolutely necessary</p>
</li>
<li><p class="first">Time Sync</p>
</li>
<li><p class="first">Encounter metadata sync from the SMART</p>
</li>
<li><dl class="first docutils">
<dt>Hide shipped encounters</dt>
<dd><ul class="first last simple">
<li>put flag to turn them on</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Mark processed encounters</p>
</li>
<li><dl class="first docutils">
<dt>Gui naturally ensures that all annotations in the query belong</dt>
<dd><p class="first last">to the same species</p>
</dd>
</dl>
</li>
<li><p class="first">Garbage collection function that removes all non-exemplar
information from encounters that have been shipped.</p>
</li>
<li><p class="first">Spawn process that reindexes large chunks of descriptors as the
database grows.</p>
</li>
</ul>
</dd>
</dl>
</div></blockquote>
<p>LONG TERM TASKS:</p>
<blockquote>
<div><dl class="docutils">
<dt>Architecture:</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>Pipeline needs</dt>
<dd><ul class="first last simple">
<li>DEFER: a move from dict based representation to list based</li>
<li>DEFER: spatial verification cyth speedup</li>
<li>DEFER: nearest neighbor (based on visual uuid caching) caching</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Controller:</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>LONGTERM: AutogenController</dt>
<dd><ul class="first last simple">
<li>register data convertors for verts / other eval columns. Make
several convertors standard and we can tag those columns to
autogenerate their functions.</li>
<li>be able to mark a column as determined by the aggregate of other
columns. Then the data is either generated on the fly, or it is
cached and the necessary book-keeping functions are
autogenerated.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Decision UIs::</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>Is Exemplar</dt>
<dd><ul class="first last simple">
<li>LONG TERM: it would be cool if they were visualized by using
networkx or some gephi like program and clustered by match score.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</div></blockquote>
<dl class="class">
<dt id="ibeis.model.hots.automated_matcher.ChoiceTuple">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">ChoiceTuple</tt><a class="headerlink" href="#ibeis.model.hots.automated_matcher.ChoiceTuple" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">tuple</span></tt></p>
<p>ChoiceTuple(sorted_nids, sorted_nscore, sorted_rawscore, sorted_aids, sorted_ascores)</p>
<dl class="method">
<dt id="ibeis.model.hots.automated_matcher.ChoiceTuple.__getnewargs__">
<tt class="descname">__getnewargs__</tt><big>(</big><big>)</big><a class="headerlink" href="#ibeis.model.hots.automated_matcher.ChoiceTuple.__getnewargs__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return self as a plain tuple.  Used by copy and pickle.</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.automated_matcher.ChoiceTuple.__getstate__">
<tt class="descname">__getstate__</tt><big>(</big><big>)</big><a class="headerlink" href="#ibeis.model.hots.automated_matcher.ChoiceTuple.__getstate__" title="Permalink to this definition">¶</a></dt>
<dd><p>Exclude the OrderedDict from pickling</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.automated_matcher.ChoiceTuple.__repr__">
<tt class="descname">__repr__</tt><big>(</big><big>)</big><a class="headerlink" href="#ibeis.model.hots.automated_matcher.ChoiceTuple.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a nicely formatted representation string</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.model.hots.automated_matcher.ChoiceTuple.sorted_aids">
<tt class="descname">sorted_aids</tt><a class="headerlink" href="#ibeis.model.hots.automated_matcher.ChoiceTuple.sorted_aids" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.model.hots.automated_matcher.ChoiceTuple.sorted_ascores">
<tt class="descname">sorted_ascores</tt><a class="headerlink" href="#ibeis.model.hots.automated_matcher.ChoiceTuple.sorted_ascores" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.model.hots.automated_matcher.ChoiceTuple.sorted_nids">
<tt class="descname">sorted_nids</tt><a class="headerlink" href="#ibeis.model.hots.automated_matcher.ChoiceTuple.sorted_nids" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.model.hots.automated_matcher.ChoiceTuple.sorted_nscore">
<tt class="descname">sorted_nscore</tt><a class="headerlink" href="#ibeis.model.hots.automated_matcher.ChoiceTuple.sorted_nscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.model.hots.automated_matcher.ChoiceTuple.sorted_rawscore">
<tt class="descname">sorted_rawscore</tt><a class="headerlink" href="#ibeis.model.hots.automated_matcher.ChoiceTuple.sorted_rawscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.execute_name_decision">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">execute_name_decision</tt><big>(</big><em>ibs</em>, <em>qaid</em>, <em>name</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#execute_name_decision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.execute_name_decision" title="Permalink to this definition">¶</a></dt>
<dd><p>sets the name of qaid to be name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ibs</strong> (<em>IBEISController</em>) &#8211; ibeis controller object</li>
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation id</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.automated_matcher &#8211;test-execute_name_decision</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">execute_name_decision</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.execute_teststep">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">execute_teststep</tt><big>(</big><em>ibs</em>, <em>qaid_chunk</em>, <em>threshold</em>, <em>interactive</em>, <em>metatup=None</em>, <em>incinfo=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#execute_teststep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.execute_teststep" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an unseen annotation and run a query</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ibs</strong> (<em>IBEISController</em>) &#8211; ibeis controller object</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.automated_matcher &#8211;test-execute_teststep</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_chunk</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">threshold</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interactive</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metatup</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">execute_teststep</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_chunk</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">metatup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.generate_incremental_queries">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">generate_incremental_queries</tt><big>(</big><em>ibs</em>, <em>qaid_list</em>, <em>daid_list</em>, <em>incinfo=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#generate_incremental_queries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.generate_incremental_queries" title="Permalink to this definition">¶</a></dt>
<dd><p>generates incremental queries that completely new to the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ibs</strong> (<em>IBEISController</em>) &#8211; ibeis controller object</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.automated_matcher &#8211;test-generate_incremental_queries</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_list</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">generate_incremental_queries</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.get_qres_choices">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">get_qres_choices</tt><big>(</big><em>ibs</em>, <em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#get_qres_choices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.get_qres_choices" title="Permalink to this definition">¶</a></dt>
<dd><p>returns all possible decision a user could make</p>
<p>TODO: Return the possiblity of a merge.
TODO: Ensure that the total probability of each possible choice sums to 1.
This will define a probability density function that we can take advantage
of</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs</strong> (<em>IBEISController</em>) &#8211; ibeis controller object</li>
<li><strong>qres</strong> (<em>QueryResult</em>) &#8211; object of feature correspondences and scores</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">choicetup</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ChoiceTuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.automated_matcher &#8211;test-get_qres_choices</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">_query_chips4</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">cfgdict</span><span class="o">=</span><span class="nb">dict</span><span class="p">())[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">choicetup</span> <span class="o">=</span> <span class="n">get_qres_choices</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qres</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">choicetup</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.get_system_exemplar_suggestion">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">get_system_exemplar_suggestion</tt><big>(</big><em>ibs</em>, <em>qaid</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#get_system_exemplar_suggestion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.get_system_exemplar_suggestion" title="Permalink to this definition">¶</a></dt>
<dd><p>hotspotter returns an exemplar suggestion</p>
<dl class="docutils">
<dt>TODO:</dt>
<dd>do a vsone query between all of the exemplars to see if this one is good
enough to be added.</dd>
<dt>TODO:</dt>
<dd>build a complete graph of exemplar scores and only add if this one is
lower than any other edge</dd>
<dt>SeeAlso:</dt>
<dd>ibsfuncs.prune_exemplars</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.get_system_name_suggestion">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">get_system_name_suggestion</tt><big>(</big><em>ibs</em>, <em>choicetup</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#get_system_name_suggestion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.get_system_name_suggestion" title="Permalink to this definition">¶</a></dt>
<dd><p>hotspotter returns an name suggestion</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation id</li>
<li><strong>qres</strong> (<em>QueryResult</em>) &#8211; object of feature correspondences and scores</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(autoname_msg, autoname_func)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.automated_matcher &#8211;test-incremental_test:0
python -m ibeis.model.hots.automated_matcher &#8211;test-incremental_test:1
python -m ibeis.model.hots.automated_matcher &#8211;test-get_system_name_suggestion</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">_query_chips4</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">cfgdict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span>
<span class="gp">... </span>           <span class="n">return_request</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span> <span class="o">=</span> <span class="n">qaid2_qres</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">choicetup</span> <span class="o">=</span> <span class="n">get_qres_choices</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qres</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">autoname_msg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">name_confidence</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_system_name_suggestion</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">choicetup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">autoname_msg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">name_confidence</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.get_user_exemplar_decision">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">get_user_exemplar_decision</tt><big>(</big><em>autoexemplar_msg</em>, <em>exemplar_decision</em>, <em>exemplar_condience</em>, <em>incinfo=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#get_user_exemplar_decision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.get_user_exemplar_decision" title="Permalink to this definition">¶</a></dt>
<dd><p>hooks into to some method of getting user input for exemplars</p>
<p>TODO: really good interface</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">?: True</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.automated_matcher &#8211;test-get_user_exemplar_decision</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">autoexemplar_msg</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exemplar_decision</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exemplar_condience</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">True</span> <span class="o">=</span> <span class="n">get_user_exemplar_decision</span><span class="p">(</span><span class="n">autoexemplar_msg</span><span class="p">,</span> <span class="n">exemplar_decision</span><span class="p">,</span> <span class="n">exemplar_condience</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.get_user_name_decision">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">get_user_name_decision</tt><big>(</big><em>ibs</em>, <em>qres</em>, <em>qreq_</em>, <em>autoname_msg</em>, <em>name</em>, <em>name_confidence</em>, <em>choicetup</em>, <em>incinfo=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#get_user_name_decision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.get_user_name_decision" title="Permalink to this definition">¶</a></dt>
<dd><p>hooks into to some method of getting user input for names</p>
<p>TODO: really good interface</p>
<p>Prompts the user for input</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qres</strong> (<em>QueryResult</em>) &#8211; object of feature correspondences and scores</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.incremental_test">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">incremental_test</tt><big>(</big><em>ibs_gt</em>, <em>num_initial=0</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#incremental_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.incremental_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds and queries new annotations one at a time with oracle guidance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ibs</strong> (<em>list</em>) &#8211; IBEISController object</li>
<li><strong>qaid_list</strong> (<em>list</em>) &#8211; list of annotation-ids to query</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd><p class="first">python dev.py -t inc &#8211;db PZ_MTEST &#8211;qaid 1:30:3 &#8211;cmd
python dev.py &#8211;db PZ_MTEST &#8211;allgt &#8211;cmd
python dev.py &#8211;db PZ_MTEST &#8211;allgt -t inc
python dev.py &#8211;db PZ_MTEST &#8211;allgt -t inc
python -m ibeis.model.hots.automated_matcher &#8211;test-incremental_test:0
python -m ibeis.model.hots.automated_matcher &#8211;test-incremental_test:1
python -m ibeis.model.hots.automated_matcher &#8211;test-incremental_test:0 &#8211;interact-after 444440 &#8211;noqcache
python -m ibeis.model.hots.automated_matcher &#8211;test-incremental_test:1 &#8211;interact-after 444440 &#8211;noqcache</p>
<p class="last">python -m ibeis.model.hots.automated_matcher &#8211;test-incremental_test:2
python -m ibeis.model.hots.automated_matcher &#8211;test-incremental_test:0</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.all_imports</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs_gt</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#num_initial = 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_initial</span> <span class="o">=</span> <span class="mi">90</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">incremental_test</span><span class="p">(</span><span class="n">ibs_gt</span><span class="p">,</span> <span class="n">num_initial</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.all_imports</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs_gt</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;GZ_ALL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_initial</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">incremental_test</span><span class="p">(</span><span class="n">ibs_gt</span><span class="p">,</span> <span class="n">num_initial</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.all_imports</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs_gt</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#num_initial = 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_initial</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">incremental_test</span><span class="p">(</span><span class="n">ibs_gt</span><span class="p">,</span> <span class="n">num_initial</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.make_name_decision">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">make_name_decision</tt><big>(</big><em>name</em>, <em>choicetup</em>, <em>ibs</em>, <em>qres</em>, <em>qreq_</em>, <em>threshold</em>, <em>interactive=True</em>, <em>metatup=None</em>, <em>dry=False</em>, <em>incinfo=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#make_name_decision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.make_name_decision" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.try_automatic_decision">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">try_automatic_decision</tt><big>(</big><em>ibs</em>, <em>qres</em>, <em>qreq_</em>, <em>choicetup</em>, <em>threshold</em>, <em>interactive=False</em>, <em>metatup=None</em>, <em>dry=False</em>, <em>incinfo=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#try_automatic_decision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.try_automatic_decision" title="Permalink to this definition">¶</a></dt>
<dd><p>Either makes automatic decision or asks user for feedback.</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.automated_matcher &#8211;test-incremental_test:0
python -m ibeis.model.hots.automated_matcher &#8211;test-incremental_test:1
python -m ibeis.model.hots.automated_matcher &#8211;test-try_automatic_decision</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_chunk</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exemplar_aids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">is_exemplar</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dry</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">special_query</span><span class="o">.</span><span class="n">query_vsone_verified</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_chunk</span><span class="p">,</span> <span class="n">exemplar_aids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qaid_chunk</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span> <span class="o">=</span> <span class="n">qaid2_qres</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metatup</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">threshold</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interactive</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metatup</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dry</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">try_automatic_decision</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qres</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">choicetup</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">metatup</span><span class="p">,</span> <span class="n">dry</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p>qres.ishow_top(ibs, sidebyside=False, show_query=True)</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.try_automatic_exemplar_decision">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">try_automatic_exemplar_decision</tt><big>(</big><em>choicetup</em>, <em>ibs</em>, <em>qres</em>, <em>qreq_</em>, <em>threshold</em>, <em>interactive=False</em>, <em>metatup=None</em>, <em>dry=False</em>, <em>incinfo=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#try_automatic_exemplar_decision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.try_automatic_exemplar_decision" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.try_automatic_name_decision">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">try_automatic_name_decision</tt><big>(</big><em>autoname_msg</em>, <em>name</em>, <em>name_confidence</em>, <em>choicetup</em>, <em>ibs</em>, <em>qres</em>, <em>qreq_</em>, <em>threshold</em>, <em>interactive=False</em>, <em>metatup=None</em>, <em>dry=False</em>, <em>incinfo=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#try_automatic_name_decision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.try_automatic_name_decision" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.update_normalizer">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">update_normalizer</tt><big>(</big><em>ibs</em>, <em>qreq_</em>, <em>choicetup</em>, <em>name</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#update_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.update_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>adds new support data to the current normalizer</p>
<p>FIXME: a miss-save in vim will trigger module unloading</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs</strong> (<em>IBEISController</em>) &#8211; ibeis controller object</li>
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; query request object with hyper-parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(tp_rawscore, tn_rawscore)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.automated_matcher &#8211;test-update_normalizer</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">choicetup</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">tp_rawscore</span><span class="p">,</span> <span class="n">tn_rawscore</span><span class="p">)</span> <span class="o">=</span> <span class="n">update_normalizer</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">choicetup</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">tp_rawscore</span><span class="p">,</span> <span class="n">tn_rawscore</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.automated_oracle">
<span id="ibeis-model-hots-automated-oracle-module"></span><h2>ibeis.model.hots.automated_oracle module<a class="headerlink" href="#module-ibeis.model.hots.automated_oracle" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.model.hots.automated_oracle.get_oracle_decision">
<tt class="descclassname">ibeis.model.hots.automated_oracle.</tt><tt class="descname">get_oracle_decision</tt><big>(</big><em>metatup</em>, <em>ibs2</em>, <em>qaid</em>, <em>choicetup</em>, <em>oracle_method=1</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_oracle.html#get_oracle_decision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_oracle.get_oracle_decision" title="Permalink to this definition">¶</a></dt>
<dd><p>Find what the correct decision should be ibs2 is the database we are working
with ibs_gt has pristine groundtruth</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_oracle.get_oracle_name_suggestion">
<tt class="descclassname">ibeis.model.hots.automated_oracle.</tt><tt class="descname">get_oracle_name_suggestion</tt><big>(</big><em>ibs2</em>, <em>autoname_msg</em>, <em>qaid</em>, <em>choicetup</em>, <em>metatup</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_oracle.html#get_oracle_name_suggestion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_oracle.get_oracle_name_suggestion" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_oracle.oracle_method1">
<tt class="descclassname">ibeis.model.hots.automated_oracle.</tt><tt class="descname">oracle_method1</tt><big>(</big><em>ibs_gt</em>, <em>ibs2</em>, <em>qnid1</em>, <em>aid_list2</em>, <em>aid2_to_aid1</em>, <em>sorted_nids</em>, <em>MAX_LOOK</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_oracle.html#oracle_method1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_oracle.oracle_method1" title="Permalink to this definition">¶</a></dt>
<dd><p>METHOD 1: MAKE BEST DECISION FROM GIVEN INFORMATION</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_oracle.oracle_method2">
<tt class="descclassname">ibeis.model.hots.automated_oracle.</tt><tt class="descname">oracle_method2</tt><big>(</big><em>ibs_gt</em>, <em>qnid1</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_oracle.html#oracle_method2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_oracle.oracle_method2" title="Permalink to this definition">¶</a></dt>
<dd><p>METHOD 2: MAKE THE ABSOLUTE CORRECT DECISION REGARDLESS OF RESULT</p>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.exceptions">
<span id="ibeis-model-hots-exceptions-module"></span><h2>ibeis.model.hots.exceptions module<a class="headerlink" href="#module-ibeis.model.hots.exceptions" title="Permalink to this headline">¶</a></h2>
<dl class="exception">
<dt id="ibeis.model.hots.exceptions.HotsCacheMissError">
<em class="property">exception </em><tt class="descclassname">ibeis.model.hots.exceptions.</tt><tt class="descname">HotsCacheMissError</tt><a class="reference internal" href="_modules/ibeis/model/hots/exceptions.html#HotsCacheMissError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.exceptions.HotsCacheMissError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></tt></p>
</dd></dl>

<dl class="exception">
<dt id="ibeis.model.hots.exceptions.HotsNeedsRecomputeError">
<em class="property">exception </em><tt class="descclassname">ibeis.model.hots.exceptions.</tt><tt class="descname">HotsNeedsRecomputeError</tt><a class="reference internal" href="_modules/ibeis/model/hots/exceptions.html#HotsNeedsRecomputeError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.exceptions.HotsNeedsRecomputeError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></tt></p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.exceptions.NoDescriptorsException">
<tt class="descclassname">ibeis.model.hots.exceptions.</tt><tt class="descname">NoDescriptorsException</tt><big>(</big><em>ibs</em>, <em>qaid</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/exceptions.html#NoDescriptorsException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.exceptions.NoDescriptorsException" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="exception">
<dt id="ibeis.model.hots.exceptions.QueryException">
<em class="property">exception </em><tt class="descclassname">ibeis.model.hots.exceptions.</tt><tt class="descname">QueryException</tt><big>(</big><em>msg</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/exceptions.html#QueryException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.exceptions.QueryException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></tt></p>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.hots_query_result">
<span id="ibeis-model-hots-hots-query-result-module"></span><h2>ibeis.model.hots.hots_query_result module<a class="headerlink" href="#module-ibeis.model.hots.hots_query_result" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibeis.model.hots.hots_query_result.QueryResult">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.hots_query_result.</tt><tt class="descname">QueryResult</tt><big>(</big><em>qres</em>, <em>qaid</em>, <em>qauuid</em>, <em>cfgstr</em>, <em>daids</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.__eq__">
<tt class="descname">__eq__</tt><big>(</big><em>other</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.__eq__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.__eq__" title="Permalink to this definition">¶</a></dt>
<dd><p>For testing. Do not use</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.assert_self">
<tt class="descname">assert_self</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.assert_self"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.assert_self" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.cache_bytes">
<tt class="descname">cache_bytes</tt><big>(</big><em>qres</em>, <em>qresdir</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.cache_bytes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.cache_bytes" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of the cached query result on disk</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_aid_ranks">
<tt class="descname">get_aid_ranks</tt><big>(</big><em>qres</em>, <em>aid_arr</em>, <em>fillvalue=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_aid_ranks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_aid_ranks" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapped function wrp_asi(get_aid_ranks)</p>
<p>orig_argspec = ArgSpec(args=[&#8216;qres&#8217;, &#8216;aid_arr&#8217;, &#8216;fillvalue&#8217;], varargs=None, keywords=None, defaults=(None,))</p>
<p>orig_docstr =  get ranks of annotation ids</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_aid_scores">
<tt class="descname">get_aid_scores</tt><big>(</big><em>qres</em>, <em>aid_arr</em>, <em>fillvalue=None</em>, <em>rawscore=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_aid_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_aid_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_aid_truth">
<tt class="descname">get_aid_truth</tt><big>(</big><em>qres</em>, <em>ibs</em>, <em>aid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_aid_truth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_aid_truth" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_aids_and_scores">
<tt class="descname">get_aids_and_scores</tt><big>(</big><em>qres</em>, <em>name_scoring=False</em>, <em>ibs=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_aids_and_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_aids_and_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a chip index list and associated score list</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_average_percision">
<tt class="descname">get_average_percision</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_average_percision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_average_percision" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_best_gt_rank">
<tt class="descname">get_best_gt_rank</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_best_gt_rank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_best_gt_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the best rank over all the groundtruth</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_classified_pos">
<tt class="descname">get_classified_pos</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_classified_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_classified_pos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_daids">
<tt class="descname">get_daids</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_daids" title="Permalink to this definition">¶</a></dt>
<dd><p>returns database annotation ids this query was run with</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_fk_list">
<tt class="descname">get_fk_list</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_fk_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_fk_list" title="Permalink to this definition">¶</a></dt>
<dd><p>returns list of fk&#8217;s wrt database annotation ids</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_fm_list">
<tt class="descname">get_fm_list</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_fm_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_fm_list" title="Permalink to this definition">¶</a></dt>
<dd><p>returns list of fm&#8217;s wrt database annotation ids</p>
<p>THIS AND OTHER ANALOGOUS FUNCS WILL BE FIRST LEVEL GETTERS
ONCE qres.aid2_xxx becomes qres.xxx_list with qres.daid_list</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_fmatch_index">
<tt class="descname">get_fmatch_index</tt><big>(</big><em>qres</em>, <em>aid</em>, <em>qfx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_fmatch_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_fmatch_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the feature index in aid matching the query&#8217;s qfx-th feature
(if it exists)</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_fname">
<tt class="descname">get_fname</tt><big>(</big><em>qres</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_fname"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_fname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_fpath">
<tt class="descname">get_fpath</tt><big>(</big><em>qres</em>, <em>qresdir</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_fpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_fs_list">
<tt class="descname">get_fs_list</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_fs_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_fs_list" title="Permalink to this definition">¶</a></dt>
<dd><p>returns list of fs&#8217;s wrt database annotation ids</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_fsv_list">
<tt class="descname">get_fsv_list</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_fsv_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_fsv_list" title="Permalink to this definition">¶</a></dt>
<dd><p>returns list of fsv&#8217;s wrt database annotation ids</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_gf_scores">
<tt class="descname">get_gf_scores</tt><big>(</big><em>qres</em>, <em>gf_aids=None</em>, <em>ibs=None</em>, <em>return_gfaids=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_gf_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_gf_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>returns groundfalse scores</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_groundfalse_aids">
<tt class="descname">get_groundfalse_aids</tt><big>(</big><em>qres</em>, <em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_groundfalse_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_groundfalse_aids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_groundtruth_aids">
<tt class="descname">get_groundtruth_aids</tt><big>(</big><em>qres</em>, <em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_groundtruth_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_groundtruth_aids" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the groundtruth with respect to what could have been matched for
this query</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_gt_ranks">
<tt class="descname">get_gt_ranks</tt><big>(</big><em>qres</em>, <em>gt_aids=None</em>, <em>ibs=None</em>, <em>return_gtaids=False</em>, <em>fillvalue=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_gt_ranks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_gt_ranks" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the 0 indexed ranking of each groundtruth chip</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_gt_scores">
<tt class="descname">get_gt_scores</tt><big>(</big><em>qres</em>, <em>gt_aids=None</em>, <em>ibs=None</em>, <em>return_gtaids=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_gt_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_gt_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>returns groundfalse scores</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_inspect_str">
<tt class="descname">get_inspect_str</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>name_scoring=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_inspect_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_inspect_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_interpolated_precision_vs_recall">
<tt class="descname">get_interpolated_precision_vs_recall</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_interpolated_precision_vs_recall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_interpolated_precision_vs_recall" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_match_tbldata">
<tt class="descname">get_match_tbldata</tt><big>(</big><em>qres</em>, <em>ranks_lt=6</em>, <em>name_scoring=False</em>, <em>ibs=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_match_tbldata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_match_tbldata" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns matchinfo in table format (qaids, aids, scores, ranks)</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_matching_keypoints">
<tt class="descname">get_matching_keypoints</tt><big>(</big><em>qres</em>, <em>ibs</em>, <em>aid2_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_matching_keypoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_matching_keypoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_name_decisiontup">
<tt class="descname">get_name_decisiontup</tt><big>(</big><em>qres</em>, <em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_name_decisiontup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_name_decisiontup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_nscoretup">
<tt class="descname">get_nscoretup</tt><big>(</big><em>qres</em>, <em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_nscoretup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_nscoretup" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">nscoretup</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.hots_query_result &#8211;test-get_nscoretup</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.hots_query_result</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">query_chips</span><span class="p">(</span><span class="n">qaids</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nscoretup</span> <span class="o">=</span> <span class="n">qres</span><span class="o">.</span><span class="n">get_nscoretup</span><span class="p">(</span><span class="n">ibs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">sorted_nids</span><span class="p">,</span> <span class="n">sorted_nscore</span><span class="p">,</span> <span class="n">sorted_aids</span><span class="p">,</span> <span class="n">sorted_scores</span><span class="p">)</span> <span class="o">=</span> <span class="n">nscoretup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">nscoretup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_precision_recall_curve">
<tt class="descname">get_precision_recall_curve</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_precision_recall_curve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_precision_recall_curve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_prob_list">
<tt class="descname">get_prob_list</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_prob_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_prob_list" title="Permalink to this definition">¶</a></dt>
<dd><p>returns list of fk&#8217;s wrt database annotation ids</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_qaid">
<tt class="descname">get_qaid</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_qaid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_qaid" title="Permalink to this definition">¶</a></dt>
<dd><p>returns query database annotation id</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_score_list">
<tt class="descname">get_score_list</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_score_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_score_list" title="Permalink to this definition">¶</a></dt>
<dd><p>returns list of fk&#8217;s wrt database annotation ids</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_sorted_nids_and_scores">
<tt class="descname">get_sorted_nids_and_scores</tt><big>(</big><em>qres</em>, <em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_sorted_nids_and_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_sorted_nids_and_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_top_aids">
<tt class="descname">get_top_aids</tt><big>(</big><em>qres</em>, <em>num=None</em>, <em>name_scoring=False</em>, <em>ibs=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_top_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_top_aids" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a ranked list of chip indexes</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_worse_possible_rank">
<tt class="descname">get_worse_possible_rank</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_worse_possible_rank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_worse_possible_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>a good non None value to use for None ranks</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.has_cache">
<tt class="descname">has_cache</tt><big>(</big><em>qres</em>, <em>qresdir</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.has_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.has_cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.is_nsum">
<tt class="descname">is_nsum</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.is_nsum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.is_nsum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.ishow_top">
<tt class="descname">ishow_top</tt><big>(</big><em>qres</em>, <em>ibs</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.ishow_top"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.ishow_top" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.load">
<tt class="descname">load</tt><big>(</big><em>qres</em>, <em>qresdir</em>, <em>verbose=False</em>, <em>force_miss=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the result from the given database</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.make_smaller_title">
<tt class="descname">make_smaller_title</tt><big>(</big><em>qres</em>, <em>remove_dsuuids=True</em>, <em>remove_chip=True</em>, <em>remove_feat=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.make_smaller_title"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.make_smaller_title" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.make_title">
<tt class="descname">make_title</tt><big>(</big><em>qres</em>, <em>pack=False</em>, <em>remove_dsuuids=False</em>, <em>remove_chip=False</em>, <em>remove_feat=False</em>, <em>textwidth=80</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.make_title"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.make_title" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.qt_inspect_gui">
<tt class="descname">qt_inspect_gui</tt><big>(</big><em>qres</em>, <em>ibs</em>, <em>ranks_lt=6</em>, <em>name_scoring=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.qt_inspect_gui"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.qt_inspect_gui" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.rrr">
<tt class="descname">rrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.save">
<tt class="descname">save</tt><big>(</big><em>qres</em>, <em>qresdir</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.save" title="Permalink to this definition">¶</a></dt>
<dd><p>saves query result to directory</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.show">
<tt class="descname">show</tt><big>(</big><em>qres</em>, <em>ibs</em>, <em>type_</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.show"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.show_analysis">
<tt class="descname">show_analysis</tt><big>(</big><em>qres</em>, <em>ibs</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.show_analysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.show_analysis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.show_precision_recall_curve">
<tt class="descname">show_precision_recall_curve</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em>, <em>fnum=1</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.show_precision_recall_curve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.show_precision_recall_curve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.show_top">
<tt class="descname">show_top</tt><big>(</big><em>qres</em>, <em>ibs</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.show_top"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.show_top" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.hots_query_result.assert_qres">
<tt class="descclassname">ibeis.model.hots.hots_query_result.</tt><tt class="descname">assert_qres</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#assert_qres"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.assert_qres" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.hots_query_result.get_num_chip_matches">
<tt class="descclassname">ibeis.model.hots.hots_query_result.</tt><tt class="descname">get_num_chip_matches</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#get_num_chip_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.get_num_chip_matches" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.hots_query_result.get_num_feats_in_matches">
<tt class="descclassname">ibeis.model.hots.hots_query_result.</tt><tt class="descname">get_num_feats_in_matches</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#get_num_feats_in_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.get_num_feats_in_matches" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.hots_query_result.qres_get_matching_keypoints">
<tt class="descclassname">ibeis.model.hots.hots_query_result.</tt><tt class="descname">qres_get_matching_keypoints</tt><big>(</big><em>qres</em>, <em>ibs</em>, <em>aid2_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#qres_get_matching_keypoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.qres_get_matching_keypoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.hots_query_result.query_result_fname">
<tt class="descclassname">ibeis.model.hots.hots_query_result.</tt><tt class="descname">query_result_fname</tt><big>(</big><em>qaid</em>, <em>qauuid</em>, <em>cfgstr</em>, <em>ext='.npz'</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#query_result_fname"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.query_result_fname" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a filename for a queryresult</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation rowid</li>
<li><strong>qauuid</strong> (<em>uuid.UUID</em>) &#8211; query annotation unique universal id</li>
<li><strong>cfgstr</strong> (<em>str</em>) &#8211; query parameter configuration string</li>
<li><strong>ext</strong> (<em>str</em>) &#8211; filetype extension</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.hots_query_result.query_result_fpath">
<tt class="descclassname">ibeis.model.hots.hots_query_result.</tt><tt class="descname">query_result_fpath</tt><big>(</big><em>qresdir</em>, <em>qaid</em>, <em>qauuid</em>, <em>cfgstr</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#query_result_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.query_result_fpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.hots_query_result.remove_corrupted_queries">
<tt class="descclassname">ibeis.model.hots.hots_query_result.</tt><tt class="descname">remove_corrupted_queries</tt><big>(</big><em>qresdir</em>, <em>qres</em>, <em>dryrun=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#remove_corrupted_queries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.remove_corrupted_queries" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.hstypes">
<span id="ibeis-model-hots-hstypes-module"></span><h2>ibeis.model.hots.hstypes module<a class="headerlink" href="#module-ibeis.model.hots.hstypes" title="Permalink to this headline">¶</a></h2>
<p>hstypes
Todo:
* SIFT: Root_SIFT -&gt; L2 normalized -&gt; Centering.
# <a class="reference external" href="http://hal.archives-ouvertes.fr/docs/00/84/07/21/PDF/RR-8325.pdf">http://hal.archives-ouvertes.fr/docs/00/84/07/21/PDF/RR-8325.pdf</a>
The devil is in the deatails
<a class="reference external" href="http://www.robots.ox.ac.uk/~vilem/bmvc2011.pdf">http://www.robots.ox.ac.uk/~vilem/bmvc2011.pdf</a>
This says dont clip, do rootsift instead
# <a class="reference external" href="http://hal.archives-ouvertes.fr/docs/00/68/81/69/PDF/hal_v1.pdf">http://hal.archives-ouvertes.fr/docs/00/68/81/69/PDF/hal_v1.pdf</a>
* Quantization of residual vectors
* Burstiness normalization for N-SMK
* Implemented A-SMK
* Incorporate Spatial Verification
* Implement correct cfgstrs based on algorithm input
for cached computations.
* Color by word
* Profile on hyrule
* Train vocab on paris
* Remove self matches.
* New SIFT parameters for pyhesaff (root, powerlaw, meanwhatever, output_dtype)</p>
<p>Issues:
* 10GB are in use when performing query on Oxford 5K
* errors when there is a word without any database vectors.
currently a weight of zero is hacked in</p>
</div>
<div class="section" id="module-ibeis.model.hots.interactive_automated_matcher">
<span id="ibeis-model-hots-interactive-automated-matcher-module"></span><h2>ibeis.model.hots.interactive_automated_matcher module<a class="headerlink" href="#module-ibeis.model.hots.interactive_automated_matcher" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibeis.model.hots.interactive_automated_matcher.IncQueryHarness">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.interactive_automated_matcher.</tt><tt class="descname">IncQueryHarness</tt><a class="reference internal" href="_modules/ibeis/model/hots/interactive_automated_matcher.html#IncQueryHarness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.interactive_automated_matcher.IncQueryHarness" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">PyQt4.QtCore.QObject</span></tt></p>
<dl class="attribute">
<dt id="ibeis.model.hots.interactive_automated_matcher.IncQueryHarness.name_decision_signal">
<tt class="descname">name_decision_signal</tt><a class="headerlink" href="#ibeis.model.hots.interactive_automated_matcher.IncQueryHarness.name_decision_signal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.interactive_automated_matcher.IncQueryHarness.name_decision_slot">
<tt class="descname">name_decision_slot</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/interactive_automated_matcher.html#IncQueryHarness.name_decision_slot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.interactive_automated_matcher.IncQueryHarness.name_decision_slot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.model.hots.interactive_automated_matcher.IncQueryHarness.next_query_signal">
<tt class="descname">next_query_signal</tt><a class="headerlink" href="#ibeis.model.hots.interactive_automated_matcher.IncQueryHarness.next_query_signal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.interactive_automated_matcher.IncQueryHarness.next_query_slot">
<tt class="descname">next_query_slot</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/interactive_automated_matcher.html#IncQueryHarness.next_query_slot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.interactive_automated_matcher.IncQueryHarness.next_query_slot" title="Permalink to this definition">¶</a></dt>
<dd><p>callback used when all interactions are completed.
Generates the next incremental query and then tries
the automatic interactions</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.interactive_automated_matcher.IncQueryHarness.request_nonblocking_inc_query">
<tt class="descname">request_nonblocking_inc_query</tt><big>(</big><em>ibs</em>, <em>qaid_list</em>, <em>daid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/interactive_automated_matcher.html#IncQueryHarness.request_nonblocking_inc_query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.interactive_automated_matcher.IncQueryHarness.request_nonblocking_inc_query" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.interactive_automated_matcher.iexec_incremental_queries">
<tt class="descclassname">ibeis.model.hots.interactive_automated_matcher.</tt><tt class="descname">iexec_incremental_queries</tt><big>(</big><em>ibs</em>, <em>qaid_list</em>, <em>daid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/interactive_automated_matcher.html#iexec_incremental_queries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.interactive_automated_matcher.iexec_incremental_queries" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.interactive_automated_matcher.incremental_test_qt">
<tt class="descclassname">ibeis.model.hots.interactive_automated_matcher.</tt><tt class="descname">incremental_test_qt</tt><big>(</big><em>ibs</em>, <em>num_initial=0</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/interactive_automated_matcher.html#incremental_test_qt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.interactive_automated_matcher.incremental_test_qt" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.interactive_automated_matcher &#8211;test-incremental_test_qt</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.all_imports</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.interactive_automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">main_locals</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">main_locals</span><span class="p">[</span><span class="s">&#39;ibs&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#num_initial = 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_initial</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">incremental_test_qt</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">num_initial</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">execstr</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">main_loop</span><span class="p">(</span><span class="n">main_locals</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">execstr</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.match_chips4">
<span id="ibeis-model-hots-match-chips4-module"></span><h2>ibeis.model.hots.match_chips4 module<a class="headerlink" href="#module-ibeis.model.hots.match_chips4" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>DoctestCMD:</dt>
<dd>python -c &#8220;import doctest, ibeis; print(doctest.testmod(ibeis.model.hots.match_chips4))&#8221;</dd>
</dl>
<dl class="function">
<dt id="ibeis.model.hots.match_chips4.execute_query_and_save_L1">
<tt class="descclassname">ibeis.model.hots.match_chips4.</tt><tt class="descname">execute_query_and_save_L1</tt><big>(</big><em>ibs</em>, <em>qreq_</em>, <em>use_cache=True</em>, <em>save_cache=True</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/match_chips4.html#execute_query_and_save_L1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.match_chips4.execute_query_and_save_L1" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">qaid2_qres</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.match_chips4 &#8211;test-execute_query_and_save_L1</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.match_chips4</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">,</span> <span class="n">sv_on</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict1</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_cache</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres_hit</span> <span class="o">=</span> <span class="n">execute_query_and_save_L1</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">,</span> <span class="n">save_cache</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qaid2_qres_hit</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.match_chips4</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">,</span> <span class="n">sv_on</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict1</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_cache</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres_hit</span> <span class="o">=</span> <span class="n">execute_query_and_save_L1</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">,</span> <span class="n">save_cache</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qaid2_qres_hit</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.match_chips4.submit_query_request">
<tt class="descclassname">ibeis.model.hots.match_chips4.</tt><tt class="descname">submit_query_request</tt><big>(</big><em>ibs</em>, <em>qaid_list</em>, <em>daid_list</em>, <em>use_cache=None</em>, <em>use_bigcache=None</em>, <em>return_request=False</em>, <em>cfgdict=None</em>, <em>qreq_=None</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/match_chips4.html#submit_query_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.match_chips4.submit_query_request" title="Permalink to this definition">¶</a></dt>
<dd><p>The standard query interface.</p>
<p>Checks a big cache for qaid2_qres.  If cache miss, tries to load each qres
individually.  On an individual cache miss, it preforms the query.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs</strong> (<em>IBEISController</em>) &#8211; ibeis control object</li>
<li><strong>qaid_list</strong> (<em>list</em>) &#8211; query annotation ids</li>
<li><strong>daid_list</strong> (<em>list</em>) &#8211; database annotation ids</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>qaid2_qres</strong> &#8211;
dict of QueryResult objects</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.match_chips4 &#8211;test-submit_query_request</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.match_chips4</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_bigcache</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span> <span class="o">=</span> <span class="n">submit_query_request</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">,</span> <span class="n">use_bigcache</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">submit_query_request</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.multi_index">
<span id="ibeis-model-hots-multi-index-module"></span><h2>ibeis.model.hots.multi_index module<a class="headerlink" href="#module-ibeis.model.hots.multi_index" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.multi_index.</tt><tt class="descname">MultiNeighborIndex</tt><big>(</big><em>mxer</em>, <em>nn_indexer_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Generalization of a NeighborIndex
More abstract wrapper around flann</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.add_points">
<tt class="descname">add_points</tt><big>(</big><em>mxer</em>, <em>new_aid_list</em>, <em>new_vecs_list</em>, <em>new_fgws_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.add_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.add_points" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.get_dtype">
<tt class="descname">get_dtype</tt><big>(</big><em>mxer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.get_dtype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.get_dtype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.get_nIndexed_list">
<tt class="descname">get_nIndexed_list</tt><big>(</big><em>mxer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.get_nIndexed_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.get_nIndexed_list" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a list of the number of indexed vectors in each subindexer</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">nIndexed_list</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.multi_index &#8211;test-get_nIndexed_list</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">get_nIndexed_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[21384, 15243, 12808, 4809, 3542, 2696]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.get_nn_aids">
<tt class="descname">get_nn_aids</tt><big>(</big><em>mxer</em>, <em>qfx2_imx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.get_nn_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.get_nn_aids" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">qfx2_aid</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.multi_index &#8211;test-get_nn_aids</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span><span class="p">,</span> <span class="n">checks</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_aid</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">get_nn_aids</span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">qfx2_aid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[ 8 16  8 55 53  3  3 28 38 34 48 38 34 25 21 21 33 34]</span>
<span class="go"> [34 45 30 27 18 35 28 52  8  4 60 25 14 25 21 26 15 15]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.get_nn_featxs">
<tt class="descname">get_nn_featxs</tt><big>(</big><em>mxer</em>, <em>qfx2_imx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.get_nn_featxs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.get_nn_featxs" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">qfx2_fx</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.multi_index &#8211;test-get_nn_featxs</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span><span class="p">,</span> <span class="n">checks</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_fgw</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">get_nn_featxs</span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">qfx2_fgw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.get_nn_fgws">
<tt class="descname">get_nn_fgws</tt><big>(</big><em>mxer</em>, <em>qfx2_imx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.get_nn_fgws"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.get_nn_fgws" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">qfx2_fgw</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.multi_index &#8211;test-get_nn_fgws</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span><span class="p">,</span> <span class="n">checks</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_fgw</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">get_nn_fgws</span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">qfx2_fgw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.get_offsets">
<tt class="descname">get_offsets</tt><big>(</big><em>mxer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.get_offsets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.get_offsets" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.multi_index &#8211;test-get_offsets</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">get_offsets</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[21384 36627 49435 54244 57786 60482]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.iter_subindexers">
<tt class="descname">iter_subindexers</tt><big>(</big><em>mxer</em>, <em>qfx2_imx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.iter_subindexers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.iter_subindexers" title="Permalink to this definition">¶</a></dt>
<dd><p>generates subindexers, indicies, and maskss within them
that partially correspond to indicies in qfx2_imx that belong
to that subindexer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.multi_index &#8211;test-iter_subindexers</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span><span class="p">,</span> <span class="n">checks</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genlist_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mxer</span><span class="o">.</span><span class="n">iter_subindexers</span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">qfx2_imx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">nnindexer</span><span class="p">,</span> <span class="n">idxs</span><span class="p">,</span> <span class="n">mask</span> <span class="ow">in</span> <span class="n">genlist_</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="n">covered</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">idxs</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">covered</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">... </span>    <span class="n">covered</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">covered</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">covered</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="n">covered</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.knn">
<tt class="descname">knn</tt><big>(</big><em>mxer</em>, <em>qfx2_vec</em>, <em>K</em>, <em>checks</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.knn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.knn" title="Permalink to this definition">¶</a></dt>
<dd><p>Polymorphic interface to knn, but uses the multindex backend</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.multi_index &#8211;test-knn:0</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span><span class="p">,</span> <span class="n">checks</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qfx2_imx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qfx2_imx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">qfx2_imx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1073</span><span class="p">,</span> <span class="mi">1079</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span><span class="p">,</span> <span class="n">checks</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">mxer</span><span class="o">.</span><span class="n">get_dtype</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(0, 18)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.knn2">
<tt class="descname">knn2</tt><big>(</big><em>mxer</em>, <em>qfx2_vec</em>, <em>K</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.knn2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.knn2" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_dist_</span><span class="p">,</span> <span class="n">qfx2_idx_</span><span class="p">,</span>  <span class="n">qfx2_fx_</span><span class="p">,</span> <span class="n">qfx2_ax_</span><span class="p">,</span> <span class="n">qfx2_rankx_</span><span class="p">,</span> <span class="n">qfx2_treex_</span><span class="p">,)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn2</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.multi_knn">
<tt class="descname">multi_knn</tt><big>(</big><em>mxer</em>, <em>qfx2_vec</em>, <em>K</em>, <em>checks</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.multi_knn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.multi_knn" title="Permalink to this definition">¶</a></dt>
<dd><p>Does a query on each of the subindexer kdtrees
returns list of the results</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span><span class="p">,</span> <span class="n">checks</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1024</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx_list</span><span class="p">,</span> <span class="n">qfx2_dist_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">multi_knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">qfx2_idx_list</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[(1074, 3), (1074, 3), (1074, 3), (1074, 3), (1074, 3), (1074, 3)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.num_indexed_annots">
<tt class="descname">num_indexed_annots</tt><big>(</big><em>mxer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.num_indexed_annots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.num_indexed_annots" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">num_indexed_annots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">59</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.num_indexed_vecs">
<tt class="descname">num_indexed_vecs</tt><big>(</big><em>mxer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.num_indexed_vecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.num_indexed_vecs" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">num_indexed_vecs</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">60482</span>
</pre></div>
</div>
<p>54244
54200 on win32</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.rrr">
<tt class="descname">rrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.multi_index.group_daids_by_cached_nnindexer">
<tt class="descclassname">ibeis.model.hots.multi_index.</tt><tt class="descname">group_daids_by_cached_nnindexer</tt><big>(</big><em>ibs</em>, <em>aid_list</em>, <em>min_reindex_thresh</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#group_daids_by_cached_nnindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.group_daids_by_cached_nnindexer" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.multi_index &#8211;test-group_daids_by_cached_nnindexer</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">group_daids_by_cached_nnindexer</span> <span class="o">=</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uncovered_aids</span><span class="p">,</span> <span class="n">covered_aids_list</span> <span class="o">=</span> <span class="n">group_daids_by_cached_nnindexer</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">uncovered_aids</span><span class="p">,</span> <span class="n">covered_aids_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.multi_index.group_daids_for_indexing_by_name">
<tt class="descclassname">ibeis.model.hots.multi_index.</tt><tt class="descname">group_daids_for_indexing_by_name</tt><big>(</big><em>ibs</em>, <em>daid_list</em>, <em>num_indexers=8</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#group_daids_for_indexing_by_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.group_daids_for_indexing_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>returns groups with only one annotation per name in each group</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.multi_index.request_ibeis_mindexer">
<tt class="descclassname">ibeis.model.hots.multi_index.</tt><tt class="descname">request_ibeis_mindexer</tt><big>(</big><em>qreq_</em>, <em>index_method='multi'</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#request_ibeis_mindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.request_ibeis_mindexer" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">valid_aids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">60</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_method</span> <span class="o">=</span> <span class="s">&#39;multi&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span> <span class="o">=</span> <span class="n">request_ibeis_mindexer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">index_method</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.multi_index.sort_along_rows">
<tt class="descclassname">ibeis.model.hots.multi_index.</tt><tt class="descname">sort_along_rows</tt><big>(</big><em>qfx2_xxx</em>, <em>qfx2_sortx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#sort_along_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.sort_along_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>sorts each row in qfx2_xxx with the corresponding row in qfx2_sortx</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.multi_index.test_mindexer">
<tt class="descclassname">ibeis.model.hots.multi_index.</tt><tt class="descname">test_mindexer</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#test_mindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.test_mindexer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.name_scoring">
<span id="ibeis-model-hots-name-scoring-module"></span><h2>ibeis.model.hots.name_scoring module<a class="headerlink" href="#module-ibeis.model.hots.name_scoring" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.model.hots.name_scoring.get_one_score_per_name">
<tt class="descclassname">ibeis.model.hots.name_scoring.</tt><tt class="descname">get_one_score_per_name</tt><big>(</big><em>ibs</em>, <em>aid_list</em>, <em>score_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/name_scoring.html#get_one_score_per_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.name_scoring.get_one_score_per_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts annotation scores to name scores</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.name_scoring &#8211;test-get_one_score_per_name</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.name_scoring</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.dev</span> <span class="kn">import</span> <span class="n">results_all</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_list</span> <span class="o">=</span> <span class="n">daid_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">results_all</span><span class="o">.</span><span class="n">get_qres_and_qreq_</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#qaid2_qres, qreq_ = ibs._query_chips4(qaid_list, daid_list, cfgdict=cfgdict, use_cache=False, return_request=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span> <span class="o">=</span> <span class="n">qaid2_qres</span><span class="p">[</span><span class="n">qaid_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid_list</span><span class="p">,</span> <span class="n">score_list</span> <span class="o">=</span> <span class="n">qres</span><span class="o">.</span><span class="n">get_aids_and_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nscoretup</span> <span class="o">=</span> <span class="n">get_one_score_per_name</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">score_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">sorted_nids</span><span class="p">,</span> <span class="n">sorted_nscore</span><span class="p">,</span> <span class="n">sorted_aids</span><span class="p">,</span> <span class="n">sorted_scores</span><span class="p">)</span> <span class="o">=</span> <span class="n">nscoretup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sorted_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1 5 4]</span>
</pre></div>
</div>
<p>[2 6 5]</p>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.neighbor_index">
<span id="ibeis-model-hots-neighbor-index-module"></span><h2>ibeis.model.hots.neighbor_index module<a class="headerlink" href="#module-ibeis.model.hots.neighbor_index" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">NeighborIndex</tt><big>(</big><em>nnindexer</em>, <em>ax2_aid</em>, <em>idx2_vec</em>, <em>idx2_fgw</em>, <em>idx2_ax</em>, <em>idx2_fx</em>, <em>flann</em>, <em>cores</em>, <em>cfgstr</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>wrapper class around flann
stores flann index and data it needs to index into</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.add_points">
<tt class="descname">add_points</tt><big>(</big><em>nnindexer</em>, <em>new_aid_list</em>, <em>new_vecs_list</em>, <em>new_fgws_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.add_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.add_points" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_aid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_vecs_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="n">new_aid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checks</span> <span class="o">=</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx1</span><span class="p">,</span> <span class="n">qfx2_dist1</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">new_aid_list</span><span class="p">,</span> <span class="n">new_vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx2</span><span class="p">,</span> <span class="n">qfx2_dist2</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qfx2_idx2</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">qfx2_idx1</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.empty_neighbors">
<tt class="descname">empty_neighbors</tt><big>(</big><em>nnindexer</em>, <em>K</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.empty_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.empty_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.get_dtype">
<tt class="descname">get_dtype</tt><big>(</big><em>nnindexer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.get_dtype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.get_dtype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_aids">
<tt class="descname">get_nn_aids</tt><big>(</big><em>nnindexer</em>, <em>qfx2_nnidx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.get_nn_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_aids" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_nnidx</strong> &#8211; (N x K) qfx2_idx[n][k] is the index of the kth
approximate nearest data vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(N x K) qfx2_fx[n][k] is the annotation id index of the
kth approximate nearest data vector</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">qfx2_aid</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;testdb1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">dbname</span><span class="o">=</span><span class="n">dbname</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">indexer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_neighbors</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checks</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_nnidx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">num_neighbors</span><span class="p">,</span> <span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_aid</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">get_nn_aids</span><span class="p">(</span><span class="n">qfx2_nnidx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">qfx2_aid</span><span class="o">.</span><span class="n">shape</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(1257, 4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_axs">
<tt class="descname">get_nn_axs</tt><big>(</big><em>nnindexer</em>, <em>qfx2_nnidx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.get_nn_axs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_axs" title="Permalink to this definition">¶</a></dt>
<dd><p>gets matching internal annotation indicies</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_featxs">
<tt class="descname">get_nn_featxs</tt><big>(</big><em>nnindexer</em>, <em>qfx2_nnidx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.get_nn_featxs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_featxs" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_nnidx</strong> &#8211; (N x K) qfx2_idx[n][k] is the index of the kth
approximate nearest data vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(N x K) qfx2_fx[n][k] is the feature index (w.r.t the
source annotation) of the kth approximate
nearest data vector</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">qfx2_fx</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_fgws">
<tt class="descname">get_nn_fgws</tt><big>(</big><em>nnindexer</em>, <em>qfx2_nnidx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.get_nn_fgws"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_fgws" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_nnidx</strong> &#8211; (N x K) qfx2_idx[n][k] is the index of the kth
approximate nearest data vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(N x K) qfx2_fgw[n][k] is the annotation id index of the
kth forground weight</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">qfx2_fgw</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">(</span><span class="n">dbname</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_nnidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_fgw</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">get_nn_fgws</span><span class="p">(</span><span class="n">qfx2_nnidx</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_vecs">
<tt class="descname">get_nn_vecs</tt><big>(</big><em>nnindexer</em>, <em>qfx2_nnidx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.get_nn_vecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_vecs" title="Permalink to this definition">¶</a></dt>
<dd><p>gets matching vectors</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.knn">
<tt class="descname">knn</tt><big>(</big><em>nnindexer</em>, <em>qfx2_vec</em>, <em>K</em>, <em>checks=1028</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.knn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.knn" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qfx2_vec</strong> &#8211; (N x D) an array of N, D-dimensional query vectors</li>
<li><strong>K</strong> &#8211; number of approximate nearest neighbors to find</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Returns: tuple of (qfx2_idx, qfx2_dist)</dt>
<dd><dl class="first last docutils">
<dt>qfx2_idx <span class="classifier-delimiter">:</span> <span class="classifier">(N x K) qfx2_idx[n][k] is the index of the kth</span></dt>
<dd>approximate nearest data vector w.r.t qfx2_vec[n]</dd>
<dt>qfx2_dist <span class="classifier-delimiter">:</span> <span class="classifier">(N x K) qfx2_dist[n][k] is the distance to the kth</span></dt>
<dd>approximate nearest data vector w.r.t. qfx2_vec[n]</dd>
</dl>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checks</span> <span class="o">=</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">qfx2_idx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">qfx2_dist</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(1257, 2) (1257, 2)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">nnindexer</span><span class="o">.</span><span class="n">get_dtype</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checks</span> <span class="o">=</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">qfx2_idx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">qfx2_dist</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(0, 2) (0, 2)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.num_indexed_annots">
<tt class="descname">num_indexed_annots</tt><big>(</big><em>nnindexer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.num_indexed_annots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.num_indexed_annots" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.num_indexed_vecs">
<tt class="descname">num_indexed_vecs</tt><big>(</big><em>nnindexer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.num_indexed_vecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.num_indexed_vecs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.rrr">
<tt class="descname">rrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.neighbor_index.clear_uuid_cache">
<tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">clear_uuid_cache</tt><big>(</big><em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#clear_uuid_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.clear_uuid_cache" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.neighbor_index &#8211;test-clear_uuid_cache</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">clear_uuid_cache</span><span class="p">(</span><span class="n">ibs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.neighbor_index.get_fgweights_hack">
<tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">get_fgweights_hack</tt><big>(</big><em>qreq_</em>, <em>daid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#get_fgweights_hack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.get_fgweights_hack" title="Permalink to this definition">¶</a></dt>
<dd><p>hack to get  feature weights. returns None if feature weights are turned off
in config settings</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.neighbor_index.get_nnindexer_uuid_map_fpath">
<tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">get_nnindexer_uuid_map_fpath</tt><big>(</big><em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#get_nnindexer_uuid_map_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.get_nnindexer_uuid_map_fpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.neighbor_index.internal_request_ibeis_nnindexer">
<tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">internal_request_ibeis_nnindexer</tt><big>(</big><em>qreq_</em>, <em>daid_list</em>, <em>verbose=True</em>, <em>use_cache=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#internal_request_ibeis_nnindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.internal_request_ibeis_nnindexer" title="Permalink to this definition">¶</a></dt>
<dd><p>FOR INTERNAL USE ONLY
takes custom daid list. might not be the same as what is in <a href="#id1"><span class="problematic" id="id2">qreq_</span></a></p>
<dl class="docutils">
<dt>_aids (list): for multiindexer use only</dt>
<dd>lets multindexer avoid shallow copies</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.neighbor_index.invert_index">
<tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">invert_index</tt><big>(</big><em>vecs_list</em>, <em>ax_list</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#invert_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.invert_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregates descriptors of input annotations and returns inverted information</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.neighbor_index.new_neighbor_index">
<tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">new_neighbor_index</tt><big>(</big><em>aid_list</em>, <em>vecs_list</em>, <em>fgws_list=None</em>, <em>flann_params={}</em>, <em>flann_cachedir=None</em>, <em>cfgstr=''</em>, <em>use_cache=True</em>, <em>use_params_hash=False</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#new_neighbor_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.new_neighbor_index" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">nnindexer</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.neighbor_index.prepare_index_data">
<tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">prepare_index_data</tt><big>(</big><em>aid_list</em>, <em>vecs_list</em>, <em>fgws_list</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#prepare_index_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.prepare_index_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.neighbor_index.request_ibeis_nnindexer">
<tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">request_ibeis_nnindexer</tt><big>(</big><em>qreq_</em>, <em>verbose=True</em>, <em>use_cache=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#request_ibeis_nnindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.request_ibeis_nnindexer" title="Permalink to this definition">¶</a></dt>
<dd><p>CALLED BY QUERYREQUST::LOAD_INDEXER</p>
<p>TODO: naming convetion of <a href="#id3"><span class="problematic" id="id4">new_</span></a> sucks. use <a href="#id5"><span class="problematic" id="id6">request_</span></a> or
anything else.</p>
<p>FIXME: and use params from qparams instead of ibs.cfg</p>
<p>IBEIS interface into neighbor_index</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">nnindexer</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span> <span class="o">=</span> <span class="n">request_ibeis_nnindexer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.neighbor_index.test_incremental_add">
<tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">test_incremental_add</tt><big>(</big><em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#test_incremental_add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.test_incremental_add" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.neighbor_index &#8211;test-test_incremental_add</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">test_incremental_add</span><span class="p">(</span><span class="n">ibs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.neighbor_index.test_nnindexer">
<tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">test_nnindexer</tt><big>(</big><em>dbname='testdb1'</em>, <em>with_indexer=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#test_nnindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.test_nnindexer" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.nn_weights">
<span id="ibeis-model-hots-nn-weights-module"></span><h2>ibeis.model.hots.nn_weights module<a class="headerlink" href="#module-ibeis.model.hots.nn_weights" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.model.hots.nn_weights.apply_normweight">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">apply_normweight</tt><big>(</big><em>normweight_fn</em>, <em>qaid</em>, <em>qfx2_idx</em>, <em>qfx2_dist</em>, <em>rule</em>, <em>K</em>, <em>Knorm</em>, <em>qreq_</em>, <em>with_metadata</em>, <em>metakey_metadata</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#apply_normweight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.apply_normweight" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>helper: applies the normalized weight function to one query annotation</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>normweight_fn (func): chosen weight function e.g. lnbnn
qaid (int): query annotation id
qfx2_idx (ndarray):
qfx2_dist (ndarray):
rule (str):
K (int):
Knorm (int):
<a href="#id7"><span class="problematic" id="id8">qreq_</span></a> (QueryRequest): hyper-parameters
with_metadata (bool):
metadata (dict):</dd>
<dt>Returns:</dt>
<dd>ndarray: qfx2_normweight</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;K&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s">&#39;Knorm&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;normalizer_rule&#39;</span><span class="p">:</span> <span class="s">&#39;name&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">testdata_nn_weights</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">K</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">Knorm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normweight_fn</span> <span class="o">=</span> <span class="n">lnbnn_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rule</span>  <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">normalizer_rule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">qaid2_nns</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">with_metadata</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metakey_metadata</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_normweight</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">apply_normweight</span><span class="p">(</span><span class="n">normweight_fn</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">qfx2_idx</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">qfx2_dist</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">Knorm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">with_metadata</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">metakey_metadata</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Timeits:</dt>
<dd>%timeit qfx2_dist.T[0:K].T
%timeit qfx2_dist[:, 0:K]</dd>
<dt>Ignore:</dt>
<dd>print(&#8216;</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt>&#8216;.join(((</dt>
<dd>&#8216;&gt;&gt;&gt; ndist = np.&#8217; + np.array_repr(ndist.T).replace(&#8216; ...,&#8217;, &#8216;&#8217;) + &#8216;.T&#8217;),
&#8216;&gt;&gt;&gt; vdist = np.&#8217; + np.array_repr(vdist.T).replace(&#8216; ...,&#8217;, &#8216;&#8217;) + &#8216;.T&#8217;)
))</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.componentwise_uint8_dot">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">componentwise_uint8_dot</tt><big>(</big><em>qfx2_qvec</em>, <em>qfx2_dvec</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#componentwise_uint8_dot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.componentwise_uint8_dot" title="Permalink to this definition">¶</a></dt>
<dd><p>a dot product is a componentwise multiplication of
two vector and then a sum. Do that for arbitary vectors.
Remember to cast uint8 to float32 and then divide by 255**2.
BUT THESE ARE SIFT DESCRIPTORS WHICH USE THE SMALL UINT8 TRICK
DIVIDE BY 512**2 instead</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.cos_match_weighter">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">cos_match_weighter</tt><big>(</big><em>qaid2_nns</em>, <em>qaid2_nnvalid0</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#cos_match_weighter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.cos_match_weighter" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">cos_weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">Knorm</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">testdata_nn_weights</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">cos_weight</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;bug setting custom params cos_weight&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_cos_weight</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">cos_match_weighter</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Dev::</dt>
<dd><p class="first">qnid = ibs.get_annot_name_rowids(qaid)
qfx2_nids = ibs.get_annot_name_rowids(<a href="#id9"><span class="problematic" id="id10">qreq_</span></a>.indexer.get_nn_aids(qfx2_idx.T[0:K].T))</p>
<p># remove first match
<a href="#id11"><span class="problematic" id="id12">qfx2_nids_</span></a> = qfx2_nids.T[1:].T
<a href="#id13"><span class="problematic" id="id14">qfx2_cos_</span></a>  = qfx2_cos.T[1:].T</p>
<p># flags of unverified &#8216;correct&#8217; matches
qfx2_samename = <a href="#id15"><span class="problematic" id="id16">qfx2_nids_</span></a> == qnid</p>
<dl class="last docutils">
<dt>for k in [1, None]:</dt>
<dd><dl class="first last docutils">
<dt>for alpha in [.01, .1, 1, 3, 10, 20, 50]:</dt>
<dd><p class="first">print(&#8216;&#8212;&#8212;-&#8216;)
print(&#8216;alpha = %r&#8217; % alpha)
print(&#8216;k = %r&#8217; % k)
qfx2_cosweight = np.multiply(np.sign(<a href="#id17"><span class="problematic" id="id18">qfx2_cos_</span></a>), np.power(<a href="#id19"><span class="problematic" id="id20">qfx2_cos_</span></a>, alpha))
if k is None:</p>
<blockquote>
<div>qfx2_weight = qfx2_cosweight
flag = qfx2_samename</div></blockquote>
<dl class="docutils">
<dt>else:</dt>
<dd>qfx2_weight = qfx2_cosweight.T[0:k].T
flag = qfx2_samename.T[0:k].T</dd>
</dl>
<p class="last">#print(qfx2_weight)
#print(flag)
<a href="#id21"><span class="problematic" id="id22">good_stats_</span></a> = ut.get_stats(qfx2_weight[flag])
<a href="#id23"><span class="problematic" id="id24">bad_stats_</span></a> = ut.get_stats(qfx2_weight[~flag])
print(&#8216;good_matches = &#8216; + ut.dict_str(<a href="#id25"><span class="problematic" id="id26">good_stats_</span></a>))
print(&#8216;bad_matchees = &#8216; + ut.dict_str(<a href="#id27"><span class="problematic" id="id28">bad_stats_</span></a>))
print(&#8216;diff_mean = &#8216; + str(good_stats_[&#8216;mean&#8217;] - bad_stats_[&#8216;mean&#8217;]))</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.dupvote_match_weighter">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">dupvote_match_weighter</tt><big>(</big><em>qaid2_nns</em>, <em>qaid2_nnvalid0</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#dupvote_match_weighter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.dupvote_match_weighter" title="Permalink to this definition">¶</a></dt>
<dd><p>dupvotes gives duplicate name votes a weight close to 0.</p>
<p>Each query feature is only allowed to vote for each name at most once.
IE: a query feature can vote for multiple names, but it cannot vote
for the same name twice.</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python dev.py &#8211;allgt -t best &#8211;db PZ_MTEST
python dev.py &#8211;allgt -t nsum &#8211;db PZ_MTEST
python dev.py &#8211;allgt -t dupvote &#8211;db PZ_MTEST</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#tup = nn_weights.testdata_nn_weights(&#39;testdb1&#39;, slice(0, 1), slice(0, 11))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;testdb1&#39;</span>  <span class="c"># &#39;GZ_ALL&#39;  # &#39;testdb1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">Knorm</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">codename</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">testdata_nn_weights</span><span class="p">(</span><span class="n">dbname</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Test Function Call</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_dupvote_weight</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">dupvote_match_weighter</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Check consistency</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_dupvote_weight</span> <span class="o">=</span> <span class="n">qaid2_dupvote_weight</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">qfx2_dupvote_weight</span>  <span class="o">&gt;</span> <span class="o">.</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_topnid</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_rowids</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">indexer</span><span class="o">.</span><span class="n">get_nn_aids</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">[</span><span class="n">qaid</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isunique_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">isunique</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">flag</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">flag</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">qfx2_topnid</span><span class="p">,</span> <span class="n">flags</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">isunique_list</span><span class="p">),</span> <span class="s">&#39;dupvote should only allow one vote per name&#39;</span>
</pre></div>
</div>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>./dev.py -t nsum &#8211;db GZ_ALL &#8211;show &#8211;va -w &#8211;qaid 1032
./dev.py -t nsum_nosv &#8211;db GZ_ALL &#8211;show &#8211;va -w &#8211;qaid 1032</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.fg_match_weighter">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">fg_match_weighter</tt><big>(</big><em>qaid2_nns</em>, <em>qaid2_nnvalid0</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#fg_match_weighter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.fg_match_weighter" title="Permalink to this definition">¶</a></dt>
<dd><p>foreground feature match weighting</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">featweight_on</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fg_weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">testdata_nn_weights</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="n">sorted_</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">featweight_on</span> <span class="o">==</span> <span class="bp">True</span><span class="p">,</span> <span class="s">&#39;bug setting custom params featweight_on&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">fg_weight</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;bug setting custom params fg_weight&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_fgvote_weight</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">fg_match_weighter</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.get_name_normalizers">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">get_name_normalizers</tt><big>(</big><em>qaid</em>, <em>qreq_</em>, <em>K</em>, <em>Knorm</em>, <em>qfx2_idx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#get_name_normalizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.get_name_normalizers" title="Permalink to this definition">¶</a></dt>
<dd><p>helper: normalizers for &#8216;name&#8217; rule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation id</li>
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">qfx2_normk</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">testdata_nn_weights</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_daids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">query_cfg</span><span class="o">.</span><span class="n">nn_cfg</span><span class="o">.</span><span class="n">K</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">query_cfg</span><span class="o">.</span><span class="n">nn_cfg</span><span class="o">.</span><span class="n">Knorm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normweight_fn</span> <span class="o">=</span> <span class="n">lnbnn_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">qaid2_nns</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_nndist</span> <span class="o">=</span> <span class="n">qfx2_dist</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">K</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.gravity_match_weighter">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">gravity_match_weighter</tt><big>(</big><em>qaid2_nns</em>, <em>qaid2_nnvalid0</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#gravity_match_weighter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.gravity_match_weighter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.lnbnn_fn">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">lnbnn_fn</tt><big>(</big><em>vdist</em>, <em>ndist</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#lnbnn_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.lnbnn_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Locale Naive Bayes Nearest Neighbor weighting</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>  <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndist</span> <span class="o">=</span> <span class="n">ndists</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>  <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist1</span> <span class="o">=</span> <span class="n">vdist</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist2</span> <span class="o">=</span> <span class="n">vdist</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist3</span> <span class="o">=</span> <span class="n">vdist</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist4</span> <span class="o">=</span> <span class="n">vdist</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">lnbnn_fn</span><span class="p">(</span><span class="n">vdist1</span><span class="p">,</span> <span class="n">ndist</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">lnbnn_fn</span><span class="p">(</span><span class="n">vdist2</span><span class="p">,</span> <span class="n">ndist</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">lnbnn_fn</span><span class="p">(</span><span class="n">vdist3</span><span class="p">,</span> <span class="n">ndist</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">lnbnn_fn</span><span class="p">(</span><span class="n">vdist4</span><span class="p">,</span> <span class="n">ndist</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.loglnbnn_fn">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">loglnbnn_fn</tt><big>(</big><em>vdist</em>, <em>ndist</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#loglnbnn_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.loglnbnn_fn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.logratio_fn">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">logratio_fn</tt><big>(</big><em>vdist</em>, <em>ndist</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#logratio_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.logratio_fn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.mark_name_valid_normalizers">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">mark_name_valid_normalizers</tt><big>(</big><em>qfx2_normnid</em>, <em>qfx2_topnid</em>, <em>qnid=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#mark_name_valid_normalizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.mark_name_valid_normalizers" title="Permalink to this definition">¶</a></dt>
<dd><p>helper: Allows matches only to the first result of a given name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qnid</strong> (<em>int</em>) &#8211; query name id</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qfx2_selnorm - index of the selected normalizer for each query feature</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.nn_normalized_weight">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">nn_normalized_weight</tt><big>(</big><em>normweight_fn</em>, <em>qaid2_nns</em>, <em>qaid2_nnvalid0</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#nn_normalized_weight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.nn_normalized_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Weights nearest neighbors using the chosen function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>normweight_fn</strong> (<em>func</em>) &#8211; chosen weight function e.g. lnbnn</li>
<li><strong>qaid2_nns</strong> (<em>dict</em>) &#8211; query descriptor nearest neighbors and distances. qaid -&gt; (qfx2_nnx, qfx2_dist)</li>
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">qaid2_weight</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;PZ_MTEST&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">testdata_nn_weights</span><span class="p">(</span><span class="n">dbname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_daids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normweight_fn</span> <span class="o">=</span> <span class="n">lnbnn_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_weight1</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">nn_normalized_weight</span><span class="p">(</span><span class="n">normweight_fn</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights1</span> <span class="o">=</span> <span class="n">qaid2_weight1</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn_normonly_weight</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">NN_WEIGHT_FUNC_DICT</span><span class="p">[</span><span class="s">&#39;lnbnn&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_weight2</span> <span class="o">=</span> <span class="n">nn_normonly_weight</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights2</span> <span class="o">=</span> <span class="n">qaid2_weight2</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">weights1</span> <span class="o">==</span> <span class="n">weights2</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;PZ_MTEST&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">testdata_nn_weights</span><span class="p">(</span><span class="n">dbname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_daids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normweight_fn</span> <span class="o">=</span> <span class="n">ratio_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_weight1</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">nn_normalized_weight</span><span class="p">(</span><span class="n">normweight_fn</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights1</span> <span class="o">=</span> <span class="n">qaid2_weight1</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn_normonly_weight</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">NN_WEIGHT_FUNC_DICT</span><span class="p">[</span><span class="s">&#39;ratio&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_weight2</span> <span class="o">=</span> <span class="n">nn_normonly_weight</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights2</span> <span class="o">=</span> <span class="n">qaid2_weight2</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">weights1</span> <span class="o">==</span> <span class="n">weights2</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>#from ibeis.model.hots import neighbor_index as hsnbrx
#nnindexer = hsnbrx.request_ibeis_nnindexer(<a href="#id29"><span class="problematic" id="id30">qreq_</span></a>)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.normonly_fn">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">normonly_fn</tt><big>(</big><em>vdist</em>, <em>ndist</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#normonly_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.normonly_fn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.ratio_fn">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">ratio_fn</tt><big>(</big><em>vdist</em>, <em>ndist</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#ratio_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.ratio_fn" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vdist</strong> (<em>ndarray</em>) &#8211; voting array</li>
<li><strong>ndist</strong> (<em>ndarray</em>) &#8211; normalizing array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">out</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mf">60408.</span><span class="p">,</span>   <span class="mf">61594.</span><span class="p">,</span>  <span class="mf">111387.</span><span class="p">,</span> <span class="mf">120138.</span><span class="p">,</span> <span class="mf">124307.</span><span class="p">,</span>  <span class="mf">125625.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">ratio_fn</span><span class="p">(</span><span class="n">vdist</span><span class="p">,</span> <span class="n">ndist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_repr</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[ 0.,  0.,  0.,  0.,  0.,  0.]], dtype=float32)</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mf">79260.</span><span class="p">,</span>  <span class="mf">138617.</span><span class="p">,</span>   <span class="mf">47964.</span><span class="p">,</span>  <span class="mf">127839.</span><span class="p">,</span>  <span class="mf">123543.</span><span class="p">,</span>  <span class="mf">112204.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span>  <span class="mf">83370.</span><span class="p">,</span>  <span class="mf">146245.</span><span class="p">,</span>  <span class="mf">128620.</span><span class="p">,</span>  <span class="mf">129598.</span><span class="p">,</span>  <span class="mf">126165.</span><span class="p">,</span>  <span class="mf">124761.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">ratio_fn</span><span class="p">(</span><span class="n">vdist</span><span class="p">,</span> <span class="n">ndist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_repr</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">array([[ 0.95,  0.95,  0.37,  0.99,  0.98,  0.9 ]], dtype=float32)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.test_all_normalized_weights">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">test_all_normalized_weights</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#test_all_normalized_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.test_all_normalized_weights" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_all_normalized_weights</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.testdata_nn_weights">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">testdata_nn_weights</tt><big>(</big><em>dbname='testdb1'</em>, <em>qaid_list=None</em>, <em>daid_list=None</em>, <em>cfgdict={}</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#testdata_nn_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.testdata_nn_weights" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;testdb1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;fg_weight&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.pipeline">
<span id="ibeis-model-hots-pipeline-module"></span><h2>ibeis.model.hots.pipeline module<a class="headerlink" href="#module-ibeis.model.hots.pipeline" title="Permalink to this headline">¶</a></h2>
<p>Hotspotter pipeline module</p>
<p>Module Concepts:</p>
<div class="highlight-python"><div class="highlight"><pre>PREFIXES:
qaid2_XXX - prefix mapping query chip index to
qfx2_XXX  - prefix mapping query chip feature index to

 * nns    - a (qfx2_idx, qfx2_dist) tuple
 * nnfilts - a (qfx2_score_list, qfx2_valid_list) tuple

 * idx    - the index into the nnindexers descriptors
 * qfx    - query feature index wrt the query chip
 * dfx    - query feature index wrt the database chip
 * dist   - the distance to a corresponding feature
 * fm     - a list of featur match pairs (qfx, dfx)
 * fsv    - a score vector of a corresponding feature
 * valid  - a valid bit for a corresponding feature

PIPELINE_VARS::
qaid2_nns - maping from query chip index to nns
{
 * qfx2_idx   - ranked list of query feature indexes to database feature indexes
 * qfx2_dist - ranked list of query feature indexes to database feature indexes
}

* qaid2_norm_weight - mapping from qaid to (qfx2_normweight, qfx2_selnorm)
         = qaid2_nnfiltagg[qaid]
</pre></div>
</div>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd><p class="first">To see the ouput of a complete pipeline run use</p>
<p># Set to whichever database you like
python main.py &#8211;db PZ_MTEST &#8211;setdb
python main.py &#8211;db NAUT_test &#8211;setdb
python main.py &#8211;db testdb1 &#8211;setdb</p>
<p class="last"># Then run whichever configuration you like
python main.py &#8211;verbose &#8211;noqcache &#8211;cfg codename:vsone  &#8211;query 1
python main.py &#8211;verbose &#8211;noqcache &#8211;cfg codename:vsone_norm  &#8211;query 1
python main.py &#8211;verbose &#8211;noqcache &#8211;cfg codename:vsmany &#8211;query 1
python main.py &#8211;verbose &#8211;noqcache &#8211;cfg codename:vsmany_nsum  &#8211;query 1</p>
</dd>
</dl>
<dl class="function">
<dt id="ibeis.model.hots.pipeline.append_chipmatch_vsmany_nonagg">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">append_chipmatch_vsmany_nonagg</tt><big>(</big><em>valid_match_tup</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#append_chipmatch_vsmany_nonagg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.append_chipmatch_vsmany_nonagg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.append_chipmatch_vsone_nonagg">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">append_chipmatch_vsone_nonagg</tt><big>(</big><em>valid_match_tup</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#append_chipmatch_vsone_nonagg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.append_chipmatch_vsone_nonagg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.assert_qaid2_chipmatch">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">assert_qaid2_chipmatch</tt><big>(</big><em>ibs</em>, <em>qreq_</em>, <em>qaid2_chipmatch</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#assert_qaid2_chipmatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.assert_qaid2_chipmatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs consistency check</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.baseline_neighbor_filter">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">baseline_neighbor_filter</tt><big>(</big><em>qreq_</em>, <em>qaid2_nns</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#baseline_neighbor_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.baseline_neighbor_filter" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; query request object with hyper-parameters</li>
<li><strong>qaid2_nns</strong> (<em>dict</em>) &#8211; maps query annotid to (qfx2_idx, qfx2_dist)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">mapping from qaid to qfx2_valid0</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">qaid2_nnvalid0</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.pipeline &#8211;test-baseline_neighbor_filter</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;testdb1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">dbname</span><span class="o">=</span><span class="n">dbname</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;baseline_neighbor_filter&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">locals_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;qaid2_nns&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nnvalid0</span> <span class="o">=</span> <span class="n">baseline_neighbor_filter</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnvalid0</span> <span class="o">=</span> <span class="n">qaid2_nnvalid0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">nnvalid0</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="p">(</span>
<span class="gp">... </span>   <span class="s">&#39;first col should be all invalid because of self match&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">nnvalid0</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span>
<span class="gp">... </span>   <span class="s">&#39;second col should have some good matches&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">nnvalid0</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="mi">1900</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
</pre></div>
</div>
<p>Removes matches to self, the same image, or the same name.</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.build_chipmatches">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">build_chipmatches</tt><big>(</big><em>qreq_</em>, <em>qaid2_nns</em>, <em>qaid2_nnvalid0</em>, <em>qaid2_nnfilts</em>, <em>qaid2_nnfiltagg</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#build_chipmatches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.build_chipmatches" title="Permalink to this definition">¶</a></dt>
<dd><p>pipeline step 4 - builds sparse chipmatches</p>
<p>Takes the dense feature matches from query feature to (what could be any)
database features and builds sparse matching pairs for each annotation to
annotation match.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</li>
<li><strong>qaid2_nns</strong> (<em>dict</em>) &#8211; dict of assigned nearest features (only indexes are
used here)</li>
<li><strong>qaid2_nnfilts</strong> (<em>dict</em>) &#8211; nonaggregate feature scores and validities for
each feature NEW</li>
<li><strong>qaid2_nnfiltagg</strong> (<em>dict</em>) &#8211; dict of (qfx2_score, qfx2_valid) where the
scores and matches correspond to the assigned nearest features
CURRENTLY UNUSED</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>qaid2_chipmatch - mapping from qaid to chipmatch
a chipmatch is a tuple (fm, fsv, fk)</p>
<blockquote>
<div><p>fm := list of feature matchs
fsv := list of feature scores vectors
fk := list of feature ranks</p>
</div></blockquote>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The prefix <tt class="docutils literal"><span class="pre">qaid2_</span></tt> denotes a mapping where keys are query-annotation-id</p>
<p>vsmany/vsone counts here. also this is where the filter
weights and thershold are applied to the matches. Essientally
nearest neighbors are converted into weighted assignments</p>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>python -c &#8220;import utool; print(utool.auto_docstr(&#8216;ibeis.model.hots.pipeline&#8217;, &#8216;build_chipmatches&#8217;))&#8221;</dd>
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.pipeline &#8211;test-build_chipmatches:0
python -m ibeis.model.hots.pipeline &#8211;test-build_chipmatches</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get testdata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testdata_build_chipmatch</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span><span class="p">,</span> <span class="n">qaid2_nnfilts</span><span class="p">,</span> <span class="n">qaid2_nnfiltagg</span><span class="p">)</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">build_chipmatches</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_daids</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qaid2_chipmatch</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qaid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">qaid2_chipmatch</span><span class="p">[</span><span class="n">qaid</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">daid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsv</span> <span class="o">=</span> <span class="n">qaid2_chipmatch</span><span class="p">[</span><span class="n">qaid</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">daid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_matches</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;vsone num_matches = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">num_matches</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">fsv</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">fm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;vsone fm bad shape&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">num_matches</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="s">&#39;vsone nmatches out of bounds&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsmany&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#cfgdict = dict(codename=&#39;vsmany_csum&#39;, dupvote_weight=&#39;0.0&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get testdata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;build_chipmatches&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">locals_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s">&#39;qaid2_nns&#39;</span><span class="p">,</span> <span class="s">&#39;qaid2_nnvalid0&#39;</span><span class="p">,</span> <span class="s">&#39;qaid2_nnfilts&#39;</span><span class="p">,</span> <span class="s">&#39;qaid2_nnfiltagg&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span><span class="p">,</span> <span class="n">qaid2_nnfilts</span><span class="p">,</span> <span class="n">qaid2_nnfiltagg</span><span class="p">)</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">build_chipmatches</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_daids</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipmatch</span> <span class="o">=</span> <span class="n">qaid2_chipmatch</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid2_fm</span><span class="p">,</span> <span class="n">daid2_fsv</span><span class="p">,</span> <span class="n">daid_fk</span> <span class="o">=</span> <span class="n">chipmatch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">daid2_fm</span><span class="p">[</span><span class="n">daid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsv</span> <span class="o">=</span> <span class="n">daid2_fsv</span><span class="p">[</span><span class="n">daid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_matches</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;vsmany num_matches = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">num_matches</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">fm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;vsmany fm bad shape&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">num_matches</span><span class="p">,</span> <span class="mi">550</span><span class="p">,</span> <span class="mi">572</span><span class="p">,</span> <span class="s">&#39;vsmany nmatches out of bounds&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Ignore:</dt>
<dd>pass</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.chipmatch_to_resdict">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">chipmatch_to_resdict</tt><big>(</big><em>qreq_</em>, <em>qaid2_chipmatch</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#chipmatch_to_resdict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.chipmatch_to_resdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a dictionary of chipmatch tuples into a dictionary of query results</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qaid2_qres</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.pipeline &#8211;test-chipmatch_to_resdict</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dupvote_weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">prescore_method</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">,</span> <span class="n">score_method</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;chipmatch_to_resdict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;qaid2_chipmatch_SVER&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">chipmatch_to_resdict</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_chipmatch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span> <span class="o">=</span> <span class="n">qaid2_qres</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dupvote_weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">prescore_method</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">,</span> <span class="n">score_method</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">,</span> <span class="n">sver_weighting</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;chipmatch_to_resdict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;qaid2_chipmatch_SVER&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">chipmatch_to_resdict</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_chipmatch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span> <span class="o">=</span> <span class="n">qaid2_qres</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">qres</span><span class="o">.</span><span class="n">filtkey_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">qres</span><span class="o">.</span><span class="n">filtkey_list</span><span class="p">)</span> <span class="o">==</span> <span class="n">qres</span><span class="o">.</span><span class="n">aid2_fsv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">qres</span><span class="o">.</span><span class="n">aid2_fsv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">115</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">qres</span><span class="o">.</span><span class="n">aid2_fs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">qres</span><span class="o">.</span><span class="n">aid2_fsv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#assert qres.aid2_fs[2].sum() == qres.aid2_score[2]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.execute_vsone_query">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">execute_vsone_query</tt><big>(</big><em>ibs</em>, <em>qreq_</em>, <em>verbose=True</em>, <em>save_cache=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#execute_vsone_query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.execute_vsone_query" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.filter_neighbors">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">filter_neighbors</tt><big>(</big><em>qreq_</em>, <em>qaid2_nns</em>, <em>qaid2_nnvalid0</em>, <em>qaid2_filtweights</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#filter_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.filter_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>converts feature weights to feature scores and validity masks</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; query request object with hyper-parameters</li>
<li><strong>qaid2_nns</strong> (<em>dict</em>) &#8211; maps query annotid to (qfx2_idx, qfx2_dist)</li>
<li><strong>qaid2_nnvalid0</strong> (<em>dict</em>) &#8211; maps query annotid to qfx2_valid0</li>
<li><strong>qaid2_filtweights</strong> (<em>dict</em>) &#8211; mapping to weights computed by filters like
lnnbnn and ratio</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(qaid2_nnfilts, qaid2_nnfiltagg) - mappings from qaid
nnfilts is a tuple (filtkey_list, qfx2_score_list, qfx2_valid_list)
nnfiltsagg is a tuple (qfx2_score_agg, qfx2_valid_agg)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.pipeline &#8211;test-filter_neighbors</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dupvote_weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;filter_neighbors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">locals_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;qaid2_nns&#39;</span><span class="p">,</span> <span class="s">&#39;qaid2_nnvalid0&#39;</span><span class="p">,</span> <span class="s">&#39;qaid2_filtweights&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span><span class="p">,</span> <span class="n">qaid2_filtweights</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Make sure internal qaids are behaving well</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_lists_eq</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">(</span><span class="n">qaid2_nnvalid0</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_lists_eq</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">)),</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nnfilts</span><span class="p">,</span> <span class="n">qaid2_nnfiltagg</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">filter_neighbors</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span><span class="p">,</span> <span class="n">qaid2_filtweights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Make sure we are getting expected filter scores back.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnfilts</span> <span class="o">=</span> <span class="n">six</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">itervalues</span><span class="p">(</span><span class="n">qaid2_nnfilts</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">filtkey_list</span><span class="p">,</span> <span class="n">qfx2_score_list</span><span class="p">,</span> <span class="n">qfx2_valid_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnfilts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_lists_eq</span><span class="p">(</span><span class="n">filtkey_list</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;lnbnn&#39;</span><span class="p">,</span> <span class="s">&#39;dupvote&#39;</span><span class="p">],</span> <span class="s">&#39;bad filters&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qfx2_score_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">qfx2_score_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s">&#39;inconsistent shape&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">qfx2_score_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">1300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_lists_eq</span><span class="p">(</span><span class="n">qfx2_valid_list</span><span class="p">,</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span> <span class="s">&#39;all should be valid&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.flag_impossible_votes">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">flag_impossible_votes</tt><big>(</big><em>qreq_</em>, <em>qaid</em>, <em>qfx2_nnidx</em>, <em>cant_match_self</em>, <em>cant_match_sameimg</em>, <em>cant_match_samename</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#flag_impossible_votes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.flag_impossible_votes" title="Permalink to this definition">¶</a></dt>
<dd><p>Flags matches to self or same image</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.generate_vsone_qreqs">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">generate_vsone_qreqs</tt><big>(</big><em>ibs</em>, <em>qreq_</em>, <em>qaid_list</em>, <em>chunksize</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#generate_vsone_qreqs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.generate_vsone_qreqs" title="Permalink to this definition">¶</a></dt>
<dd><p>helper</p>
<p>Generate vsone quries one at a time, but create shallow qreqs in chunks.</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.get_pipeline_testdata">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">get_pipeline_testdata</tt><big>(</big><em>dbname=None</em>, <em>cfgdict={}</em>, <em>qaid_list=None</em>, <em>daid_list=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#get_pipeline_testdata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.get_pipeline_testdata" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">pipeline_root</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">,</span> <span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.get_prescore_shortlist">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">get_prescore_shortlist</tt><big>(</big><em>qreq_</em>, <em>qaid</em>, <em>chipmatch</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#get_prescore_shortlist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.get_prescore_shortlist" title="Permalink to this definition">¶</a></dt>
<dd><p>computes which of the annotations should continue in the next pipeline step</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;spatial_verification&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;qaid2_chipmatch_FILT&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipmatch</span> <span class="o">=</span> <span class="n">qaid2_chipmatch</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">topx2_aid</span><span class="p">,</span> <span class="n">nRerank</span><span class="p">)</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_prescore_shortlist</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">chipmatch</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.get_sparse_matchinfo_nonagg">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">get_sparse_matchinfo_nonagg</tt><big>(</big><em>qreq_</em>, <em>qfx2_idx</em>, <em>qfx2_valid0</em>, <em>nnfilts</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#get_sparse_matchinfo_nonagg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.get_sparse_matchinfo_nonagg" title="Permalink to this definition">¶</a></dt>
<dd><p>builds sparse iterator that generates feature match pairs, scores, and ranks</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qfx2_idx</strong> (<em>ndarray[int32_t, ndims=2]</em>) &#8211; mapping from query feature index
to db neighbor index</li>
<li><strong>nnfilts</strong> (<em>tuple</em>) &#8211; (filt_list, qfx2_score_list, qfx2_valid_list)</li>
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; query request object with hyper-parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">valid_match_tup</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.pipeline &#8211;test-get_sparse_matchinfo_nonagg</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsmany&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get testdata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testdata_build_chipmatch</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span><span class="p">,</span> <span class="n">qaid2_nnfilts</span><span class="p">,</span> <span class="n">qaid2_nnfiltagg</span><span class="p">)</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_daids</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_idx</span> <span class="o">=</span> <span class="n">qaid2_nns</span><span class="p">[</span><span class="n">qaid</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_valid0</span> <span class="o">=</span> <span class="n">qaid2_nnvalid0</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnfilts</span> <span class="o">=</span> <span class="n">qaid2_nnfilts</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnfiltagg</span> <span class="o">=</span> <span class="n">qaid2_nnfiltagg</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">filt_list</span><span class="p">,</span> <span class="n">qfx2_score_list</span><span class="p">,</span> <span class="n">qfx2_valid_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnfilts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_score_agg</span><span class="p">,</span> <span class="n">qfx2_valid_agg</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnfiltagg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">valid_match_tup</span> <span class="o">=</span> <span class="n">get_sparse_matchinfo_nonagg</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_valid0</span><span class="p">,</span> <span class="n">nnfilts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipmatch</span> <span class="o">=</span> <span class="n">append_chipmatch_vsmany_nonagg</span><span class="p">(</span><span class="n">valid_match_tup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">daid2_fm</span><span class="p">,</span> <span class="n">daid2_fsv</span><span class="p">,</span> <span class="n">daid2_fk</span><span class="p">)</span> <span class="o">=</span> <span class="n">chipmatch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">daid2_fm</span><span class="p">[</span><span class="n">daid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsv</span> <span class="o">=</span> <span class="n">daid2_fsv</span><span class="p">[</span><span class="n">daid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fk</span> <span class="o">=</span> <span class="n">daid2_fk</span><span class="p">[</span><span class="n">daid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">fm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">fm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">fk</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">fk</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">fsv</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">fm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">fsv</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">active_filter_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.hack_fix_dupvote_weights">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">hack_fix_dupvote_weights</tt><big>(</big><em>qreq_</em>, <em>qaid2_chipmatchSV</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#hack_fix_dupvote_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.hack_fix_dupvote_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>If the one feature allowed to match to a name was removed by spatial
verification then that feature never gets to vote.</p>
<p>Maybe that is a good thing, but maybe we should try and reclaim it.</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python main.py &#8211;verbose &#8211;noqcache &#8211;cfg codename:vsmany_nsum  &#8211;query 1 &#8211;db PZ_MTEST</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dupvote_weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">prescore_method</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">,</span> <span class="n">score_method</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;spatial_verification&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;qaid2_chipmatch_FILT&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nnfilts</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;qaid2_nnfilts&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dupvotex</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">listfind</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">active_filter_list</span><span class="p">,</span> <span class="s">&#39;dupvote&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">dupvotex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;dupvotex=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">dupvotex</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatchSV</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">_spatial_verification</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_chipmatch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">before</span> <span class="o">=</span> <span class="p">[[</span><span class="n">fsv</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">dupvotex</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">... </span>             <span class="k">for</span> <span class="n">fsv</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">itervalues</span><span class="p">(</span><span class="n">chipmatch</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="gp">... </span>                 <span class="k">for</span> <span class="n">chipmatch</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">itervalues</span><span class="p">(</span><span class="n">qaid2_chipmatchSV</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">before_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">before</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;before_sum=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">before_sum</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">before_sum</span><span class="p">,</span> <span class="mi">1940</span><span class="p">,</span> <span class="mi">2010</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total_reweighted</span> <span class="o">=</span> <span class="n">hack_fix_dupvote_weights</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_chipmatchSV</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;total_reweighted=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">total_reweighted</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">after</span> <span class="o">=</span> <span class="p">[[</span><span class="n">fsv</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">dupvotex</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">... </span>             <span class="k">for</span> <span class="n">fsv</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">itervalues</span><span class="p">(</span><span class="n">chipmatch</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="gp">... </span>                 <span class="k">for</span> <span class="n">chipmatch</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">itervalues</span><span class="p">(</span><span class="n">qaid2_chipmatchSV</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">after_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">after</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;after_sum=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">after_sum</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff</span> <span class="o">=</span> <span class="n">after_sum</span> <span class="o">-</span> <span class="n">before_sum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">after_sum</span><span class="p">,</span> <span class="mi">1950</span><span class="p">,</span> <span class="mi">2015</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">total_reweighted</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">diff</span> <span class="o">-</span> <span class="n">total_reweighted</span><span class="p">,</span> <span class="o">-</span><span class="mf">1E-5</span><span class="p">,</span> <span class="mf">1E-5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total_reweighted2</span> <span class="o">=</span> <span class="n">hack_fix_dupvote_weights</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_chipmatchSV</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;total_reweighted2=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">total_reweighted</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">total_reweighted2</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.identity_filter">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">identity_filter</tt><big>(</big><em>qreq_</em>, <em>qaid2_nns</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#identity_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.identity_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>testing function returns unfiltered nearest neighbors
this does check that you are not matching yourself</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.nearest_neighbors">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">nearest_neighbors</tt><big>(</big><em>qreq_</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#nearest_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.nearest_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Plain Nearest Neighbors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; query request object with hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qaid2_nns - a dict mapping query annnotation-ids to a nearest
neighbor tuple (qfx2_idx, qfx2_dist). indexes and dist have the
shape (nDesc x K) where nDesc is the number of descriptors in the
annotation, and K is the number of approximate nearest neighbors.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.pipeline &#8211;test-nearest_neighbors</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">dbname</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                            <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nns</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">nearest_neighbors</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nns</span> <span class="o">=</span> <span class="n">qaid2_nns</span><span class="p">[</span><span class="n">qaids</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">nns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Assert dictionary corresponds to internal qaids</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="n">qaids</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Assert nns tuple is valid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qfx2_idx</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">qfx2_dist</span><span class="o">.</span><span class="n">shape</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qfx2_idx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">qfx2_idx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.new_fmfsvfk">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">new_fmfsvfk</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#new_fmfsvfk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.new_fmfsvfk" title="Permalink to this definition">¶</a></dt>
<dd><p>returns new chipmatch</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.pipeline_dense_step">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">pipeline_dense_step</tt><big>(</big><em>qreq_</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#pipeline_dense_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.pipeline_dense_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.pipeline_dense_step_chunks">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">pipeline_dense_step_chunks</tt><big>(</big><em>qreq_</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#pipeline_dense_step_chunks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.pipeline_dense_step_chunks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.precompute_topx2_dlen_sqrd">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">precompute_topx2_dlen_sqrd</tt><big>(</big><em>qreq_</em>, <em>aid2_fm</em>, <em>topx2_aid</em>, <em>topx2_kpts</em>, <em>nRerank</em>, <em>use_chip_extent</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#precompute_topx2_dlen_sqrd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.precompute_topx2_dlen_sqrd" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for spatial verification, computes the squared diagonal length of
matching chips</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">topx2_dlen_sqrd</td>
</tr>
</tbody>
</table>
<p># TODO: decouple example</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;spatial_verification&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;qaid2_chipmatch_FILT&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipmatch</span> <span class="o">=</span> <span class="n">qaid2_chipmatch</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topx2_aid</span><span class="p">,</span> <span class="n">nRerank</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_prescore_shortlist</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">chipmatch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">daid2_fm</span><span class="p">,</span> <span class="n">daid2_fsv</span><span class="p">,</span> <span class="n">daid2_fk</span><span class="p">)</span> <span class="o">=</span> <span class="n">chipmatch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_kpts</span><span class="p">(</span><span class="n">qaid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topx2_kpts</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_kpts</span><span class="p">(</span><span class="n">topx2_aid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_chip_extent</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topx2_dlen_sqrd</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">precompute_topx2_dlen_sqrd</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">daid2_fm</span><span class="p">,</span> <span class="n">topx2_aid</span><span class="p">,</span> <span class="n">topx2_kpts</span><span class="p">,</span> <span class="n">nRerank</span><span class="p">,</span> <span class="n">use_chip_extent</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.prescore_nsum">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">prescore_nsum</tt><big>(</big><em>qreq_</em>, <em>daid2_prescore</em>, <em>nShortlist</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#prescore_nsum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.prescore_nsum" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.pipeline &#8211;test-prescore_nsum</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;nsum_unnorm&#39;</span><span class="p">,</span> <span class="n">index_method</span><span class="o">=</span><span class="s">&#39;single&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;spatial_verification&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;qaid2_chipmatch_FILT&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipmatch</span> <span class="o">=</span> <span class="n">qaid2_chipmatch</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nShortlist</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">nShortlist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prescore_method</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">prescore_method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">prescore_method</span> <span class="o">==</span> <span class="s">&#39;nsum&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid2_prescore</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">score_chipmatch</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">chipmatch</span><span class="p">,</span> <span class="n">prescore_method</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.print_nearest_neighbor_assignments">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">print_nearest_neighbor_assignments</tt><big>(</big><em>qvecs_list</em>, <em>nns_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#print_nearest_neighbor_assignments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.print_nearest_neighbor_assignments" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.request_ibeis_query_L0">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">request_ibeis_query_L0</tt><big>(</big><em>ibs</em>, <em>qreq_</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#request_ibeis_query_L0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.request_ibeis_query_L0" title="Permalink to this definition">¶</a></dt>
<dd><p>Driver logic of query pipeline</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs</strong> (<em>IBEISController</em>) &#8211; IBEIS database object to be queried.
technically this object already lives inside of <a href="#id31"><span class="problematic" id="id32">qreq_</span></a>.</li>
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters. use <tt class="docutils literal"><span class="pre">ibs.new_query_request</span></tt> to create one</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(dict[int, QueryResult]): qaid2_qres maps query annotid to QueryResult</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.pipeline &#8211;test-request_ibeis_query_L0</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># one-vs-many:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsmany&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">request_ibeis_query_L0</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span>
<span class="gp">... </span>                                             <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span> <span class="o">=</span> <span class="n">qaid2_qres</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">qaid2_qres</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--show&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">qres</span><span class="o">.</span><span class="n">show_analysis</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">make_figtitle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qres</span><span class="o">.</span><span class="n">get_inspect_str</span><span class="p">())</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># one-vs-one:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># pipeline.rrr()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">,</span> <span class="n">sv_on</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs1</span><span class="p">,</span> <span class="n">qreq_1</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qreq_1</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres1</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">request_ibeis_query_L0</span><span class="p">(</span><span class="n">ibs1</span><span class="p">,</span> <span class="n">qreq_1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres1</span> <span class="o">=</span> <span class="n">qaid2_qres1</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">qaid2_qres1</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--show&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">qres1</span><span class="o">.</span><span class="n">show_analysis</span><span class="p">(</span><span class="n">ibs1</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">make_figtitle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qres1</span><span class="o">.</span><span class="n">get_inspect_str</span><span class="p">())</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.save_resdict">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">save_resdict</tt><big>(</big><em>qreq_</em>, <em>qaid2_qres</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#save_resdict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.save_resdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a dictionary of query results to disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.score_chipmatch">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">score_chipmatch</tt><big>(</big><em>qreq_</em>, <em>qaid</em>, <em>chipmatch</em>, <em>score_method</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#score_chipmatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.score_chipmatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns scores to database annotation ids for a particualry query&#8217;s
chipmatch</p>
<p>DOES NOT APPLY SCORE NORMALIZATION</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</li>
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation id</li>
<li><strong>isprescore</strong> (<em>bool</em>) &#8211; flag</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">scores for each database id w.r.t. a single query</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">daid2_score</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.pipeline &#8211;test-score_chipmatch</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_ENABLE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># PRESCORE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;spatial_verification&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;qaid2_chipmatch_FILT&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipmatch</span> <span class="o">=</span> <span class="n">qaid2_chipmatch</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_method</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">prescore_method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid2_score_pre</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">score_chipmatch</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">chipmatch</span><span class="p">,</span> <span class="n">score_method</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># POSTSCORE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;chipmatch_to_resdict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;qaid2_chipmatch_SVER&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipmatch</span> <span class="o">=</span> <span class="n">qaid2_chipmatch</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_method</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">score_method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid2_score_post</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">score_chipmatch</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">chipmatch</span><span class="p">,</span> <span class="n">score_method</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.spatial_verification">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">spatial_verification</tt><big>(</big><em>qreq_</em>, <em>qaid2_chipmatch</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#spatial_verification"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.spatial_verification" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dict or tuple(dict, dict)</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.pipeline &#8211;test-spatial_verification</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dupvote_weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">prescore_method</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">,</span> <span class="n">score_method</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;spatial_verification&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;qaid2_chipmatch_FILT&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nnfilts</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;qaid2_nnfilts&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatchSV</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">spatial_verification</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_chipmatch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt_daids</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_query_groundtruth</span><span class="p">(</span><span class="n">qaid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid</span> <span class="o">=</span> <span class="n">gt_daids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">qaid2_chipmatch</span><span class="p">[</span><span class="n">qaid</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">daid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fmSV</span> <span class="o">=</span> <span class="n">qaid2_chipmatchSV</span><span class="p">[</span><span class="n">qaid</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">daid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsv</span> <span class="o">=</span> <span class="n">qaid2_chipmatch</span><span class="p">[</span><span class="n">qaid</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">daid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsvSV</span> <span class="o">=</span> <span class="n">qaid2_chipmatchSV</span><span class="p">[</span><span class="n">qaid</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">daid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">fmSV</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">),</span> <span class="s">&#39;feature matches were not filtered&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.testdata_build_chipmatch">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">testdata_build_chipmatch</tt><big>(</big><em>dbname</em>, <em>cfgdict</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#testdata_build_chipmatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.testdata_build_chipmatch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.testrun_pipeline_upto">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">testrun_pipeline_upto</tt><big>(</big><em>qreq_</em>, <em>stop_node=None</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#testrun_pipeline_upto"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.testrun_pipeline_upto" title="Permalink to this definition">¶</a></dt>
<dd><p>convinience: runs pipeline for tests
this should mirror request_ibeis_query_L0</p>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_func_sourcecode</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">request_ibeis_query_L0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stripsource</span> <span class="o">=</span> <span class="n">source</span><span class="p">[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stripsource</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">strip_line_comments</span><span class="p">(</span><span class="n">stripsource</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">triplequote1</span> <span class="o">=</span> <span class="s">&#39;&quot;&#39;</span> <span class="o">*</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">triplequote2</span> <span class="o">=</span> <span class="s">&quot;&#39;&quot;</span> <span class="o">*</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">docstr_regex1</span> <span class="o">=</span> <span class="s">&#39;r?&#39;</span> <span class="o">+</span> <span class="n">triplequote1</span> <span class="o">+</span> <span class="s">&#39;.* + &#39;</span> <span class="o">+</span> <span class="n">triplequote1</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">    &#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">docstr_regex2</span> <span class="o">=</span> <span class="s">&#39;r?&#39;</span> <span class="o">+</span> <span class="n">triplequote2</span> <span class="o">+</span> <span class="s">&#39;.* + &#39;</span> <span class="o">+</span> <span class="n">triplequote2</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">    &#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stripsource</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">regex_replace</span><span class="p">(</span><span class="n">docstr_regex1</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">stripsource</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stripsource</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">regex_replace</span><span class="p">(</span><span class="n">docstr_regex2</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">stripsource</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stripsource</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">strip_line_comments</span><span class="p">(</span><span class="n">stripsource</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">stripsource</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.threshold_and_scale_weights">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">threshold_and_scale_weights</tt><big>(</big><em>qreq_</em>, <em>qaid</em>, <em>qfx2_valid0</em>, <em>filt2_weights</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#threshold_and_scale_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.threshold_and_scale_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function</p>
<p>converts weights into per keypoint scores for a given filter / weight function
qfx2_score is an ndarray containing the score of individual feature matches.
qfx2_valid marks if that score will be thresholded.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; query request object with hyper-parameters</li>
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation id</li>
<li><strong>qfx2_valid0</strong> (<em>ndarray</em>) &#8211; maps query feature index to K matches non-impossibility flags</li>
<li><strong>filt2_weights</strong> (<em>dict</em>) &#8211; maps filter names to qfx2_weight ndarray</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(nnfilts, nnfiltagg)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">soon nnfiltagg will not be returned</p>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dupvote_weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;filter_neighbors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">locals_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;qaid2_nns&#39;</span><span class="p">,</span> <span class="s">&#39;qaid2_nnvalid0&#39;</span><span class="p">,</span> <span class="s">&#39;qaid2_filtweights&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span><span class="p">,</span> <span class="n">qaid2_filtweights</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Continue with function logic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filt2_weights</span> <span class="o">=</span> <span class="n">qaid2_filtweights</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_valid0</span> <span class="o">=</span> <span class="n">qaid2_nnvalid0</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnfilts</span><span class="p">,</span> <span class="n">nnfiltagg</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">threshold_and_scale_weights</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">qfx2_valid0</span><span class="p">,</span> <span class="n">filt2_weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">nnfilts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s">&#39;ratio&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratio_scores</span> <span class="o">=</span> <span class="n">nnfilts</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">ratio_scores</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">ratio_scores</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsmany&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;filter_neighbors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">locals_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;qaid2_nns&#39;</span><span class="p">,</span> <span class="s">&#39;qaid2_nnvalid0&#39;</span><span class="p">,</span> <span class="s">&#39;qaid2_filtweights&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span><span class="p">,</span> <span class="n">qaid2_filtweights</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Continue with function logic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filt2_weights</span> <span class="o">=</span> <span class="n">qaid2_filtweights</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_valid0</span> <span class="o">=</span> <span class="n">qaid2_nnvalid0</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnfilts</span><span class="p">,</span> <span class="n">nnfiltagg</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">threshold_and_scale_weights</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">qfx2_valid0</span><span class="p">,</span> <span class="n">filt2_weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_lists_eq</span><span class="p">(</span><span class="n">nnfilts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;lnbnn&#39;</span><span class="p">,</span> <span class="s">&#39;dupvote&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.try_load_resdict">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">try_load_resdict</tt><big>(</big><em>qreq_</em>, <em>force_miss=False</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#try_load_resdict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.try_load_resdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Try and load the result structures for each query.
returns a list of failed qaids</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qaid2_qres_hit</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">force_miss</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres_hit</span> <span class="o">=</span> <span class="n">try_load_resdict</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">force_miss</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">qaid2_qres_hit</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.weight_neighbors">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">weight_neighbors</tt><big>(</big><em>qreq_</em>, <em>qaid2_nns</em>, <em>qaid2_nnvalid0</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#weight_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.weight_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>PIPELINE NODE 3</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; query request object with hyper-parameters</li>
<li><strong>qaid2_nns</strong> (<em>dict</em>) &#8211; maps query annotid to (qfx2_idx, qfx2_dist)</li>
<li><strong>qaid2_nnvalid0</strong> (<em>dict</em>) &#8211; maps query annotid to qfx2_valid0</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">qaid2_filtweights</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.pipeline &#8211;test-weight_neighbors</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#cfgdict = dict(codename=&#39;vsone&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># dbname = &#39;GZ_ALL&#39;  # &#39;testdb1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;testdb1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">dbname</span><span class="p">,</span> <span class="n">cfgdict</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;weight_neighbors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">locals_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;qaid2_nns&#39;</span><span class="p">,</span> <span class="s">&#39;qaid2_nnvalid0&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span>  <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_filtweights</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">weight_neighbors</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnvalid0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtkey_list</span> <span class="o">=</span> <span class="n">qaid2_filtweights</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtkey_list</span> <span class="o">==</span> <span class="p">[</span><span class="s">&#39;lnbnn&#39;</span><span class="p">,</span> <span class="s">&#39;dupvote&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.precision_recall">
<span id="ibeis-model-hots-precision-recall-module"></span><h2>ibeis.model.hots.precision_recall module<a class="headerlink" href="#module-ibeis.model.hots.precision_recall" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.model.hots.precision_recall.get_average_percision_">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">get_average_percision_</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#get_average_percision_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.get_average_percision_" title="Permalink to this definition">¶</a></dt>
<dd><p>gets average percision using the PASCAL definition</p>
<p>FIXME: Use only the groundtruth that could have been matched in the
database. (shouldn&#8217;t be an issue until we start using daid subsets)</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval">http://en.wikipedia.org/wiki/Information_retrieval</a></p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.precision_recall.get_interpolated_precision_vs_recall_">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">get_interpolated_precision_vs_recall_</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#get_interpolated_precision_vs_recall_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.get_interpolated_precision_vs_recall_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.precision_recall.get_nFalseNegative">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">get_nFalseNegative</tt><big>(</big><em>TP</em>, <em>atrank</em>, <em>nGroundTruth</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#get_nFalseNegative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.get_nFalseNegative" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of documents we should have retrieved but didn&#8217;t</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.precision_recall.get_nFalsePositive">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">get_nFalsePositive</tt><big>(</big><em>TP</em>, <em>atrank</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#get_nFalsePositive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.get_nFalsePositive" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of documents we should not have retrieved</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.precision_recall.get_nTruePositive">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">get_nTruePositive</tt><big>(</big><em>atrank</em>, <em>was_retrieved</em>, <em>gt_ranks</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#get_nTruePositive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.get_nTruePositive" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of documents we got right</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.precision_recall.get_precision">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">get_precision</tt><big>(</big><em>TP</em>, <em>FP</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#get_precision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.get_precision" title="Permalink to this definition">¶</a></dt>
<dd><p>precision positive predictive value</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.precision_recall.get_precision_recall_curve_">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">get_precision_recall_curve_</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#get_precision_recall_curve_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.get_precision_recall_curve_" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.hots_query_result</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()[</span><span class="mi">14</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">_query_chips4</span><span class="p">(</span><span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span> <span class="o">=</span> <span class="n">qaid2_qres</span><span class="p">[</span><span class="n">qaids</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt_aids</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atrank</span>  <span class="o">=</span> <span class="mi">18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">precision_curve</span><span class="p">,</span> <span class="n">recall_curve</span> <span class="o">=</span> <span class="n">qres</span><span class="o">.</span><span class="n">get_precision_recall_curve</span><span class="p">(</span><span class="n">ibs</span><span class="o">=</span><span class="n">ibs</span><span class="p">,</span> <span class="n">gt_aids</span><span class="o">=</span><span class="n">gt_aids</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Precision_and_recall">http://en.wikipedia.org/wiki/Precision_and_recall</a></p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.precision_recall.get_recall">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">get_recall</tt><big>(</big><em>TP</em>, <em>FN</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#get_recall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.get_recall" title="Permalink to this definition">¶</a></dt>
<dd><p>recall, true positive rate, sensitivity, hit rate</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.precision_recall.show_precision_recall_curve_">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">show_precision_recall_curve_</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em>, <em>fnum=1</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#show_precision_recall_curve_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.show_precision_recall_curve_" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.hots_query_result</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.query_helpers">
<span id="ibeis-model-hots-query-helpers-module"></span><h2>ibeis.model.hots.query_helpers module<a class="headerlink" href="#module-ibeis.model.hots.query_helpers" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.model.hots.query_helpers.check_sift_desc">
<tt class="descclassname">ibeis.model.hots.query_helpers.</tt><tt class="descname">check_sift_desc</tt><big>(</big><em>desc</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_helpers.html#check_sift_desc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_helpers.check_sift_desc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.query_helpers.data_index_integrity">
<tt class="descclassname">ibeis.model.hots.query_helpers.</tt><tt class="descname">data_index_integrity</tt><big>(</big><em>ibs</em>, <em>qreq</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_helpers.html#data_index_integrity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_helpers.data_index_integrity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.query_helpers.get_query_components">
<tt class="descclassname">ibeis.model.hots.query_helpers.</tt><tt class="descname">get_query_components</tt><big>(</big><em>ibs</em>, <em>qaids</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_helpers.html#get_query_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_helpers.get_query_components" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.query_request">
<span id="ibeis-model-hots-query-request-module"></span><h2>ibeis.model.hots.query_request module<a class="headerlink" href="#module-ibeis.model.hots.query_request" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibeis.model.hots.query_request.QueryParams">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.query_request.</tt><tt class="descname">QueryParams</tt><big>(</big><em>qparams</em>, <em>cfg</em>, <em>cfgdict=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<blockquote>
<div><p>Structure to store static query pipeline parameters
parses nested config structure into this flat one</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.query_request &#8211;test-QueryParams</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">query_request</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">query_cfg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#cfg.pipeline_root = &#39;asmk&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;pipeline_root&#39;</span><span class="p">:</span> <span class="s">&#39;asmk&#39;</span><span class="p">,</span> <span class="s">&#39;sv_on&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
<span class="gp">... </span>           <span class="s">&#39;fg_weight&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s">&#39;featweight_on&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qparams</span> <span class="o">=</span> <span class="n">query_request</span><span class="o">.</span><span class="n">QueryParams</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qparams</span><span class="o">.</span><span class="n">fg_weight</span> <span class="o">==</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qparams</span><span class="o">.</span><span class="n">pipeline_root</span> <span class="o">==</span> <span class="s">&#39;smk&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qparams</span><span class="o">.</span><span class="n">featweight_on</span> <span class="ow">is</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;)_</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt>&#8216;.join(result.split(&#8216;)_&#8217;)))</dt>
<dd>_smk_SMK(agg=True,t=0.0,a=3.0,idf)_
VocabAssign(nAssign=10,a=1.2,s=None,eqw=T)_
VocabTrain(nWords=8000,init=akmeans++,nIters=128,taids=all)_
SV(OFF)_
FEATWEIGHT(ON,uselabel,rf)_
FEAT(<a href="#id33"><span class="problematic" id="id34">hesaff+sift_</span></a>)_
CHIP(sz450)</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="ibeis.model.hots.query_request.QueryRequest">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.query_request.</tt><tt class="descname">QueryRequest</tt><big>(</big><em>qreq_</em>, <em>qaid_list</em>, <em>daid_list</em>, <em>qparams</em>, <em>qresdir</em>, <em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.assert_self">
<tt class="descname">assert_self</tt><big>(</big><em>qreq_</em>, <em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.assert_self"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.assert_self" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.ensure_featweights">
<tt class="descname">ensure_featweights</tt><big>(</big><em>qreq_</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.ensure_featweights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.ensure_featweights" title="Permalink to this definition">¶</a></dt>
<dd><p>ensure feature weights are computed</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_cfgstr">
<tt class="descname">get_cfgstr</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd><p>main cfgstring used to identify the &#8216;querytype&#8217;</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_data_hashid">
<tt class="descname">get_data_hashid</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_data_hashid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_data_hashid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_external_daids">
<tt class="descname">get_external_daids</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_external_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_external_daids" title="Permalink to this definition">¶</a></dt>
<dd><p>These are the users daids in vsone mode</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_external_duuids">
<tt class="descname">get_external_duuids</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_external_duuids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_external_duuids" title="Permalink to this definition">¶</a></dt>
<dd><p>These are the users qauuids in vsone mode</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_external_qaids">
<tt class="descname">get_external_qaids</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_external_qaids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_external_qaids" title="Permalink to this definition">¶</a></dt>
<dd><p>These are the users qaids in vsone mode</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_external_query_groundtruth">
<tt class="descname">get_external_query_groundtruth</tt><big>(</big><em>qreq_</em>, <em>qaids</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_external_query_groundtruth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_external_query_groundtruth" title="Permalink to this definition">¶</a></dt>
<dd><p>gets groundtruth that are accessible via this query</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_external_quuids">
<tt class="descname">get_external_quuids</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_external_quuids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_external_quuids" title="Permalink to this definition">¶</a></dt>
<dd><p>These are the users qauuids in vsone mode</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_infostr">
<tt class="descname">get_infostr</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_infostr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_infostr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_internal_daids">
<tt class="descname">get_internal_daids</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_internal_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_internal_daids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_internal_duuids">
<tt class="descname">get_internal_duuids</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_internal_duuids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_internal_duuids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_internal_qaids">
<tt class="descname">get_internal_qaids</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_internal_qaids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_internal_qaids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_internal_query_groundtruth">
<tt class="descname">get_internal_query_groundtruth</tt><big>(</big><em>qreq_</em>, <em>qaids</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_internal_query_groundtruth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_internal_query_groundtruth" title="Permalink to this definition">¶</a></dt>
<dd><p>gets groundtruth that are accessible via this query</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_internal_quuids">
<tt class="descname">get_internal_quuids</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_internal_quuids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_internal_quuids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_qresdir">
<tt class="descname">get_qresdir</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_qresdir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_qresdir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_query_cfgstr">
<tt class="descname">get_query_cfgstr</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_query_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_query_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_query_hashid">
<tt class="descname">get_query_hashid</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_query_hashid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_query_hashid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_unique_species">
<tt class="descname">get_unique_species</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_unique_species"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_unique_species" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.lazy_load">
<tt class="descname">lazy_load</tt><big>(</big><em>qreq_</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.lazy_load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.lazy_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs preloading of all data needed for a batch of queries</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.lazy_preload">
<tt class="descname">lazy_preload</tt><big>(</big><em>qreq_</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.lazy_preload"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.lazy_preload" title="Permalink to this definition">¶</a></dt>
<dd><p>feature weights and normalizers should be loaded before vsone queries
are issued. They do not depened only on qparams</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.load_indexer">
<tt class="descname">load_indexer</tt><big>(</big><em>qreq_</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.load_indexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.load_indexer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.load_score_normalizer">
<tt class="descname">load_score_normalizer</tt><big>(</big><em>qreq_</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.load_score_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.load_score_normalizer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.make_empty_query_results">
<tt class="descname">make_empty_query_results</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.make_empty_query_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.make_empty_query_results" title="Permalink to this definition">¶</a></dt>
<dd><p>returns empty query results for each external qaid</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.rrr">
<tt class="descname">rrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.set_external_daids">
<tt class="descname">set_external_daids</tt><big>(</big><em>qreq_</em>, <em>daid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.set_external_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.set_external_daids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.set_external_qaid_mask">
<tt class="descname">set_external_qaid_mask</tt><big>(</big><em>qreq_</em>, <em>masked_qaid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.set_external_qaid_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.set_external_qaid_mask" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.query_request &#8211;test-set_external_qaid_mask</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masked_qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="o">.</span><span class="n">set_external_qaid_mask</span><span class="p">(</span><span class="n">masked_qaid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.set_external_qaids">
<tt class="descname">set_external_qaids</tt><big>(</big><em>qreq_</em>, <em>qaid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.set_external_qaids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.set_external_qaids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.set_internal_daids">
<tt class="descname">set_internal_daids</tt><big>(</big><em>qreq_</em>, <em>daid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.set_internal_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.set_internal_daids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.set_internal_masked_daids">
<tt class="descname">set_internal_masked_daids</tt><big>(</big><em>qreq_</em>, <em>masked_daid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.set_internal_masked_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.set_internal_masked_daids" title="Permalink to this definition">¶</a></dt>
<dd><p>used by the pipeline to execute a subset of the query request
without modifying important state</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.set_internal_masked_qaids">
<tt class="descname">set_internal_masked_qaids</tt><big>(</big><em>qreq_</em>, <em>masked_qaid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.set_internal_masked_qaids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.set_internal_masked_qaids" title="Permalink to this definition">¶</a></dt>
<dd><p>used by the pipeline to execute a subset of the query request
without modifying important state</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">,</span> <span class="n">sv_on</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">qaid_list</span><span class="o">=</span><span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="o">=</span><span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_lists_eq</span><span class="p">(</span><span class="n">qaid_list</span><span class="p">,</span> <span class="n">qaids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masked_qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="o">.</span><span class="n">set_internal_masked_qaids</span><span class="p">(</span><span class="n">masked_qaid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_internal_aids</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_lists_eq</span><span class="p">(</span><span class="n">new_internal_aids</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.set_internal_qaids">
<tt class="descname">set_internal_qaids</tt><big>(</big><em>qreq_</em>, <em>qaid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.set_internal_qaids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.set_internal_qaids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.set_internal_unmasked_qaids">
<tt class="descname">set_internal_unmasked_qaids</tt><big>(</big><em>qreq_</em>, <em>unmasked_qaid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.set_internal_unmasked_qaids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.set_internal_unmasked_qaids" title="Permalink to this definition">¶</a></dt>
<dd><p>used by the pipeline to execute a subset of the query request
without modifying important state</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">,</span> <span class="n">sv_on</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">qaid_list</span><span class="o">=</span><span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="o">=</span><span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_lists_eq</span><span class="p">(</span><span class="n">qaid_list</span><span class="p">,</span> <span class="n">qaids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unmasked_qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="o">.</span><span class="n">set_internal_unmasked_qaids</span><span class="p">(</span><span class="n">unmasked_qaid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_internal_aids</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_lists_eq</span><span class="p">(</span><span class="n">new_internal_aids</span><span class="p">,</span> <span class="n">unmasked_qaid_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.shallowcopy">
<tt class="descname">shallowcopy</tt><big>(</big><em>qreq_</em>, <em>qx=None</em>, <em>dx=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.shallowcopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.shallowcopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a copy of qreq with the same qparams object and a subset of the qx
and dx objects.
used to generate chunks of vsone queries</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">get_test_qreq</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq2_</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">shallowcopy</span><span class="p">(</span><span class="n">qx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_daids</span><span class="p">()</span> <span class="ow">is</span> <span class="n">qreq2_</span><span class="o">.</span><span class="n">get_external_daids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">())</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qreq2_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">qreq2_</span><span class="o">.</span><span class="n">metadata</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.query_request.apply_species_with_detector_hack">
<tt class="descclassname">ibeis.model.hots.query_request.</tt><tt class="descname">apply_species_with_detector_hack</tt><big>(</big><em>ibs</em>, <em>cfgdict</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#apply_species_with_detector_hack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.apply_species_with_detector_hack" title="Permalink to this definition">¶</a></dt>
<dd><p>HACK turns of featweights if they cannot be applied</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.query_request.get_test_qreq">
<tt class="descclassname">ibeis.model.hots.query_request.</tt><tt class="descname">get_test_qreq</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#get_test_qreq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.get_test_qreq" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.query_request.new_ibeis_query_request">
<tt class="descclassname">ibeis.model.hots.query_request.</tt><tt class="descname">new_ibeis_query_request</tt><big>(</big><em>ibs</em>, <em>qaid_list</em>, <em>daid_list</em>, <em>cfgdict=None</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#new_ibeis_query_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.new_ibeis_query_request" title="Permalink to this definition">¶</a></dt>
<dd><p>ibeis entry point to create a new query request object</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.query_request &#8211;test-new_ibeis_query_request</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;sv_on&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;fg_weight&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s">&#39;featweight_on&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Execute test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">new_ibeis_query_request</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Check Results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">fg_weight</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span>
<span class="gp">... </span>   <span class="s">&#39;qreq_.qparams.fg_weight = </span><span class="si">%r</span><span class="s"> &#39;</span> <span class="o">%</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">fg_weight</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">sv_on</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">,</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;qreq_.qparams.sv_on = </span><span class="si">%r</span><span class="s"> &#39;</span> <span class="o">%</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">sv_on</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datahashid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_data_hashid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_dbname</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">dbname</span> <span class="o">+</span> <span class="n">datahashid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">PZ_MTEST_DSUUIDS((5)q87ho9a0@9s02imh)</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;NAUT_test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;sv_on&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">&#39;fg_weight&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s">&#39;featweight_on&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Execute test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">new_ibeis_query_request</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Check Results.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Featweight should be off because there is no Naut detector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">fg_weight</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">,</span> <span class="p">(</span>
<span class="gp">... </span>   <span class="s">&#39;qreq_.qparams.fg_weight = </span><span class="si">%r</span><span class="s"> &#39;</span> <span class="o">%</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">fg_weight</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">sv_on</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">,</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;qreq_.qparams.sv_on = </span><span class="si">%r</span><span class="s"> &#39;</span> <span class="o">%</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">sv_on</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datahashid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_data_hashid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_dbname</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">dbname</span> <span class="o">+</span> <span class="n">datahashid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">NAUT_test_DSUUIDS((5)4e972cjxcj30a8u1)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.query_request.test_cfg_deepcopy">
<tt class="descclassname">ibeis.model.hots.query_request.</tt><tt class="descname">test_cfg_deepcopy</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#test_cfg_deepcopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.test_cfg_deepcopy" title="Permalink to this definition">¶</a></dt>
<dd><p>TESTING FUNCTION</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">test_cfg_deepcopy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.score_normalization">
<span id="ibeis-model-hots-score-normalization-module"></span><h2>ibeis.model.hots.score_normalization module<a class="headerlink" href="#module-ibeis.model.hots.score_normalization" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>GOALS:</dt>
<dd><ol class="first arabic simple">
<li>vsmany
* works resaonable for very few and very many
* stars with small k and then k becomes a percent or log percent
* distinctiveness from different location</li>
<li>1-vs-1
* uses distinctivness and foreground when available
* start with ratio test and ransac</li>
<li>First N decision are interactive until we learn a good threshold</li>
</ol>
<p>4) Always show numbers between 0 and 1 spatial verification is based on
single best exemplar</p>
<blockquote>
<div>x - build normalizer
x - test normalizer
x - monotonicity (both nondecreasing and strictly increasing)
x - cache normalizer
x - cache maitainance (deleters and listers)
o - Incemental learning
o - Spceies sensitivity</div></blockquote>
<ol class="arabic simple" start="5">
<li>Add exemplars that are distinct from exiting (matches below threshold)</li>
</ol>
<p class="last">(no rebuilding kd-tree for each image)</p>
</dd>
</dl>
<dl class="class">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">ScoreNormalizer</tt><big>(</big><em>normalizer</em>, <em>cfgstr=None</em>, <em>score_domain=None</em>, <em>p_tp_given_score=None</em>, <em>tp_support=None</em>, <em>tn_support=None</em>, <em>tp_labels=None</em>, <em>fn_labels=None</em>, <em>clipscore=None</em>, <em>timestamp=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">utool.util_cache.Cachable</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.score_normalization &#8211;test-ScoreNormalizer</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgstr</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_domain</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_tp_given_score</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_labels</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn_labels</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalizer</span> <span class="o">=</span> <span class="n">ScoreNormalizer</span><span class="p">(</span><span class="n">cfgstr</span><span class="p">,</span> <span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">,</span> <span class="n">tp_labels</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">fn_labels</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.add_support">
<tt class="descname">add_support</tt><big>(</big><em>normalizer</em>, <em>tp_scores</em>, <em>fp_scores</em>, <em>tp_labels</em>, <em>fp_labels</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer.add_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.add_support" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.get_cfgstr">
<tt class="descname">get_cfgstr</tt><big>(</big><em>normalizer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer.get_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.get_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.get_infostr">
<tt class="descname">get_infostr</tt><big>(</big><em>normalizer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer.get_infostr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.get_infostr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.get_prefix">
<tt class="descname">get_prefix</tt><big>(</big><em>normalizer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer.get_prefix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.get_prefix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.normalize_score_">
<tt class="descname">normalize_score_</tt><big>(</big><em>normalizer</em>, <em>score</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer.normalize_score_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.normalize_score_" title="Permalink to this definition">¶</a></dt>
<dd><p>for internal use only</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.normalize_score_list">
<tt class="descname">normalize_score_list</tt><big>(</big><em>normalizer</em>, <em>score_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer.normalize_score_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.normalize_score_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.prefix">
<tt class="descname">prefix</tt><em class="property"> = 'normalizer_'</em><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.prefix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.retrain">
<tt class="descname">retrain</tt><big>(</big><em>normalizer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer.retrain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.retrain" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.rrr">
<tt class="descname">rrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.visualize">
<tt class="descname">visualize</tt><big>(</big><em>normalizer</em>, <em>update=True</em>, <em>verbose=True</em>, <em>fnum=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer.visualize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.visualize" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.score_normalization &#8211;test-visualize &#8211;index 0
&#8211;cmd</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#import ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--index&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalizer</span> <span class="o">=</span> <span class="n">load_precomputed_normalizer</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">with_global</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalizer</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">six</span><span class="o">.</span><span class="n">exec_</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">present</span><span class="p">(),</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#pt.plt.show()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.visualize_probs">
<tt class="descname">visualize_probs</tt><big>(</big><em>normalizer</em>, <em>update=True</em>, <em>fnum=None</em>, <em>pnum=(1</em>, <em>1</em>, <em>1)</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer.visualize_probs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.visualize_probs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.visualize_support">
<tt class="descname">visualize_support</tt><big>(</big><em>normalizer</em>, <em>update=True</em>, <em>fnum=None</em>, <em>pnum=(1</em>, <em>1</em>, <em>1)</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer.visualize_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.visualize_support" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.cached_ibeis_score_normalizer">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">cached_ibeis_score_normalizer</tt><big>(</big><em>ibs</em>, <em>qres_list</em>, <em>qreq_</em>, <em>use_cache=True</em>, <em>**learnkw</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#cached_ibeis_score_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.cached_ibeis_score_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Builds a normalizer trained on query results for a database</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>qaid2_qres (int): query annotation id</dd>
<dt>Returns:</dt>
<dd>ScoreNormalizer: cached or freshly trained score normalizer</dd>
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.score_normalization &#8211;test-cached_ibeis_score_normalizer</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibeis</span><span class="o">.</span><span class="n">_init_numpy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;PZ_MTEST&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">dbname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_list</span> <span class="o">=</span> <span class="n">daid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone_unnorm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres_list</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">query_chips</span><span class="p">(</span><span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">cfgdict</span><span class="p">,</span> <span class="n">return_request</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_normalizer</span> <span class="o">=</span> <span class="n">cached_ibeis_score_normalizer</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qres_list</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">score_normalizer</span><span class="o">.</span><span class="n">get_fname</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="s">&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt>&#8216; + score_normalizer.get_cfgstr()</dt>
<dd><div class="first highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">normalizer_5cv1%3s&amp;.cPkl</span>
<span class="go">PZ_MTEST_DSUUIDS((9)67j%dr%&amp;bl%4oh4+)_QSUUIDS((9)67j%dr%&amp;bl%4oh4+)zebra_plains_vsone_NN(single,K1+1,last,cks1024)_FILT(ratio&lt;0.625;1.0,fg;1.0)_SV(0.01;2;1.57minIn=4,nRR=50,nsum,)_AGG(nsum)_FLANN(4_kdtrees)_FEATWEIGHT(ON,uselabel,rf)_FEAT(hesaff+sift_)_CHIP(sz450)</span>
</pre></div>
</div>
<p class="last">normalizer_PZ_MTEST_SUUIDS((9)67j%dr%&amp;bl%4oh4+).cPkl</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.delete_all_learned_normalizers">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">delete_all_learned_normalizers</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#delete_all_learned_normalizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.delete_all_learned_normalizers" title="Permalink to this definition">¶</a></dt>
<dd><p>DELETES ALL CACHED NORMALIZERS IN ALL DATABASES</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.score_normalization &#8211;test-delete_all_learned_normalizers
#-y</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DOCTEST_DISABLE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">score_normalization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_normalization</span><span class="o">.</span><span class="n">delete_all_learned_normalizers</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.find_score_maxclip">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">find_score_maxclip</tt><big>(</big><em>tp_support</em>, <em>tn_support</em>, <em>clip_factor=2.6180339887499997</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#find_score_maxclip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.find_score_maxclip" title="Permalink to this definition">¶</a></dt>
<dd><p>returns score to clip true positives past.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">clip_score</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">50000</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">110</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clip_score</span> <span class="o">=</span> <span class="n">find_score_maxclip</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">clip_score</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">287.983738762</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.get_ibeis_score_training_data">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">get_ibeis_score_training_data</tt><big>(</big><em>ibs</em>, <em>qaid_list</em>, <em>qres_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#get_ibeis_score_training_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.get_ibeis_score_training_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns &#8220;good&#8221; taining examples</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.inspect_pdfs">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">inspect_pdfs</tt><big>(</big><em>tn_support</em>, <em>tp_support</em>, <em>score_domain</em>, <em>p_tp_given_score</em>, <em>p_tn_given_score</em>, <em>p_score_given_tp</em>, <em>p_score_given_tn</em>, <em>p_score</em>, <em>with_scores=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#inspect_pdfs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.inspect_pdfs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.learn_ibeis_score_normalizer">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">learn_ibeis_score_normalizer</tt><big>(</big><em>ibs</em>, <em>qaid_list</em>, <em>qres_list</em>, <em>cfgstr</em>, <em>**learnkw</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#learn_ibeis_score_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.learn_ibeis_score_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the result of queries and trains a score normalizer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qaid_list</strong> (<em>int</em>) &#8211; query annotation id</li>
<li><strong>qres_list</strong> (<em>list</em>) &#8211; object of feature correspondences and scores</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">freshly trained score normalizer</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ScoreNormalizer</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.learn_score_normalization">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">learn_score_normalization</tt><big>(</big><em>tp_support</em>, <em>tn_support</em>, <em>gridsize=1024</em>, <em>adjust=8</em>, <em>return_all=False</em>, <em>monotonize=True</em>, <em>clip_factor=2.6180339887499997</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#learn_score_normalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.learn_score_normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes collected data and applys parzen window density estimation and bayes rule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gridsize</strong> (<em>int</em>) &#8211; default 512</li>
<li><strong>adjust</strong> (<em>int</em>) &#8211; default 8</li>
<li><strong>return_all</strong> (<em>bool</em>) &#8211; default False</li>
<li><strong>monotonize</strong> (<em>bool</em>) &#8211; default True</li>
<li><strong>clip_factor</strong> (<em>float</em>) &#8211; default phi ** 2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(score_domain, p_tp_given_score, p_tn_given_score, p_score_given_tp, p_score_given_tn, p_score, clip_score)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tn_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">,</span> <span class="n">clip_score</span><span class="p">)</span> <span class="o">=</span> <span class="n">learn_score_normalization</span><span class="p">(</span><span class="n">tp_support</span><span class="p">,</span> <span class="n">tn_support</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p_tp_given_score</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">92</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.list_available_score_normalizers">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">list_available_score_normalizers</tt><big>(</big><em>with_global=True</em>, <em>with_local=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#list_available_score_normalizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.list_available_score_normalizers" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.score_normalization &#8211;test-list_available_score_normalizers</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">local_normalizers_fpaths</span> <span class="o">=</span> <span class="n">list_available_score_normalizers</span><span class="p">(</span><span class="n">with_global</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">global_normalizers_fpaths</span> <span class="o">=</span> <span class="n">list_available_score_normalizers</span><span class="p">(</span><span class="n">with_local</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># quote them</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># local_normalizers_fpaths = [&#39;&quot;%s&quot;&#39; % fpath for fpath in local_normalizers_fpaths]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># global_normalizers_fpaths = [&#39;&quot;%s&quot;&#39; % fpath for fpath in global_normalizers_fpaths]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Available LOCAL normalizers: &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">indentjoin</span><span class="p">(</span><span class="n">local_normalizers_fpaths</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">  &#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Available GLOBAL normalizers: &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">indentjoin</span><span class="p">(</span><span class="n">global_normalizers_fpaths</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">  &#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_file_nBytes_str</span><span class="p">,</span> <span class="n">local_normalizers_fpaths</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_file_nBytes_str</span><span class="p">,</span> <span class="n">global_normalizers_fpaths</span><span class="p">)))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.load_precomputed_normalizer">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">load_precomputed_normalizer</tt><big>(</big><em>index</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#load_precomputed_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.load_precomputed_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>python -m ibeis.model.hots.score_normalization &#8211;test-load_precomputed_normalizer</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalizer</span> <span class="o">=</span> <span class="n">load_precomputed_normalizer</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalizer</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">six</span><span class="o">.</span><span class="n">exec_</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">present</span><span class="p">(),</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.parse_available_normalizers">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">parse_available_normalizers</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#parse_available_normalizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.parse_available_normalizers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.plot_postbayes_pdf">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">plot_postbayes_pdf</tt><big>(</big><em>score_domain</em>, <em>p_tn_given_score</em>, <em>p_tp_given_score</em>, <em>cfgstr=''</em>, <em>fnum=None</em>, <em>pnum=(1</em>, <em>1</em>, <em>1)</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#plot_postbayes_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.plot_postbayes_pdf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.plot_prebayes_pdf">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">plot_prebayes_pdf</tt><big>(</big><em>score_domain</em>, <em>p_score_given_tn</em>, <em>p_score_given_tp</em>, <em>p_score</em>, <em>cfgstr=''</em>, <em>fnum=None</em>, <em>pnum=(1</em>, <em>1</em>, <em>1)</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#plot_prebayes_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.plot_prebayes_pdf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.plot_support">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">plot_support</tt><big>(</big><em>tn_support</em>, <em>tp_support</em>, <em>fnum=None</em>, <em>pnum=(1</em>, <em>1</em>, <em>1)</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#plot_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.plot_support" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.request_ibeis_normalizer">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">request_ibeis_normalizer</tt><big>(</big><em>qreq_</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#request_ibeis_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.request_ibeis_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>FIXME: do what is in the docstr</p>
<p>Tries to load the best possible normalizer for this query request.
If none are found then a it tries to load a downloaded baseline. If
none exists then it starts to compute a custom baseline.</p>
<p>The basline probability for an empty normalizer should be 1/2.
The probability of a baseline normalizer should be regularized to
stay close to 1/2 when there is little support.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">cached or prebuilt score normalizer</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ScoreNormalizer</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">query_request</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="n">n</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;nsum_unnorm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#cfgdict = dict(codename=&#39;vsone_unnorm&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">query_request</span><span class="o">.</span><span class="n">new_ibeis_query_request</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalizer</span> <span class="o">=</span> <span class="n">request_ibeis_normalizer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.test">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">test</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.test" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.test_score_normalization">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">test_score_normalization</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#test_score_normalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.test_score_normalization" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd><p class="first">python ibeis/model/hots/score_normalization.py &#8211;test-test_score_normalization</p>
<p class="last">python dev.py -t custom &#8211;cfg codename:vsone_unnorm &#8211;db PZ_MTEST &#8211;allgt &#8211;vf &#8211;va
python dev.py -t custom &#8211;cfg codename:vsone_unnorm &#8211;db PZ_MTEST &#8211;allgt &#8211;vf &#8211;va &#8211;index 0:8:3 &#8211;dindex 0:10 &#8211;verbose</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#from ibeis.model.hots import score_normalization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#score_normalization.rrr()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">test_score_normalization</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">execstr</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">execstr_dict</span><span class="p">(</span><span class="n">locals_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#print(execstr)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">exec</span><span class="p">(</span><span class="n">execstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">exec</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">present</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.train_baseline_for_all_dbs">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">train_baseline_for_all_dbs</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#train_baseline_for_all_dbs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.train_baseline_for_all_dbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs unnormalized queries to compute normalized queries</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.score_normalization &#8211;test-train_baseline_for_all_dbs</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_baseline_for_all_dbs</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.train_baseline_ibeis_normalizer">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">train_baseline_ibeis_normalizer</tt><big>(</big><em>ibs</em>, <em>use_cache=True</em>, <em>**learnkw</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#train_baseline_ibeis_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.train_baseline_ibeis_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs unnormalized queries to compute normalized queries</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">normalizer</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ScoreNormalizer</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.score_normalization &#8211;test-train_baseline_ibeis_normalizer &#8211;cmd
python -m ibeis.model.hots.score_normalization &#8211;test-train_baseline_ibeis_normalizer &#8211;noshow</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.all_imports</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">score_normalization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#score_normalization.rrr()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;GZ_ALL&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;PZ_MTEST&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">dbname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">learnkw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalizer</span> <span class="o">=</span> <span class="n">score_normalization</span><span class="o">.</span><span class="n">train_baseline_ibeis_normalizer</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">use_cache</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">learnkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalizer</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">normalizer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">exec</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">present</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.try_download_baseline_ibeis_normalizer">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">try_download_baseline_ibeis_normalizer</tt><big>(</big><em>qreq_</em>, <em>cfgstr</em>, <em>cachedir</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#try_download_baseline_ibeis_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.try_download_baseline_ibeis_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>tries to download a baseline normalizer for some species.
creates an empty normalizer if it cannot</p>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.special_query">
<span id="ibeis-model-hots-special-query-module"></span><h2>ibeis.model.hots.special_query module<a class="headerlink" href="#module-ibeis.model.hots.special_query" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.model.hots.special_query.apply_new_qres_filter_scores">
<tt class="descclassname">ibeis.model.hots.special_query.</tt><tt class="descname">apply_new_qres_filter_scores</tt><big>(</big><em>qres_vsone</em>, <em>newfsv_list</em>, <em>newscore_aids</em>, <em>filtkey</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/special_query.html#apply_new_qres_filter_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.special_query.apply_new_qres_filter_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.special_query.build_vsone_shortlist">
<tt class="descclassname">ibeis.model.hots.special_query.</tt><tt class="descname">build_vsone_shortlist</tt><big>(</big><em>ibs</em>, <em>qaid2_qres_vsmany</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/special_query.html#build_vsone_shortlist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.special_query.build_vsone_shortlist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.special_query.choose_vsmany_K">
<tt class="descclassname">ibeis.model.hots.special_query.</tt><tt class="descname">choose_vsmany_K</tt><big>(</big><em>ibs</em>, <em>qaids</em>, <em>daids</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/special_query.html#choose_vsmany_K"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.special_query.choose_vsmany_K" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.special_query.empty_query">
<tt class="descclassname">ibeis.model.hots.special_query.</tt><tt class="descname">empty_query</tt><big>(</big><em>ibs</em>, <em>qaids</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/special_query.html#empty_query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.special_query.empty_query" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ibs</strong> (<em>IBEISController</em>) &#8211; ibeis controller object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(qaid2_qres, <a href="#id35"><span class="problematic" id="id36">qreq_</span></a>)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.special_query &#8211;test-empty_query</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.special_query</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qaid2_qres</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span> <span class="o">=</span> <span class="n">empty_query</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">qaid2_qres</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span> <span class="o">=</span> <span class="n">qaid2_qres</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span><span class="o">.</span><span class="n">ishow_top</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">make_figtitle</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">show_query</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sidebyside</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.special_query.get_new_qres_filter_scores">
<tt class="descclassname">ibeis.model.hots.special_query.</tt><tt class="descname">get_new_qres_filter_scores</tt><big>(</big><em>qres_vsone</em>, <em>qres_vsmany</em>, <em>top_aids</em>, <em>filtkey</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/special_query.html#get_new_qres_filter_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.special_query.get_new_qres_filter_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>applies scores of type <tt class="docutils literal"><span class="pre">filtkey</span></tt> from qaid2_qres_vsmany to qaid2_qres_vsone</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.special_query.query_vsone_pairs">
<tt class="descclassname">ibeis.model.hots.special_query.</tt><tt class="descname">query_vsone_pairs</tt><big>(</big><em>ibs</em>, <em>vsone_query_pairs</em>, <em>use_cache</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/special_query.html#query_vsone_pairs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.special_query.query_vsone_pairs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.special_query.query_vsone_verified">
<tt class="descclassname">ibeis.model.hots.special_query.</tt><tt class="descname">query_vsone_verified</tt><big>(</big><em>ibs</em>, <em>qaids</em>, <em>daids</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/special_query.html#query_vsone_verified"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.special_query.query_vsone_verified" title="Permalink to this definition">¶</a></dt>
<dd><p>A hacked in vsone-reranked pipeline
Actually just two calls to the pipeline</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ibs</strong> (<em>IBEISController</em>) &#8211; ibeis controller object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qaid2_qres, <a href="#id37"><span class="problematic" id="id38">qreq_</span></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.special_query &#8211;test-query_vsone_verified</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.special_query</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#ibs = ibeis.opendb(&#39;PZ_MTEST&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">valid_aids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qaids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">query_vsone_verified</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span> <span class="o">=</span> <span class="n">qaid2_qres</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd><p class="first">qres = qaid2_qres_vsmany[qaid]</p>
<p class="last">qres = qaid2_qres[qaid]
ibs.delete_qres_cache()
qres.show_top(ibs, update=True)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.special_query.test_vsone_verified">
<tt class="descclassname">ibeis.model.hots.special_query.</tt><tt class="descname">test_vsone_verified</tt><big>(</big><em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/special_query.html#test_vsone_verified"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.special_query.test_vsone_verified" title="Permalink to this definition">¶</a></dt>
<dd><p>hack in vsone-reranking</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.all_imports</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#reload_all()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_vsone_verified</span><span class="p">(</span><span class="n">ibs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.voting_rules2">
<span id="ibeis-model-hots-voting-rules2-module"></span><h2>ibeis.model.hots.voting_rules2 module<a class="headerlink" href="#module-ibeis.model.hots.voting_rules2" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.enforce_one_name">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">enforce_one_name</tt><big>(</big><em>ibs</em>, <em>aid2_score</em>, <em>chipmatch=None</em>, <em>aid2_chipscore=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#enforce_one_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.enforce_one_name" title="Permalink to this definition">¶</a></dt>
<dd><p>this is a hack to make the same name only show up once in the top ranked
list</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.get_chipmatch_testdata">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">get_chipmatch_testdata</tt><big>(</big><em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#get_chipmatch_testdata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.get_chipmatch_testdata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.get_scores_from_altx2_score">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">get_scores_from_altx2_score</tt><big>(</big><em>ibs</em>, <em>qcx</em>, <em>altx2_prob</em>, <em>altx2_tnx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#get_scores_from_altx2_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.get_scores_from_altx2_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.positional_scoring_rule">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">positional_scoring_rule</tt><big>(</big><em>qfx2_utilities</em>, <em>rule</em>, <em>isWeighted</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#positional_scoring_rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.positional_scoring_rule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.score_chipmatch_PL">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">score_chipmatch_PL</tt><big>(</big><em>ibs</em>, <em>qcx</em>, <em>chipmatch</em>, <em>qreq</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#score_chipmatch_PL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.score_chipmatch_PL" title="Permalink to this definition">¶</a></dt>
<dd><p>chipmatch = qcx2_chipmatch[qcx]</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.score_chipmatch_csum">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">score_chipmatch_csum</tt><big>(</big><em>qaid</em>, <em>chipmatch</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#score_chipmatch_csum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.score_chipmatch_csum" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">aid_list, score_list</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.voting_rules2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">chipmatch</span> <span class="o">=</span> <span class="n">get_chipmatch_testdata</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">score_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">score_chipmatch_csum</span><span class="p">(</span><span class="n">qaid</span><span class="p">,</span> <span class="n">chipmatch</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">score_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.score_chipmatch_nsum">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">score_chipmatch_nsum</tt><big>(</big><em>qaid</em>, <em>chipmatch</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#score_chipmatch_nsum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.score_chipmatch_nsum" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">nid2_score</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python dev.py -t nsum_nosv &#8211;db GZ_ALL &#8211;allgt &#8211;noqcache
python dev.py -t nsum &#8211;db GZ_ALL &#8211;show &#8211;va -w &#8211;qaid 1032 &#8211;noqcache
python dev.py -t nsum_nosv &#8211;db GZ_ALL &#8211;show &#8211;va -w &#8211;qaid 1032 &#8211;noqcache
qaid=1032_res_gooc+f4msr4ouy9t_quuid=c4f78a6d.npz
qaid=1032_res_5ujbs8h&amp;%vw1olnx_quuid=c4f78a6d.npz</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.voting_rules2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">chipmatch</span> <span class="o">=</span> <span class="n">get_chipmatch_testdata</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">score_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">score_chipmatch_nsum</span><span class="p">(</span><span class="n">qaid</span><span class="p">,</span> <span class="n">chipmatch</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.score_chipmatch_nunique">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">score_chipmatch_nunique</tt><big>(</big><em>ibs</em>, <em>qaid</em>, <em>chipmatch</em>, <em>qreq</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#score_chipmatch_nunique"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.score_chipmatch_nunique" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.score_chipmatch_pos">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">score_chipmatch_pos</tt><big>(</big><em>ibs</em>, <em>qcx</em>, <em>chipmatch</em>, <em>qreq</em>, <em>rule='borda'</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#score_chipmatch_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.score_chipmatch_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Positional Scoring Rule</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.score_chipmatch_true_nsum">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">score_chipmatch_true_nsum</tt><big>(</big><em>qaid</em>, <em>chipmatch</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#score_chipmatch_true_nsum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.score_chipmatch_true_nsum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.word_index">
<span id="ibeis-model-hots-word-index-module"></span><h2>ibeis.model.hots.word_index module<a class="headerlink" href="#module-ibeis.model.hots.word_index" title="Permalink to this headline">¶</a></h2>
<p>python -c &#8220;import doctest, ibeis; print(doctest.testmod(ibeis.model.hots.word_index))&#8221;
python -m doctest -v ibeis/model/hots/word_index.py
python -m doctest ibeis/model/hots/word_index.py</p>
<dl class="class">
<dt id="ibeis.model.hots.word_index.NeighborAssignment">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.word_index.</tt><tt class="descname">NeighborAssignment</tt><big>(</big><em>asgn</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#NeighborAssignment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.NeighborAssignment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="ibeis.model.hots.word_index.WordIndex">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.word_index.</tt><tt class="descname">WordIndex</tt><big>(</big><em>windex</em>, <em>ax2_aid</em>, <em>idx2_vec</em>, <em>idx2_ax</em>, <em>idx2_fx</em>, <em>flann</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Abstract wrapper around flann</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.word_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windex</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_windex</span><span class="p">()</span>  
</pre></div>
</div>
<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.add_points">
<tt class="descname">add_points</tt><big>(</big><em>windex</em>, <em>new_aid_list</em>, <em>new_vecs_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex.add_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.add_points" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.word_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windex</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_windex</span><span class="p">()</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_aid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_vecs_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="n">new_aid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checks</span> <span class="o">=</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx1</span><span class="p">,</span> <span class="n">qfx2_dist1</span><span class="p">)</span> <span class="o">=</span> <span class="n">windex</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windex</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">new_aid_list</span><span class="p">,</span> <span class="n">new_vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx2</span><span class="p">,</span> <span class="n">qfx2_dist2</span><span class="p">)</span> <span class="o">=</span> <span class="n">windex</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qfx2_idx2</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">qfx2_idx1</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.empty_words">
<tt class="descname">empty_words</tt><big>(</big><em>K</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex.empty_words"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.empty_words" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.get_nn_aids">
<tt class="descname">get_nn_aids</tt><big>(</big><em>windex</em>, <em>qfx2_nnidx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex.get_nn_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.get_nn_aids" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_nnidx</strong> (<em>ndarray</em>) &#8211; (N x K) qfx2_idx[n][k] is the index of the kth
approximate nearest data vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qfx2_aid - (N x K) qfx2_fx[n][k] is the annotation id index
of the kth approximate nearest data vector</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.get_nn_axs">
<tt class="descname">get_nn_axs</tt><big>(</big><em>windex</em>, <em>qfx2_nnidx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex.get_nn_axs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.get_nn_axs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.get_nn_featxs">
<tt class="descname">get_nn_featxs</tt><big>(</big><em>windex</em>, <em>qfx2_nnidx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex.get_nn_featxs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.get_nn_featxs" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_nnidx</strong> (<em>ndarray</em>) &#8211; (N x K) qfx2_idx[n][k] is the index of the kth
approximate nearest data vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qfx2_fx - (N x K) qfx2_fx[n][k] is the feature index (w.r.t
the source annotation) of the kth approximate nearest data vector</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.knn">
<tt class="descname">knn</tt><big>(</big><em>windex</em>, <em>qfx2_vec</em>, <em>K</em>, <em>checks=1028</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex.knn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.knn" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qfx2_vec</strong> (<em>ndarray</em>) &#8211; (N x D) array of N, D-dimensional query vectors</li>
<li><strong>K</strong> (<em>int</em>) &#8211; number of approximate nearest words to find</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>tuple of (qfx2_idx, qfx2_dist)</p>
<dl class="docutils">
<dt>qfx2_idx (ndarray):  (N x K) qfx2_idx[n][k] is the index of the kth</dt>
<dd><p class="first last">approximate nearest data vector w.r.t qfx2_vec[n]</p>
</dd>
<dt>qfx2_dist (ndarray): (N x K) qfx2_dist[n][k] is the distance to the kth</dt>
<dd><p class="first last">approximate nearest data vector w.r.t. qfx2_vec[n]</p>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.word_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windex</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_windex</span><span class="p">()</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_aid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_vecs_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="n">new_aid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checks</span> <span class="o">=</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">windex</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.num_indexed_annots">
<tt class="descname">num_indexed_annots</tt><big>(</big><em>windex</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex.num_indexed_annots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.num_indexed_annots" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.num_indexed_vecs">
<tt class="descname">num_indexed_vecs</tt><big>(</big><em>windex</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex.num_indexed_vecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.num_indexed_vecs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.rrr">
<tt class="descname">rrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.word_index.invert_index">
<tt class="descclassname">ibeis.model.hots.word_index.</tt><tt class="descname">invert_index</tt><big>(</big><em>vecs_list</em>, <em>ax_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#invert_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.invert_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregates descriptors of input annotations and returns inverted information</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.word_index.new_ibeis_windex">
<tt class="descclassname">ibeis.model.hots.word_index.</tt><tt class="descname">new_ibeis_windex</tt><big>(</big><em>ibs</em>, <em>daid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#new_ibeis_windex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.new_ibeis_windex" title="Permalink to this definition">¶</a></dt>
<dd><p>IBEIS interface into word_index</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.word_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windex</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_windex</span><span class="p">()</span> 
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.word_index.new_word_index">
<tt class="descclassname">ibeis.model.hots.word_index.</tt><tt class="descname">new_word_index</tt><big>(</big><em>aid_list=[]</em>, <em>vecs_list=[]</em>, <em>flann_params={}</em>, <em>flann_cachedir=None</em>, <em>indexer_cfgstr=''</em>, <em>hash_rowids=True</em>, <em>use_cache=True</em>, <em>use_params_hash=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#new_word_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.new_word_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.word_index.test_windex">
<tt class="descclassname">ibeis.model.hots.word_index.</tt><tt class="descname">test_windex</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#test_windex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.test_windex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.word_index.vlad">
<tt class="descclassname">ibeis.model.hots.word_index.</tt><tt class="descname">vlad</tt><big>(</big><em>qfx2_vec</em>, <em>qfx2_cvec</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#vlad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.vlad" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ibeis.model.hots" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.model.hots.reload_subs">
<tt class="descclassname">ibeis.model.hots.</tt><tt class="descname">reload_subs</tt><big>(</big><em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots.html#reload_subs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.reload_subs" title="Permalink to this definition">¶</a></dt>
<dd><p>Reloads ibeis.model.hots and submodules</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.rrrr">
<tt class="descclassname">ibeis.model.hots.</tt><tt class="descname">rrrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#ibeis.model.hots.rrrr" title="Permalink to this definition">¶</a></dt>
<dd><p>Reloads ibeis.model.hots and submodules</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">ibeis.model.hots package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.automated_helpers">ibeis.model.hots.automated_helpers module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.automated_matcher">ibeis.model.hots.automated_matcher module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.automated_oracle">ibeis.model.hots.automated_oracle module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.exceptions">ibeis.model.hots.exceptions module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.hots_query_result">ibeis.model.hots.hots_query_result module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.hstypes">ibeis.model.hots.hstypes module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.interactive_automated_matcher">ibeis.model.hots.interactive_automated_matcher module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.match_chips4">ibeis.model.hots.match_chips4 module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.multi_index">ibeis.model.hots.multi_index module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.name_scoring">ibeis.model.hots.name_scoring module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.neighbor_index">ibeis.model.hots.neighbor_index module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.nn_weights">ibeis.model.hots.nn_weights module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.pipeline">ibeis.model.hots.pipeline module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.precision_recall">ibeis.model.hots.precision_recall module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.query_helpers">ibeis.model.hots.query_helpers module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.query_request">ibeis.model.hots.query_request module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.score_normalization">ibeis.model.hots.score_normalization module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.special_query">ibeis.model.hots.special_query module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.voting_rules2">ibeis.model.hots.voting_rules2 module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.word_index">ibeis.model.hots.word_index module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots">Module contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ibeis.model.detect.html"
                        title="previous chapter">ibeis.model.detect package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ibeis.model.hots.smk.html"
                        title="next chapter">ibeis.model.hots.smk package</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/ibeis.model.hots.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ibeis.model.hots.smk.html" title="ibeis.model.hots.smk package"
             >next</a> |</li>
        <li class="right" >
          <a href="ibeis.model.detect.html" title="ibeis.model.detect package"
             >previous</a> |</li>
        <li><a href="index.html">ibeis 0.1.0.dev1 documentation</a> &raquo;</li>
          <li><a href="ibeis.html" >ibeis package</a> &raquo;</li>
          <li><a href="ibeis.model.html" >ibeis.model package</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Jon Crall.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>