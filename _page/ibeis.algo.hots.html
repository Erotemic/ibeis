

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ibeis.algo.hots package &mdash; ibeis 1.5.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ibeis 1.5.1 documentation" href="index.html"/>
        <link rel="up" title="ibeis.algo package" href="ibeis.algo.html"/>
        <link rel="next" title="ibeis.algo.hots.smk package" href="ibeis.algo.hots.smk.html"/>
        <link rel="prev" title="ibeis.algo.detect package" href="ibeis.algo.detect.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ibeis
          

          
          </a>

          
            
            
              <div class="version">
                1.5.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="ibeis.html">ibeis package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="ibeis.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="ibeis.algo.html">ibeis.algo package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="ibeis.algo.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="ibeis.algo.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="ibeis.algo.html#module-ibeis.algo.Config">ibeis.algo.Config module</a></li>
<li class="toctree-l4"><a class="reference internal" href="ibeis.algo.html#module-ibeis.algo">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ibeis.control.html">ibeis.control package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibeis.dbio.html">ibeis.dbio package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibeis.expt.html">ibeis.expt package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibeis.gui.html">ibeis.gui package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibeis.init.html">ibeis.init package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibeis.other.html">ibeis.other package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibeis.scripts.html">ibeis.scripts package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibeis.templates.html">ibeis.templates package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibeis.tests.html">ibeis.tests package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibeis.viz.html">ibeis.viz package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibeis.web.html">ibeis.web package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#module-ibeis.__main__">ibeis.__main__ module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#module-ibeis._devcmds_ibeis">ibeis._devcmds_ibeis module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#module-ibeis._devscript">ibeis._devscript module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#module-ibeis.all_imports">ibeis.all_imports module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#module-ibeis.annotmatch_funcs">ibeis.annotmatch_funcs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#module-ibeis.constants">ibeis.constants module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#module-ibeis.core_annots">ibeis.core_annots module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#module-ibeis.dev">ibeis.dev module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#module-ibeis.filter_configs">ibeis.filter_configs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#module-ibeis.ibsfuncs">ibeis.ibsfuncs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#module-ibeis.main_module">ibeis.main_module module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#module-ibeis.params">ibeis.params module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#module-ibeis.species">ibeis.species module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#module-ibeis.tag_funcs">ibeis.tag_funcs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#module-ibeis.workflow">ibeis.workflow module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.html#module-ibeis">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">ibeis</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="ibeis.html">ibeis package</a> &raquo;</li>
      
          <li><a href="ibeis.algo.html">ibeis.algo package</a> &raquo;</li>
      
    <li>ibeis.algo.hots package</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/ibeis.algo.hots.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ibeis-algo-hots-package">
<h1>ibeis.algo.hots package<a class="headerlink" href="#ibeis-algo-hots-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="ibeis.algo.hots.smk.html">ibeis.algo.hots.smk package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ibeis.algo.hots.smk.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.algo.hots.smk.html#module-ibeis.algo.hots.smk.smk_core">ibeis.algo.hots.smk.smk_core module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.algo.hots.smk.html#module-ibeis.algo.hots.smk.smk_debug">ibeis.algo.hots.smk.smk_debug module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.algo.hots.smk.html#module-ibeis.algo.hots.smk.smk_hamming">ibeis.algo.hots.smk.smk_hamming module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.algo.hots.smk.html#module-ibeis.algo.hots.smk.smk_index">ibeis.algo.hots.smk.smk_index module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.algo.hots.smk.html#module-ibeis.algo.hots.smk.smk_match">ibeis.algo.hots.smk.smk_match module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.algo.hots.smk.html#module-ibeis.algo.hots.smk.smk_plots">ibeis.algo.hots.smk.smk_plots module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.algo.hots.smk.html#module-ibeis.algo.hots.smk.smk_repr">ibeis.algo.hots.smk.smk_repr module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.algo.hots.smk.html#module-ibeis.algo.hots.smk.smk_residuals">ibeis.algo.hots.smk.smk_residuals module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.algo.hots.smk.html#module-ibeis.algo.hots.smk.smk_scoring">ibeis.algo.hots.smk.smk_scoring module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.algo.hots.smk.html#module-ibeis.algo.hots.smk">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-ibeis.algo.hots._grave_bayes">
<span id="ibeis-algo-hots-grave-bayes-module"></span><h2>ibeis.algo.hots._grave_bayes module<a class="headerlink" href="#module-ibeis.algo.hots._grave_bayes" title="Permalink to this headline">¶</a></h2>
<p>Arc reversal
<a class="reference external" href="http://www.cs.toronto.edu/~cebly/Papers/simulation.pdf">http://www.cs.toronto.edu/~cebly/Papers/simulation.pdf</a></p>
<dl class="docutils">
<dt>TODO:</dt>
<dd><p class="first">Need to find faster more mature libraries
<a class="reference external" href="http://dlib.net/bayes.html">http://dlib.net/bayes.html</a>
<a class="reference external" href="http://www.cs.waikato.ac.nz/ml/weka/">http://www.cs.waikato.ac.nz/ml/weka/</a>
<a class="reference external" href="http://www.cs.waikato.ac.nz/~remco/weka.bn.pdf">http://www.cs.waikato.ac.nz/~remco/weka.bn.pdf</a>
<a class="reference external" href="https://code.google.com/p/pebl-project/">https://code.google.com/p/pebl-project/</a>
<a class="reference external" href="https://github.com/abhik/pebl">https://github.com/abhik/pebl</a>
<a class="reference external" href="http://www.cs.ubc.ca/~murphyk/Software/bnsoft.html">http://www.cs.ubc.ca/~murphyk/Software/bnsoft.html</a></p>
<p class="last">Demo case where we think we know the labels of others.  Only one unknown
name. Need to classify it as one of the other known names.</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Bayesian_network">https://en.wikipedia.org/wiki/Bayesian_network</a>
<a class="reference external" href="https://class.coursera.org/pgm-003/lecture/17">https://class.coursera.org/pgm-003/lecture/17</a>
<a class="reference external" href="http://www.cs.ubc.ca/~murphyk/Bayes/bnintro.html">http://www.cs.ubc.ca/~murphyk/Bayes/bnintro.html</a>
<a class="reference external" href="http://www3.cs.stonybrook.edu/~sael/teaching/cse537/Slides/chapter14d_BP.pdf">http://www3.cs.stonybrook.edu/~sael/teaching/cse537/Slides/chapter14d_BP.pdf</a>
<a class="reference external" href="http://www.cse.unsw.edu.au/~cs9417ml/Bayes/Pages/PearlPropagation.html">http://www.cse.unsw.edu.au/~cs9417ml/Bayes/Pages/PearlPropagation.html</a>
<a class="reference external" href="https://github.com/pgmpy/pgmpy.git">https://github.com/pgmpy/pgmpy.git</a>
<a class="reference external" href="http://pgmpy.readthedocs.org/en/latest/">http://pgmpy.readthedocs.org/en/latest/</a>
<a class="reference external" href="http://nipy.bic.berkeley.edu:5000/download/11">http://nipy.bic.berkeley.edu:5000/download/11</a>
<a class="reference external" href="http://pgmpy.readthedocs.org/en/latest/wiki.html#add-feature-to-accept-and-output-state-names-for-models">http://pgmpy.readthedocs.org/en/latest/wiki.html#add-feature-to-accept-and-output-state-names-for-models</a>
<a class="reference external" href="http://www.csse.monash.edu.au/bai/book/BAI_Chapter2.pdf">http://www.csse.monash.edu.au/bai/book/BAI_Chapter2.pdf</a></p>
<dl class="docutils">
<dt>Clustering with CRF:</dt>
<dd><a class="reference external" href="http://srl.informatik.uni-freiburg.de/publicationsdir/tipaldiIROS09.pdf">http://srl.informatik.uni-freiburg.de/publicationsdir/tipaldiIROS09.pdf</a>
<a class="reference external" href="http://www.dis.uniroma1.it/~dottoratoii/media/students/documents/thesis_tipaldi.pdf">http://www.dis.uniroma1.it/~dottoratoii/media/students/documents/thesis_tipaldi.pdf</a>
An Unsupervised Conditional Random Fields Approach for Clustering Gene Expression Time Series
<a class="reference external" href="http://bioinformatics.oxfordjournals.org/content/24/21/2467.full">http://bioinformatics.oxfordjournals.org/content/24/21/2467.full</a></dd>
<dt>CRFs:</dt>
<dd><a class="reference external" href="http://homepages.inf.ed.ac.uk/csutton/publications/crftutv2.pdf">http://homepages.inf.ed.ac.uk/csutton/publications/crftutv2.pdf</a></dd>
<dt>AlphaBeta Swap:</dt>
<dd><p class="first"><a class="reference external" href="https://github.com/amueller/gco_python">https://github.com/amueller/gco_python</a>
<a class="reference external" href="https://github.com/pmneila/PyMaxflow">https://github.com/pmneila/PyMaxflow</a>
<a class="reference external" href="http://www.cs.cornell.edu/rdz/papers/bvz-iccv99.pdf">http://www.cs.cornell.edu/rdz/papers/bvz-iccv99.pdf</a></p>
<p class="last"><a class="reference external" href="http://arxiv.org/pdf/1411.6340.pdf">http://arxiv.org/pdf/1411.6340.pdf</a>  Iteratively Reweighted Graph Cut for Multi-label MRFs with Non-convex Priors</p>
</dd>
<dt>Fusion Moves:</dt>
<dd><a class="reference external" href="http://www.robots.ox.ac.uk/~vilem/fusion.pdf">http://www.robots.ox.ac.uk/~vilem/fusion.pdf</a>
<a class="reference external" href="http://hci.iwr.uni-heidelberg.de/publications/mip/techrep/beier_15_fusion.pdf">http://hci.iwr.uni-heidelberg.de/publications/mip/techrep/beier_15_fusion.pdf</a></dd>
</dl>
<p>Consensus Clustering</p>
<p>Explaining Away</p>
<dl class="docutils">
<dt>Course Notes:</dt>
<dd><p class="first">Tie breaking for MAP assignment.
<a class="reference external" href="https://class.coursera.org/pgm-003/lecture/60">https://class.coursera.org/pgm-003/lecture/60</a>
* random perdibiation</p>
<p>Correspondence Problem is discussed in
<a class="reference external" href="https://class.coursera.org/pgm-003/lecture/68">https://class.coursera.org/pgm-003/lecture/68</a></p>
<p>Sparse Pattern Factors</p>
<p class="last">Collective Inference:
Plate Models / Aggragator CPD is used to define dependencies.</p>
</dd>
</dl>
<dl class="function">
<dt id="ibeis.algo.hots._grave_bayes.flow">
<code class="descclassname">ibeis.algo.hots._grave_bayes.</code><code class="descname">flow</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_grave_bayes.html#flow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._grave_bayes.flow" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pmneila.github.io/PyMaxflow/maxflow.html#maxflow-fastmin">http://pmneila.github.io/PyMaxflow/maxflow.html#maxflow-fastmin</a></p>
<p>pip install PyMaxFlow
pip install pystruct
pip install hdbscan</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._grave_bayes.make_name_model">
<code class="descclassname">ibeis.algo.hots._grave_bayes.</code><code class="descname">make_name_model</code><span class="sig-paren">(</span><em>num_annots</em>, <em>num_names=None</em>, <em>verbose=True</em>, <em>mode=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_grave_bayes.html#make_name_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._grave_bayes.make_name_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the general name model</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.bayes --exec-make_name_model --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.bayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">num_annots</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_names</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kw</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">argparse_funckw</span><span class="p">(</span><span class="n">make_name_model</span><span class="p">,</span> <span class="n">defaults</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">make_name_model</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">show_prior</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._grave_bayes.name_model_mode1">
<code class="descclassname">ibeis.algo.hots._grave_bayes.</code><code class="descname">name_model_mode1</code><span class="sig-paren">(</span><em>num_annots</em>, <em>num_names=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_grave_bayes.html#name_model_mode1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._grave_bayes.name_model_mode1" title="Permalink to this definition">¶</a></dt>
<dd><p>spaghettii</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.bayes --exec-name_model_mode1 --show
python -m ibeis.algo.hots.bayes --exec-name_model_mode1
python -m ibeis.algo.hots.bayes --exec-name_model_mode1 --num-annots<span class="o">=</span>3
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.bayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">num_annots</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_names</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kw</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">argparse_funckw</span><span class="p">(</span><span class="n">name_model_mode1</span><span class="p">,</span> <span class="n">defaults</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">name_model_mode1</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">show_prior</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">show_title</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._grave_bayes.name_model_mode5">
<code class="descclassname">ibeis.algo.hots._grave_bayes.</code><code class="descname">name_model_mode5</code><span class="sig-paren">(</span><em>num_annots</em>, <em>num_names=None</em>, <em>verbose=True</em>, <em>mode=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_grave_bayes.html#name_model_mode5"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._grave_bayes.name_model_mode5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._grave_bayes.show_model">
<code class="descclassname">ibeis.algo.hots._grave_bayes.</code><code class="descname">show_model</code><span class="sig-paren">(</span><em>model</em>, <em>evidence={}</em>, <em>soft_evidence={}</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_grave_bayes.html#show_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._grave_bayes.show_model" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/22207802/pygraphviz-networkx-set-node-level-or-layer">http://stackoverflow.com/questions/22207802/pygraphviz-networkx-set-node-level-or-layer</a></p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._grave_bayes.try_query">
<code class="descclassname">ibeis.algo.hots._grave_bayes.</code><code class="descname">try_query</code><span class="sig-paren">(</span><em>model</em>, <em>infr</em>, <em>evidence</em>, <em>interest_ttypes=[]</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_grave_bayes.html#try_query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._grave_bayes.try_query" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.bayes --exec-try_query --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.bayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other_evidence</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_evidence</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_evidence</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;high&#39;</span><span class="p">,</span> <span class="s">&#39;low&#39;</span><span class="p">,</span> <span class="s">&#39;low&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query_vars</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">make_name_model</span><span class="p">(</span><span class="n">num_annots</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_names</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">evidence</span><span class="p">,</span> <span class="n">soft_evidence</span> <span class="o">=</span> <span class="n">update_model_evidence</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">name_evidence</span><span class="p">,</span> <span class="n">score_evidence</span><span class="p">,</span> <span class="n">other_evidence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interest_ttypes</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infr</span> <span class="o">=</span> <span class="n">pgmpy</span><span class="o">.</span><span class="n">inference</span><span class="o">.</span><span class="n">BeliefPropagation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evidence</span> <span class="o">=</span> <span class="n">infr</span><span class="o">.</span><span class="n">_ensure_internal_evidence</span><span class="p">(</span><span class="n">evidence</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query_results</span> <span class="o">=</span> <span class="n">try_query</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">infr</span><span class="p">,</span> <span class="n">evidence</span><span class="p">,</span> <span class="n">interest_ttypes</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;query_results = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">query_results</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">show_prior</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">query_results</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="ibeis-algo-hots-grave-scorenorm-module">
<h2>ibeis.algo.hots._grave_scorenorm module<a class="headerlink" href="#ibeis-algo-hots-grave-scorenorm-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-ibeis.algo.hots._neighbor_experiment">
<span id="ibeis-algo-hots-neighbor-experiment-module"></span><h2>ibeis.algo.hots._neighbor_experiment module<a class="headerlink" href="#module-ibeis.algo.hots._neighbor_experiment" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.algo.hots._neighbor_experiment.augment_nnindexer_experiment">
<code class="descclassname">ibeis.algo.hots._neighbor_experiment.</code><code class="descname">augment_nnindexer_experiment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_neighbor_experiment.html#augment_nnindexer_experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._neighbor_experiment.augment_nnindexer_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://answers.opencv.org/question/44592/flann-index-training-fails-with-segfault/">http://answers.opencv.org/question/44592/flann-index-training-fails-with-segfault/</a></p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>utprof.py -m ibeis.algo.hots._neighbor_experiment --test-augment_nnindexer_experiment
python -m ibeis.algo.hots._neighbor_experiment --test-augment_nnindexer_experiment

python -m ibeis.algo.hots._neighbor_experiment --test-augment_nnindexer_experiment --db PZ_MTEST --diskshow --adjust<span class="o">=</span>.1 --save <span class="s2">&quot;augment_experiment_{db}.png&quot;</span> --dpath<span class="o">=</span><span class="s1">&#39;.&#39;</span> --dpi<span class="o">=</span><span class="m">180</span> --figsize<span class="o">=</span>9,6
python -m ibeis.algo.hots._neighbor_experiment --test-augment_nnindexer_experiment --db PZ_Master0 --diskshow --adjust<span class="o">=</span>.1 --save <span class="s2">&quot;augment_experiment_{db}.png&quot;</span> --dpath<span class="o">=</span><span class="s1">&#39;.&#39;</span> --dpi<span class="o">=</span><span class="m">180</span> --figsize<span class="o">=</span>9,6 --nosave-flann --show
python -m ibeis.algo.hots._neighbor_experiment --test-augment_nnindexer_experiment --db PZ_Master0 --diskshow --adjust<span class="o">=</span>.1 --save <span class="s2">&quot;augment_experiment_{db}.png&quot;</span> --dpath<span class="o">=</span><span class="s1">&#39;.&#39;</span> --dpi<span class="o">=</span><span class="m">180</span> --figsize<span class="o">=</span>9,6 --nosave-flann --show


python -m ibeis.algo.hots._neighbor_experiment --test-augment_nnindexer_experiment --db PZ_Master0 --diskshow --adjust<span class="o">=</span>.1 --save <span class="s2">&quot;augment_experiment_{db}.png&quot;</span> --dpath<span class="o">=</span><span class="s1">&#39;.&#39;</span> --dpi<span class="o">=</span><span class="m">180</span> --figsize<span class="o">=</span>9,6 --nosave-flann --no-api-cache --nocache-uuids

python -m ibeis.algo.hots._neighbor_experiment --test-augment_nnindexer_experiment --db PZ_MTEST --show
python -m ibeis.algo.hots._neighbor_experiment --test-augment_nnindexer_experiment --db PZ_Master0 --show

<span class="c"># RUNS THE SEGFAULTING CASE</span>
python -m ibeis.algo.hots._neighbor_experiment --test-augment_nnindexer_experiment --db PZ_Master0 --show
<span class="c"># Debug it</span>
gdb python
run -m ibeis.algo.hots._neighbor_experiment --test-augment_nnindexer_experiment --db PZ_Master0 --show
gdb python
run -m ibeis.algo.hots._neighbor_experiment --test-augment_nnindexer_experiment --db PZ_Master0 --diskshow --adjust<span class="o">=</span>.1 --save <span class="s2">&quot;augment_experiment_{db}.png&quot;</span> --dpath<span class="o">=</span><span class="s1">&#39;.&#39;</span> --dpi<span class="o">=</span><span class="m">180</span> --figsize<span class="o">=</span>9,6
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots._neighbor_experiment</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">augment_nnindexer_experiment</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._neighbor_experiment.flann_add_time_experiment">
<code class="descclassname">ibeis.algo.hots._neighbor_experiment.</code><code class="descname">flann_add_time_experiment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_neighbor_experiment.html#flann_add_time_experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._neighbor_experiment.flann_add_time_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>builds plot of number of annotations vs indexer build time.</p>
<p>TODO: time experiment</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots._neighbor_experiment --test-flann_add_time_experiment --db PZ_MTEST --show
python -m ibeis.algo.hots._neighbor_experiment --test-flann_add_time_experiment --db PZ_Master0 --show
utprof.py -m ibeis.algo.hots._neighbor_experiment --test-flann_add_time_experiment --show

valgrind --tool<span class="o">=</span>memcheck --suppressions<span class="o">=</span>valgrind-python.supp python -m ibeis.algo.hots._neighbor_experiment --test-flann_add_time_experiment --db PZ_MTEST --no-with-reindex
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots._neighbor_experiment</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#ibs = ibeis.opendb(&#39;PZ_MTEST&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">flann_add_time_experiment</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._neighbor_experiment.pyflann_remove_and_save">
<code class="descclassname">ibeis.algo.hots._neighbor_experiment.</code><code class="descname">pyflann_remove_and_save</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_neighbor_experiment.html#pyflann_remove_and_save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._neighbor_experiment.pyflann_remove_and_save" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p># Logic goes here
~/code/flann/src/cpp/flann/algorithms/kdtree_index.h</p>
<p>~/code/flann/src/cpp/flann/util/serialization.h
~/code/flann/src/cpp/flann/util/dynamic_bitset.h</p>
<p># Bindings go here
~/code/flann/src/cpp/flann/flann.cpp
~/code/flann/src/cpp/flann/flann.h</p>
<p># Contains stuff for the flann namespace like flann::log_level
# Also has Index with
# Matrix&lt;ElementType&gt; features; SEEMS USEFUL
~/code/flann/src/cpp/flann/flann.hpp</p>
<p># Wrappers go here
~/code/flann/src/python/pyflann/flann_ctypes.py
~/code/flann/src/python/pyflann/index.py</p>
<p>~/local/build_scripts/flannscripts/autogen_bindings.py</p>
<dl class="docutils">
<dt>Greping:</dt>
<dd>cd ~/code/flann/src
grep -ER cleanRemovedPoints *
grep -ER <a href="#id1"><span class="problematic" id="id2">removed_points_</span></a> *</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots._neighbor_experiment --exec-pyflann_remove_and_save
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots._neighbor_experiment</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyflann_remove_and_save</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._neighbor_experiment.pyflann_test_remove_add">
<code class="descclassname">ibeis.algo.hots._neighbor_experiment.</code><code class="descname">pyflann_test_remove_add</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_neighbor_experiment.html#pyflann_test_remove_add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._neighbor_experiment.pyflann_test_remove_add" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots._neighbor_experiment --exec-pyflann_test_remove_add
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots._neighbor_experiment</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyflann_test_remove_add</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._neighbor_experiment.pyflann_test_remove_add2">
<code class="descclassname">ibeis.algo.hots._neighbor_experiment.</code><code class="descname">pyflann_test_remove_add2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_neighbor_experiment.html#pyflann_test_remove_add2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._neighbor_experiment.pyflann_test_remove_add2" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots._neighbor_experiment --exec-pyflann_test_remove_add2
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots._neighbor_experiment</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyflann_test_remove_add2</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._neighbor_experiment.subindexer_time_experiment">
<code class="descclassname">ibeis.algo.hots._neighbor_experiment.</code><code class="descname">subindexer_time_experiment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_neighbor_experiment.html#subindexer_time_experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._neighbor_experiment.subindexer_time_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>builds plot of number of annotations vs indexer build time.</p>
<p>TODO: time experiment</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._neighbor_experiment.test_incremental_add">
<code class="descclassname">ibeis.algo.hots._neighbor_experiment.</code><code class="descname">test_incremental_add</code><span class="sig-paren">(</span><em>ibs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_neighbor_experiment.html#test_incremental_add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._neighbor_experiment.test_incremental_add" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; </td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots._neighbor_experiment --test-test_incremental_add
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index_cache</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">test_incremental_add</span><span class="p">(</span><span class="n">ibs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._neighbor_experiment.test_multiple_add_removes">
<code class="descclassname">ibeis.algo.hots._neighbor_experiment.</code><code class="descname">test_multiple_add_removes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_neighbor_experiment.html#test_multiple_add_removes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._neighbor_experiment.test_multiple_add_removes" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots._neighbor_experiment --exec-test_multiple_add_removes
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots._neighbor_experiment</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">test_multiple_add_removes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots._pipeline_helpers">
<span id="ibeis-algo-hots-pipeline-helpers-module"></span><h2>ibeis.algo.hots._pipeline_helpers module<a class="headerlink" href="#module-ibeis.algo.hots._pipeline_helpers" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.algo.hots._pipeline_helpers.print_nearest_neighbor_assignments">
<code class="descclassname">ibeis.algo.hots._pipeline_helpers.</code><code class="descname">print_nearest_neighbor_assignments</code><span class="sig-paren">(</span><em>qvecs_list</em>, <em>nns_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_pipeline_helpers.html#print_nearest_neighbor_assignments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._pipeline_helpers.print_nearest_neighbor_assignments" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._pipeline_helpers.testdata_matching">
<code class="descclassname">ibeis.algo.hots._pipeline_helpers.</code><code class="descname">testdata_matching</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_pipeline_helpers.html#testdata_matching"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._pipeline_helpers.testdata_matching" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots._pipeline_helpers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._pipeline_helpers.testdata_post_sver">
<code class="descclassname">ibeis.algo.hots._pipeline_helpers.</code><code class="descname">testdata_post_sver</code><span class="sig-paren">(</span><em>defaultdb=u'PZ_MTEST'</em>, <em>qaid_list=None</em>, <em>daid_list=None</em>, <em>codename=u'vsmany'</em>, <em>cfgdict=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_pipeline_helpers.html#testdata_post_sver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._pipeline_helpers.testdata_post_sver" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots._pipeline_helpers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._pipeline_helpers.testdata_pre">
<code class="descclassname">ibeis.algo.hots._pipeline_helpers.</code><code class="descname">testdata_pre</code><span class="sig-paren">(</span><em>stopnode, defaultdb=u'testdb1', p=[u'default'], a=[u'default:qindex=0:1,dindex=0:5'], **kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_pipeline_helpers.html#testdata_pre"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._pipeline_helpers.testdata_pre" title="Permalink to this definition">¶</a></dt>
<dd><p>New (1-1-2016) generic pipeline node testdata getter</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>stopnode</strong> (<em>str</em>) &#8211; </li>
<li><strong>defaultdb</strong> (<em>str</em>) &#8211; (default = u&#8217;testdb1&#8217;)</li>
<li><strong>p</strong> (<em>list</em>) &#8211; (default = [u&#8217;default:&#8217;])</li>
<li><strong>a</strong> (<em>list</em>) &#8211; (default = [u&#8217;default:qsize=1,dsize=4&#8217;])</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(ibs, <a href="#id3"><span class="problematic" id="id4">qreq_</span></a>, args)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots._pipeline_helpers --exec-testdata_pre --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots._pipeline_helpers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stopnode</span> <span class="o">=</span> <span class="s">&#39;build_chipmatches&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">defaultdb</span> <span class="o">=</span> <span class="s">&#39;testdb1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;default:&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;default:qindex=0:1,dindex=0:5&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">testdata_pre</span><span class="p">(</span><span class="n">stopnode</span><span class="p">,</span> <span class="n">defaultdb</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._pipeline_helpers.testdata_pre_baselinefilter">
<code class="descclassname">ibeis.algo.hots._pipeline_helpers.</code><code class="descname">testdata_pre_baselinefilter</code><span class="sig-paren">(</span><em>defaultdb=u'testdb1'</em>, <em>qaid_list=None</em>, <em>daid_list=None</em>, <em>codename=u'vsmany'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_pipeline_helpers.html#testdata_pre_baselinefilter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._pipeline_helpers.testdata_pre_baselinefilter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._pipeline_helpers.testdata_pre_sver">
<code class="descclassname">ibeis.algo.hots._pipeline_helpers.</code><code class="descname">testdata_pre_sver</code><span class="sig-paren">(</span><em>defaultdb=u'PZ_MTEST'</em>, <em>qaid_list=None</em>, <em>daid_list=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_pipeline_helpers.html#testdata_pre_sver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._pipeline_helpers.testdata_pre_sver" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots._pipeline_helpers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._pipeline_helpers.testdata_pre_vsonerr">
<code class="descclassname">ibeis.algo.hots._pipeline_helpers.</code><code class="descname">testdata_pre_vsonerr</code><span class="sig-paren">(</span><em>defaultdb=u'PZ_MTEST', qaid_list=[1], daid_list=u'all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_pipeline_helpers.html#testdata_pre_vsonerr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._pipeline_helpers.testdata_pre_vsonerr" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots._pipeline_helpers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._pipeline_helpers.testdata_pre_weight_neighbors">
<code class="descclassname">ibeis.algo.hots._pipeline_helpers.</code><code class="descname">testdata_pre_weight_neighbors</code><span class="sig-paren">(</span><em>defaultdb=u'testdb1', qaid_list=[1, 2], daid_list=None, codename=u'vsmany', cfgdict=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_pipeline_helpers.html#testdata_pre_weight_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._pipeline_helpers.testdata_pre_weight_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>TODO: replace testdata_pre_weight_neighbors with</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre</span><span class="p">(</span><span class="s">&#39;weight_neighbors&#39;</span><span class="p">,</span> <span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                               <span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:qindex=0:1,dindex=0:5,hackerrors=False&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                               <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:codename=vsmany,bar_l2_on=True,fg_on=False&#39;</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._pipeline_helpers.testdata_scoring">
<code class="descclassname">ibeis.algo.hots._pipeline_helpers.</code><code class="descname">testdata_scoring</code><span class="sig-paren">(</span><em>defaultdb=u'PZ_MTEST', qaid_list=[1], daid_list=u'all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_pipeline_helpers.html#testdata_scoring"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._pipeline_helpers.testdata_scoring" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._pipeline_helpers.testdata_sparse_matchinfo_nonagg">
<code class="descclassname">ibeis.algo.hots._pipeline_helpers.</code><code class="descname">testdata_sparse_matchinfo_nonagg</code><span class="sig-paren">(</span><em>defaultdb=u'testdb1', p=[u'default']</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_pipeline_helpers.html#testdata_sparse_matchinfo_nonagg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._pipeline_helpers.testdata_sparse_matchinfo_nonagg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots._pipeline_helpers.testrun_pipeline_upto">
<code class="descclassname">ibeis.algo.hots._pipeline_helpers.</code><code class="descname">testrun_pipeline_upto</code><span class="sig-paren">(</span><em>qreq_</em>, <em>stop_node=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/_pipeline_helpers.html#testrun_pipeline_upto"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots._pipeline_helpers.testrun_pipeline_upto" title="Permalink to this definition">¶</a></dt>
<dd><p>Main tester function. Runs the pipeline by mirroring
<cite>request_ibeis_query_L0</cite>, but stops at a requested breakpoint and returns
the local variables.</p>
<p>convinience: runs pipeline for tests
this should mirror request_ibeis_query_L0</p>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.automatch_suggestor">
<span id="ibeis-algo-hots-automatch-suggestor-module"></span><h2>ibeis.algo.hots.automatch_suggestor module<a class="headerlink" href="#module-ibeis.algo.hots.automatch_suggestor" title="Permalink to this headline">¶</a></h2>
<p>Reports decisions and confidences about names (identifications) and
exemplars using query results objects.</p>
<dl class="class">
<dt id="ibeis.algo.hots.automatch_suggestor.ChoiceTuple">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.automatch_suggestor.</code><code class="descname">ChoiceTuple</code><span class="sig-paren">(</span><em>sorted_nids</em>, <em>sorted_nscore</em>, <em>sorted_rawscore</em>, <em>sorted_aids</em>, <em>sorted_ascores</em><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.ChoiceTuple" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="method">
<dt id="ibeis.algo.hots.automatch_suggestor.ChoiceTuple.__getnewargs__">
<code class="descname">__getnewargs__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.ChoiceTuple.__getnewargs__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return self as a plain tuple.  Used by copy and pickle.</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.automatch_suggestor.ChoiceTuple.__getstate__">
<code class="descname">__getstate__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.ChoiceTuple.__getstate__" title="Permalink to this definition">¶</a></dt>
<dd><p>Exclude the OrderedDict from pickling</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.automatch_suggestor.ChoiceTuple.__repr__">
<code class="descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.ChoiceTuple.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a nicely formatted representation string</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.automatch_suggestor.ChoiceTuple.sorted_aids">
<code class="descname">sorted_aids</code><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.ChoiceTuple.sorted_aids" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.automatch_suggestor.ChoiceTuple.sorted_ascores">
<code class="descname">sorted_ascores</code><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.ChoiceTuple.sorted_ascores" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.automatch_suggestor.ChoiceTuple.sorted_nids">
<code class="descname">sorted_nids</code><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.ChoiceTuple.sorted_nids" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.automatch_suggestor.ChoiceTuple.sorted_nscore">
<code class="descname">sorted_nscore</code><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.ChoiceTuple.sorted_nscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.automatch_suggestor.ChoiceTuple.sorted_rawscore">
<code class="descname">sorted_rawscore</code><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.ChoiceTuple.sorted_rawscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ibeis.algo.hots.automatch_suggestor.ExemplarDecision">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.automatch_suggestor.</code><code class="descname">ExemplarDecision</code><span class="sig-paren">(</span><em>new_exemplar_aids</em>, <em>remove_exemplar_aids</em><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.ExemplarDecision" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="method">
<dt id="ibeis.algo.hots.automatch_suggestor.ExemplarDecision.__getnewargs__">
<code class="descname">__getnewargs__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.ExemplarDecision.__getnewargs__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return self as a plain tuple.  Used by copy and pickle.</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.automatch_suggestor.ExemplarDecision.__getstate__">
<code class="descname">__getstate__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.ExemplarDecision.__getstate__" title="Permalink to this definition">¶</a></dt>
<dd><p>Exclude the OrderedDict from pickling</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.automatch_suggestor.ExemplarDecision.__repr__">
<code class="descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.ExemplarDecision.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a nicely formatted representation string</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.automatch_suggestor.ExemplarDecision.new_exemplar_aids">
<code class="descname">new_exemplar_aids</code><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.ExemplarDecision.new_exemplar_aids" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.automatch_suggestor.ExemplarDecision.remove_exemplar_aids">
<code class="descname">remove_exemplar_aids</code><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.ExemplarDecision.remove_exemplar_aids" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automatch_suggestor.exemplar_method1_distinctiveness">
<code class="descclassname">ibeis.algo.hots.automatch_suggestor.</code><code class="descname">exemplar_method1_distinctiveness</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid</em>, <em>other_exemplars</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automatch_suggestor.html#exemplar_method1_distinctiveness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.exemplar_method1_distinctiveness" title="Permalink to this definition">¶</a></dt>
<dd><p>choose as exemplar if it is distinctive with respect to other exemplars</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automatch_suggestor.exemplar_method2_randomness">
<code class="descclassname">ibeis.algo.hots.automatch_suggestor.</code><code class="descname">exemplar_method2_randomness</code><span class="sig-paren">(</span><em>qaid</em>, <em>other_exemplars</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automatch_suggestor.html#exemplar_method2_randomness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.exemplar_method2_randomness" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.automatch_suggestor --test-exemplar_method2_randomness
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automatch_suggestor</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other_exemplars</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exemplar_decision</span> <span class="o">=</span> <span class="n">exemplar_method2_randomness</span><span class="p">(</span><span class="n">qaid</span><span class="p">,</span> <span class="n">other_exemplars</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exemplar_decision_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">exemplar_method2_randomness</span><span class="p">(</span><span class="n">qaid</span><span class="p">,</span> <span class="n">other_exemplars</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flat_others</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_list_column</span><span class="p">(</span><span class="n">exemplar_decision_list</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flat_others</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[3, 2, 6, 1, 3, 2, 9, 3, 6, 2, 1, 5, 1, 6, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automatch_suggestor.get_qres_name_choices">
<code class="descclassname">ibeis.algo.hots.automatch_suggestor.</code><code class="descname">get_qres_name_choices</code><span class="sig-paren">(</span><em>ibs</em>, <em>cm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automatch_suggestor.html#get_qres_name_choices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.get_qres_name_choices" title="Permalink to this definition">¶</a></dt>
<dd><p>returns all possible decision a user could make</p>
<p>TODO: Return the possiblity of a merge.
TODO: Ensure that the total probability of each possible choice sums to 1.
This will define a probability density function that we can take advantage
of</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; ibeis controller object</li>
<li><strong>cm</strong> (<em>QueryResult</em>) &#8211; object of feature correspondences and scores</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">choicetup</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#ibeis.algo.hots.automatch_suggestor.ChoiceTuple" title="ibeis.algo.hots.automatch_suggestor.ChoiceTuple">ChoiceTuple</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.automatch_suggestor --test-get_qres_name_choices:0
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automatch_suggestor</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cm</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">choicetup</span> <span class="o">=</span> <span class="n">get_qres_name_choices</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">cm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">choicetup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">choicetup</span><span class="o">.</span><span class="n">sorted_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="n">force_dtype</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([1])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automatch_suggestor.get_system_exemplar_suggestion">
<code class="descclassname">ibeis.algo.hots.automatch_suggestor.</code><code class="descname">get_system_exemplar_suggestion</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automatch_suggestor.html#get_system_exemplar_suggestion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.get_system_exemplar_suggestion" title="Permalink to this definition">¶</a></dt>
<dd><p>hotspotter returns an exemplar suggestion</p>
<dl class="docutils">
<dt>TODO:</dt>
<dd>do a vsone query between all of the exemplars to see if this one is good
enough to be added.</dd>
<dt>TODO:</dt>
<dd>build a complete graph of exemplar scores and only add if this one is
lower than any other edge</dd>
<dt>SeeAlso:</dt>
<dd>ibsfuncs.set_exemplars_from_quality_and_viewpoint</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.automatch_suggestor --test-get_system_exemplar_suggestion:1
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automatch_suggestor</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">autoexmplr_msg</span><span class="p">,</span> <span class="n">exemplar_decision</span><span class="p">,</span> <span class="n">exemplar_confidence</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_system_exemplar_suggestion</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">autoexmplr_msg</span><span class="p">,</span> <span class="n">exemplar_decision</span><span class="p">,</span> <span class="n">exemplar_confidence</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automatch_suggestor</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">autoexmplr_msg</span><span class="p">,</span> <span class="n">exemplar_decision</span><span class="p">,</span> <span class="n">exemplar_confidence</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_system_exemplar_suggestion</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">autoexmplr_msg</span><span class="p">,</span> <span class="n">exemplar_decision</span><span class="p">,</span> <span class="n">exemplar_confidence</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automatch_suggestor.get_system_name_suggestion">
<code class="descclassname">ibeis.algo.hots.automatch_suggestor.</code><code class="descname">get_system_name_suggestion</code><span class="sig-paren">(</span><em>ibs</em>, <em>choicetup</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automatch_suggestor.html#get_system_name_suggestion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automatch_suggestor.get_system_name_suggestion" title="Permalink to this definition">¶</a></dt>
<dd><p>Suggests a decision based on the current choices</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; </li>
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation id</li>
<li><strong>cm</strong> (<em>QueryResult</em>) &#8211; object of feature correspondences and scores</li>
<li><strong>metatup</strong> (<em>None</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(autoname_msg, autoname_func)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.automated_matcher --test-test_incremental_queries:0
python -m ibeis.algo.hots.automated_matcher --test-test_incremental_queries:1
python -m ibeis.algo.hots.automated_matcher --test-get_system_name_suggestion
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automatch_suggestor</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cm</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">choicetup</span> <span class="o">=</span> <span class="n">get_qres_name_choices</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">cm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">autoname_msg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">name_confidence</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_system_name_suggestion</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">choicetup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">autoname_msg</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">name_confidence</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.automated_helpers">
<span id="ibeis-algo-hots-automated-helpers-module"></span><h2>ibeis.algo.hots.automated_helpers module<a class="headerlink" href="#module-ibeis.algo.hots.automated_helpers" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>Idea:</dt>
<dd>what about the probability of a descriptor match being a score like in SIFT.
we can learn that too.</dd>
<dt>Have:</dt>
<dd><ul class="first simple">
<li>semantic and visual uuids</li>
<li>Test that accepts unknown annotations one at a time and
for each runs query, makes decision about name, and executes decision.</li>
<li>As a placeholder for exemplar decisions  an exemplar is added if
number of exemplars per name is less than threshold.</li>
<li>vs-one reranking query mode</li>
<li>test harness but start with larger test set</li>
<li>vs-one score normalizer ~~/ score normalizer for different values of K * / different params~~
vs-many score normalization doesnt actually matter. We just need the ranking.</li>
<li>need to add in the multi-indexer code into the pipeline. Need to
decide which subindexers to load given a set of daids</li>
<li>need to use set query as an exemplar if its vs-one reranking scores
are below a threshold</li>
<li>flip the vsone ratio score so its &lt; .8 rather than &gt; 1.2 or whatever</li>
<li>start from nothing and let the system make the first few decisions correctly</li>
<li>tell me the correct answer in the automated test</li>
<li>turn on multi-indexing. (should just work..., probably bugs though. Just need to throw the switch)</li>
<li>paramater to only add exemplar if post-normlized score is above a threshold</li>
<li>ensure vsone ratio test is happening correctly</li>
<li>normalization gets a cfgstr based on the query</li>
<li>need to allow for scores to be un-invalidatd post spatial verification
e.g. when the first match initially is invalidated through
spatial verification but the next matches survive.</li>
<li>keep distinctiveness weights from vsmany for vsone weighting
basically involves keeping weights from different filters and not
aggregating match weights until the end.</li>
<li>Put test query mode into the main application and work on the interface for it.</li>
<li>add matches to multiple animals (merge)</li>
<li>update normalizer (have setup the datastructure to allow for it need to integrate it seemlessly)</li>
<li>score normalization update. on add the new support data, reapply bayes</li>
</ul>
<blockquote>
<div>rule, and save to the current cache for a given algorithm configuration.</div></blockquote>
<ul class="last simple">
<li>spawn background process to reindex chunks of data</li>
</ul>
</dd>
<dt>TODO:</dt>
<dd><ul class="first last simple">
<li>Improve vsone scoring.</li>
<li>test case where there is a 360 view that is linkable from the tests case</li>
<li>~~Remember name_confidence of decisions for manual review~~ Defer</li>
</ul>
</dd>
</dl>
<p>Tasks:</p>
<blockquote>
<div><dl class="docutils">
<dt>Algorithm::</dt>
<dd><blockquote class="first">
<div><ul>
<li><dl class="first docutils">
<dt>Incremental query needs to handle</dt>
<dd><ul class="first last">
<li><p class="first">test mode and live mode</p>
</li>
<li><p class="first">normalizer update</p>
</li>
<li><p class="first">use correct distinctivenes score in vsone</p>
</li>
<li><dl class="first docutils">
<dt>tested application of distinctiveness, foreground, ratio,</dt>
<dd><p class="first last">spatial_verification, vsone verification, and score
normalization.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Mathematically formal description of the space of choices</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>getting the proability of each choice will give us a much better</dt>
<dd><p class="first last">confidence measure for our decision. An example of a probability
partition might be .2 - merge with rank1.  .2 merge with rank 2, .5
merge with rank1 and rank2, .1 others</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Improved automated exemplar decision mechanism</p>
</li>
<li><p class="first">Improved automated name decision mechanism</p>
</li>
</ul>
</div></blockquote>
<dl class="last docutils">
<dt>SQL::</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>New Image Columns</dt>
<dd><ul class="first last simple">
<li>image_posix_timedelta</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>New Name Columns</dt>
<dd><ul class="first last simple">
<li>name_temp_flag</li>
<li>name_alias_text</li>
<li>name_uuid</li>
<li>name_visual_uuid</li>
<li>name_member_annot_rowids_evalstr</li>
<li>name_member_num_annot_rowids</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>New ImageSet Columns</dt>
<dd><ul class="first last simple">
<li>imageset_start_time</li>
<li>imageset_end_time</li>
<li>imageset_lat</li>
<li>imageset_lon</li>
<li>imageset_processed_flag</li>
<li>imageset_shipped_flag</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
<dt>Decision UIs::</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>Query versus top N results</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>ability to draw an undirected edge between the query and any number of</dt>
<dd><p class="first last">results. ie create a match any of the top results</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>a match to more than one results should by default merge the two names</dt>
<dd><p class="first last">(this involves a name enhancement subtask). trigger a split / merge dialog</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Is Exemplar</dt>
<dd><ul class="first last simple">
<li>allows for user to set the exemplars for a given name</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Name Progress</dt>
<dd><ul class="first last simple">
<li>Shows the current name matching progress</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Split</dt>
<dd><ul class="first last simple">
<li>Allows a user to split off some images from a name into a new name
or some other name.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Merge</dt>
<dd><ul class="first last simple">
<li>Allows a user to join two names.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>GUI::</dt>
<dd><ul class="first last">
<li><p class="first">NameTree needs to not refresh unless absolutely necessary</p>
</li>
<li><p class="first">Time Sync</p>
</li>
<li><p class="first">ImageSet metadata sync from the SMART</p>
</li>
<li><dl class="first docutils">
<dt>Hide shipped imagesets</dt>
<dd><ul class="first last simple">
<li>put flag to turn them on</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Mark processed imagesets</p>
</li>
<li><dl class="first docutils">
<dt>Gui naturally ensures that all annotations in the query belong</dt>
<dd><p class="first last">to the same species</p>
</dd>
</dl>
</li>
<li><p class="first">Garbage collection function that removes all non-exemplar
information from imagesets that have been shipped.</p>
</li>
<li><p class="first">Spawn process that reindexes large chunks of descriptors as the
database grows.</p>
</li>
</ul>
</dd>
</dl>
</div></blockquote>
<p>LONG TERM TASKS:</p>
<blockquote>
<div><dl class="docutils">
<dt>Architecture:</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>Pipeline needs</dt>
<dd><ul class="first last simple">
<li>DEFER: a move from dict based representation to list based</li>
<li>DEFER: spatial verification cyth speedup</li>
<li>DEFER: nearest neighbor (based on visual uuid caching) caching</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Controller:</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>LONGTERM: AutogenController</dt>
<dd><ul class="first last simple">
<li>register data convertors for verts / other eval columns. Make
several convertors standard and we can tag those columns to
autogenerate their functions.</li>
<li>be able to mark a column as determined by the aggregate of other
columns. Then the data is either generated on the fly, or it is
cached and the necessary book-keeping functions are
autogenerated.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Decision UIs::</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>Is Exemplar</dt>
<dd><ul class="first last simple">
<li>LONG TERM: it would be cool if they were visualized by using
networkx or some gephi like program and clustered by match score.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</div></blockquote>
<dl class="function">
<dt id="ibeis.algo.hots.automated_helpers.add_annot_chunk">
<code class="descclassname">ibeis.algo.hots.automated_helpers.</code><code class="descname">add_annot_chunk</code><span class="sig-paren">(</span><em>ibs_gt</em>, <em>ibs2</em>, <em>aids_chunk1</em>, <em>aid1_to_aid2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_helpers.html#add_annot_chunk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_helpers.add_annot_chunk" title="Permalink to this definition">¶</a></dt>
<dd><p>adds annotations to the tempoarary database and prevents duplicate
additions.</p>
<p>aids_chunk1 = aid_list1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs_gt</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; </li>
<li><strong>ibs2</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; </li>
<li><strong>aids_chunk1</strong> (<em>list</em>) &#8211; </li>
<li><strong>aid1_to_aid2</strong> (<em>dict</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">aids_chunk2</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_helpers.annot_testdb_consistency_checks">
<code class="descclassname">ibeis.algo.hots.automated_helpers.</code><code class="descname">annot_testdb_consistency_checks</code><span class="sig-paren">(</span><em>ibs_gt</em>, <em>ibs2</em>, <em>aid_list1</em>, <em>aid_list2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_helpers.html#annot_testdb_consistency_checks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_helpers.annot_testdb_consistency_checks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_helpers.assert_testdb_annot_consistency">
<code class="descclassname">ibeis.algo.hots.automated_helpers.</code><code class="descname">assert_testdb_annot_consistency</code><span class="sig-paren">(</span><em>ibs_gt</em>, <em>ibs2</em>, <em>aid_list1</em>, <em>aid_list2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_helpers.html#assert_testdb_annot_consistency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_helpers.assert_testdb_annot_consistency" title="Permalink to this definition">¶</a></dt>
<dd><p>just tests uuids</p>
<dl class="docutils">
<dt>if anything goes wrong this should fix it:</dt>
<dd>from ibeis import ibsfuncs
aid_list1 = ibs_gt.get_valid_aids()
ibs_gt.update_annot_visual_uuids(aid_list1)
ibs2.update_annot_visual_uuids(aid_list2)
ibsfuncs.fix_remove_visual_dupliate_annotations(ibs_gt)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_helpers.check_results">
<code class="descclassname">ibeis.algo.hots.automated_helpers.</code><code class="descname">check_results</code><span class="sig-paren">(</span><em>ibs_gt</em>, <em>ibs2</em>, <em>aid1_to_aid2</em>, <em>aids_list1_</em>, <em>incinfo</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_helpers.html#check_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_helpers.check_results" title="Permalink to this definition">¶</a></dt>
<dd><p>reports how well the incremental query ran when the oracle was calling the
shots.</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_helpers.ensure_testdb_clean_data">
<code class="descclassname">ibeis.algo.hots.automated_helpers.</code><code class="descname">ensure_testdb_clean_data</code><span class="sig-paren">(</span><em>ibs_gt</em>, <em>ibs2</em>, <em>aid_list1</em>, <em>aid_list2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_helpers.html#ensure_testdb_clean_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_helpers.ensure_testdb_clean_data" title="Permalink to this definition">¶</a></dt>
<dd><p>removes previously set names and exemplars</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_helpers.interactive_commandline_prompt">
<code class="descclassname">ibeis.algo.hots.automated_helpers.</code><code class="descname">interactive_commandline_prompt</code><span class="sig-paren">(</span><em>msg</em>, <em>decisiontype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_helpers.html#interactive_commandline_prompt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_helpers.interactive_commandline_prompt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_helpers.make_incremental_test_database">
<code class="descclassname">ibeis.algo.hots.automated_helpers.</code><code class="descname">make_incremental_test_database</code><span class="sig-paren">(</span><em>ibs_gt</em>, <em>aid_list1</em>, <em>reset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_helpers.html#make_incremental_test_database"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_helpers.make_incremental_test_database" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes test database. adds image and annotations but does not transfer names.
if reset is true the new database is gaurenteed to be built from a fresh
start.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs_gt</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; </li>
<li><strong>aid_list1</strong> (<em>list</em>) &#8211; </li>
<li><strong>reset</strong> (<em>bool</em>) &#8211; if True the test database is completely rebuilt</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">ibs2</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController">IBEISController</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_helpers.setup_incremental_test">
<code class="descclassname">ibeis.algo.hots.automated_helpers.</code><code class="descname">setup_incremental_test</code><span class="sig-paren">(</span><em>ibs_gt</em>, <em>clear_names=True</em>, <em>aid_order=u'shuffle'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_helpers.html#setup_incremental_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_helpers.setup_incremental_test" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.automated_helpers --test-setup_incremental_test:0

python dev.py -t custom --cfg codename:vsone_unnorm --db PZ_MTEST --allgt --vf --va
python dev.py -t custom --cfg codename:vsone_unnorm --db PZ_MTEST --allgt --vf --va --index <span class="m">0</span> <span class="m">4</span> <span class="m">8</span> --verbose
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automated_helpers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span> <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs_gt</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs2</span><span class="p">,</span> <span class="n">aid_list1</span><span class="p">,</span> <span class="n">aid1_to_aid2</span> <span class="o">=</span> <span class="n">setup_incremental_test</span><span class="p">(</span><span class="n">ibs_gt</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automated_helpers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs_gt</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;GZ_ALL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs2</span><span class="p">,</span> <span class="n">aid_list1</span><span class="p">,</span> <span class="n">aid1_to_aid2</span> <span class="o">=</span> <span class="n">setup_incremental_test</span><span class="p">(</span><span class="n">ibs_gt</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.automated_matcher">
<span id="ibeis-algo-hots-automated-matcher-module"></span><h2>ibeis.algo.hots.automated_matcher module<a class="headerlink" href="#module-ibeis.algo.hots.automated_matcher" title="Permalink to this headline">¶</a></h2>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -c <span class="s2">&quot;import utool as ut; ut.write_modscript_alias(&#39;Tinc.sh&#39;, &#39;ibeis.algo.hots.qt_inc_automatch&#39;)&quot;</span>

sh Tinc.sh --test-test_inc_query:0
sh Tinc.sh --test-test_inc_query:1
sh Tinc.sh --test-test_inc_query:2
sh Tinc.sh --test-test_inc_query:3 --num-initial 5000

python -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:0
</pre></div>
</div>
<dl class="class">
<dt id="ibeis.algo.hots.automated_matcher.Metatup">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.automated_matcher.</code><code class="descname">Metatup</code><span class="sig-paren">(</span><em>ibs_gt</em>, <em>aid1_to_aid2</em><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.Metatup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="method">
<dt id="ibeis.algo.hots.automated_matcher.Metatup.__getnewargs__">
<code class="descname">__getnewargs__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.Metatup.__getnewargs__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return self as a plain tuple.  Used by copy and pickle.</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.automated_matcher.Metatup.__getstate__">
<code class="descname">__getstate__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.Metatup.__getstate__" title="Permalink to this definition">¶</a></dt>
<dd><p>Exclude the OrderedDict from pickling</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.automated_matcher.Metatup.__repr__">
<code class="descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.Metatup.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a nicely formatted representation string</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.automated_matcher.Metatup.aid1_to_aid2">
<code class="descname">aid1_to_aid2</code><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.Metatup.aid1_to_aid2" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.automated_matcher.Metatup.ibs_gt">
<code class="descname">ibs_gt</code><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.Metatup.ibs_gt" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_matcher.exec_exemplar_decision_and_continue">
<code class="descclassname">ibeis.algo.hots.automated_matcher.</code><code class="descname">exec_exemplar_decision_and_continue</code><span class="sig-paren">(</span><em>exemplar_decision</em>, <em>ibs</em>, <em>cm</em>, <em>qreq_</em>, <em>incinfo=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_matcher.html#exec_exemplar_decision_and_continue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.exec_exemplar_decision_and_continue" title="Permalink to this definition">¶</a></dt>
<dd><p>DECISION STEP 4)</p>
<p>The exemplar decision in the previous step is executed.  The persistant
vsmany query request is updated if needbe and the execution continues.
(currently to the end of this iteration)</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_matcher.exec_name_decision_and_continue">
<code class="descclassname">ibeis.algo.hots.automated_matcher.</code><code class="descname">exec_name_decision_and_continue</code><span class="sig-paren">(</span><em>chosen_names</em>, <em>ibs</em>, <em>cm</em>, <em>qreq_</em>, <em>incinfo=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_matcher.html#exec_name_decision_and_continue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.exec_name_decision_and_continue" title="Permalink to this definition">¶</a></dt>
<dd><p>DECISION STEP 2)</p>
<p>The name decision from the previous step is executed and the score
normalizer is updated. Then execution continues to the exemplar decision
step.</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_matcher.execute_query_batch">
<code class="descclassname">ibeis.algo.hots.automated_matcher.</code><code class="descname">execute_query_batch</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid_chunk</em>, <em>qreq_vsmany_</em>, <em>incinfo</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_matcher.html#execute_query_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.execute_query_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: remove special query</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_matcher.generate_incremental_queries">
<code class="descclassname">ibeis.algo.hots.automated_matcher.</code><code class="descname">generate_incremental_queries</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid_list</em>, <em>incinfo=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_matcher.html#generate_incremental_queries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.generate_incremental_queries" title="Permalink to this definition">¶</a></dt>
<dd><p>qt entry point. generates query results for the qt harness to process.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; ibeis controller object</li>
<li><strong>qaid_list</strong> (<em>list</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.automated_matcher --test-generate_incremental_queries
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_chunk</span> <span class="o">=</span> <span class="n">testdata_automatch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generate_incremental_queries</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_matcher.generate_subquery_steps">
<code class="descclassname">ibeis.algo.hots.automated_matcher.</code><code class="descname">generate_subquery_steps</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid_chunk</em>, <em>incinfo=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_matcher.html#generate_subquery_steps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.generate_subquery_steps" title="Permalink to this definition">¶</a></dt>
<dd><p>Generats query results for the qt harness to then send into the next
decision steps.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; ibeis controller object</li>
<li><strong>qaid_chunk</strong> &#8211; </li>
<li><strong>incinfo</strong> (<em>dict</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.automated_matcher --test-generate_subquery_steps
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_chunk</span> <span class="o">=</span> <span class="n">testdata_automatch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generate_subquery_steps</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_chunk</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_matcher.get_name_suggestion">
<code class="descclassname">ibeis.algo.hots.automated_matcher.</code><code class="descname">get_name_suggestion</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid</em>, <em>choicetup</em>, <em>incinfo</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_matcher.html#get_name_suggestion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.get_name_suggestion" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_matcher.initialize_persistant_query_request">
<code class="descclassname">ibeis.algo.hots.automated_matcher.</code><code class="descname">initialize_persistant_query_request</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid_chunk</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_matcher.html#initialize_persistant_query_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.initialize_persistant_query_request" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_matcher.load_or_make_qreq">
<code class="descclassname">ibeis.algo.hots.automated_matcher.</code><code class="descname">load_or_make_qreq</code><span class="sig-paren">(</span><em>ibs</em>, <em>qreq_vsmany_</em>, <em>qaid_chunk</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_matcher.html#load_or_make_qreq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.load_or_make_qreq" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_matcher.run_until_exemplar_decision_signal">
<code class="descclassname">ibeis.algo.hots.automated_matcher.</code><code class="descname">run_until_exemplar_decision_signal</code><span class="sig-paren">(</span><em>ibs</em>, <em>cm</em>, <em>qreq_</em>, <em>incinfo=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_matcher.html#run_until_exemplar_decision_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.run_until_exemplar_decision_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>DECISION STEP 3)</p>
<p>Either the system or the user decides if the query should be added to the
database as an exemplar.</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_matcher.run_until_finish">
<code class="descclassname">ibeis.algo.hots.automated_matcher.</code><code class="descname">run_until_finish</code><span class="sig-paren">(</span><em>incinfo=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_matcher.html#run_until_finish"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.run_until_finish" title="Permalink to this definition">¶</a></dt>
<dd><p>DECISION STEP 5)</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_matcher.run_until_name_decision_signal">
<code class="descclassname">ibeis.algo.hots.automated_matcher.</code><code class="descname">run_until_name_decision_signal</code><span class="sig-paren">(</span><em>ibs</em>, <em>cm</em>, <em>qreq_</em>, <em>incinfo=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_matcher.html#run_until_name_decision_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.run_until_name_decision_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>DECISION STEP 1)</p>
<p>Either the system or the user makes a decision about the name of the query
annotation.</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.automated_matcher --test-run_until_name_decision_signal
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_chunk</span> <span class="o">=</span> <span class="n">testdata_automatch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exemplar_aids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">is_exemplar</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">incinfo</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="n">generate_subquery_steps</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_chunk</span><span class="p">,</span> <span class="n">incinfo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item</span> <span class="o">=</span> <span class="n">six</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">incinfo</span> <span class="o">=</span> <span class="n">item</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_until_name_decision_signal</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">incinfo</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore::</dt>
<dd>cm.ishow_top(ibs, sidebyside=False, show_query=True)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_matcher.test_generate_incremental_queries">
<code class="descclassname">ibeis.algo.hots.automated_matcher.</code><code class="descname">test_generate_incremental_queries</code><span class="sig-paren">(</span><em>ibs_gt</em>, <em>ibs</em>, <em>aid_list1</em>, <em>aid1_to_aid2</em>, <em>num_initial=0</em>, <em>incinfo=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_matcher.html#test_generate_incremental_queries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.test_generate_incremental_queries" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: move this somewhere else
Testing function</p>
<p>Adds and queries new annotations one at a time with oracle guidance
ibs1 is ibs_gt, ibs2 is ibs</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_matcher.testdata_automatch">
<code class="descclassname">ibeis.algo.hots.automated_matcher.</code><code class="descname">testdata_automatch</code><span class="sig-paren">(</span><em>dbname=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_matcher.html#testdata_automatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.testdata_automatch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_matcher.update_normalizer">
<code class="descclassname">ibeis.algo.hots.automated_matcher.</code><code class="descname">update_normalizer</code><span class="sig-paren">(</span><em>ibs</em>, <em>cm</em>, <em>qreq_</em>, <em>chosen_names</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_matcher.html#update_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_matcher.update_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>adds new support data to the current normalizer</p>
<p>FIXME: broken</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; ibeis controller object</li>
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</li>
<li><strong>choicetup</strong> &#8211; </li>
<li><strong>name</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(tp_rawscore, tn_rawscore)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.automated_matcher --test-update_normalizer
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_chunk</span> <span class="o">=</span> <span class="n">testdata_automatch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exemplar_aids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">is_exemplar</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">incinfo</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="n">generate_subquery_steps</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_chunk</span><span class="p">,</span> <span class="n">incinfo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item</span> <span class="o">=</span> <span class="n">six</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">incinfo</span> <span class="o">=</span> <span class="n">item</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="o">.</span><span class="n">load_score_normalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chosen_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;easy&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update_normalizer</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">chosen_names</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.automated_oracle">
<span id="ibeis-algo-hots-automated-oracle-module"></span><h2>ibeis.algo.hots.automated_oracle module<a class="headerlink" href="#module-ibeis.algo.hots.automated_oracle" title="Permalink to this headline">¶</a></h2>
<p>module for making the correct automatic decisions in incremental tests</p>
<dl class="function">
<dt id="ibeis.algo.hots.automated_oracle.get_oracle_name_decision">
<code class="descclassname">ibeis.algo.hots.automated_oracle.</code><code class="descname">get_oracle_name_decision</code><span class="sig-paren">(</span><em>metatup</em>, <em>ibs</em>, <em>qaid</em>, <em>choicetup</em>, <em>oracle_method=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_oracle.html#get_oracle_name_decision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_oracle.get_oracle_name_decision" title="Permalink to this definition">¶</a></dt>
<dd><p>Find what the correct decision should be ibs is the database we are working
with ibs_gt has pristine groundtruth</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_oracle.get_oracle_name_suggestion">
<code class="descclassname">ibeis.algo.hots.automated_oracle.</code><code class="descname">get_oracle_name_suggestion</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid</em>, <em>choicetup</em>, <em>metatup</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_oracle.html#get_oracle_name_suggestion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_oracle.get_oracle_name_suggestion" title="Permalink to this definition">¶</a></dt>
<dd><p>main entry point for the oracle</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_oracle.oracle_method1">
<code class="descclassname">ibeis.algo.hots.automated_oracle.</code><code class="descname">oracle_method1</code><span class="sig-paren">(</span><em>ibs_gt</em>, <em>ibs</em>, <em>qnid1</em>, <em>aid_list2</em>, <em>aid2_to_aid1</em>, <em>sorted_nids</em>, <em>MAX_LOOK</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_oracle.html#oracle_method1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_oracle.oracle_method1" title="Permalink to this definition">¶</a></dt>
<dd><p>METHOD 1: MAKE BEST DECISION FROM GIVEN INFORMATION</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.automated_oracle.oracle_method2">
<code class="descclassname">ibeis.algo.hots.automated_oracle.</code><code class="descname">oracle_method2</code><span class="sig-paren">(</span><em>ibs_gt</em>, <em>qnid1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_oracle.html#oracle_method2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_oracle.oracle_method2" title="Permalink to this definition">¶</a></dt>
<dd><p>METHOD 2: MAKE THE ABSOLUTE CORRECT DECISION REGARDLESS OF RESULT</p>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.automated_params">
<span id="ibeis-algo-hots-automated-params-module"></span><h2>ibeis.algo.hots.automated_params module<a class="headerlink" href="#module-ibeis.algo.hots.automated_params" title="Permalink to this headline">¶</a></h2>
<p>module that specified how we choose paramaters based on current search database
properties</p>
<dl class="function">
<dt id="ibeis.algo.hots.automated_params.choose_vsmany_K">
<code class="descclassname">ibeis.algo.hots.automated_params.</code><code class="descname">choose_vsmany_K</code><span class="sig-paren">(</span><em>num_names</em>, <em>qaids</em>, <em>daids</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/automated_params.html#choose_vsmany_K"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.automated_params.choose_vsmany_K" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: Should also scale up the number of checks as well</p>
<p>method for choosing K in the initial vsmany queries</p>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.bayes">
<span id="ibeis-algo-hots-bayes-module"></span><h2>ibeis.algo.hots.bayes module<a class="headerlink" href="#module-ibeis.algo.hots.bayes" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Ambiguity / num names</li>
<li>independence of annotations</li>
<li>continuous</li>
<li>exponential case</li>
<li>speicifc examples of our prob</li>
<li>human in loop</li>
</ol>
<dl class="function">
<dt id="ibeis.algo.hots.bayes.cluster_query">
<code class="descclassname">ibeis.algo.hots.bayes.</code><code class="descname">cluster_query</code><span class="sig-paren">(</span><em>model</em>, <em>query_vars=None</em>, <em>evidence=None</em>, <em>soft_evidence=None</em>, <em>method=None</em>, <em>operation=u'maximize'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/bayes.html#cluster_query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.bayes.cluster_query" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.bayes --exec-cluster_query --show
</pre></div>
</div>
<dl class="docutils">
<dt>ParamGrid:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">param_grid</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c">#method=[&#39;approx&#39;, &#39;bf&#39;, &#39;bp&#39;],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">method</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;approx&#39;</span><span class="p">,</span> <span class="s">&#39;bp&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combos</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">all_dict_combinations</span><span class="p">(</span><span class="n">param_grid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">keys</span> <span class="o">=</span> <span class="s">&#39;method&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;, &#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">method</span><span class="p">,</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_take</span><span class="p">(</span><span class="n">combos</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">keys</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Setup:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.bayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other_evidence</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_evidence</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_evidence</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">special_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;fred&#39;</span><span class="p">,</span> <span class="s">&#39;sue&#39;</span><span class="p">,</span> <span class="s">&#39;tom&#39;</span><span class="p">,</span> <span class="s">&#39;paul&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">make_name_model</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">num_annots</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_names</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_scores</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">special_names</span><span class="o">=</span><span class="n">special_names</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">method</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">evidence</span><span class="p">,</span> <span class="n">soft_evidence</span> <span class="o">=</span> <span class="n">update_model_evidence</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">model</span><span class="p">,</span> <span class="n">name_evidence</span><span class="p">,</span> <span class="n">score_evidence</span><span class="p">,</span> <span class="n">other_evidence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evidence</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_ensure_internal_evidence</span><span class="p">(</span><span class="n">evidence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query_vars</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_getattr</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">ttype2_cpds</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">],</span> <span class="s">&#39;variable&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query_results</span> <span class="o">=</span> <span class="n">cluster_query</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">query_vars</span><span class="p">,</span> <span class="n">evidence</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">query_results</span><span class="p">[</span><span class="s">&#39;top_assignments&#39;</span><span class="p">],</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pgm_ext</span><span class="o">.</span><span class="n">show_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="n">evidence</span><span class="p">,</span> <span class="o">**</span><span class="n">query_results</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.bayes.collapse_factor_labels">
<code class="descclassname">ibeis.algo.hots.bayes.</code><code class="descname">collapse_factor_labels</code><span class="sig-paren">(</span><em>model</em>, <em>reduced_joint</em>, <em>evidence</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/bayes.html#collapse_factor_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.bayes.collapse_factor_labels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.bayes.collapse_labels">
<code class="descclassname">ibeis.algo.hots.bayes.</code><code class="descname">collapse_labels</code><span class="sig-paren">(</span><em>model</em>, <em>evidence</em>, <em>reduced_variables</em>, <em>reduced_row_idxs</em>, <em>reduced_values</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/bayes.html#collapse_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.bayes.collapse_labels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.bayes.compute_reduced_joint">
<code class="descclassname">ibeis.algo.hots.bayes.</code><code class="descname">compute_reduced_joint</code><span class="sig-paren">(</span><em>model</em>, <em>query_vars</em>, <em>evidence</em>, <em>method</em>, <em>operation=u'maximize'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/bayes.html#compute_reduced_joint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.bayes.compute_reduced_joint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.bayes.draw_tree_model">
<code class="descclassname">ibeis.algo.hots.bayes.</code><code class="descname">draw_tree_model</code><span class="sig-paren">(</span><em>model</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/bayes.html#draw_tree_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.bayes.draw_tree_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.bayes.get_hacked_pos">
<code class="descclassname">ibeis.algo.hots.bayes.</code><code class="descname">get_hacked_pos</code><span class="sig-paren">(</span><em>netx_graph</em>, <em>name_nodes=None</em>, <em>prog=u'dot'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/bayes.html#get_hacked_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.bayes.get_hacked_pos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.bayes.make_name_model">
<code class="descclassname">ibeis.algo.hots.bayes.</code><code class="descname">make_name_model</code><span class="sig-paren">(</span><em>num_annots</em>, <em>num_names=None</em>, <em>verbose=True</em>, <em>mode=1</em>, <em>num_scores=2</em>, <em>p_score_given_same=None</em>, <em>hack_score_only=False</em>, <em>score_basis=None</em>, <em>special_names=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/bayes.html#make_name_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.bayes.make_name_model" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.bayes --exec-make_name_model --show
python -m ibeis.algo.hots.bayes --exec-make_name_model
python -m ibeis.algo.hots.bayes --exec-make_name_model --num-annots<span class="o">=</span>3
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.bayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">num_annots</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_names</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modeltype</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--modeltype&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;bayes&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kw</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">argparse_funckw</span><span class="p">(</span><span class="n">make_name_model</span><span class="p">,</span> <span class="n">defaults</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">make_name_model</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_model</span><span class="p">(</span><span class="n">show_prior</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">show_title</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">modeltype</span><span class="o">=</span><span class="n">modeltype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.bayes.make_temp_state">
<code class="descclassname">ibeis.algo.hots.bayes.</code><code class="descname">make_temp_state</code><span class="sig-paren">(</span><em>state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/bayes.html#make_temp_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.bayes.make_temp_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.bayes.reduce_marginalize">
<code class="descclassname">ibeis.algo.hots.bayes.</code><code class="descname">reduce_marginalize</code><span class="sig-paren">(</span><em>phi</em>, <em>query_variables=None</em>, <em>evidence={}</em>, <em>inplace=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/bayes.html#reduce_marginalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.bayes.reduce_marginalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Hack for reduction followed by marginalization</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">reduced_joint</span> <span class="o">=</span> <span class="n">joint</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">query_variables</span><span class="p">,</span> <span class="n">evidence</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_rows</span> <span class="o">=</span> <span class="n">reduced_joint</span><span class="o">.</span><span class="n">_row_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_vals</span> <span class="o">=</span> <span class="n">reduced_joint</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">map_vals</span> <span class="o">=</span> <span class="n">new_rows</span><span class="p">[</span><span class="n">new_vals</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">map_assign</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">reduced_joint</span><span class="o">.</span><span class="n">variables</span><span class="p">,</span> <span class="n">map_vals</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.bayes.report_partitioning_statistics">
<code class="descclassname">ibeis.algo.hots.bayes.</code><code class="descname">report_partitioning_statistics</code><span class="sig-paren">(</span><em>new_reduced_joint</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/bayes.html#report_partitioning_statistics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.bayes.report_partitioning_statistics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.bayes.show_model">
<code class="descclassname">ibeis.algo.hots.bayes.</code><code class="descname">show_model</code><span class="sig-paren">(</span><em>model</em>, <em>evidence={}</em>, <em>soft_evidence={}</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/bayes.html#show_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.bayes.show_model" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/22207802/pygraphviz-networkx-set-node-level-or-layer">http://stackoverflow.com/questions/22207802/pygraphviz-networkx-set-node-level-or-layer</a></p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.bayes --exec-show_model --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.bayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evidence</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">soft_evidence</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">show_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">evidence</span><span class="p">,</span> <span class="n">soft_evidence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.bayes.test_model">
<code class="descclassname">ibeis.algo.hots.bayes.</code><code class="descname">test_model</code><span class="sig-paren">(</span><em>num_annots</em>, <em>num_names</em>, <em>score_evidence=[]</em>, <em>name_evidence=[]</em>, <em>other_evidence={}</em>, <em>noquery=False</em>, <em>verbose=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/bayes.html#test_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.bayes.test_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.bayes.update_model_evidence">
<code class="descclassname">ibeis.algo.hots.bayes.</code><code class="descname">update_model_evidence</code><span class="sig-paren">(</span><em>model</em>, <em>name_evidence</em>, <em>score_evidence</em>, <em>other_evidence</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/bayes.html#update_model_evidence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.bayes.update_model_evidence" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.bayes --exec-update_model_evidence
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.bayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other_evidence</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_evidence</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_evidence</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;high&#39;</span><span class="p">,</span> <span class="s">&#39;low&#39;</span><span class="p">,</span> <span class="s">&#39;low&#39;</span><span class="p">,</span> <span class="s">&#39;low&#39;</span><span class="p">,</span> <span class="s">&#39;low&#39;</span><span class="p">,</span> <span class="s">&#39;high&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">make_name_model</span><span class="p">(</span><span class="n">num_annots</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">num_names</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                        <span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update_model_evidence</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">name_evidence</span><span class="p">,</span> <span class="n">score_evidence</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                      <span class="n">other_evidence</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.chip_match">
<span id="ibeis-algo-hots-chip-match-module"></span><h2>ibeis.algo.hots.chip_match module<a class="headerlink" href="#module-ibeis.algo.hots.chip_match" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.chip_match.</code><code class="descname">AnnotMatch</code><span class="sig-paren">(</span><em>cm</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ibeis.algo.hots.chip_match.MatchBaseIO" title="ibeis.algo.hots.chip_match.MatchBaseIO"><code class="xref py py-class docutils literal"><span class="pre">ibeis.algo.hots.chip_match.MatchBaseIO</span></code></a>, <code class="xref py py-class docutils literal"><span class="pre">utool.util_dev.NiceRepr</span></code></p>
<p>This implements part the match between whole annotations and the other
annotaions / names. This does not include algorithm specific feature
matches.</p>
<dl class="attribute">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.algo_annot_scores">
<code class="descname">algo_annot_scores</code><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.algo_annot_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.algo_name_scores">
<code class="descname">algo_name_scores</code><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.algo_name_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.argsort">
<code class="descname">argsort</code><span class="sig-paren">(</span><em>cm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.argsort"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.argsort" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.evaluate_dnids">
<code class="descname">evaluate_dnids</code><span class="sig-paren">(</span><em>cm</em>, <em>ibs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.evaluate_dnids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.evaluate_dnids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_annot_ranks">
<code class="descname">get_annot_ranks</code><span class="sig-paren">(</span><em>cm</em>, <em>daids</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_annot_ranks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_annot_ranks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_annot_scores">
<code class="descname">get_annot_scores</code><span class="sig-paren">(</span><em>cm</em>, <em>daids</em>, <em>score_method=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_annot_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_annot_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_chip_shortlist_aids">
<code class="descname">get_chip_shortlist_aids</code><span class="sig-paren">(</span><em>cm</em>, <em>num_shortlist</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_chip_shortlist_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_chip_shortlist_aids" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.chip_match</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_sver</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">score_nsum</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top_daids</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_chip_shortlist_aids</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">cm</span><span class="o">.</span><span class="n">qnid</span> <span class="ow">in</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_rowids</span><span class="p">(</span><span class="n">top_daids</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_groundtruth_daids">
<code class="descname">get_groundtruth_daids</code><span class="sig-paren">(</span><em>cm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_groundtruth_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_groundtruth_daids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_groundtruth_flags">
<code class="descname">get_groundtruth_flags</code><span class="sig-paren">(</span><em>cm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_groundtruth_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_groundtruth_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_name_ranks">
<code class="descname">get_name_ranks</code><span class="sig-paren">(</span><em>cm</em>, <em>dnids</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_name_ranks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_name_ranks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_name_shortlist_aids">
<code class="descname">get_name_shortlist_aids</code><span class="sig-paren">(</span><em>cm</em>, <em>nNameShortList</em>, <em>nAnnotPerName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_name_shortlist_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_name_shortlist_aids" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.chip_match</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_sver</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">score_nsum</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top_daids</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_name_shortlist_aids</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">cm</span><span class="o">.</span><span class="n">qnid</span> <span class="ow">in</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_rowids</span><span class="p">(</span><span class="n">top_daids</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_nid_scores">
<code class="descname">get_nid_scores</code><span class="sig-paren">(</span><em>cm</em>, <em>nid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_nid_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_nid_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_num_matches_list">
<code class="descname">get_num_matches_list</code><span class="sig-paren">(</span><em>cm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_num_matches_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_num_matches_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_ranked_nids">
<code class="descname">get_ranked_nids</code><span class="sig-paren">(</span><em>cm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_ranked_nids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_ranked_nids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_ranked_nids_and_aids">
<code class="descname">get_ranked_nids_and_aids</code><span class="sig-paren">(</span><em>cm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_ranked_nids_and_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_ranked_nids_and_aids" title="Permalink to this definition">¶</a></dt>
<dd><p>Hacky func</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">ibeis.algo.hots.name_scoring.NameScoreTup</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_top_aids">
<code class="descname">get_top_aids</code><span class="sig-paren">(</span><em>cm</em>, <em>ntop=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_top_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_top_aids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_top_gf_aids">
<code class="descname">get_top_gf_aids</code><span class="sig-paren">(</span><em>cm</em>, <em>ibs</em>, <em>ntop=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_top_gf_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_top_gf_aids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_top_gt_aids">
<code class="descname">get_top_gt_aids</code><span class="sig-paren">(</span><em>cm</em>, <em>ibs</em>, <em>ntop=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_top_gt_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_top_gt_aids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_top_nids">
<code class="descname">get_top_nids</code><span class="sig-paren">(</span><em>cm</em>, <em>ntop=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_top_nids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_top_nids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_top_scores">
<code class="descname">get_top_scores</code><span class="sig-paren">(</span><em>cm</em>, <em>ntop=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_top_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_top_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.get_top_truth_aids">
<code class="descname">get_top_truth_aids</code><span class="sig-paren">(</span><em>cm</em>, <em>ibs</em>, <em>truth</em>, <em>ntop=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.get_top_truth_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.get_top_truth_aids" title="Permalink to this definition">¶</a></dt>
<dd><p>top scoring aids of a certain truth value</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.groundtruth_daids">
<code class="descname">groundtruth_daids</code><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.groundtruth_daids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.ishow_analysis">
<code class="descname">ishow_analysis</code><span class="sig-paren">(</span><em>cm</em>, <em>qreq_</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.ishow_analysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.ishow_analysis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.name_argsort">
<code class="descname">name_argsort</code><span class="sig-paren">(</span><em>cm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.name_argsort"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.name_argsort" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.num_daids">
<code class="descname">num_daids</code><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.num_daids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.ranks">
<code class="descname">ranks</code><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.ranks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.set_cannonical_annot_score">
<code class="descname">set_cannonical_annot_score</code><span class="sig-paren">(</span><em>cm</em>, <em>annot_score_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.set_cannonical_annot_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.set_cannonical_annot_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.set_cannonical_name_score">
<code class="descname">set_cannonical_name_score</code><span class="sig-paren">(</span><em>cm</em>, <em>annot_score_list</em>, <em>name_score_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.set_cannonical_name_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.set_cannonical_name_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.show_analysis">
<code class="descname">show_analysis</code><span class="sig-paren">(</span><em>cm</em>, <em>qreq_</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.show_analysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.show_analysis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.show_single_namematch">
<code class="descname">show_single_namematch</code><span class="sig-paren">(</span><em>cm</em>, <em>qreq_</em>, <em>dnid</em>, <em>fnum=None</em>, <em>pnum=None</em>, <em>homog=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#AnnotMatch.show_single_namematch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.show_single_namematch" title="Permalink to this definition">¶</a></dt>
<dd><p>HACK FOR ANNOT MATCH</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.chip_match.AnnotMatch.unique_name_ranks">
<code class="descname">unique_name_ranks</code><a class="headerlink" href="#ibeis.algo.hots.chip_match.AnnotMatch.unique_name_ranks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ibeis.algo.hots.chip_match.ChipMatch">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.chip_match.</code><code class="descname">ChipMatch</code><span class="sig-paren">(</span><em>cm</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">ibeis.algo.hots.chip_match._ChipMatchVisualization</span></code>, <a class="reference internal" href="#ibeis.algo.hots.chip_match.AnnotMatch" title="ibeis.algo.hots.chip_match.AnnotMatch"><code class="xref py py-class docutils literal"><span class="pre">ibeis.algo.hots.chip_match.AnnotMatch</span></code></a>, <code class="xref py py-class docutils literal"><span class="pre">ibeis.algo.hots.chip_match._ChipMatchScorers</span></code>, <code class="xref py py-class docutils literal"><span class="pre">ibeis.algo.hots.old_chip_match._OldStyleChipMatchSimulator</span></code></p>
<p>behaves as as the ChipMatchOldTup named tuple until we
completely replace the old structure</p>
<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.append_featscore_column">
<code class="descname">append_featscore_column</code><span class="sig-paren">(</span><em>cm</em>, <em>filtkey</em>, <em>filtweight_list</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.append_featscore_column"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.append_featscore_column" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.as_dict">
<code class="descname">as_dict</code><span class="sig-paren">(</span><em>cm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.as_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.as_simple_dict">
<code class="descname">as_simple_dict</code><span class="sig-paren">(</span><em>cm</em>, <em>keys=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.as_simple_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.as_simple_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.assert_self">
<code class="descname">assert_self</code><span class="sig-paren">(</span><em>cm</em>, <em>qreq_=None</em>, <em>strict=False</em>, <em>assert_feats=True</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.assert_self"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.assert_self" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.combine_cms">
<em class="property">classmethod </em><code class="descname">combine_cms</code><span class="sig-paren">(</span><em>cm_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.combine_cms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.combine_cms" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.core_annots</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">depc</span><span class="p">,</span> <span class="n">aid_list</span> <span class="o">=</span> <span class="n">testdata_core</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">request</span> <span class="o">=</span> <span class="n">depc</span><span class="o">.</span><span class="n">new_request</span><span class="p">(</span><span class="s">&#39;vsone&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">{</span><span class="s">&#39;dim_size&#39;</span><span class="p">:</span> <span class="mi">450</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rawres_list2</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">postprocess</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">take_column</span><span class="p">(</span><span class="n">rawres_list2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cls</span> <span class="o">=</span> <span class="n">ChipMatch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">ChipMatch</span><span class="o">.</span><span class="n">combine_cms</span><span class="p">(</span><span class="n">cm_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span><span class="o">.</span><span class="n">score_nsum</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span><span class="o">.</span><span class="n">ishow_analysis</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.compress_annots">
<code class="descname">compress_annots</code><span class="sig-paren">(</span><em>cm</em>, <em>flags</em>, <em>inplace=False</em>, <em>keepscores=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.compress_annots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.compress_annots" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.compress_top_feature_matches">
<code class="descname">compress_top_feature_matches</code><span class="sig-paren">(</span><em>cm</em>, <em>num=10</em>, <em>rng=&lt;module 'numpy.random' from '/usr/local/lib/python2.7/dist-packages/numpy/random/__init__.pyc'&gt;</em>, <em>use_random=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.compress_top_feature_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.compress_top_feature_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>DO NOT USE</p>
<p>FIXME: Use boolean lists</p>
<p>Removes all but the best feature matches for testing purposes
rng = np.random.RandomState(0)</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.dfxs_list">
<code class="descname">dfxs_list</code><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.dfxs_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.extend_results">
<code class="descname">extend_results</code><span class="sig-paren">(</span><em>cm</em>, <em>qreq_</em>, <em>other_aids=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.extend_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.extend_results" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a new cmtup_old that contains empty data for an extended set of
aids</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qreq</strong> (<em>ibeis.QueryRequest</em>) &#8211; query request object with hyper-parameters</li>
<li><strong>other_aids</strong> (<em>None</em>) &#8211; (default = None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">out</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ibeis.ChipMatch</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.chip_match --exec-extend_results --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.chip_match</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cm</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">a</span><span class="o">=</span><span class="s">&#39;default:dindex=0:10,qindex=0:1&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">t</span><span class="o">=</span><span class="s">&#39;best:SV=False&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">daid_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">assert_self</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other_aids</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">extend_results</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">other_aids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">daid_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">118</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span><span class="o">.</span><span class="n">assert_self</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.from_json">
<em class="property">classmethod </em><code class="descname">from_json</code><span class="sig-paren">(</span><em>json_str</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.from_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.from_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert json string back to ChipMatch object</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># FIXME; util_test is broken with classmethods</span>
python -m ibeis.algo.hots.chip_match --test-from_json --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.chip_match</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cls</span> <span class="o">=</span> <span class="n">ChipMatch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm1</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cm</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">json_str</span> <span class="o">=</span> <span class="n">cm1</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">ChipMatch</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">score_nsum</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">show_single_namematch</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.from_unscored">
<em class="property">classmethod </em><code class="descname">from_unscored</code><span class="sig-paren">(</span><em>prior_cm</em>, <em>fm_list</em>, <em>fs_list</em>, <em>H_list=None</em>, <em>fsv_col_lbls=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.from_unscored"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.from_unscored" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.from_vsmany_match_tup">
<em class="property">classmethod </em><code class="descname">from_vsmany_match_tup</code><span class="sig-paren">(</span><em>vmt</em>, <em>qaid=None</em>, <em>fsv_col_lbls=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.from_vsmany_match_tup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.from_vsmany_match_tup" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vmt</strong> (<a href="#id5"><span class="problematic" id="id6">ibeis.algo.hots.pipeline.ValidMatchTup_</span></a>) &#8211; valid_match_tup</li>
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation id</li>
<li><strong>fsv_col_lbls</strong> (<em>None</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">cm</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ibeis.ChipMatch</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.from_vsone_match_tup">
<em class="property">classmethod </em><code class="descname">from_vsone_match_tup</code><span class="sig-paren">(</span><em>vmt_list</em>, <em>daid_list=None</em>, <em>qaid=None</em>, <em>fsv_col_lbls=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.from_vsone_match_tup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.from_vsone_match_tup" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vmt_list</strong> (list of <a href="#id7"><span class="problematic" id="id8">ValidMatchTup_</span></a>) &#8211; list of valid_match_tups</li>
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation id</li>
<li><strong>fsv_col_lbls</strong> (<em>None</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">cm</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ibeis.ChipMatch</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.get_annot_fm">
<code class="descname">get_annot_fm</code><span class="sig-paren">(</span><em>cm</em>, <em>daid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.get_annot_fm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.get_annot_fm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.get_cvs_str">
<code class="descname">get_cvs_str</code><span class="sig-paren">(</span><em>cm</em>, <em>numtop=6</em>, <em>ibs=None</em>, <em>sort=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.get_cvs_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.get_cvs_str" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>numtop</strong> (<em>int</em>) &#8211; (default = 6)</li>
<li><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; ibeis controller object(default = None)</li>
<li><strong>sort</strong> (<em>bool</em>) &#8211; (default = True)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">csv_str</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Very weird that it got a score
qaid 6 vs 41 has</p>
<blockquote>
<div>[72, 79, 0, 17, 6, 60, 15, 36, 63]
[72, 79, 0, 17, 6, 60, 15, 36, 63]
[72, 79, 0, 17, 6, 60, 15, 36, 63]
[0.060, 0.053, 0.0497, 0.040, 0.016, 0, 0, 0, 0]
[7, 40, 41, 86, 103, 88, 8, 101, 35]</div></blockquote>
<p>makes very little sense</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.chip_match --test-get_cvs_str --force-serial
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.chip_match</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_post_sver</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numtop</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sort</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">csv_str</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cvs_str</span><span class="p">(</span><span class="n">numtop</span><span class="p">,</span> <span class="n">ibs</span><span class="p">,</span> <span class="n">sort</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;csv_str = </span><span class="se">\n</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">csv_str</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.get_flat_fm_info">
<code class="descname">get_flat_fm_info</code><span class="sig-paren">(</span><em>cm</em>, <em>flags=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.get_flat_fm_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.get_flat_fm_info" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a href="#id9"><span class="problematic" id="id10">info_</span></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.chip_match --exec-get_flat_fm_info --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.chip_match</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_sver</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">info_</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_flat_fm_info</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_all_eq</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">lmap</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">info_</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;info_ = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">info_</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.get_fpath">
<code class="descname">get_fpath</code><span class="sig-paren">(</span><em>cm</em>, <em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.get_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.get_fpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.get_fs">
<code class="descname">get_fs</code><span class="sig-paren">(</span><em>cm</em>, <em>idx=None</em>, <em>colx=None</em>, <em>daid=None</em>, <em>col=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.get_fs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.get_fs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.get_fs_list">
<code class="descname">get_fs_list</code><span class="sig-paren">(</span><em>cm</em>, <em>colx=None</em>, <em>col=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.get_fs_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.get_fs_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.get_fsv_prod_list">
<code class="descname">get_fsv_prod_list</code><span class="sig-paren">(</span><em>cm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.get_fsv_prod_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.get_fsv_prod_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.get_inspect_str">
<code class="descname">get_inspect_str</code><span class="sig-paren">(</span><em>cm</em>, <em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.get_inspect_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.get_inspect_str" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">varinfo</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.chip_match --exec-get_inspect_str
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.chip_match</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cm</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="s">&#39;default:dindex=0:10,qindex=0:1&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="s">&#39;best:SV=False&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">varinfo</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_inspect_str</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;varinfo = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">varinfo</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.get_num_feat_score_cols">
<code class="descname">get_num_feat_score_cols</code><span class="sig-paren">(</span><em>cm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.get_num_feat_score_cols"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.get_num_feat_score_cols" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.get_rawinfostr">
<code class="descname">get_rawinfostr</code><span class="sig-paren">(</span><em>cm</em>, <em>colored=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.get_rawinfostr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.get_rawinfostr" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">varinfo</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.chip_match --exec-get_rawinfostr --show --cex
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.chip_match</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cm</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="s">&#39;default:dindex=0:10,qindex=0:1&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="s">&#39;best:SV=False&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">varinfo</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_rawinfostr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;varinfo = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">varinfo</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>cm</em>, <em>qaid=None</em>, <em>daid_list=None</em>, <em>fm_list=None</em>, <em>fsv_list=None</em>, <em>fk_list=None</em>, <em>score_list=None</em>, <em>H_list=None</em>, <em>fsv_col_lbls=None</em>, <em>dnid_list=None</em>, <em>qnid=None</em>, <em>unique_nids=None</em>, <em>name_score_list=None</em>, <em>annot_score_list=None</em>, <em>autoinit=True</em>, <em>filtnorm_aids=None</em>, <em>filtnorm_fxs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>qaid and daid_list are not optional. fm_list and fsv_list are strongly
encouraged and will probalby break things if they are not there.</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.inspect_difference">
<code class="descname">inspect_difference</code><span class="sig-paren">(</span><em>cm</em>, <em>other</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.inspect_difference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.inspect_difference" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.load_from_fpath">
<em class="property">classmethod </em><code class="descname">load_from_fpath</code><span class="sig-paren">(</span><em>fpath</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.load_from_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.load_from_fpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.naids_list">
<code class="descname">naids_list</code><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.naids_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.nfxs_list">
<code class="descname">nfxs_list</code><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.nfxs_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.print_csv">
<code class="descname">print_csv</code><span class="sig-paren">(</span><em>cm</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.print_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.print_csv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.print_inspect_str">
<code class="descname">print_inspect_str</code><span class="sig-paren">(</span><em>cm</em>, <em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.print_inspect_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.print_inspect_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.print_rawinfostr">
<code class="descname">print_rawinfostr</code><span class="sig-paren">(</span><em>cm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.print_rawinfostr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.print_rawinfostr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.qfxs_list">
<code class="descname">qfxs_list</code><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.qfxs_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.rrr">
<code class="descname">rrr</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>cm</em>, <em>qreq_</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.shortlist_subset">
<code class="descname">shortlist_subset</code><span class="sig-paren">(</span><em>cm</em>, <em>top_aids</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.shortlist_subset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.shortlist_subset" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a new cmtup_old with only the requested daids
TODO: rectify with take_feature_matches</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.sortself">
<code class="descname">sortself</code><span class="sig-paren">(</span><em>cm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.sortself"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.sortself" title="Permalink to this definition">¶</a></dt>
<dd><p>reorders the internal data using cm.score_list</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.take_annots">
<code class="descname">take_annots</code><span class="sig-paren">(</span><em>cm</em>, <em>idx_list</em>, <em>inplace=False</em>, <em>keepscores=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.take_annots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.take_annots" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.chip_match</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cm</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">a</span><span class="o">=</span><span class="s">&#39;default:dindex=0:10,qindex=0:1&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">t</span><span class="o">=</span><span class="s">&#39;best:sv=false&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">num_daids</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inplace</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">keepscores</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">out</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">take_annots</span><span class="p">(</span><span class="n">idx_list</span><span class="p">,</span> <span class="n">inplace</span><span class="p">,</span> <span class="n">keepscores</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;out = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">out</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">cm</span><span class="o">.</span><span class="n">inspect_difference</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="s">&#39;should be no difference&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.chip_match</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cm</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">a</span><span class="o">=</span><span class="s">&#39;default:dindex=0:10,qindex=0:1&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">t</span><span class="o">=</span><span class="s">&#39;best:SV=False&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inplace</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">keepscores</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">out</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">take_annots</span><span class="p">(</span><span class="n">idx_list</span><span class="p">,</span> <span class="n">inplace</span><span class="p">,</span> <span class="n">keepscores</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;out = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">out</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.take_feature_matches">
<code class="descname">take_feature_matches</code><span class="sig-paren">(</span><em>cm</em>, <em>indicies_list</em>, <em>inplace=False</em>, <em>keepscores=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.take_feature_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.take_feature_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes outlier feature matches
TODO: rectify with shortlist_subset</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>indicies_list</strong> (<em>list</em>) &#8211; list of lists of indicies to keep.
if an item is None, the match to the corresponding daid is
removed.</li>
<li><strong>inplace</strong> (<em>bool</em>) &#8211; (default = False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">out</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ibeis.ChipMatch</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.chip_match --exec-take_feature_matches --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.chip_match</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cm</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="s">&#39;default:dindex=0:10,qindex=0:1&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="s">&#39;best:SV=False&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indicies_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">num_daids</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inplace</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">keepscores</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">take_feature_matches</span><span class="p">(</span><span class="n">indicies_list</span><span class="p">,</span> <span class="n">inplace</span><span class="p">,</span> <span class="n">keepscores</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="ow">not</span> <span class="n">cm</span><span class="o">.</span><span class="n">inspect_difference</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="s">&#39;should be different&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;out = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">out</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.ChipMatch.to_json">
<code class="descname">to_json</code><span class="sig-paren">(</span><em>cm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#ChipMatch.to_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.ChipMatch.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Serialize ChipMatch object as JSON string</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.chip_match --test-ChipMatch.to_json:0
python -m ibeis.algo.hots.chip_match --test-ChipMatch.to_json
python -m ibeis.algo.hots.chip_match --test-ChipMatch.to_json:1 --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Simple doctest demonstrating the json format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.chip_match</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">query_chips</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">return_cm</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">return_request</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">compress_top_feature_matches</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Serialize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Raw ChipMatch JSON:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">json_str</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">Pretty ChipMatch JSON:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Pretty String Formatting</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dictrep</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dictrep</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">delete_dict_keys</span><span class="p">(</span><span class="n">dictrep</span><span class="p">,</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">dictrep</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>  <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">dictrep</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">hack_liststr</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">key_order_metric</span><span class="o">=</span><span class="s">&#39;strlen&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;u</span><span class="se">\&#39;</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\&#39;</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># test to convert back and forth from json</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.chip_match</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cm</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm1</span> <span class="o">=</span> <span class="n">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Serialize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">json_str</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">json_str</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Unserialize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">ChipMatch</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Show if it works</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">score_nsum</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">show_single_namematch</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># result = (&#39;json_str = \n%s&#39; % (str(json_str),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># print(result)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ibeis.algo.hots.chip_match.MatchBaseIO">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.chip_match.</code><code class="descname">MatchBaseIO</code><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#MatchBaseIO"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.MatchBaseIO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="ibeis.algo.hots.chip_match.MatchBaseIO.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#MatchBaseIO.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.MatchBaseIO.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="ibeis.algo.hots.chip_match.MatchBaseIO.load_from_fpath">
<em class="property">classmethod </em><code class="descname">load_from_fpath</code><span class="sig-paren">(</span><em>fpath</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#MatchBaseIO.load_from_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.MatchBaseIO.load_from_fpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.MatchBaseIO.save_to_fpath">
<code class="descname">save_to_fpath</code><span class="sig-paren">(</span><em>cm</em>, <em>fpath</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#MatchBaseIO.save_to_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.MatchBaseIO.save_to_fpath" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python ibeis --tf MatchBaseIO.save_to_fpath --verbtest --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.chip_match</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="mi">18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_sver</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="n">qaid</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">score_nsum</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_app_resource_dir</span><span class="p">(</span><span class="s">&#39;ibeis&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpath</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">dpath</span><span class="p">,</span> <span class="s">&#39;tmp_chipmatch.cPkl&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">save_to_fpath</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm2</span> <span class="o">=</span> <span class="n">ChipMatch</span><span class="o">.</span><span class="n">load_from_fpath</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">cm</span> <span class="o">==</span> <span class="n">cm2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">ishow_analysis</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="ibeis.algo.hots.chip_match.NeedRecomputeError">
<em class="property">exception </em><code class="descclassname">ibeis.algo.hots.chip_match.</code><code class="descname">NeedRecomputeError</code><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#NeedRecomputeError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.NeedRecomputeError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

<dl class="class">
<dt id="ibeis.algo.hots.chip_match.TestLogger">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.chip_match.</code><code class="descname">TestLogger</code><span class="sig-paren">(</span><em>testlog</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#TestLogger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.TestLogger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="ibeis.algo.hots.chip_match.TestLogger.context">
<code class="descname">context</code><span class="sig-paren">(</span><em>testlog</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#TestLogger.context"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.TestLogger.context" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.TestLogger.end_test">
<code class="descname">end_test</code><span class="sig-paren">(</span><em>testlog</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#TestLogger.end_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.TestLogger.end_test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.TestLogger.log_failed">
<code class="descname">log_failed</code><span class="sig-paren">(</span><em>testlog</em>, <em>msg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#TestLogger.log_failed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.TestLogger.log_failed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.TestLogger.log_passed">
<code class="descname">log_passed</code><span class="sig-paren">(</span><em>testlog</em>, <em>msg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#TestLogger.log_passed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.TestLogger.log_passed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.TestLogger.log_skipped">
<code class="descname">log_skipped</code><span class="sig-paren">(</span><em>testlog</em>, <em>msg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#TestLogger.log_skipped"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.TestLogger.log_skipped" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.TestLogger.skip_test">
<code class="descname">skip_test</code><span class="sig-paren">(</span><em>testlog</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#TestLogger.skip_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.TestLogger.skip_test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.chip_match.TestLogger.start_test">
<code class="descname">start_test</code><span class="sig-paren">(</span><em>testlog</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#TestLogger.start_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.TestLogger.start_test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.chip_match.check_arrs_eq">
<code class="descclassname">ibeis.algo.hots.chip_match.</code><code class="descname">check_arrs_eq</code><span class="sig-paren">(</span><em>arr1</em>, <em>arr2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#check_arrs_eq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.check_arrs_eq" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.chip_match.extend_nplists">
<code class="descclassname">ibeis.algo.hots.chip_match.</code><code class="descname">extend_nplists</code><span class="sig-paren">(</span><em>x_list</em>, <em>num</em>, <em>shape</em>, <em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#extend_nplists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.extend_nplists" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.chip_match.extend_nplists_">
<code class="descclassname">ibeis.algo.hots.chip_match.</code><code class="descname">extend_nplists_</code><span class="sig-paren">(</span><em>x_list</em>, <em>num</em>, <em>shape</em>, <em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#extend_nplists_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.extend_nplists_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.chip_match.extend_pylist">
<code class="descclassname">ibeis.algo.hots.chip_match.</code><code class="descname">extend_pylist</code><span class="sig-paren">(</span><em>x_list</em>, <em>num</em>, <em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#extend_pylist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.extend_pylist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.chip_match.extend_pylist_">
<code class="descclassname">ibeis.algo.hots.chip_match.</code><code class="descname">extend_pylist_</code><span class="sig-paren">(</span><em>x_list</em>, <em>num</em>, <em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#extend_pylist_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.extend_pylist_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.chip_match.extend_scores">
<code class="descclassname">ibeis.algo.hots.chip_match.</code><code class="descname">extend_scores</code><span class="sig-paren">(</span><em>vals</em>, <em>num</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#extend_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.extend_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.chip_match.filtnorm_op">
<code class="descclassname">ibeis.algo.hots.chip_match.</code><code class="descname">filtnorm_op</code><span class="sig-paren">(</span><em>filtnorm_</em>, <em>op_</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#filtnorm_op"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.filtnorm_op" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.chip_match.get_chipmatch_fname">
<code class="descclassname">ibeis.algo.hots.chip_match.</code><code class="descname">get_chipmatch_fname</code><span class="sig-paren">(</span><em>qaid</em>, <em>qreq_</em>, <em>qauuid=None</em>, <em>cfgstr=None</em>, <em>TRUNCATE_UUIDS=False</em>, <em>MAX_FNAME_LEN=200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#get_chipmatch_fname"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.get_chipmatch_fname" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.chip_match --test-get_chipmatch_fname
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.chip_match</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre</span><span class="p">(</span><span class="s">&#39;spatial_verification&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                               <span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">qaid_override</span><span class="o">=</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                               <span class="n">p</span><span class="o">=</span><span class="s">&#39;default:sqrd_dist_on=True&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">cm_list_FILT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">get_chipmatch_fname</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">qaid</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qauuid</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">TRUNCATE_UUIDS</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">MAX_FNAME_LEN</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fname</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">qaid=18_cm_cvgrsbnffsgifyom_quuid=a126d459-b730-573e-7a21-92894b016565.cPkl</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.chip_match.safeop">
<code class="descclassname">ibeis.algo.hots.chip_match.</code><code class="descname">safeop</code><span class="sig-paren">(</span><em>op_</em>, <em>xs</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#safeop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.safeop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.chip_match.testdata_cm">
<code class="descclassname">ibeis.algo.hots.chip_match.</code><code class="descname">testdata_cm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/chip_match.html#testdata_cm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.chip_match.testdata_cm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.crf">
<span id="ibeis-algo-hots-crf-module"></span><h2>ibeis.algo.hots.crf module<a class="headerlink" href="#module-ibeis.algo.hots.crf" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.algo.hots.crf.chain_crf">
<code class="descclassname">ibeis.algo.hots.crf.</code><code class="descname">chain_crf</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/crf.html#chain_crf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.crf.chain_crf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.crf.crftest">
<code class="descclassname">ibeis.algo.hots.crf.</code><code class="descname">crftest</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/crf.html#crftest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.crf.crftest" title="Permalink to this definition">¶</a></dt>
<dd><p>pip install pyqpbo
pip install pystruct</p>
<p><a class="reference external" href="http://taku910.github.io/crfpp/#install">http://taku910.github.io/crfpp/#install</a></p>
<p>cd ~/tmp
#wget <a class="reference external" href="https://drive.google.com/folderview?id=0B4y35FiV1wh7fngteFhHQUN2Y1B5eUJBNHZUemJYQV9VWlBUb3JlX0xBdWVZTWtSbVBneU0&amp;usp=drive_web#list">https://drive.google.com/folderview?id=0B4y35FiV1wh7fngteFhHQUN2Y1B5eUJBNHZUemJYQV9VWlBUb3JlX0xBdWVZTWtSbVBneU0&amp;usp=drive_web#list</a>
7z x CRF++-0.58.tar.gz
7z x CRF++-0.58.tar
cd CRF++-0.58
chmod +x configure
./configure
make</p>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.demobayes">
<span id="ibeis-algo-hots-demobayes-module"></span><h2>ibeis.algo.hots.demobayes module<a class="headerlink" href="#module-ibeis.algo.hots.demobayes" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.algo.hots.demobayes.classify_k">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">classify_k</code><span class="sig-paren">(</span><em>cfg={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#classify_k"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.classify_k" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.demobayes --exec-classify_k --show --ev :nA<span class="o">=</span>3
python -m ibeis.algo.hots.demobayes --exec-classify_k --show --ev :nA<span class="o">=</span>3,k<span class="o">=</span>1
python -m ibeis.algo.hots.demobayes --exec-classify_k --show --ev :nA<span class="o">=</span>3,k<span class="o">=</span><span class="m">0</span> --method<span class="o">=</span>approx
python -m ibeis.algo.hots.demobayes --exec-classify_k --show --ev :nA<span class="o">=</span>10,k<span class="o">=</span><span class="m">1</span> --method<span class="o">=</span>approx
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfg_list</span> <span class="o">=</span> <span class="n">testdata_demo_cfgs</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">classify_k</span><span class="p">(</span><span class="n">cfg_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.classify_one_new_unknown">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">classify_one_new_unknown</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#classify_one_new_unknown"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.classify_one_new_unknown" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a model that knows who the previous annots are and tries to classify a new annot</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.demobayes --exec-classify_one_new_unknown --verbose
python -m ibeis.algo.hots.demobayes --exec-classify_one_new_unknown --show --verbose --present
python3 -m ibeis.algo.hots.demobayes --exec-classify_one_new_unknown --verbose
python3 -m ibeis.algo.hots.demobayes --exec-classify_one_new_unknown --verbose --diskshow --verbose --present --save demo5.png --dpath . --figsize<span class="o">=</span>20,10 --dpi<span class="o">=</span><span class="m">128</span> --clipwhite
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">classify_one_new_unknown</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.demo_ambiguity">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">demo_ambiguity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#demo_ambiguity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.demo_ambiguity" title="Permalink to this definition">¶</a></dt>
<dd><p>Test what happens when an annotation need to choose between one of two
names</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.demobayes --exec-demo_ambiguity --show --verbose --present
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">demo_ambiguity</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.demo_annot_idependence_overlap">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">demo_annot_idependence_overlap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#demo_annot_idependence_overlap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.demo_annot_idependence_overlap" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Given:</dt>
<dd><ul class="first last simple">
<li>an unknown annotation d</li>
<li>three annots with the same name (Fred) a, b, and c</li>
<li>a and b are near duplicates</li>
<li>(a and c) / (b and c) are novel views</li>
</ul>
</dd>
<dt>Goal:</dt>
<dd><ul class="first last">
<li><p class="first">If d matches to a and b the probably that d is Fred should not be
much more than if d matched only a or only b.</p>
</li>
<li><dl class="first docutils">
<dt>The probability that d is Fred given it matches to any of the 3 annots</dt>
<dd><p class="first">alone should be equal</p>
<blockquote class="last">
<div><p>P(d is Fred | Mad=1) = P(d is Fred | Mbd=1) = P(d is Fred | Mcd=1)</p>
</div></blockquote>
</dd>
</dl>
</li>
<li><p class="first">The probability that d is fred given two matches to any of those two annots
should be greater than the probability given only one.</p>
<blockquote>
<div><p>P(d is Fred | Mad=1, Mbd=1) &gt; P(d is Fred | Mad=1)
P(d is Fred | Mad=1, Mcd=1) &gt; P(d is Fred | Mad=1)</p>
</div></blockquote>
</li>
<li><p class="first">The probability that d is fred given matches to two near duplicate
matches should be less than
if d matches two non-duplicate matches.</p>
<blockquote>
<div><p>P(d is Fred | Mad=1, Mcd=1) &gt; P(d is Fred | Mad=1, Mbd=1)</p>
</div></blockquote>
</li>
<li><p class="first">The probability that d is fred given two near duplicates should be only epsilon greater than
a match to either one individually.</p>
<blockquote>
<div><p>P(d is Fred | Mad=1, Mbd=1) = P(d is Fred | Mad=1) + epsilon</p>
</div></blockquote>
</li>
</ul>
</dd>
</dl>
<p>Method:</p>
<blockquote>
<div><p>We need to model the fact that there are other causes that create the
effect of a high score.  Namely, near duplicates.
This can be done by adding an extra conditional that score depends on
if they match as well as if they are near duplicates.</p>
<p>P(S_ij | Mij) &#8211;&gt; P(S_ij | Mij, Dij)</p>
<p>where</p>
<p>Dij is a random variable indicating if the image is a near duplicate.</p>
<p>We can model this as an independant variable</p>
<p>P(Dij) = {True: .5, False: .5}</p>
<p>or as depending on if the names match.</p>
<p>P(Dij | Mij) = {&#8216;same&#8217;: {True: .5, False: .5} diff: {True: 0, False 1}}</p>
</div></blockquote>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.demobayes --exec-demo_annot_idependence_overlap --verbose --present --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">demo_annot_idependence_overlap</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.demo_bayesnet">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">demo_bayesnet</code><span class="sig-paren">(</span><em>cfg={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#demo_bayesnet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.demo_bayesnet" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a model that knows who the previous annots are and tries to classify a new annot</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis --tf demo_bayesnet --diskshow --verbose --save demo4.png --dpath . --figsize<span class="o">=</span>20,10 --dpi<span class="o">=</span><span class="m">128</span> --clipwhite

python -m ibeis --tf demo_bayesnet --ev :nA<span class="o">=</span>3,Sab<span class="o">=</span>0,Sac<span class="o">=</span>0,Sbc<span class="o">=</span>1
python -m ibeis --tf demo_bayesnet --ev :nA<span class="o">=</span>4,Sab<span class="o">=</span>0,Sac<span class="o">=</span>0,Sbc<span class="o">=</span>1,Sbd<span class="o">=</span><span class="m">1</span> --show
python -m ibeis --tf demo_bayesnet --ev :nA<span class="o">=</span>4,Sab<span class="o">=</span>0,Sac<span class="o">=</span>0,Sbc<span class="o">=</span>1,Scd<span class="o">=</span><span class="m">1</span> --show
python -m ibeis --tf demo_bayesnet --ev :nA<span class="o">=</span>4,Sab<span class="o">=</span>0,Sac<span class="o">=</span>0,Sbc<span class="o">=</span>1,Sbd<span class="o">=</span>1,Scd<span class="o">=</span><span class="m">1</span> --show

python -m ibeis --tf demo_bayesnet --ev :nA<span class="o">=</span>3,Sab<span class="o">=</span>0,Sac<span class="o">=</span>0,Sbc<span class="o">=</span>1
python -m ibeis --tf demo_bayesnet --ev :nA<span class="o">=</span>5,rand_scores<span class="o">=</span>True --show

python -m ibeis --tf demo_bayesnet --ev :nA<span class="o">=</span>4,nS<span class="o">=</span>3,rand_scores<span class="o">=</span>True --show --verbose
python -m ibeis --tf demo_bayesnet --ev :nA<span class="o">=</span>5,nS<span class="o">=</span>2,Na<span class="o">=</span>fred,rand_scores<span class="o">=</span>True --show --verbose
python -m ibeis --tf demo_bayesnet --ev :nA<span class="o">=</span>5,nS<span class="o">=</span>5,Na<span class="o">=</span>fred,rand_scores<span class="o">=</span>True --show --verbose
python -m ibeis --tf demo_bayesnet --ev :nA<span class="o">=</span>4,nS<span class="o">=</span>2,Na<span class="o">=</span>fred,rand_scores<span class="o">=</span>True --show --verbose

python -m ibeis.algo.hots.demobayes --exec-demo_bayesnet <span class="se">\</span>
        --ev <span class="o">=</span>:nA<span class="o">=</span>4,Sab<span class="o">=</span>0,Sac<span class="o">=</span>0,Sbc<span class="o">=</span><span class="m">1</span> <span class="se">\</span>
        :Sbd<span class="o">=</span><span class="m">1</span> :Scd<span class="o">=</span><span class="m">1</span> :Sbd<span class="o">=</span>1,Scd<span class="o">=</span><span class="m">1</span> :Sbd<span class="o">=</span>1,Scd<span class="o">=</span>1,Sad<span class="o">=</span><span class="m">0</span> <span class="se">\</span>
        --show --present
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfg_list</span> <span class="o">=</span> <span class="n">testdata_demo_cfgs</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;cfg_list = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cfg_list</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">cfg</span> <span class="ow">in</span> <span class="n">cfg_list</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">demo_bayesnet</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.demo_conflicting_evidence">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">demo_conflicting_evidence</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#demo_conflicting_evidence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.demo_conflicting_evidence" title="Permalink to this definition">¶</a></dt>
<dd><p>Notice that the number of annotations in the graph does not affect the
probability of names.</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.demo_model_idependencies">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">demo_model_idependencies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#demo_model_idependencies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.demo_model_idependencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Independences of the 3 annot 3 name model</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.demobayes --exec-demo_model_idependencies --mode<span class="o">=</span><span class="m">1</span> --num-names<span class="o">=</span><span class="m">2</span> --show
python -m ibeis.algo.hots.demobayes --exec-demo_model_idependencies --mode<span class="o">=</span>2
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">demo_model_idependencies</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.demo_modes">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">demo_modes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#demo_modes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.demo_modes" title="Permalink to this definition">¶</a></dt>
<dd><p>Look at the last result of the different names demo under differet modes</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.demo_name_annot_complexity">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">demo_name_annot_complexity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#demo_name_annot_complexity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.demo_name_annot_complexity" title="Permalink to this definition">¶</a></dt>
<dd><p>This demo is meant to show the structure of the graph as more annotations
and names are added.</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.demobayes --exec-demo_name_annot_complexity --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">demo_name_annot_complexity</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.demo_single_add">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">demo_single_add</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#demo_single_add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.demo_single_add" title="Permalink to this definition">¶</a></dt>
<dd><p>This demo shows how a name is assigned to a new annotation.</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.demobayes --exec-demo_single_add --show --present --mode<span class="o">=</span>1
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">demo_single_add</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.demo_structure">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">demo_structure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#demo_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.demo_structure" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.demobayes --exec-demo_structure --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">demo_structure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.get_toy_annots">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">get_toy_annots</code><span class="sig-paren">(</span><em>num_annots</em>, <em>num_names=None</em>, <em>initial_aids=None</em>, <em>initial_nids=None</em>, <em>nid_sequence=None</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#get_toy_annots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.get_toy_annots" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>num_annots</strong> (<em>int</em>) &#8211; </li>
<li><strong>num_names</strong> (<em>int</em>) &#8211; (default = None)</li>
<li><strong>initial_aids</strong> (<em>None</em>) &#8211; (default = None)</li>
<li><strong>initial_nids</strong> (<em>None</em>) &#8211; (default = None)</li>
<li><strong>nid_sequence</strong> (<em>None</em>) &#8211; (default = None)</li>
<li><strong>seed</strong> (<em>None</em>) &#8211; (default = None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(aids, nids, aids1, nids1, all_aids, all_nids)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.demobayes --exec-get_toy_annots
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_annots</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_names</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_aids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_nids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nid_sequence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seed</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">nids</span><span class="p">,</span> <span class="n">aids1</span><span class="p">,</span> <span class="n">nids1</span><span class="p">,</span> <span class="n">all_aids</span><span class="p">,</span> <span class="n">all_nids</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_toy_annots</span><span class="p">(</span><span class="n">num_annots</span><span class="p">,</span> <span class="n">num_names</span><span class="p">,</span> <span class="n">initial_aids</span><span class="p">,</span> <span class="n">initial_nids</span><span class="p">,</span> <span class="n">nid_sequence</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;(aids, nids, aids1, nids1, all_aids, all_nids) = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">aids</span><span class="p">,</span> <span class="n">nids</span><span class="p">,</span> <span class="n">aids1</span><span class="p">,</span> <span class="n">nids1</span><span class="p">,</span> <span class="n">all_aids</span><span class="p">,</span> <span class="n">all_nids</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.get_toy_data_1v1">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">get_toy_data_1v1</code><span class="sig-paren">(</span><em>num_annots=5</em>, <em>num_names=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#get_toy_data_1v1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.get_toy_data_1v1" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.demobayes --exec-get_toy_data_1v1 --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toy_data</span> <span class="o">=</span> <span class="n">get_toy_data_1v1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_toy_distributions</span><span class="p">(</span><span class="n">toy_data</span><span class="p">[</span><span class="s">&#39;toy_params&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toy_data</span> <span class="o">=</span> <span class="n">get_toy_data_1v1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_aids</span> <span class="o">=</span> <span class="n">toy_data</span><span class="p">[</span><span class="s">&#39;aids&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_nids</span> <span class="o">=</span> <span class="n">toy_data</span><span class="p">[</span><span class="s">&#39;nids&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_annots</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_names</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toy_data2</span> <span class="o">=</span> <span class="n">get_toy_data_1v1</span><span class="p">(</span><span class="n">num_annots</span><span class="p">,</span> <span class="n">num_names</span><span class="p">,</span> <span class="n">initial_aids</span><span class="o">=</span><span class="n">initial_aids</span><span class="p">,</span> <span class="n">initial_nids</span><span class="o">=</span><span class="n">initial_nids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_toy_distributions</span><span class="p">(</span><span class="n">toy_data</span><span class="p">[</span><span class="s">&#39;toy_params&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.get_toy_data_1vM">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">get_toy_data_1vM</code><span class="sig-paren">(</span><em>num_annots</em>, <em>num_names=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#get_toy_data_1vM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.get_toy_data_1vM" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num_annots</strong> (<em>int</em>) &#8211; </li>
<li><strong>num_names</strong> (<em>int</em>) &#8211; (default = None)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>initial_aids, initial_nids, nid_sequence, seed</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(pair_list, feat_list)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.demobayes --exec-get_toy_data_1vM --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_annots</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_names</span> <span class="o">=</span> <span class="mi">40</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_toy_data_1vM</span><span class="p">(</span><span class="n">num_annots</span><span class="p">,</span> <span class="n">num_names</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.learn_prob_score">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">learn_prob_score</code><span class="sig-paren">(</span><em>num_scores=5</em>, <em>pad=55</em>, <em>ret_enc=False</em>, <em>use_cache=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#learn_prob_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.learn_prob_score" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>num_scores</strong> (<em>int</em>) &#8211; (default = 5)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(discr_domain, discr_p_same)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.demobayes --exec-learn_prob_score --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_scores</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">discr_domain</span><span class="p">,</span> <span class="n">discr_p_same</span><span class="p">,</span> <span class="n">encoder</span><span class="p">)</span> <span class="o">=</span> <span class="n">learn_prob_score</span><span class="p">(</span><span class="n">num_scores</span><span class="p">,</span> <span class="n">ret_enc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">use_cache</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;discr_p_same = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">discr_p_same</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.make_bayes_notebook">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">make_bayes_notebook</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#make_bayes_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.make_bayes_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.demobayes --exec-make_bayes_notebook
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">make_bayes_notebook</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.show_model_templates">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">show_model_templates</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#show_model_templates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.show_model_templates" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.demobayes --exec-show_model_templates
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">show_model_templates</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.show_toy_distributions">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">show_toy_distributions</code><span class="sig-paren">(</span><em>toy_params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#show_toy_distributions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.show_toy_distributions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.test_triangle_property">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">test_triangle_property</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#test_triangle_property"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.test_triangle_property" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.demobayes --exec-test_triangle_property --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.demobayes</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">test_triangle_property</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.demobayes.testdata_demo_cfgs">
<code class="descclassname">ibeis.algo.hots.demobayes.</code><code class="descname">testdata_demo_cfgs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/demobayes.html#testdata_demo_cfgs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.demobayes.testdata_demo_cfgs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.devcases">
<span id="ibeis-algo-hots-devcases-module"></span><h2>ibeis.algo.hots.devcases module<a class="headerlink" href="#module-ibeis.algo.hots.devcases" title="Permalink to this headline">¶</a></h2>
<p>development module storing my &#8220;development state&#8221;</p>
<dl class="docutils">
<dt>TODO:</dt>
<dd><ul class="first">
<li><dl class="first docutils">
<dt>figure out what packages I use have lisencing issues.</dt>
<dd><ul class="first last simple">
<li>Reimplement them or work around them.</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p class="last">Excplitict Negative Matches between chips</p>
</dd>
</dl>
<dl class="function">
<dt id="ibeis.algo.hots.devcases.find_close_incorrect_match">
<code class="descclassname">ibeis.algo.hots.devcases.</code><code class="descname">find_close_incorrect_match</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaids</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/devcases.html#find_close_incorrect_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.devcases.find_close_incorrect_match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.devcases.fix_pz_master">
<code class="descclassname">ibeis.algo.hots.devcases.</code><code class="descname">fix_pz_master</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/devcases.html#fix_pz_master"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.devcases.fix_pz_master" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.devcases --test-fix_pz_master --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.devcases</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">fix_pz_master</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.devcases.get_dev_test_fpaths">
<code class="descclassname">ibeis.algo.hots.devcases.</code><code class="descname">get_dev_test_fpaths</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/devcases.html#get_dev_test_fpaths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.devcases.get_dev_test_fpaths" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.devcases.get_gzall_small_test">
<code class="descclassname">ibeis.algo.hots.devcases.</code><code class="descname">get_gzall_small_test</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/devcases.html#get_gzall_small_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.devcases.get_gzall_small_test" title="Permalink to this definition">¶</a></dt>
<dd><p>ibs.get_annot_visual_uuids([qaid, aid])</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.devcases.get_pz_master_testcase">
<code class="descclassname">ibeis.algo.hots.devcases.</code><code class="descname">get_pz_master_testcase</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/devcases.html#get_pz_master_testcase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.devcases.get_pz_master_testcase" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.devcases.load_gztest">
<code class="descclassname">ibeis.algo.hots.devcases.</code><code class="descname">load_gztest</code><span class="sig-paren">(</span><em>ibs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/devcases.html#load_gztest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.devcases.load_gztest" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.special_query --test-load_gztest
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.devcases</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;GZ_ALL&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.devcases.myquery">
<code class="descclassname">ibeis.algo.hots.devcases.</code><code class="descname">myquery</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/devcases.html#myquery"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.devcases.myquery" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>BUG::</dt>
<dd><p class="first">THERE IS A BUG SOMEWHERE: HOW IS THIS POSSIBLE?
if everything is weightd ) how di the true positive even get a score
while the true negative did not
qres_copy.filtkey_list = [&#8216;ratio&#8217;, &#8216;fg&#8217;, &#8216;homogerr&#8217;, &#8216;distinctiveness&#8217;]
CORRECT STATS
{</p>
<blockquote>
<div>&#8216;max&#8217;  : [0.832, 0.968, 0.604, 0.000],
&#8216;min&#8217;  : [0.376, 0.524, 0.000, 0.000],
&#8216;mean&#8217; : [0.561, 0.924, 0.217, 0.000],
&#8216;std&#8217;  : [0.114, 0.072, 0.205, 0.000],
&#8216;nMin&#8217; : [1, 1, 1, 51],
&#8216;nMax&#8217; : [1, 1, 1, 1],
&#8216;shape&#8217;: (52, 4),</div></blockquote>
<p>}
INCORRECT STATS
{</p>
<blockquote>
<div>&#8216;max&#8217;  : [0.759, 0.963, 0.264, 0.000],
&#8216;min&#8217;  : [0.379, 0.823, 0.000, 0.000],
&#8216;mean&#8217; : [0.506, 0.915, 0.056, 0.000],
&#8216;std&#8217;  : [0.125, 0.039, 0.078, 0.000],
&#8216;nMin&#8217; : [1, 1, 1, 24],
&#8216;nMax&#8217; : [1, 1, 1, 1],
&#8216;shape&#8217;: (26, 4),</div></blockquote>
<dl class="last docutils">
<dt>#   score_diff,  tp_score,  tn_score,       p,   K,  dcvs_clip_max,  fg_power,  homogerr_power</dt>
<dd>0.494,     0.494,     0.000,  73.000,   2,          0.500,     0.100,          10.000</dd>
</dl>
</dd>
</dl>
<p>see how seperability changes as we very things</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.devcases --test-myquery
python -m ibeis.algo.hots.devcases --test-myquery --show --index 0
python -m ibeis.algo.hots.devcases --test-myquery --show --index 1
python -m ibeis.algo.hots.devcases --test-myquery --show --index 2
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Pareto_distribution">http://en.wikipedia.org/wiki/Pareto_distribution</a> &lt;- look into</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.all_imports</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.devcases</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">dev_ipython_copypaster</span><span class="p">(</span><span class="n">myquery</span><span class="p">)</span> <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">()</span> <span class="k">else</span> <span class="n">myquery</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.devcases.show_power_law_plots">
<code class="descclassname">ibeis.algo.hots.devcases.</code><code class="descname">show_power_law_plots</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/devcases.html#show_power_law_plots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.devcases.show_power_law_plots" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.devcases --test-show_power_law_plots --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#%pylab qt4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.all_imports</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.devcases</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_power_law_plots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.devcases.testdata_my_exmaples">
<code class="descclassname">ibeis.algo.hots.devcases.</code><code class="descname">testdata_my_exmaples</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/devcases.html#testdata_my_exmaples"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.devcases.testdata_my_exmaples" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.all_imports</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.devcases</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.distinctiveness_normalizer">
<span id="ibeis-algo-hots-distinctiveness-normalizer-module"></span><h2>ibeis.algo.hots.distinctiveness_normalizer module<a class="headerlink" href="#module-ibeis.algo.hots.distinctiveness_normalizer" title="Permalink to this headline">¶</a></h2>
<p>External mechanism for computing feature distinctiveness</p>
<p>stores some set of vectors which lose their association with
their parent.</p>
<dl class="class">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.distinctiveness_normalizer.</code><code class="descname">DistinctivnessNormalizer</code><span class="sig-paren">(</span><em>dstcnvs_normer</em>, <em>species</em>, <em>cachedir=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#DistinctivnessNormalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">utool.util_cache.Cachable</span></code></p>
<dl class="method">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.add_support">
<code class="descname">add_support</code><span class="sig-paren">(</span><em>dstcnvs_normer</em>, <em>new_vecs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#DistinctivnessNormalizer.add_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.add_support" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.archive">
<code class="descname">archive</code><span class="sig-paren">(</span><em>dstcnvs_normer</em>, <em>cachedir=None</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#DistinctivnessNormalizer.archive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.archive" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.ensure_flann">
<code class="descname">ensure_flann</code><span class="sig-paren">(</span><em>dstcnvs_normer</em>, <em>cachedir=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#DistinctivnessNormalizer.ensure_flann"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.ensure_flann" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.exists">
<code class="descname">exists</code><span class="sig-paren">(</span><em>dstcnvs_normer</em>, <em>cachedir=None</em>, <em>verbose=True</em>, <em>need_flann=False</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#DistinctivnessNormalizer.exists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.exists" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cachedir</strong> (<em>str</em>) &#8211; cache directory</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; verbosity flag</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">load_success</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">flag</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.distinctiveness_normalizer --test-exists
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.distinctiveness_normalizer</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dstcnvs_normer</span> <span class="o">=</span> <span class="n">testdata_distinctiveness</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">dstcnvs_normer</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.ext">
<code class="descname">ext</code><em class="property"> = u'.cPkl'</em><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.ext" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.get_cfgstr">
<code class="descname">get_cfgstr</code><span class="sig-paren">(</span><em>dstcnvs_normer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#DistinctivnessNormalizer.get_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.get_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.get_distinctiveness">
<code class="descname">get_distinctiveness</code><span class="sig-paren">(</span><em>dstcnvs_normer</em>, <em>qfx2_vec</em>, <em>dcvs_K=2</em>, <em>dcvs_power=1.0</em>, <em>dcvs_max_clip=1.0</em>, <em>dcvs_min_clip=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#DistinctivnessNormalizer.get_distinctiveness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.get_distinctiveness" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_vec</strong> (<em>ndarray</em>) &#8211; mapping from query feature index to vec</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.distinctiveness_normalizer --test-get_distinctiveness --show
python -m ibeis.algo.hots.distinctiveness_normalizer --test-get_distinctiveness --db GZ_ALL --show
python -m ibeis.algo.hots.distinctiveness_normalizer --test-get_distinctiveness --show --dcvs_power .25
python -m ibeis.algo.hots.distinctiveness_normalizer --test-get_distinctiveness --show --dcvs_power .5
python -m ibeis.algo.hots.distinctiveness_normalizer --test-get_distinctiveness --show --dcvs_power .1
python -m ibeis.algo.hots.distinctiveness_normalizer --test-get_distinctiveness --show --dcvs_K 1<span class="p">&amp;</span>
python -m ibeis.algo.hots.distinctiveness_normalizer --test-get_distinctiveness --show --dcvs_K 2<span class="p">&amp;</span>
python -m ibeis.algo.hots.distinctiveness_normalizer --test-get_distinctiveness --show --dcvs_K 3<span class="p">&amp;</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.distinctiveness_normalizer</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dstcnvs_normer</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">testdata_distinctiveness</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="n">qaid</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;dcvs_power&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="s">&#39;dcvs_K&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;dcvs_max_clip&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">argparse_dict</span><span class="p">(</span><span class="n">default_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_dstncvs</span> <span class="o">=</span> <span class="n">dstcnvs_normer</span><span class="o">.</span><span class="n">get_distinctiveness</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qfx2_dstncvs</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">qfx2_dstncvs</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">qfx2_dstncvs</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Show distinctivness on an animal and a corresponding graph</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_chips</span><span class="p">(</span><span class="n">qaid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_kpts</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_kpts</span><span class="p">(</span><span class="n">qaid</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_chip_distinctiveness_plot</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">qfx2_kpts</span><span class="p">,</span> <span class="n">qfx2_dstncvs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#pt.figure(2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#pt.show_all_colormaps()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.get_flann_fpath">
<code class="descname">get_flann_fpath</code><span class="sig-paren">(</span><em>dstcnvs_normer</em>, <em>cachedir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#DistinctivnessNormalizer.get_flann_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.get_flann_fpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.get_prefix">
<code class="descname">get_prefix</code><span class="sig-paren">(</span><em>dstcnvs_normer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#DistinctivnessNormalizer.get_prefix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.get_prefix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.init_support">
<code class="descname">init_support</code><span class="sig-paren">(</span><em>dstcnvs_normer</em>, <em>vecs</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#DistinctivnessNormalizer.init_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.init_support" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>dstcnvs_normer</em>, <em>cachedir=None</em>, <em>verbose=True</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#DistinctivnessNormalizer.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.load_or_build_flann">
<code class="descname">load_or_build_flann</code><span class="sig-paren">(</span><em>dstcnvs_normer</em>, <em>cachedir=None</em>, <em>verbose=True</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#DistinctivnessNormalizer.load_or_build_flann"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.load_or_build_flann" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.prefix">
<code class="descname">prefix</code><em class="property"> = u'distinctivness'</em><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.prefix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.publish">
<code class="descname">publish</code><span class="sig-paren">(</span><em>dstcnvs_normer</em>, <em>cachedir=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#DistinctivnessNormalizer.publish"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.publish" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets this as the default normalizer available for download
ONLY DEVELOPERS CAN PERFORM THIS OPERATION</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cachedir</strong> (<em>str</em>) &#8211; </td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.distinctiveness_normalizer --test-publish
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.distinctiveness_normalizer</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dstcnvs_normer</span> <span class="o">=</span> <span class="n">testdata_distinctiveness</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dstcnvs_normer</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dstcnvs_normer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">dstcnvs_normer</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">cachedir</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.rebuild">
<code class="descname">rebuild</code><span class="sig-paren">(</span><em>dstcnvs_normer</em>, <em>verbose=True</em>, <em>quiet=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#DistinctivnessNormalizer.rebuild"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.rebuild" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>dstcnvs_normer</em>, <em>cachedir=None</em>, <em>verbose=True</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#DistinctivnessNormalizer.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.save" title="Permalink to this definition">¶</a></dt>
<dd><p>args = tuple()
kwargs = {}</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.save_flann">
<code class="descname">save_flann</code><span class="sig-paren">(</span><em>dstcnvs_normer</em>, <em>cachedir=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#DistinctivnessNormalizer.save_flann"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.DistinctivnessNormalizer.save_flann" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.clear_distinctivness_cache">
<code class="descclassname">ibeis.algo.hots.distinctiveness_normalizer.</code><code class="descname">clear_distinctivness_cache</code><span class="sig-paren">(</span><em>j</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#clear_distinctivness_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.clear_distinctivness_cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.compute_distinctiveness_from_dist">
<code class="descclassname">ibeis.algo.hots.distinctiveness_normalizer.</code><code class="descname">compute_distinctiveness_from_dist</code><span class="sig-paren">(</span><em>norm_dist</em>, <em>dcvs_power</em>, <em>dcvs_max_clip</em>, <em>dcvs_min_clip</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#compute_distinctiveness_from_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.compute_distinctiveness_from_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute distinctiveness from distance to dcvs_K+1 nearest neighbor</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.dev_train_distinctiveness">
<code class="descclassname">ibeis.algo.hots.distinctiveness_normalizer.</code><code class="descname">dev_train_distinctiveness</code><span class="sig-paren">(</span><em>species=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#dev_train_distinctiveness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.dev_train_distinctiveness" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; ibeis controller object</li>
<li><strong>species</strong> (<em>None</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.distinctiveness_normalizer --test-dev_train_distinctiveness

<span class="nb">alias </span><span class="nv">dev_train_distinctiveness</span><span class="o">=</span><span class="s1">&#39;python -m ibeis.algo.hots.distinctiveness_normalizer --test-dev_train_distinctiveness&#39;</span>
<span class="c"># Publishing (uses cached normalizers if available)</span>
dev_train_distinctiveness --species GZ --publish
dev_train_distinctiveness --species PZ --publish
dev_train_distinctiveness --species PZ --retrain
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.distinctiveness_normalizer</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">species</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--species&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="s">&#39;zebra_grevys&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dev_train_distinctiveness</span><span class="p">(</span><span class="n">species</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.download_baseline_distinctiveness_normalizer">
<code class="descclassname">ibeis.algo.hots.distinctiveness_normalizer.</code><code class="descname">download_baseline_distinctiveness_normalizer</code><span class="sig-paren">(</span><em>cachedir</em>, <em>species</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#download_baseline_distinctiveness_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.download_baseline_distinctiveness_normalizer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.list_distinctivness_cache">
<code class="descclassname">ibeis.algo.hots.distinctiveness_normalizer.</code><code class="descname">list_distinctivness_cache</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#list_distinctivness_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.list_distinctivness_cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.list_published_distinctivness">
<code class="descclassname">ibeis.algo.hots.distinctiveness_normalizer.</code><code class="descname">list_published_distinctivness</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#list_published_distinctivness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.list_published_distinctivness" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.distinctiveness_normalizer --test-list_published_distinctivness
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.distinctiveness_normalizer</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">published_fpaths</span> <span class="o">=</span> <span class="n">list_published_distinctivness</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">published_fpaths</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.request_ibeis_distinctiveness_normalizer">
<code class="descclassname">ibeis.algo.hots.distinctiveness_normalizer.</code><code class="descname">request_ibeis_distinctiveness_normalizer</code><span class="sig-paren">(</span><em>qreq_</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#request_ibeis_distinctiveness_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.request_ibeis_distinctiveness_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.distinctiveness_normalizer --test-request_ibeis_distinctiveness_normalizer
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.distinctiveness_normalizer</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">ibeis</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">TEST_SPECIES</span><span class="o">.</span><span class="n">ZEB_PLAIN</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">ibeis</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">TEST_SPECIES</span><span class="o">.</span><span class="n">ZEB_PLAIN</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dstcnvs_normer</span> <span class="o">=</span> <span class="n">request_ibeis_distinctiveness_normalizer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">dstcnvs_normer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.request_species_distinctiveness_normalizer">
<code class="descclassname">ibeis.algo.hots.distinctiveness_normalizer.</code><code class="descname">request_species_distinctiveness_normalizer</code><span class="sig-paren">(</span><em>species</em>, <em>cachedir=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#request_species_distinctiveness_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.request_species_distinctiveness_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function to get distinctivness model independent of IBEIS.</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.show_chip_distinctiveness_plot">
<code class="descclassname">ibeis.algo.hots.distinctiveness_normalizer.</code><code class="descname">show_chip_distinctiveness_plot</code><span class="sig-paren">(</span><em>chip</em>, <em>kpts</em>, <em>dstncvs</em>, <em>fnum=1</em>, <em>pnum=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#show_chip_distinctiveness_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.show_chip_distinctiveness_plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.test_single_annot_distinctiveness_params">
<code class="descclassname">ibeis.algo.hots.distinctiveness_normalizer.</code><code class="descname">test_single_annot_distinctiveness_params</code><span class="sig-paren">(</span><em>ibs</em>, <em>aid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#test_single_annot_distinctiveness_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.test_single_annot_distinctiveness_params" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.distinctiveness_normalizer --test-test_single_annot_distinctiveness_params --show
python -m ibeis.algo.hots.distinctiveness_normalizer --test-test_single_annot_distinctiveness_params --show --db GZ_ALL
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.distinctiveness_normalizer</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--db&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--aid&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_single_annot_distinctiveness_params</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.testdata_distinctiveness">
<code class="descclassname">ibeis.algo.hots.distinctiveness_normalizer.</code><code class="descname">testdata_distinctiveness</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#testdata_distinctiveness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.testdata_distinctiveness" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.distinctiveness_normalizer</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dstcnvs_normer</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">testdata_distinctiveness</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.view_distinctiveness_model_dir">
<code class="descclassname">ibeis.algo.hots.distinctiveness_normalizer.</code><code class="descname">view_distinctiveness_model_dir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#view_distinctiveness_model_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.view_distinctiveness_model_dir" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.distinctiveness_normalizer --test-view_distinctiveness_model_dir
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.distinctiveness_normalizer</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view_distinctiveness_model_dir</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.distinctiveness_normalizer.view_publish_dir">
<code class="descclassname">ibeis.algo.hots.distinctiveness_normalizer.</code><code class="descname">view_publish_dir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/distinctiveness_normalizer.html#view_publish_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.distinctiveness_normalizer.view_publish_dir" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.distinctiveness_normalizer --test-view_publish_dir
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.distinctiveness_normalizer</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view_publish_dir</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.exceptions">
<span id="ibeis-algo-hots-exceptions-module"></span><h2>ibeis.algo.hots.exceptions module<a class="headerlink" href="#module-ibeis.algo.hots.exceptions" title="Permalink to this headline">¶</a></h2>
<dl class="exception">
<dt id="ibeis.algo.hots.exceptions.HotsCacheMissError">
<em class="property">exception </em><code class="descclassname">ibeis.algo.hots.exceptions.</code><code class="descname">HotsCacheMissError</code><a class="reference internal" href="_modules/ibeis/algo/hots/exceptions.html#HotsCacheMissError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.exceptions.HotsCacheMissError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

<dl class="exception">
<dt id="ibeis.algo.hots.exceptions.HotsNeedsRecomputeError">
<em class="property">exception </em><code class="descclassname">ibeis.algo.hots.exceptions.</code><code class="descname">HotsNeedsRecomputeError</code><a class="reference internal" href="_modules/ibeis/algo/hots/exceptions.html#HotsNeedsRecomputeError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.exceptions.HotsNeedsRecomputeError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.exceptions.NoDescriptorsException">
<code class="descclassname">ibeis.algo.hots.exceptions.</code><code class="descname">NoDescriptorsException</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/exceptions.html#NoDescriptorsException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.exceptions.NoDescriptorsException" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="exception">
<dt id="ibeis.algo.hots.exceptions.QueryException">
<em class="property">exception </em><code class="descclassname">ibeis.algo.hots.exceptions.</code><code class="descname">QueryException</code><span class="sig-paren">(</span><em>msg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/exceptions.html#QueryException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.exceptions.QueryException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.hstypes">
<span id="ibeis-algo-hots-hstypes-module"></span><h2>ibeis.algo.hots.hstypes module<a class="headerlink" href="#module-ibeis.algo.hots.hstypes" title="Permalink to this headline">¶</a></h2>
<p>hstypes
Todo:
* SIFT: Root_SIFT -&gt; L2 normalized -&gt; Centering.
# <a class="reference external" href="http://hal.archives-ouvertes.fr/docs/00/84/07/21/PDF/RR-8325.pdf">http://hal.archives-ouvertes.fr/docs/00/84/07/21/PDF/RR-8325.pdf</a>
The devil is in the deatails
<a class="reference external" href="http://www.robots.ox.ac.uk/~vilem/bmvc2011.pdf">http://www.robots.ox.ac.uk/~vilem/bmvc2011.pdf</a>
This says dont clip, do rootsift instead
# <a class="reference external" href="http://hal.archives-ouvertes.fr/docs/00/68/81/69/PDF/hal_v1.pdf">http://hal.archives-ouvertes.fr/docs/00/68/81/69/PDF/hal_v1.pdf</a>
* Quantization of residual vectors
* Burstiness normalization for N-SMK
* Implemented A-SMK
* Incorporate Spatial Verification
* Implement correct cfgstrs based on algorithm input
for cached computations.
* Color by word
* Profile on hyrule
* Train vocab on paris
* Remove self matches.
* New SIFT parameters for pyhesaff (root, powerlaw, meanwhatever, output_dtype)</p>
<dl class="docutils">
<dt>TODO:</dt>
<dd>This needs to be less constant when using non-sift descriptors</dd>
</dl>
<p>Issues:
* 10GB are in use when performing query on Oxford 5K
* errors when there is a word without any database vectors.
currently a weight of zero is hacked in</p>
<dl class="class">
<dt id="ibeis.algo.hots.hstypes.FiltKeys">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.hstypes.</code><code class="descname">FiltKeys</code><a class="reference internal" href="_modules/ibeis/algo/hots/hstypes.html#FiltKeys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.hstypes.FiltKeys" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="attribute">
<dt id="ibeis.algo.hots.hstypes.FiltKeys.BARL2">
<code class="descname">BARL2</code><em class="property"> = 'bar_l2'</em><a class="headerlink" href="#ibeis.algo.hots.hstypes.FiltKeys.BARL2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.hstypes.FiltKeys.DIST">
<code class="descname">DIST</code><em class="property"> = 'dist'</em><a class="headerlink" href="#ibeis.algo.hots.hstypes.FiltKeys.DIST" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.hstypes.FiltKeys.DISTINCTIVENESS">
<code class="descname">DISTINCTIVENESS</code><em class="property"> = 'distinctiveness'</em><a class="headerlink" href="#ibeis.algo.hots.hstypes.FiltKeys.DISTINCTIVENESS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.hstypes.FiltKeys.FG">
<code class="descname">FG</code><em class="property"> = 'fg'</em><a class="headerlink" href="#ibeis.algo.hots.hstypes.FiltKeys.FG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.hstypes.FiltKeys.HOMOGERR">
<code class="descname">HOMOGERR</code><em class="property"> = 'homogerr'</em><a class="headerlink" href="#ibeis.algo.hots.hstypes.FiltKeys.HOMOGERR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.hstypes.FiltKeys.LNBNN">
<code class="descname">LNBNN</code><em class="property"> = 'lnbnn'</em><a class="headerlink" href="#ibeis.algo.hots.hstypes.FiltKeys.LNBNN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.hstypes.FiltKeys.RATIO">
<code class="descname">RATIO</code><em class="property"> = 'ratio'</em><a class="headerlink" href="#ibeis.algo.hots.hstypes.FiltKeys.RATIO" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="data">
<dt id="ibeis.algo.hots.hstypes.PSEUDO_UINT8_MAX_SQRD">
<code class="descclassname">ibeis.algo.hots.hstypes.</code><code class="descname">PSEUDO_UINT8_MAX_SQRD</code><em class="property"> = 262144.0</em><a class="headerlink" href="#ibeis.algo.hots.hstypes.PSEUDO_UINT8_MAX_SQRD" title="Permalink to this definition">¶</a></dt>
<dd><p><em>SeeAlso</em> &#8211; vt.distance.understanding_pseudomax_props</p>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.match_chips4">
<span id="ibeis-algo-hots-match-chips4-module"></span><h2>ibeis.algo.hots.match_chips4 module<a class="headerlink" href="#module-ibeis.algo.hots.match_chips4" title="Permalink to this headline">¶</a></h2>
<p>Runs functions in pipeline to get query reuslts and does some caching.</p>
<dl class="function">
<dt id="ibeis.algo.hots.match_chips4.empty_query">
<code class="descclassname">ibeis.algo.hots.match_chips4.</code><code class="descname">empty_query</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaids</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/match_chips4.html#empty_query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.match_chips4.empty_query" title="Permalink to this definition">¶</a></dt>
<dd><p>Hack to give an empty query a query result object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; ibeis controller object</li>
<li><strong>qaids</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(qaid2_cm, <a href="#id11"><span class="problematic" id="id12">qreq_</span></a>)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.match_chips4 --test-empty_query
python -m ibeis.algo.hots.match_chips4 --test-empty_query --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.match_chips4</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">ibeis</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">TEST_SPECIES</span><span class="o">.</span><span class="n">ZEB_PLAIN</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qaid2_cm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span> <span class="o">=</span> <span class="n">empty_query</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">qaid2_cm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">qaid2_cm</span><span class="p">[</span><span class="n">qaids</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">get_top_aids</span><span class="p">()),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">ishow_top</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">make_figtitle</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">show_query</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sidebyside</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.match_chips4.execute_query2">
<code class="descclassname">ibeis.algo.hots.match_chips4.</code><code class="descname">execute_query2</code><span class="sig-paren">(</span><em>ibs</em>, <em>qreq_</em>, <em>verbose</em>, <em>save_qcache</em>, <em>batch_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/match_chips4.html#execute_query2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.match_chips4.execute_query2" title="Permalink to this definition">¶</a></dt>
<dd><p>Breaks up query request into several subrequests
to process &#8220;more efficiently&#8221; and safer as well.</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.match_chips4.execute_query_and_save_L1">
<code class="descclassname">ibeis.algo.hots.match_chips4.</code><code class="descname">execute_query_and_save_L1</code><span class="sig-paren">(</span><em>ibs</em>, <em>qreq_</em>, <em>use_cache</em>, <em>save_qcache</em>, <em>verbose=True</em>, <em>batch_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/match_chips4.html#execute_query_and_save_L1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.match_chips4.execute_query_and_save_L1" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; </li>
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; </li>
<li><strong>use_cache</strong> (<em>bool</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">qaid2_cm</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.match_chips4 --test-execute_query_and_save_L1:0
python -m ibeis.algo.hots.match_chips4 --test-execute_query_and_save_L1:1
python -m ibeis.algo.hots.match_chips4 --test-execute_query_and_save_L1:2
python -m ibeis.algo.hots.match_chips4 --test-execute_query_and_save_L1:3
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.match_chips4</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsmany&#39;</span><span class="p">,</span> <span class="n">sv_on</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="s">&#39;default&#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_cfg_lbl</span><span class="p">(</span><span class="n">cfgdict1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">main_helpers</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">qaid_override</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span><span class="p">,</span> <span class="n">save_qcache</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_cm</span> <span class="o">=</span> <span class="n">execute_query_and_save_L1</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">,</span> <span class="n">save_qcache</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qaid2_cm</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.match_chips4</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">,</span> <span class="n">sv_on</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="s">&#39;default&#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_cfg_lbl</span><span class="p">(</span><span class="n">cfgdict1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">main_helpers</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">qaid_override</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span><span class="p">,</span> <span class="n">save_qcache</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_cm</span> <span class="o">=</span> <span class="n">execute_query_and_save_L1</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">,</span> <span class="n">save_qcache</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qaid2_cm</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># TEST SAVE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.match_chips4</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsmany&#39;</span><span class="p">,</span> <span class="n">sv_on</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="s">&#39;default&#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_cfg_lbl</span><span class="p">(</span><span class="n">cfgdict1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">main_helpers</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">qaid_override</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span><span class="p">,</span> <span class="n">save_qcache</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_cm</span> <span class="o">=</span> <span class="n">execute_query_and_save_L1</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">,</span> <span class="n">save_qcache</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qaid2_cm</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># TEST LOAD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.match_chips4</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsmany&#39;</span><span class="p">,</span> <span class="n">sv_on</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="s">&#39;default&#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_cfg_lbl</span><span class="p">(</span><span class="n">cfgdict1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">main_helpers</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">qaid_override</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span><span class="p">,</span> <span class="n">save_qcache</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_cm</span> <span class="o">=</span> <span class="n">execute_query_and_save_L1</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">,</span> <span class="n">save_qcache</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qaid2_cm</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># TEST PARTIAL HIT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.match_chips4</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsmany&#39;</span><span class="p">,</span> <span class="n">sv_on</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">prescore_method</span><span class="o">=</span><span class="s">&#39;csum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="s">&#39;default&#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_cfg_lbl</span><span class="p">(</span><span class="n">cfgdict1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">main_helpers</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">qaid_override</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span><span class="p">,</span> <span class="n">save_qcache</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_cm</span> <span class="o">=</span> <span class="n">execute_query_and_save_L1</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">,</span> <span class="n">save_qcache</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">qaid2_cm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">get_fpath</span><span class="p">(</span><span class="n">qreq_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">qaid2_cm</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">get_fpath</span><span class="p">(</span><span class="n">qreq_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">qaid2_cm</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">get_fpath</span><span class="p">(</span><span class="n">qreq_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">qaid2_cm</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">get_fpath</span><span class="p">(</span><span class="n">qreq_</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Re-execute&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_cm_</span> <span class="o">=</span> <span class="n">execute_query_and_save_L1</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">,</span> <span class="n">save_qcache</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">qaid2_cm_</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span> <span class="o">==</span> <span class="n">qaid2_cm</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span> <span class="k">for</span> <span class="n">qaid</span> <span class="ow">in</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span> <span class="k">for</span> <span class="n">fpath</span> <span class="ow">in</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_chipmatch_fpaths</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">())]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.match_chips4.submit_query_request">
<code class="descclassname">ibeis.algo.hots.match_chips4.</code><code class="descname">submit_query_request</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid_list</em>, <em>daid_list</em>, <em>use_cache=None</em>, <em>use_bigcache=None</em>, <em>cfgdict=None</em>, <em>qreq_=None</em>, <em>verbose=False</em>, <em>save_qcache=None</em>, <em>prog_hook=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/match_chips4.html#submit_query_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.match_chips4.submit_query_request" title="Permalink to this definition">¶</a></dt>
<dd><p>The standard query interface.</p>
<p>TODO: rename use_cache to use_qcache</p>
<p>Checks a big cache for qaid2_cm.  If cache miss, tries to load each cm
individually.  On an individual cache miss, it preforms the query.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; ibeis control object</li>
<li><strong>qaid_list</strong> (<em>list</em>) &#8211; query annotation ids</li>
<li><strong>daid_list</strong> (<em>list</em>) &#8211; database annotation ids</li>
<li><strong>use_cache</strong> (<em>bool</em>) &#8211; </li>
<li><strong>use_bigcache</strong> (<em>bool</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>qaid2_cm</strong> &#8211; dict of QueryResult objects</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.match_chips4 --test-submit_query_request
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.match_chips4</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_bigcache</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="p">{},</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_cm</span> <span class="o">=</span> <span class="n">submit_query_request</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">,</span> <span class="n">use_bigcache</span><span class="p">,</span> <span class="n">qreq_</span><span class="o">=</span><span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.match_chips4.submit_query_request_nocache">
<code class="descclassname">ibeis.algo.hots.match_chips4.</code><code class="descname">submit_query_request_nocache</code><span class="sig-paren">(</span><em>ibs</em>, <em>qreq_</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/match_chips4.html#submit_query_request_nocache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.match_chips4.submit_query_request_nocache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.multi_index">
<span id="ibeis-algo-hots-multi-index-module"></span><h2>ibeis.algo.hots.multi_index module<a class="headerlink" href="#module-ibeis.algo.hots.multi_index" title="Permalink to this headline">¶</a></h2>
<p>module which uses multiple flann indexes as a way of working around adding
points to a single flann structure which seems to cause crashes.</p>
<dl class="class">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.multi_index.</code><code class="descname">MultiNeighborIndex</code><span class="sig-paren">(</span><em>mxer</em>, <em>nn_indexer_list</em>, <em>min_reindex_thresh=10</em>, <em>max_subindexers=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>TODO: rename to DistributedNeighborIndex</p>
<p>Generalization of a NeighborIndex
More abstract wrapper around flann</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">testdata_mindexer</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.add_ibeis_support">
<code class="descname">add_ibeis_support</code><span class="sig-paren">(</span><em>mxer</em>, <em>qreq_</em>, <em>new_aid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.add_ibeis_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.add_ibeis_support" title="Permalink to this definition">¶</a></dt>
<dd><p>Chooses indexer with smallest number of annotations and reindexes it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</li>
<li><strong>new_aid_list</strong> (<em>list</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.multi_index --test-add_ibeis_support
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">testdata_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()[</span><span class="mi">70</span><span class="p">:</span><span class="mi">80</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">add_ibeis_support</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">new_aid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.add_support">
<code class="descname">add_support</code><span class="sig-paren">(</span><em>mxer</em>, <em>new_aid_list</em>, <em>new_vecs_list</em>, <em>new_fgws_list</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.add_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.add_support" title="Permalink to this definition">¶</a></dt>
<dd><p>Chooses indexer with smallest number of annotations and reindexes it.</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.assert_can_add_aids">
<code class="descname">assert_can_add_aids</code><span class="sig-paren">(</span><em>mxer</em>, <em>new_aid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.assert_can_add_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.assert_can_add_aids" title="Permalink to this definition">¶</a></dt>
<dd><p>Aids that are already indexed should never be added.</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.get_dtype">
<code class="descname">get_dtype</code><span class="sig-paren">(</span><em>mxer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.get_dtype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.get_dtype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.get_indexed_aids">
<code class="descname">get_indexed_aids</code><span class="sig-paren">(</span><em>mxer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.get_indexed_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.get_indexed_aids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.get_multi_indexed_aids">
<code class="descname">get_multi_indexed_aids</code><span class="sig-paren">(</span><em>mxer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.get_multi_indexed_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.get_multi_indexed_aids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.get_multi_num_indexed_annots">
<code class="descname">get_multi_num_indexed_annots</code><span class="sig-paren">(</span><em>mxer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.get_multi_num_indexed_annots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.get_multi_num_indexed_annots" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.get_nIndexed_list">
<code class="descname">get_nIndexed_list</code><span class="sig-paren">(</span><em>mxer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.get_nIndexed_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.get_nIndexed_list" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a list of the number of indexed vectors in each subindexer</p>
<p>Args:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">nIndexed_list</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.multi_index --test-get_nIndexed_list
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">testdata_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nIndexed_list</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">get_nIndexed_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">21384</span><span class="p">,</span> <span class="mi">15243</span><span class="p">,</span> <span class="mi">12808</span><span class="p">,</span> <span class="mi">4809</span><span class="p">,</span> <span class="mi">3542</span><span class="p">,</span> <span class="mi">2696</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">assert_almost_eq</span><span class="p">(</span><span class="n">nIndexed_list</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;error.max() = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">max</span><span class="p">(),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#np.all(ut.inbounds(nIndexed_list, low, high))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.get_nn_aids">
<code class="descname">get_nn_aids</code><span class="sig-paren">(</span><em>mxer</em>, <em>qfx2_imx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.get_nn_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.get_nn_aids" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_imx</strong> (<em>ndarray</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qfx2_aid</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.multi_index --test-get_nn_aids
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">testdata_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="n">qaid</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_query_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_aid</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">get_nn_aids</span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt_aids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_groundtruth</span><span class="p">(</span><span class="n">qaid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">qfx2_aid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Make sure there are lots (like 5%) of correct matches</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask_cover</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">get_covered_mask</span><span class="p">(</span><span class="n">qfx2_aid</span><span class="p">,</span> <span class="n">gt_aids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_correct</span>   <span class="o">=</span> <span class="n">mask_cover</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_incorrect</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">mask_cover</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;fraction correct = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">num_correct</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">num_incorrect</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">num_correct</span><span class="p">,</span> <span class="mi">900</span><span class="p">,</span> <span class="mi">1100</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="s">&#39;not enough matches to groundtruth&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.get_nn_featxs">
<code class="descname">get_nn_featxs</code><span class="sig-paren">(</span><em>mxer</em>, <em>qfx2_imx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.get_nn_featxs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.get_nn_featxs" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_imx</strong> (<em>ndarray</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qfx2_fx</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.multi_index --test-get_nn_featxs
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">testdata_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_query_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_fgw</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">get_nn_featxs</span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">qfx2_fgw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.get_nn_fgws">
<code class="descname">get_nn_fgws</code><span class="sig-paren">(</span><em>mxer</em>, <em>qfx2_imx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.get_nn_fgws"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.get_nn_fgws" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_imx</strong> (<em>ndarray</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qfx2_fgw</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.multi_index --test-get_nn_fgws
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">testdata_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_query_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_fgw</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">get_nn_fgws</span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">qfx2_fgw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.get_offsets">
<code class="descname">get_offsets</code><span class="sig-paren">(</span><em>mxer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.get_offsets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.get_offsets" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.multi_index --test-get_offsets
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">testdata_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset_list</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">get_offsets</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#target = np.array([15257, 12769,  4819,  3542,  2694])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">21384</span><span class="p">,</span> <span class="mi">36627</span><span class="p">,</span> <span class="mi">49435</span><span class="p">,</span> <span class="mi">54244</span><span class="p">,</span> <span class="mi">57786</span><span class="p">,</span> <span class="mi">60482</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">assert_almost_eq</span><span class="p">(</span><span class="n">offset_list</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;error.max() = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">max</span><span class="p">(),))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.iter_subindexers">
<code class="descname">iter_subindexers</code><span class="sig-paren">(</span><em>mxer</em>, <em>qfx2_imx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.iter_subindexers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.iter_subindexers" title="Permalink to this definition">¶</a></dt>
<dd><p>generates subindexers, indices, and maskss within them
that partially correspond to indices in qfx2_imx that belong
to that subindexer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_imx</strong> (<em>ndarray</em>) &#8211; </td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.multi_index --test-iter_subindexers
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">testdata_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_query_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genlist_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mxer</span><span class="o">.</span><span class="n">iter_subindexers</span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">qfx2_imx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">nnindexer</span><span class="p">,</span> <span class="n">idxs</span><span class="p">,</span> <span class="n">mask</span> <span class="ow">in</span> <span class="n">genlist_</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="n">covered</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">idxs</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">covered</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">... </span>    <span class="n">covered</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">covered</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">covered</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="n">covered</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.knn">
<code class="descname">knn</code><span class="sig-paren">(</span><em>mxer</em>, <em>qfx2_vec</em>, <em>K</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.knn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.knn" title="Permalink to this definition">¶</a></dt>
<dd><p>Polymorphic interface to knn, but uses the multindex backend</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.multi_index --test-knn:0
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">testdata_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_query_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qfx2_imx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qfx2_imx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">qfx2_imx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1073</span><span class="p">,</span> <span class="mi">1079</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">testdata_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">mxer</span><span class="o">.</span><span class="n">get_dtype</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(0, 18)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.knn2">
<code class="descname">knn2</code><span class="sig-paren">(</span><em>mxer</em>, <em>qfx2_vec</em>, <em>K</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.knn2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.knn2" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">testdata_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_query_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_dist_</span><span class="p">,</span> <span class="n">qfx2_idx_</span><span class="p">,</span>  <span class="n">qfx2_fx_</span><span class="p">,</span> <span class="n">qfx2_ax_</span><span class="p">,</span> <span class="n">qfx2_rankx_</span><span class="p">,</span> <span class="n">qfx2_treex_</span><span class="p">,)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn2</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.multi_knn">
<code class="descname">multi_knn</code><span class="sig-paren">(</span><em>mxer</em>, <em>qfx2_vec</em>, <em>K</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.multi_knn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.multi_knn" title="Permalink to this definition">¶</a></dt>
<dd><p>Does a query on each of the subindexer kdtrees
returns list of the results</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">testdata_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_query_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx_list</span><span class="p">,</span> <span class="n">qfx2_dist_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">multi_knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">qfx2_idx_list</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d1_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_list_column</span><span class="p">(</span><span class="n">shape_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d2_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_list_column</span><span class="p">(</span><span class="n">shape_list</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">d2_list</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">d1_list</span><span class="p">,</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">)]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.num_indexed_annots">
<code class="descname">num_indexed_annots</code><span class="sig-paren">(</span><em>mxer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.num_indexed_annots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.num_indexed_annots" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">testdata_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">num_indexed_annots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">59</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.num_indexed_vecs">
<code class="descname">num_indexed_vecs</code><span class="sig-paren">(</span><em>mxer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#MultiNeighborIndex.num_indexed_vecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.num_indexed_vecs" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">testdata_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_indexed</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">num_indexed_vecs</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">num_indexed</span><span class="p">,</span> <span class="mi">60300</span><span class="p">,</span> <span class="mi">60500</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.multi_index.MultiNeighborIndex.rrr">
<code class="descname">rrr</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.multi_index.MultiNeighborIndex.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.multi_index.group_daids_for_indexing_by_name">
<code class="descclassname">ibeis.algo.hots.multi_index.</code><code class="descname">group_daids_for_indexing_by_name</code><span class="sig-paren">(</span><em>ibs</em>, <em>daid_list</em>, <em>num_indexers=8</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#group_daids_for_indexing_by_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.group_daids_for_indexing_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>returns groups with only one annotation per name in each group</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.multi_index.request_ibeis_mindexer">
<code class="descclassname">ibeis.algo.hots.multi_index.</code><code class="descname">request_ibeis_mindexer</code><span class="sig-paren">(</span><em>qreq_</em>, <em>index_method='multi'</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#request_ibeis_mindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.request_ibeis_mindexer" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.multi_index --test-request_ibeis_mindexer:2
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">valid_aids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">60</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fg_on</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_method</span> <span class="o">=</span> <span class="s">&#39;multi&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span> <span class="o">=</span> <span class="n">request_ibeis_mindexer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">index_method</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;PZ_Master0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">valid_aids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">60</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fg_on</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_method</span> <span class="o">=</span> <span class="s">&#39;multi&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span> <span class="o">=</span> <span class="n">request_ibeis_mindexer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">index_method</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Test background reindex</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.multi_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">valid_aids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Remove all cached nnindexers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="o">.</span><span class="n">delete_flann_cachedir</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># This request should build a new nnindexer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">30</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fg_on</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_method</span> <span class="o">=</span> <span class="s">&#39;multi&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span> <span class="o">=</span> <span class="n">request_ibeis_mindexer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">index_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mxer</span><span class="o">.</span><span class="n">nn_indexer_list</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;one subindexer&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># The next request should trigger a background process</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># and build two subindexer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">60</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_method</span> <span class="o">=</span> <span class="s">&#39;multi&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span> <span class="o">=</span> <span class="n">request_ibeis_mindexer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">index_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Do some work in the foreground to ensure that it doesnt block</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># the background job</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;[FG] sleeping or doing bit compute&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Takes about 15 seconds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">ut</span><span class="o">.</span><span class="n">Timer</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ut</span><span class="o">.</span><span class="n">enumerate_primes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">9E4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#time.sleep(10)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;[FG] done sleeping&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mxer</span><span class="o">.</span><span class="n">nn_indexer_list</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;two subindexer&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># And this shoud build just one subindexer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">60</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_method</span> <span class="o">=</span> <span class="s">&#39;multi&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span> <span class="o">=</span> <span class="n">request_ibeis_mindexer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">index_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mxer</span><span class="o">.</span><span class="n">nn_indexer_list</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;one big subindexer&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.multi_index.sort_along_rows">
<code class="descclassname">ibeis.algo.hots.multi_index.</code><code class="descname">sort_along_rows</code><span class="sig-paren">(</span><em>qfx2_xxx</em>, <em>qfx2_sortx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#sort_along_rows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.sort_along_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>sorts each row in qfx2_xxx with the corresponding row in qfx2_sortx</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.multi_index.testdata_mindexer">
<code class="descclassname">ibeis.algo.hots.multi_index.</code><code class="descname">testdata_mindexer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/multi_index.html#testdata_mindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.multi_index.testdata_mindexer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.name_scoring">
<span id="ibeis-algo-hots-name-scoring-module"></span><h2>ibeis.algo.hots.name_scoring module<a class="headerlink" href="#module-ibeis.algo.hots.name_scoring" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibeis.algo.hots.name_scoring.NameScoreTup">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.name_scoring.</code><code class="descname">NameScoreTup</code><span class="sig-paren">(</span><em>sorted_nids</em>, <em>sorted_nscore</em>, <em>sorted_aids</em>, <em>sorted_scores</em><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.name_scoring.NameScoreTup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="method">
<dt id="ibeis.algo.hots.name_scoring.NameScoreTup.__getnewargs__">
<code class="descname">__getnewargs__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.name_scoring.NameScoreTup.__getnewargs__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return self as a plain tuple.  Used by copy and pickle.</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.name_scoring.NameScoreTup.__getstate__">
<code class="descname">__getstate__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.name_scoring.NameScoreTup.__getstate__" title="Permalink to this definition">¶</a></dt>
<dd><p>Exclude the OrderedDict from pickling</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.name_scoring.NameScoreTup.__repr__">
<code class="descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.name_scoring.NameScoreTup.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a nicely formatted representation string</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.name_scoring.NameScoreTup.sorted_aids">
<code class="descname">sorted_aids</code><a class="headerlink" href="#ibeis.algo.hots.name_scoring.NameScoreTup.sorted_aids" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.name_scoring.NameScoreTup.sorted_nids">
<code class="descname">sorted_nids</code><a class="headerlink" href="#ibeis.algo.hots.name_scoring.NameScoreTup.sorted_nids" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.name_scoring.NameScoreTup.sorted_nscore">
<code class="descname">sorted_nscore</code><a class="headerlink" href="#ibeis.algo.hots.name_scoring.NameScoreTup.sorted_nscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.name_scoring.NameScoreTup.sorted_scores">
<code class="descname">sorted_scores</code><a class="headerlink" href="#ibeis.algo.hots.name_scoring.NameScoreTup.sorted_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.name_scoring.align_name_scores_with_annots">
<code class="descclassname">ibeis.algo.hots.name_scoring.</code><code class="descname">align_name_scores_with_annots</code><span class="sig-paren">(</span><em>annot_score_list</em>, <em>annot_aid_list</em>, <em>daid2_idx</em>, <em>name_groupxs</em>, <em>name_score_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/name_scoring.html#align_name_scores_with_annots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.name_scoring.align_name_scores_with_annots" title="Permalink to this definition">¶</a></dt>
<dd><p>takes name scores and gives them to the best annotation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of scores aligned with cm.daid_list and cm.dnid_list</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">score_list</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>annot_score_list</strong> (<em>list</em>) &#8211; score associated with each annot</li>
<li><strong>name_groupxs</strong> (<em>list</em>) &#8211; groups annot_score lists into groups compatible with name_score_list</li>
<li><strong>name_score_list</strong> (<em>list</em>) &#8211; score assocated with name</li>
<li><strong>nid2_nidx</strong> (<em>dict</em>) &#8211; mapping from nids to index in name score list</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.name_scoring --test-align_name_scores_with_annots
python -m ibeis.algo.hots.name_scoring --test-align_name_scores_with_annots --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.name_scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#ibs, qreq_, cm_list = plh.testdata_pre_sver(&#39;PZ_MTEST&#39;, qaid_list=[18])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_post_sver</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">evaluate_csum_score</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">evaluate_nsum_score</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Annot aligned lists</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot_score_list</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">algo_annot_scores</span><span class="p">[</span><span class="s">&#39;csum&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot_aid_list</span>   <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">daid_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid2_idx</span>        <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">daid2_idx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Name aligned lists</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_score_list</span>  <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">algo_name_scores</span><span class="p">[</span><span class="s">&#39;nsum&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_groupxs</span>     <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">name_groupxs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Execute Function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_list</span> <span class="o">=</span> <span class="n">align_name_scores_with_annots</span><span class="p">(</span><span class="n">annot_score_list</span><span class="p">,</span> <span class="n">annot_aid_list</span><span class="p">,</span> <span class="n">daid2_idx</span><span class="p">,</span> <span class="n">name_groupxs</span><span class="p">,</span> <span class="n">name_score_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Check that the correct name gets the highest score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">name_score_list</span><span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">nid2_nidx</span><span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">qnid</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">score_list</span> <span class="o">==</span> <span class="n">target</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">score_list</span> <span class="o">=</span> <span class="n">score_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_rowids</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">daid_list</span><span class="p">[</span><span class="n">test_index</span><span class="p">]),</span> <span class="n">cm</span><span class="o">.</span><span class="n">qnid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">ut</span><span class="o">.</span><span class="n">isunique</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">dnid_list</span><span class="p">[</span><span class="n">score_list</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]),</span> <span class="s">&#39;bad name score&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_top_nids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">cm</span><span class="o">.</span><span class="n">unique_nids</span><span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">nsum_score_list</span><span class="o">.</span><span class="n">argmax</span><span class="p">()],</span> <span class="s">&#39;bug in alignment&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">show_ranked_matches</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.name_scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot_score_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot_aid_list</span>   <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid2_idx</span>        <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Name aligned lists</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_score_list</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_groupxs</span>     <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Execute Function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_list</span> <span class="o">=</span> <span class="n">align_name_scores_with_annots</span><span class="p">(</span><span class="n">annot_score_list</span><span class="p">,</span> <span class="n">annot_aid_list</span><span class="p">,</span> <span class="n">daid2_idx</span><span class="p">,</span> <span class="n">name_groupxs</span><span class="p">,</span> <span class="n">name_score_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.name_scoring.compute_nsum_score">
<code class="descclassname">ibeis.algo.hots.name_scoring.</code><code class="descname">compute_nsum_score</code><span class="sig-paren">(</span><em>cm</em>, <em>qreq_=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/name_scoring.html#compute_nsum_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.name_scoring.compute_nsum_score" title="Permalink to this definition">¶</a></dt>
<dd><p>nsum</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cm</strong> (<em>ibeis.ChipMatch</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(unique_nids, nsum_score_list)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.name_scoring --test-compute_nsum_score
python -m ibeis.algo.hots.name_scoring --test-compute_nsum_score:0
python -m ibeis.algo.hots.name_scoring --test-compute_nsum_score:2
utprof.py -m ibeis.algo.hots.name_scoring --test-compute_nsum_score:2
utprof.py -m ibeis.algo.hots.pipeline --test-request_ibeis_query_L0:0 --db PZ_Master1 -a timectrl:qindex<span class="o">=</span>0:256
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.name_scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">testdata_chipmatch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">unique_nids</span><span class="p">,</span> <span class="n">nsum_score_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_nsum_score</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">((</span><span class="n">unique_nids</span><span class="p">,</span> <span class="n">nsum_score_list</span><span class="p">),</span> <span class="n">label_list</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;unique_nids&#39;</span><span class="p">,</span> <span class="s">&#39;nsum_score_list&#39;</span><span class="p">],</span> <span class="n">with_dtype</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">unique_nids = np.array([1, 2, 3])</span>
<span class="go">nsum_score_list = np.array([ 4.,  7.,  5.])</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.name_scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#ibs, qreq_, cm_list = plh.testdata_pre_sver(&#39;testdb1&#39;, qaid_list=[1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_post_sver</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">evaluate_dnids</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">_cast_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#cm.qnid = 1   # Hack for testdb1 names</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsum_nid_list</span><span class="p">,</span> <span class="n">nsum_score_list</span> <span class="o">=</span> <span class="n">compute_nsum_score</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">nsum_nid_list</span> <span class="o">==</span> <span class="n">cm</span><span class="o">.</span><span class="n">unique_nids</span><span class="p">),</span> <span class="s">&#39;nids out of alignment&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span><span class="n">nsum_nid_list</span> <span class="o">==</span> <span class="n">cm</span><span class="o">.</span><span class="n">qnid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_true</span> <span class="o">=</span> <span class="n">nsum_score_list</span><span class="p">[</span><span class="n">flags</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_false</span> <span class="o">=</span> <span class="n">nsum_score_list</span><span class="p">[</span><span class="o">~</span><span class="n">flags</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">max_true</span> <span class="o">&gt;</span> <span class="n">max_false</span><span class="p">,</span> <span class="s">&#39;is this truely a hard case?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">max_true</span> <span class="o">&gt;</span> <span class="mf">1.2</span><span class="p">,</span> <span class="s">&#39;score=</span><span class="si">%r</span><span class="s"> should be higher for aid=18&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">max_true</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsum_nid_list2</span><span class="p">,</span> <span class="n">nsum_score_list2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">compute_nsum_score2</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">nsum_score_list2</span><span class="p">,</span> <span class="n">nsum_score_list</span><span class="p">),</span> <span class="s">&#39;something is very wrong&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#assert np.all(nsum_score_list2 == nsum_score_list), &#39;could be a percision issue&#39;</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.name_scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#ibs, qreq_, cm_list = plh.testdata_pre_sver(&#39;testdb1&#39;, qaid_list=[1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_post_sver</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="n">cfgdict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">augment_queryside_hack</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">score_nsum</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#cm.evaluate_dnids(qreq_.ibs)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#cm.qnid = 1   # Hack for testdb1 names</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#nsum_nid_list, nsum_score_list = compute_nsum_score(cm, qreq_=qreq_)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">show_ranked_matches</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example3:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.name_scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#ibs, qreq_, cm_list = plh.testdata_pre_sver(&#39;testdb1&#39;, qaid_list=[1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_post_sver</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cfgdict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">augment_queryside_hack</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">score_nsum</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#cm.evaluate_dnids(qreq_.ibs)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#cm.qnid = 1   # Hack for testdb1 names</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#nsum_nid_list, nsum_score_list = compute_nsum_score(cm, qreq_=qreq_)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">show_ranked_matches</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example4:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># FIXME: breaks when fg_on=True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.name_scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots</span> <span class="kn">import</span> <span class="n">name_scoring</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots</span> <span class="kn">import</span> <span class="n">scoring</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Test to make sure name score and chips score are equal when per_name=1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s">&#39;spatial_verification&#39;</span><span class="p">,</span> <span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:dpername=1,qsize=1,dsize=10&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:K=1,fg_on=True,sqrd_dist_on=True&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">cm_list_FILT</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Ensure there is only one aid per database name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">IBEISControl</span><span class="o">.</span><span class="n">IBEISController</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#stats_dict = ibs.get_annot_stats_dict(qreq_.get_external_daids(), prefix=&#39;d&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#stats = stats_dict[&#39;dper_name&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_per_name_stats</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_daids</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;per_name_stats = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="bp">False</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">stats</span><span class="p">[</span><span class="s">&#39;mean&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">stats</span><span class="p">[</span><span class="s">&#39;std&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;this test requires one annot per name in the database&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">evaluate_dnids</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">assert_self</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">_cast_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># cm.fs_list = cm.fs_list.astype(np.float)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsum_nid_list</span><span class="p">,</span> <span class="n">nsum_score_list</span> <span class="o">=</span> <span class="n">name_scoring</span><span class="o">.</span><span class="n">compute_nsum_score</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsum_nid_list2</span><span class="p">,</span> <span class="n">nsum_score_list2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">name_scoring</span><span class="o">.</span><span class="n">compute_nsum_score2</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">csum_score_list</span> <span class="o">=</span> <span class="n">scoring</span><span class="o">.</span><span class="n">compute_csum_score</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">asserteq</span><span class="p">(</span><span class="n">nsum_score_list</span><span class="p">,</span> <span class="n">csum_score_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">asserteq</span><span class="p">(</span><span class="n">nsum_score_list</span><span class="p">,</span> <span class="n">csum_score_list</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">iswarning</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">asserteq</span><span class="p">(</span><span class="n">nsum_score_list2</span><span class="p">,</span> <span class="n">csum_score_list</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">iswarning</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#assert np.allclose(nsum_score_list, csum_score_list), &#39;should be the same when K=1 and per_name=1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#assert all(nsum_score_list  == csum_score_list), &#39;should be the same when K=1 and per_name=1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#assert all(nsum_score_list2 == csum_score_list), &#39;should be the same when K=1 and per_name=1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Evaluate parts of the sourcecode</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.name_scoring.compute_nsum_score2">
<code class="descclassname">ibeis.algo.hots.name_scoring.</code><code class="descname">compute_nsum_score2</code><span class="sig-paren">(</span><em>cm</em>, <em>qreq_=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/name_scoring.html#compute_nsum_score2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.name_scoring.compute_nsum_score2" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Example3:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.name_scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#ibs, qreq_, cm_list = plh.testdata_pre_sver(&#39;testdb1&#39;, qaid_list=[1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_post_sver</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cfgdict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fg_on</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">augment_queryside_hack</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">evaluate_dnids</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsum_nid_list1</span><span class="p">,</span> <span class="n">nsum_score_list1</span><span class="p">,</span> <span class="n">featflag_list1</span> <span class="o">=</span> <span class="n">compute_nsum_score2</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsum_nid_list2</span><span class="p">,</span> <span class="n">nsum_score_list2</span> <span class="o">=</span> <span class="n">compute_nsum_score</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">show_ranked_matches</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.name_scoring.get_chipmatch_namescore_nonvoting_feature_flags">
<code class="descclassname">ibeis.algo.hots.name_scoring.</code><code class="descname">get_chipmatch_namescore_nonvoting_feature_flags</code><span class="sig-paren">(</span><em>cm</em>, <em>qreq_=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/name_scoring.html#get_chipmatch_namescore_nonvoting_feature_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.name_scoring.get_chipmatch_namescore_nonvoting_feature_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes flags to desribe which features can or can not vote</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.name_scoring --exec-get_chipmatch_namescore_nonvoting_feature_flags
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># FIXME: breaks when fg_on=True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.name_scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots</span> <span class="kn">import</span> <span class="n">name_scoring</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Test to make sure name score and chips score are equal when per_name=1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre</span><span class="p">(</span><span class="s">&#39;spatial_verification&#39;</span><span class="p">,</span> <span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:dpername=1,qsize=1,dsize=10&#39;</span><span class="p">],</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:K=1,fg_on=True&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">cm_list_FILT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">evaluate_dnids</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">featflat_list</span> <span class="o">=</span> <span class="n">get_chipmatch_namescore_nonvoting_feature_flags</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">,</span> <span class="n">featflat_list</span><span class="p">))),</span> <span class="s">&#39;all features should be able to vote in K=1, per_name=1 case&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.name_scoring.get_namescore_nonvoting_feature_flags">
<code class="descclassname">ibeis.algo.hots.name_scoring.</code><code class="descname">get_namescore_nonvoting_feature_flags</code><span class="sig-paren">(</span><em>fm_list</em>, <em>fs_list</em>, <em>dnid_list</em>, <em>name_groupxs</em>, <em>kpts1=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/name_scoring.html#get_namescore_nonvoting_feature_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.name_scoring.get_namescore_nonvoting_feature_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>fm_list = [fm[:min(len(fm), 10)] for fm in fm_list]
fs_list = [fs[:min(len(fs), 10)] for fs in fs_list]</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.name_scoring.group_scores_by_name">
<code class="descclassname">ibeis.algo.hots.name_scoring.</code><code class="descname">group_scores_by_name</code><span class="sig-paren">(</span><em>ibs</em>, <em>aid_list</em>, <em>score_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/name_scoring.html#group_scores_by_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.name_scoring.group_scores_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts annotation scores to name scores.
Over multiple annotations finds keypoints best match and uses that score.</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.name_scoring --test-group_scores_by_name
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.name_scoring</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cm</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#print(cm.get_inspect_str(qreq_))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid_list</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">daid_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_list</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">annot_score_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nscoretup</span> <span class="o">=</span> <span class="n">group_scores_by_name</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">score_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">sorted_nids</span><span class="p">,</span> <span class="n">sorted_nscore</span><span class="p">,</span> <span class="n">sorted_aids</span><span class="p">,</span> <span class="n">sorted_scores</span><span class="p">)</span> <span class="o">=</span> <span class="n">nscoretup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">sorted_nids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cm</span><span class="o">.</span><span class="n">qnid</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>TODO:</dt>
<dd><p class="first"># TODO: this code needs a really good test case
#&gt;&gt;&gt; result = np.array_repr(sorted_nids[0:2])
#&gt;&gt;&gt; print(result)
#array([1, 5])</p>
<dl class="docutils">
<dt>Ignore::</dt>
<dd># hack in dict of Nones prob for testing
import six
qres.aid2_prob = {aid:None for aid in six.iterkeys(qres.aid2_score)}</dd>
</dl>
<p>array([ 1,  5, 26])
[2 6 5]</p>
<dl class="last docutils">
<dt>Timeit::</dt>
<dd>import ibeis
ibs = ibeis.opendb(&#8216;PZ_MTEST&#8217;)
aid_list = ibs.get_valid_aids()
aid_arr = np.array(aid_list)
%timeit ibs.get_annot_name_rowids(aid_list)
%timeit ibs.get_annot_name_rowids(aid_arr)</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.name_scoring.testdata_chipmatch">
<code class="descclassname">ibeis.algo.hots.name_scoring.</code><code class="descname">testdata_chipmatch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/name_scoring.html#testdata_chipmatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.name_scoring.testdata_chipmatch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.neighbor_index">
<span id="ibeis-algo-hots-neighbor-index-module"></span><h2>ibeis.algo.hots.neighbor_index module<a class="headerlink" href="#module-ibeis.algo.hots.neighbor_index" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>TODO:</dt>
<dd>Remove Bloat</dd>
</dl>
<p>multi_index.py as well</p>
<p><a class="reference external" href="https://github.com/spotify/annoy">https://github.com/spotify/annoy</a></p>
<dl class="class">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.neighbor_index.</code><code class="descname">NeighborIndex</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>flann_params</em>, <em>cfgstr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>wrapper class around flann
stores flann index and data it needs to index into</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.add_ibeis_support">
<code class="descname">add_ibeis_support</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>qreq_</em>, <em>new_daid_list</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.add_ibeis_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.add_ibeis_support" title="Permalink to this definition">¶</a></dt>
<dd><p># TODO: ensure that the memcache changes appropriately</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.add_support">
<code class="descname">add_support</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>new_daid_list</em>, <em>new_vecs_list</em>, <em>new_fgws_list</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.add_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.add_support" title="Permalink to this definition">¶</a></dt>
<dd><p>adds support data (aka data to be indexed)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>new_daid_list</strong> (<em>list</em>) &#8211; list of annotation ids that are being added</li>
<li><strong>new_vecs_list</strong> (<em>list</em>) &#8211; list of descriptor vectors for each annotation</li>
<li><strong>new_fgws_list</strong> (<em>list</em>) &#8211; list of weights per vector for each annotation</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; verbosity flag(default = True)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.neighbor_index --test-add_support
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">(</span><span class="n">use_memcache</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_daid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_query_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get before data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx1</span><span class="p">,</span> <span class="n">qfx2_dist1</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_vecs_list</span><span class="p">,</span> <span class="n">new_fgws_list</span> <span class="o">=</span> <span class="n">get_support_data</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">new_daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute test function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="o">.</span><span class="n">add_support</span><span class="p">(</span><span class="n">new_daid_list</span><span class="p">,</span> <span class="n">new_vecs_list</span><span class="p">,</span> <span class="n">new_fgws_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># test before data vs after data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx2</span><span class="p">,</span> <span class="n">qfx2_dist2</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qfx2_idx2</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">qfx2_idx1</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.build_and_save">
<code class="descname">build_and_save</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>cachedir</em>, <em>verbose=True</em>, <em>memtrack=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.build_and_save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.build_and_save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.debug_nnindexer">
<code class="descname">debug_nnindexer</code><span class="sig-paren">(</span><em>nnindexer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.debug_nnindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.debug_nnindexer" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes sure the indexer has valid SIFT descriptors</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.empty_neighbors">
<code class="descname">empty_neighbors</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>nQfx</em>, <em>K</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.empty_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.empty_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.ensure_indexer">
<code class="descname">ensure_indexer</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>cachedir</em>, <em>verbose=True</em>, <em>force_rebuild=False</em>, <em>memtrack=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.ensure_indexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.ensure_indexer" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures that you get a neighbor indexer. It either loads a chached
indexer or rebuilds a new one.</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.ext">
<code class="descname">ext</code><em class="property"> = '.flann'</em><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.ext" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.get_cfgstr">
<code class="descname">get_cfgstr</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>noquery=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.get_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.get_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd><p>returns string which uniquely identified configuration and support data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>noquery</strong> (<em>bool</em>) &#8211; if True cfgstr is only relevant to building the
index. No search params are returned (default = False)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">flann_cfgstr</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.neighbor_index --test-get_cfgstr
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fg_on</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s">&#39;default:fg_on=False&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="o">.</span><span class="n">load_indexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">indexer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noquery</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_cfgstr</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">get_cfgstr</span><span class="p">(</span><span class="n">noquery</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;flann_cfgstr = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">flann_cfgstr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">flann_cfgstr = _FLANN((algo=kdtree,seed=42,t=8,))_VECS((11260,128)gj5nea@ni0%f3aja)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.get_dtype">
<code class="descname">get_dtype</code><span class="sig-paren">(</span><em>nnindexer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.get_dtype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.get_dtype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.get_fname">
<code class="descname">get_fname</code><span class="sig-paren">(</span><em>nnindexer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.get_fname"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.get_fname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.get_fpath">
<code class="descname">get_fpath</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>cachedir</em>, <em>cfgstr=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.get_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.get_fpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.get_indexed_aids">
<code class="descname">get_indexed_aids</code><span class="sig-paren">(</span><em>nnindexer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.get_indexed_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.get_indexed_aids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.get_indexed_vecs">
<code class="descname">get_indexed_vecs</code><span class="sig-paren">(</span><em>nnindexer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.get_indexed_vecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.get_indexed_vecs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.get_nn_aids">
<code class="descname">get_nn_aids</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>qfx2_nnidx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.get_nn_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.get_nn_aids" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_nnidx</strong> &#8211; (N x K) qfx2_idx[n][k] is the index of the kth
approximate nearest data vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(N x K) qfx2_fx[n][k] is the annotation id index of the
kth approximate nearest data vector</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">qfx2_aid</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.neighbor_index --exec-get_nn_aids
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fg_on</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s">&#39;default:fg_on=False&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="o">.</span><span class="n">load_indexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">indexer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_query_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_neighbors</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_nnidx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">num_neighbors</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_aid</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">get_nn_aids</span><span class="p">(</span><span class="n">qfx2_nnidx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qfx2_aid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">num_neighbors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;qfx2_aid.shape = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">qfx2_aid</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">qfx2_aid.shape = (1257, 4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.get_nn_axs">
<code class="descname">get_nn_axs</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>qfx2_nnidx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.get_nn_axs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.get_nn_axs" title="Permalink to this definition">¶</a></dt>
<dd><p>gets matching internal annotation indices</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.get_nn_featxs">
<code class="descname">get_nn_featxs</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>qfx2_nnidx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.get_nn_featxs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.get_nn_featxs" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_nnidx</strong> &#8211; (N x K) qfx2_idx[n][k] is the index of the kth
approximate nearest data vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(N x K) qfx2_fx[n][k] is the feature index (w.r.t the
source annotation) of the kth approximate
nearest data vector</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">qfx2_fx</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.get_nn_fgws">
<code class="descname">get_nn_fgws</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>qfx2_nnidx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.get_nn_fgws"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.get_nn_fgws" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets forground weights of neighbors</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis --tf NeighborIndex.get_nn_fgws
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_nnidx</strong> &#8211; (N x K) qfx2_idx[n][k] is the index of the kth
approximate nearest data vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(N x K) qfx2_fgw[n][k] is the annotation id index of the
kth forground weight</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">qfx2_fgw</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">(</span><span class="n">dbname</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_nnidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_fgw</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">get_nn_fgws</span><span class="p">(</span><span class="n">qfx2_nnidx</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.get_nn_vecs">
<code class="descname">get_nn_vecs</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>qfx2_nnidx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.get_nn_vecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.get_nn_vecs" title="Permalink to this definition">¶</a></dt>
<dd><p>gets matching vectors</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.get_prefix">
<code class="descname">get_prefix</code><span class="sig-paren">(</span><em>nnindexer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.get_prefix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.get_prefix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.get_removed_idxs">
<code class="descname">get_removed_idxs</code><span class="sig-paren">(</span><em>nnindexer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.get_removed_idxs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.get_removed_idxs" title="Permalink to this definition">¶</a></dt>
<dd><p>__removed_ids = nnindexer.flann._FLANN__removed_ids
invalid_idxs = nnindexer.get_removed_idxs()
assert len(np.intersect1d(invalid_idxs, __removed_ids)) == len(__removed_ids)</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.init_support">
<code class="descname">init_support</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>aid_list</em>, <em>vecs_list</em>, <em>fgws_list</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.init_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.init_support" title="Permalink to this definition">¶</a></dt>
<dd><p>prepares inverted indicies and FLANN data structure</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.knn">
<code class="descname">knn</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>qfx2_vec</em>, <em>K</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.knn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.knn" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the indices and squared distance to the nearest K neighbors.
The distance is noramlized between zero and one using
VEC_PSEUDO_MAX_DISTANCE = (np.sqrt(2) * VEC_PSEUDO_MAX)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qfx2_vec</strong> &#8211; (N x D) an array of N, D-dimensional query vectors</li>
<li><strong>K</strong> &#8211; number of approximate nearest neighbors to find</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Returns: tuple of (qfx2_idx, qfx2_dist)</dt>
<dd><dl class="first last docutils">
<dt>ndarray <span class="classifier-delimiter">:</span> <span class="classifier">qfx2_idx[n][k] (N x K) is the index of the kth</span></dt>
<dd>approximate nearest data vector w.r.t qfx2_vec[n]</dd>
<dt>ndarray <span class="classifier-delimiter">:</span> <span class="classifier">qfx2_dist[n][k] (N x K) is the distance to the kth</span></dt>
<dd>approximate nearest data vector w.r.t. qfx2_vec[n]
distance is normalized squared euclidean distance.</dd>
</dl>
</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis --tf NeighborIndex.knn:0 --debug2
python -m ibeis --tf NeighborIndex.knn:1
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_query_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="o">.</span><span class="n">debug_nnindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">vt</span><span class="o">.</span><span class="n">check_sift_validity</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">),</span> <span class="s">&#39;bad SIFT properties&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">qfx2_idx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">qfx2_dist</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;qfx2_vec.dtype = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">qfx2_vec</span><span class="o">.</span><span class="n">dtype</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;nnindexer.max_distance_sqrd = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nnindexer</span><span class="o">.</span><span class="n">max_distance_sqrd</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">qfx2_dist</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s">&#39;distance should be less than 1. got </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">qfx2_dist</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Ensure distance calculations are correct</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_dvec</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">idx2_vec</span><span class="p">[</span><span class="n">qfx2_idx</span><span class="o">.</span><span class="n">T</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">targetdist</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">L2_sift</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">qfx2_dvec</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rawdist</span>    <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">L2_sqrd</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">qfx2_dvec</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">qfx2_dist</span> <span class="o">*</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">max_distance_sqrd</span> <span class="o">==</span> <span class="n">rawdist</span><span class="p">),</span> <span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s">&#39;inconsistant distance calculations&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">targetdist</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">),</span> <span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s">&#39;inconsistant distance calculations&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">nnindexer</span><span class="o">.</span><span class="n">get_dtype</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">qfx2_idx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">qfx2_dist</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(0, 2) (0, 2)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>cachedir=None</em>, <em>fpath=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a cached flann neighbor indexer from disk (not the data)</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.num_indexed_annots">
<code class="descname">num_indexed_annots</code><span class="sig-paren">(</span><em>nnindexer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.num_indexed_annots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.num_indexed_annots" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.num_indexed_vecs">
<code class="descname">num_indexed_vecs</code><span class="sig-paren">(</span><em>nnindexer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.num_indexed_vecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.num_indexed_vecs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.prefix1">
<code class="descname">prefix1</code><em class="property"> = 'flann'</em><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.prefix1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.reindex">
<code class="descname">reindex</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>verbose=True</em>, <em>memtrack=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.reindex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.reindex" title="Permalink to this definition">¶</a></dt>
<dd><p>indexes all vectors with FLANN.</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.remove_ibeis_support">
<code class="descname">remove_ibeis_support</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>qreq_</em>, <em>remove_daid_list</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.remove_ibeis_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.remove_ibeis_support" title="Permalink to this definition">¶</a></dt>
<dd><p># TODO: ensure that the memcache changes appropriately</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.remove_support">
<code class="descname">remove_support</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>remove_daid_list</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.remove_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.remove_support" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.neighbor_index --test-remove_support
</pre></div>
</div>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>~/code/flann/src/python/pyflann/index.py</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (IMPORTANT)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">(</span><span class="n">use_memcache</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">remove_daid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_query_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># get before data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx1</span><span class="p">,</span> <span class="n">qfx2_dist1</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute test function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="o">.</span><span class="n">remove_support</span><span class="p">(</span><span class="n">remove_daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># test before data vs after data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx2</span><span class="p">,</span> <span class="n">qfx2_dist2</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2_nvecs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_take</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">dict_hist</span><span class="p">(</span><span class="n">nnindexer</span><span class="o">.</span><span class="n">idx2_ax</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nnindexer</span><span class="o">.</span><span class="n">ax2_aid</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qfx2_idx2</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">ax2_nvecs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&#39;should only get points from aid 7&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qfx2_idx1</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">ax2_nvecs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&#39;should get points from everyone&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.rrr">
<code class="descname">rrr</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>cachedir=None</em>, <em>fpath=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Caches a flann neighbor indexer to disk (not the data)</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex2">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.neighbor_index.</code><code class="descname">NeighborIndex2</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>flann_params=None</em>, <em>cfgstr=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ibeis.algo.hots.neighbor_index.NeighborIndex" title="ibeis.algo.hots.neighbor_index.NeighborIndex"><code class="xref py py-class docutils literal"><span class="pre">ibeis.algo.hots.neighbor_index.NeighborIndex</span></code></a>, <code class="xref py py-class docutils literal"><span class="pre">utool.util_dev.NiceRepr</span></code></p>
<dl class="staticmethod">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex2.get_support">
<em class="property">static </em><code class="descname">get_support</code><span class="sig-paren">(</span><em>depc</em>, <em>aid_list</em>, <em>config</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex2.get_support"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex2.get_support" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex2.ibeis_knn">
<code class="descname">ibeis_knn</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>qfx2_vec</em>, <em>K</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex2.ibeis_knn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex2.ibeis_knn" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex2.on_load">
<code class="descname">on_load</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>depc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex2.on_load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex2.on_load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex2.on_save">
<code class="descname">on_save</code><span class="sig-paren">(</span><em>nnindexer</em>, <em>depc</em>, <em>fpath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#NeighborIndex2.on_save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex2.on_save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index.NeighborIndex2.rrr">
<code class="descname">rrr</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.NeighborIndex2.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index.get_support_data">
<code class="descclassname">ibeis.algo.hots.neighbor_index.</code><code class="descname">get_support_data</code><span class="sig-paren">(</span><em>qreq_</em>, <em>daid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#get_support_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.get_support_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index.invert_index">
<code class="descclassname">ibeis.algo.hots.neighbor_index.</code><code class="descname">invert_index</code><span class="sig-paren">(</span><em>vecs_list</em>, <em>ax_list</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#invert_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.invert_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregates descriptors of input annotations and returns inverted information</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vecs_list</strong> (<em>list</em>) &#8211; </li>
<li><strong>ax_list</strong> (<em>list</em>) &#8211; </li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; verbosity flag(default = True)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(idx2_vec, idx2_ax, idx2_fx)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.neighbor_index --test-invert_index
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">vt</span><span class="o">.</span><span class="n">tests</span><span class="o">.</span><span class="n">dummy</span><span class="o">.</span><span class="n">get_dummy_dpts</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">ax_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">idx2_vec</span><span class="p">,</span> <span class="n">idx2_ax</span><span class="p">,</span> <span class="n">idx2_fx</span><span class="p">)</span> <span class="o">=</span> <span class="n">invert_index</span><span class="p">(</span><span class="n">vecs_list</span><span class="p">,</span> <span class="n">ax_list</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index.prepare_index_data">
<code class="descclassname">ibeis.algo.hots.neighbor_index.</code><code class="descname">prepare_index_data</code><span class="sig-paren">(</span><em>aid_list</em>, <em>vecs_list</em>, <em>fgws_list</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#prepare_index_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.prepare_index_data" title="Permalink to this definition">¶</a></dt>
<dd><p>flattens vecs_list and builds a reverse index from the flattened indices
(idx) to the original aids and fxs</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index.test_nnindexer">
<code class="descclassname">ibeis.algo.hots.neighbor_index.</code><code class="descname">test_nnindexer</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index.html#test_nnindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index.test_nnindexer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.neighbor_index_cache">
<span id="ibeis-algo-hots-neighbor-index-cache-module"></span><h2>ibeis.algo.hots.neighbor_index_cache module<a class="headerlink" href="#module-ibeis.algo.hots.neighbor_index_cache" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibeis.algo.hots.neighbor_index_cache.UUIDMapHyrbridCache">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">UUIDMapHyrbridCache</code><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#UUIDMapHyrbridCache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.UUIDMapHyrbridCache" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class that lets multiple ways of writing to the uuid_map
be swapped in and out interchangably</p>
<p>TODO: the global read / write should periodically sync itself to disk and it
should be loaded from disk initially</p>
<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index_cache.UUIDMapHyrbridCache.dump">
<code class="descname">dump</code><span class="sig-paren">(</span><em>cachedir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#UUIDMapHyrbridCache.dump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.UUIDMapHyrbridCache.dump" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index_cache.UUIDMapHyrbridCache.init">
<code class="descname">init</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#UUIDMapHyrbridCache.init"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.UUIDMapHyrbridCache.init" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index_cache.UUIDMapHyrbridCache.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>cachedir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#UUIDMapHyrbridCache.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.UUIDMapHyrbridCache.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a cache UUIDMap</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index_cache.UUIDMapHyrbridCache.read_uuid_map_dict">
<code class="descname">read_uuid_map_dict</code><span class="sig-paren">(</span><em>uuid_map_fpath</em>, <em>min_reindex_thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#UUIDMapHyrbridCache.read_uuid_map_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.UUIDMapHyrbridCache.read_uuid_map_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>uses in memory dictionary instead of disk</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.neighbor_index_cache.UUIDMapHyrbridCache.write_uuid_map_dict">
<code class="descname">write_uuid_map_dict</code><span class="sig-paren">(</span><em>uuid_map_fpath</em>, <em>visual_uuid_list</em>, <em>daids_hashid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#UUIDMapHyrbridCache.write_uuid_map_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.UUIDMapHyrbridCache.write_uuid_map_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>uses in memory dictionary instead of disk</p>
<p>let the multi-indexer know about any big caches we&#8217;ve made multi-indexer.
Also lets nnindexer know about other prebuilt indexers so it can attempt to
just add points to them as to avoid a rebuild.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.background_flann_func">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">background_flann_func</code><span class="sig-paren">(</span><em>cachedir</em>, <em>daid_list</em>, <em>vecs_list</em>, <em>fgws_list</em>, <em>flann_params</em>, <em>cfgstr</em>, <em>uuid_map_fpath</em>, <em>daids_hashid</em>, <em>visual_uuid_list</em>, <em>min_reindex_thresh</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#background_flann_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.background_flann_func" title="Permalink to this definition">¶</a></dt>
<dd><p>FIXME: Duplicate code</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.build_nnindex_cfgstr">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">build_nnindex_cfgstr</code><span class="sig-paren">(</span><em>qreq_</em>, <em>daid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#build_nnindex_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.build_nnindex_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd><p>builds a string that  uniquely identified an indexer built with parameters
from the input query requested and indexing descriptor from the input
annotation ids</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</li>
<li><strong>daid_list</strong> (<em>list</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">nnindex_cfgstr</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.neighbor_index_cache --test-build_nnindex_cfgstr
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index_cache</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">ibeis</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">TEST_SPECIES</span><span class="o">.</span><span class="n">ZEB_PLAIN</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fg_on</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindex_cfgstr</span> <span class="o">=</span> <span class="n">build_nnindex_cfgstr</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">nnindex_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">_VUUIDS((6)ylydksaqdigdecdd)_FLANN(8_kdtrees)_FEATWEIGHT(OFF)_FEAT(hesaff+sift_)_CHIP(sz450)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.can_request_background_nnindexer">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">can_request_background_nnindexer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#can_request_background_nnindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.can_request_background_nnindexer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.check_background_process">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">check_background_process</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#check_background_process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.check_background_process" title="Permalink to this definition">¶</a></dt>
<dd><p>checks to see if the process has finished and then
writes the uuid map to disk</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.clear_memcache">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">clear_memcache</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#clear_memcache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.clear_memcache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.clear_uuid_cache">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">clear_uuid_cache</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#clear_uuid_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.clear_uuid_cache" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.neighbor_index_cache --test-clear_uuid_cache
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index_cache</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s">&#39;default:fg_on=True&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fgws_list</span> <span class="o">=</span> <span class="n">clear_uuid_cache</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fgws_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.get_data_cfgstr">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">get_data_cfgstr</code><span class="sig-paren">(</span><em>ibs</em>, <em>daid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#get_data_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.get_data_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd><p>part 2 data hash id</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.get_nnindexer_uuid_map_fpath">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">get_nnindexer_uuid_map_fpath</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#get_nnindexer_uuid_map_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.get_nnindexer_uuid_map_fpath" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index_cache</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uuid_map_fpath</span> <span class="o">=</span> <span class="n">get_nnindexer_uuid_map_fpath</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">path_ndir_split</span><span class="p">(</span><span class="n">uuid_map_fpath</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">.../_ibeis_cache/flann/uuid_map_FLANN(8_kdtrees)_FEAT(hesaff+sift_)_CHIP(sz450).cPkl</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.group_daids_by_cached_nnindexer">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">group_daids_by_cached_nnindexer</code><span class="sig-paren">(</span><em>qreq_</em>, <em>daid_list</em>, <em>min_reindex_thresh</em>, <em>max_covers=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#group_daids_by_cached_nnindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.group_daids_by_cached_nnindexer" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.neighbor_index_cache --test-group_daids_by_cached_nnindexer
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index_cache</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ZEB_PLAIN</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">TEST_SPECIES</span><span class="o">.</span><span class="n">ZEB_PLAIN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">ZEB_PLAIN</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Set the params a bit lower</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_covers</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">min_reindex_thresh</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_reindex_thresh</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">min_reindex_thresh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># STEP 0: CLEAR THE CACHE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clear_uuid_cache</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># STEP 1: ASSERT EMPTY INDEX</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">ZEB_PLAIN</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uncovered_aids</span><span class="p">,</span> <span class="n">covered_aids_list</span> <span class="o">=</span> <span class="n">group_daids_by_cached_nnindexer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">qreq_</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">min_reindex_thresh</span><span class="p">,</span> <span class="n">max_covers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">uncovered_aids</span><span class="p">,</span> <span class="n">covered_aids_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">result1</span><span class="p">,</span> <span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[]),</span> <span class="s">&#39;pre request&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># TEST 2: SHOULD MAKE 123 COVERED</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span> <span class="o">=</span> <span class="n">request_memcached_ibeis_nnindexer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uncovered_aids</span><span class="p">,</span> <span class="n">covered_aids_list</span> <span class="o">=</span> <span class="n">group_daids_by_cached_nnindexer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">qreq_</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">min_reindex_thresh</span><span class="p">,</span> <span class="n">max_covers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">uncovered_aids</span><span class="p">,</span> <span class="n">covered_aids_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">result2</span><span class="p">,</span> <span class="p">([],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]),</span> <span class="s">&#39;post request&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.new_neighbor_index">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">new_neighbor_index</code><span class="sig-paren">(</span><em>daid_list</em>, <em>vecs_list</em>, <em>fgws_list</em>, <em>flann_params</em>, <em>cachedir</em>, <em>cfgstr</em>, <em>force_rebuild=False</em>, <em>verbose=True</em>, <em>memtrack=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#new_neighbor_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.new_neighbor_index" title="Permalink to this definition">¶</a></dt>
<dd><p>constructs neighbor index independent of ibeis</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>daid_list</strong> (<em>list</em>) &#8211; </li>
<li><strong>vecs_list</strong> (<em>list</em>) &#8211; </li>
<li><strong>fgws_list</strong> (<em>list</em>) &#8211; </li>
<li><strong>flann_params</strong> (<em>dict</em>) &#8211; </li>
<li><strong>flann_cachedir</strong> (<em>None</em>) &#8211; </li>
<li><strong>nnindex_cfgstr</strong> (<em>str</em>) &#8211; </li>
<li><strong>use_memcache</strong> (<em>bool</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">nnindexer</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.neighbor_index_cache --test-new_neighbor_index
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index_cache</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">ibeis</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">TEST_SPECIES</span><span class="o">.</span><span class="n">ZEB_PLAIN</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindex_cfgstr</span> <span class="o">=</span> <span class="n">build_nnindex_cfgstr</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindex_cfgstr</span> <span class="o">=</span> <span class="n">build_nnindex_cfgstr</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgstr</span> <span class="o">=</span> <span class="n">nnindex_cfgstr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cachedir</span>     <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_flann_cachedir</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flann_params</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">flann_params</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Get annot descriptors to index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vecs_list</span><span class="p">,</span> <span class="n">fgws_list</span> <span class="o">=</span> <span class="n">get_support_data</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span> <span class="o">=</span> <span class="n">new_neighbor_index</span><span class="p">(</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">vecs_list</span><span class="p">,</span> <span class="n">fgws_list</span><span class="p">,</span> <span class="n">flann_params</span><span class="p">,</span> <span class="n">cachedir</span><span class="p">,</span> <span class="n">cfgstr</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;nnindexer.ax2_aid = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nnindexer</span><span class="o">.</span><span class="n">ax2_aid</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">nnindexer.ax2_aid = [1 2 3 4 5 6]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.print_uuid_cache">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">print_uuid_cache</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#print_uuid_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.print_uuid_cache" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.neighbor_index_cache --test-print_uuid_cache
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index_cache</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_Master0&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s">&#39;default:fg_on=False&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_uuid_cache</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">nnindexer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.request_augmented_ibeis_nnindexer">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">request_augmented_ibeis_nnindexer</code><span class="sig-paren">(</span><em>qreq_</em>, <em>daid_list</em>, <em>verbose=True</em>, <em>use_memcache=True</em>, <em>force_rebuild=False</em>, <em>memtrack=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#request_augmented_ibeis_nnindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.request_augmented_ibeis_nnindexer" title="Permalink to this definition">¶</a></dt>
<dd><p>DO NOT USE. THIS FUNCTION CAN CURRENTLY CAUSE A SEGFAULT</p>
<p>tries to give you an indexer for the requested daids using the least amount
of computation possible. By loading and adding to a partially build nnindex
if possible and if that fails fallbs back to request_memcache.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</li>
<li><strong>daid_list</strong> (<em>list</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">nnindex_cfgstr</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.neighbor_index_cache --test-request_augmented_ibeis_nnindexer
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index_cache</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ZEB_PLAIN</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">TEST_SPECIES</span><span class="o">.</span><span class="n">ZEB_PLAIN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_memcache</span><span class="p">,</span> <span class="n">max_covers</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">ZEB_PLAIN</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">min_reindex_thresh</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_reindex_thresh</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">min_reindex_thresh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># CLEAR CACHE for clean test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clear_uuid_cache</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># LOAD 3 AIDS INTO CACHE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">ZEB_PLAIN</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Should fallback</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span> <span class="o">=</span> <span class="n">request_augmented_ibeis_nnindexer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># assert the fallback</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uncovered_aids</span><span class="p">,</span> <span class="n">covered_aids_list</span> <span class="o">=</span> <span class="n">group_daids_by_cached_nnindexer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">qreq_</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">min_reindex_thresh</span><span class="p">,</span> <span class="n">max_covers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">uncovered_aids</span><span class="p">,</span> <span class="n">covered_aids_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">result2</span><span class="p">,</span> <span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]),</span> <span class="s">&#39;pre augment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Should augment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span> <span class="o">=</span> <span class="n">request_augmented_ibeis_nnindexer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uncovered_aids</span><span class="p">,</span> <span class="n">covered_aids_list</span> <span class="o">=</span> <span class="n">group_daids_by_cached_nnindexer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">qreq_</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">min_reindex_thresh</span><span class="p">,</span> <span class="n">max_covers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result3</span> <span class="o">=</span> <span class="n">uncovered_aids</span><span class="p">,</span> <span class="n">covered_aids_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">result3</span><span class="p">,</span> <span class="p">([],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]),</span> <span class="s">&#39;post augment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Should fallback</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer2</span> <span class="o">=</span> <span class="n">request_augmented_ibeis_nnindexer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">nnindexer</span> <span class="ow">is</span> <span class="n">nnindexer2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.request_background_nnindexer">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">request_background_nnindexer</code><span class="sig-paren">(</span><em>qreq_</em>, <em>daid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#request_background_nnindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.request_background_nnindexer" title="Permalink to this definition">¶</a></dt>
<dd><p>FIXME: Duplicate code</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</li>
<li><strong>daid_list</strong> (<em>list</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.neighbor_index_cache --test-request_background_nnindexer
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index_cache</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">ibeis</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">TEST_SPECIES</span><span class="o">.</span><span class="n">ZEB_PLAIN</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">request_background_nnindexer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.request_diskcached_ibeis_nnindexer">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">request_diskcached_ibeis_nnindexer</code><span class="sig-paren">(</span><em>qreq_</em>, <em>daid_list</em>, <em>nnindex_cfgstr=None</em>, <em>verbose=True</em>, <em>force_rebuild=False</em>, <em>memtrack=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#request_diskcached_ibeis_nnindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.request_diskcached_ibeis_nnindexer" title="Permalink to this definition">¶</a></dt>
<dd><p>builds new NeighborIndexer which will try to use a disk cached flann if
available</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</li>
<li><strong>daid_list</strong> (<em>list</em>) &#8211; </li>
<li><strong>nnindex_cfgstr</strong> &#8211; </li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">nnindexer</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">NeighborIndexer</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.neighbor_index_cache --test-request_diskcached_ibeis_nnindexer
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index_cache</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">ibeis</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">TEST_SPECIES</span><span class="o">.</span><span class="n">ZEB_PLAIN</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindex_cfgstr</span> <span class="o">=</span> <span class="n">build_nnindex_cfgstr</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span> <span class="o">=</span> <span class="n">request_diskcached_ibeis_nnindexer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">nnindex_cfgstr</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">nnindexer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.request_ibeis_nnindexer">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">request_ibeis_nnindexer</code><span class="sig-paren">(</span><em>qreq_</em>, <em>verbose=True</em>, <em>use_memcache=True</em>, <em>force_rebuild=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#request_ibeis_nnindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.request_ibeis_nnindexer" title="Permalink to this definition">¶</a></dt>
<dd><p>CALLED BY QUERYREQUST::LOAD_INDEXER
IBEIS interface into neighbor_index_cache</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">nnindexer</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">NeighborIndexer</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.neighbor_index_cache --test-request_ibeis_nnindexer
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index_cache</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span> <span class="o">=</span> <span class="n">request_ibeis_nnindexer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.request_memcached_ibeis_nnindexer">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">request_memcached_ibeis_nnindexer</code><span class="sig-paren">(</span><em>qreq_</em>, <em>daid_list</em>, <em>use_memcache=True</em>, <em>verbose=True</em>, <em>veryverbose=False</em>, <em>force_rebuild=False</em>, <em>allow_memfallback=True</em>, <em>memtrack=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#request_memcached_ibeis_nnindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.request_memcached_ibeis_nnindexer" title="Permalink to this definition">¶</a></dt>
<dd><p>FOR INTERNAL USE ONLY
takes custom daid list. might not be the same as what is in <a href="#id13"><span class="problematic" id="id14">qreq_</span></a></p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.neighbor_index_cache --test-request_memcached_ibeis_nnindexer
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index_cache</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">min_reindex_thresh</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ZEB_PLAIN</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">TEST_SPECIES</span><span class="o">.</span><span class="n">ZEB_PLAIN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">ZEB_PLAIN</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_memcache</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span> <span class="o">=</span> <span class="n">request_memcached_ibeis_nnindexer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">use_memcache</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">nnindexer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.neighbor_index_cache.test_nnindexer">
<code class="descclassname">ibeis.algo.hots.neighbor_index_cache.</code><code class="descname">test_nnindexer</code><span class="sig-paren">(</span><em>dbname='testdb1'</em>, <em>with_indexer=True</em>, <em>use_memcache=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/neighbor_index_cache.html#test_nnindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.neighbor_index_cache.test_nnindexer" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.neighbor_index_cache</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.nn_weights">
<span id="ibeis-algo-hots-nn-weights-module"></span><h2>ibeis.algo.hots.nn_weights module<a class="headerlink" href="#module-ibeis.algo.hots.nn_weights" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.apply_normweight">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">apply_normweight</code><span class="sig-paren">(</span><em>normweight_fn</em>, <em>qfx2_normk</em>, <em>qfx2_idx</em>, <em>qfx2_dist</em>, <em>Knorm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#apply_normweight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.apply_normweight" title="Permalink to this definition">¶</a></dt>
<dd><p>helper applies the normalized weight function to one query annotation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>normweight_fn</strong> (<em>func</em>) &#8211; chosen weight function e.g. lnbnn</li>
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation id</li>
<li><strong>qfx2_idx</strong> (<em>ndarray[int32_t, ndims=2]</em>) &#8211; mapping from query feature index to db neighbor index</li>
<li><strong>qfx2_dist</strong> (<em>ndarray</em>) &#8211; mapping from query feature index to dist</li>
<li><strong>Knorm</strong> (<em>int</em>) &#8211; </li>
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">qfx2_normweight</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.nn_weights --test-apply_normweight
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;K&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s">&#39;Knorm&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;normalizer_rule&#39;</span><span class="p">:</span> <span class="s">&#39;name&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_weight_neighbors</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">Knorm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normweight_fn</span> <span class="o">=</span> <span class="n">lnbnn_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalizer_rule</span>  <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">normalizer_rule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">nns_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_normk</span> <span class="o">=</span> <span class="n">get_normk</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">Knorm</span><span class="p">,</span> <span class="n">normalizer_rule</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_normweight</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">apply_normweight</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="n">normweight_fn</span><span class="p">,</span> <span class="n">qfx2_normk</span><span class="p">,</span> <span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">,</span> <span class="n">Knorm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">qfx2_normweight</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">950</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.bar_l2_fn">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">bar_l2_fn</code><span class="sig-paren">(</span><em>vdist</em>, <em>ndist</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#bar_l2_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.bar_l2_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>The feature weight is (1 - the euclidian distance
between the features). The normalizers are unused.</p>
<p>(not really a normaalized function)</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist</span><span class="p">,</span> <span class="n">ndist</span> <span class="o">=</span> <span class="n">testdata_vn_dists</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">bar_l2_fn</span><span class="p">(</span><span class="n">vdist</span><span class="p">,</span> <span class="n">ndist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hz_str</span><span class="p">(</span><span class="s">&#39;barl2  = &#39;</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">barl2  = np.array([[ 1.  ,  0.6 ,  0.41],</span>
<span class="go">                   [ 0.83,  0.7 ,  0.49],</span>
<span class="go">                   [ 0.87,  0.58,  0.27],</span>
<span class="go">                   [ 0.88,  0.63,  0.46],</span>
<span class="go">                   [ 0.82,  0.53,  0.5 ]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.borda_match_weighter">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">borda_match_weighter</code><span class="sig-paren">(</span><em>nns_list</em>, <em>nnvalid0_list</em>, <em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#borda_match_weighter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.borda_match_weighter" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_weight_neighbors</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bordavote_weight_list</span> <span class="o">=</span> <span class="n">borda_match_weighter</span><span class="p">(</span><span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;bordavote_weight_list = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">bordavote_weight_list</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.const_match_weighter">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">const_match_weighter</code><span class="sig-paren">(</span><em>nns_list</em>, <em>nnvalid0_list</em>, <em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#const_match_weighter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.const_match_weighter" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_weight_neighbors</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">constvote_weight_list</span> <span class="o">=</span> <span class="n">borda_match_weighter</span><span class="p">(</span><span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;constvote_weight_list = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">constvote_weight_list</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.cos_match_weighter">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">cos_match_weighter</code><span class="sig-paren">(</span><em>nns_list</em>, <em>nnvalid0_list</em>, <em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#cos_match_weighter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.cos_match_weighter" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses smk-like selectivity function. Need to gridsearch for a good alpha.</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.nn_weights --test-cos_match_weighter
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_weight_neighbors</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">cos_on</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">Knorm</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">cos_on</span><span class="p">,</span> <span class="s">&#39;bug setting custom params cos_weight&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos_weight_list</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">cos_match_weighter</span><span class="p">(</span><span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.distinctiveness_match_weighter">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">distinctiveness_match_weighter</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#distinctiveness_match_weighter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.distinctiveness_match_weighter" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: finish intergration</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_weight_neighbors</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone_dist_extern_distinctiveness&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span> <span class="o">=</span> <span class="n">tup</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.fg_match_weighter">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">fg_match_weighter</code><span class="sig-paren">(</span><em>nns_list</em>, <em>nnvalid0_list</em>, <em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#fg_match_weighter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.fg_match_weighter" title="Permalink to this definition">¶</a></dt>
<dd><p>foreground feature match weighting</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.nn_weights --exec-fg_match_weighter
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_weight_neighbors</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="n">sorted_</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">fg_on</span> <span class="o">==</span> <span class="bp">True</span><span class="p">,</span> <span class="s">&#39;bug setting custom params fg_on&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fgvotes_list</span> <span class="o">=</span> <span class="n">fg_match_weighter</span><span class="p">(</span><span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;fgvotes_list = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fgvotes_list</span><span class="p">,))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.get_name_normalizers">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">get_name_normalizers</code><span class="sig-paren">(</span><em>qaid</em>, <em>qreq_</em>, <em>Knorm</em>, <em>qfx2_idx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#get_name_normalizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.get_name_normalizers" title="Permalink to this definition">¶</a></dt>
<dd><p>helper normalizers for &#8216;name&#8217; normalizer_rule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation id</li>
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; hyper-parameters</li>
<li><strong>Knorm</strong> (<em>int</em>) &#8211; </li>
<li><strong>qfx2_idx</strong> (<em>ndarray</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">qfx2_normk</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;K&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s">&#39;Knorm&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;normalizer_rule&#39;</span><span class="p">:</span> <span class="s">&#39;name&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_weight_neighbors</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">Knorm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">nns_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_normk</span> <span class="o">=</span> <span class="n">get_name_normalizers</span><span class="p">(</span><span class="n">qaid</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">Knorm</span><span class="p">,</span> <span class="n">qfx2_idx</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.get_normk">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">get_normk</code><span class="sig-paren">(</span><em>qreq_</em>, <em>qaid</em>, <em>qfx2_idx</em>, <em>Knorm</em>, <em>normalizer_rule</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#get_normk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.get_normk" title="Permalink to this definition">¶</a></dt>
<dd><p>Get positions of the LNBNN/ratio tests normalizers</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.gravity_match_weighter">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">gravity_match_weighter</code><span class="sig-paren">(</span><em>nns_list</em>, <em>nnvalid0_list</em>, <em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#gravity_match_weighter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.gravity_match_weighter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.lnbnn_fn">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">lnbnn_fn</code><span class="sig-paren">(</span><em>vdist</em>, <em>ndist</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#lnbnn_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.lnbnn_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Locale Naive Bayes Nearest Neighbor weighting</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://www.cs.ubc.ca/~lowe/papers/12mccannCVPR.pdf">http://www.cs.ubc.ca/~lowe/papers/12mccannCVPR.pdf</a>
<a class="reference external" href="http://www.cs.ubc.ca/~sanchom/local-naive-bayes-nearest-neighbor">http://www.cs.ubc.ca/~sanchom/local-naive-bayes-nearest-neighbor</a></p>
<dl class="docutils">
<dt>Sympy:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#https://github.com/sympy/sympy/pull/10247</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">log</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.stats</span> <span class="kn">import</span> <span class="n">P</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">variance</span><span class="p">,</span> <span class="n">Die</span><span class="p">,</span> <span class="n">Normal</span><span class="p">,</span> <span class="n">FiniteRV</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">,</span> <span class="n">Cbar</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;C Cbar&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d_i</span> <span class="o">=</span> <span class="n">Die</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;di&#39;</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">di</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="o">/</span> <span class="n">P</span><span class="p">(</span><span class="n">di</span><span class="p">,</span> <span class="n">Cbar</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PdiC</span><span class="p">,</span> <span class="n">PdiCbar</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;PdiC, PdiCbar&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oddsC</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">PdiC</span> <span class="o">/</span> <span class="n">PdiCbar</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">oddsC</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="kn">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">check_expr_eq</span><span class="p">(</span><span class="n">oddsC</span><span class="p">,</span> <span class="n">log</span><span class="p">(</span><span class="n">PdiC</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">PdiCbar</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist</span><span class="p">,</span> <span class="n">ndist</span> <span class="o">=</span> <span class="n">testdata_vn_dists</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">lnbnn_fn</span><span class="p">(</span><span class="n">vdist</span><span class="p">,</span> <span class="n">ndist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hz_str</span><span class="p">(</span><span class="s">&#39;lnbnn  = &#39;</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">lnbnn  = np.array([[ 0.62,  0.22,  0.03],</span>
<span class="go">                   [ 0.35,  0.22,  0.01],</span>
<span class="go">                   [ 0.87,  0.58,  0.27],</span>
<span class="go">                   [ 0.67,  0.42,  0.25],</span>
<span class="go">                   [ 0.59,  0.3 ,  0.27]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.loglnbnn_fn">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">loglnbnn_fn</code><span class="sig-paren">(</span><em>vdist</em>, <em>ndist</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#loglnbnn_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.loglnbnn_fn" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist</span><span class="p">,</span> <span class="n">ndist</span> <span class="o">=</span> <span class="n">testdata_vn_dists</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">loglnbnn_fn</span><span class="p">(</span><span class="n">vdist</span><span class="p">,</span> <span class="n">ndist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hz_str</span><span class="p">(</span><span class="s">&#39;loglnbnn  = &#39;</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">loglnbnn  = np.array([[ 0.48,  0.2 ,  0.03],</span>
<span class="go">                      [ 0.3 ,  0.2 ,  0.01],</span>
<span class="go">                      [ 0.63,  0.46,  0.24],</span>
<span class="go">                      [ 0.51,  0.35,  0.22],</span>
<span class="go">                      [ 0.46,  0.26,  0.24]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.logratio_fn">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">logratio_fn</code><span class="sig-paren">(</span><em>vdist</em>, <em>ndist</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#logratio_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.logratio_fn" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist</span><span class="p">,</span> <span class="n">ndist</span> <span class="o">=</span> <span class="n">testdata_vn_dists</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">normonly_fn</span><span class="p">(</span><span class="n">vdist</span><span class="p">,</span> <span class="n">ndist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ 0.62,  0.62,  0.62],</span>
<span class="go">          [ 0.52,  0.52,  0.52],</span>
<span class="go">          [ 1.  ,  1.  ,  1.  ],</span>
<span class="go">          [ 0.79,  0.79,  0.79],</span>
<span class="go">          [ 0.77,  0.77,  0.77]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.mark_name_valid_normalizers">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">mark_name_valid_normalizers</code><span class="sig-paren">(</span><em>qnid</em>, <em>qfx2_topnid</em>, <em>qfx2_normnid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#mark_name_valid_normalizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.mark_name_valid_normalizers" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper func that allows matches only to the first result for a name</p>
<p>Each query feature finds its K matches and Kn normalizing matches. These
are the candidates from which it can choose a set of matches and a single
normalizer.</p>
<p>A normalizer is marked as invalid if it belongs to a name that was also in
its feature&#8217;s candidate matching set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qfx2_topnid</strong> (<em>ndarray</em>) &#8211; marks the names a feature matches</li>
<li><strong>qfx2_normnid</strong> (<em>ndarray</em>) &#8211; marks the names of the feature normalizers</li>
<li><strong>qnid</strong> (<em>int</em>) &#8211; query name id</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">qfx2_selnorm - index of the selected normalizer for each query feature</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.nn_weights --exec-mark_name_valid_normalizers
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qnid</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_topnid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_normnid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_selnorm</span> <span class="o">=</span> <span class="n">mark_name_valid_normalizers</span><span class="p">(</span><span class="n">qnid</span><span class="p">,</span> <span class="n">qfx2_topnid</span><span class="p">,</span> <span class="n">qfx2_normnid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qfx2_topnid</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qfx2_normnid</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_normk_</span> <span class="o">=</span> <span class="n">qfx2_selnorm</span> <span class="o">+</span> <span class="p">(</span><span class="n">Knorm</span><span class="p">)</span>  <span class="c"># convert form negative to pos indexes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">qfx2_normk_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[2 1 2 0 0 0 2 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.nn_normalized_weight">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">nn_normalized_weight</code><span class="sig-paren">(</span><em>normweight_fn</em>, <em>nns_list</em>, <em>nnvalid0_list</em>, <em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#nn_normalized_weight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.nn_normalized_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic function to weight nearest neighbors</p>
<p>ratio, lnbnn, and other nearest neighbor based functions use this</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>normweight_fn</strong> (<em>func</em>) &#8211; chosen weight function e.g. lnbnn</li>
<li><strong>nns_list</strong> (<em>dict</em>) &#8211; query descriptor nearest neighbors and distances. (qfx2_nnx, qfx2_dist)</li>
<li><strong>nnvalid0_list</strong> (<em>list</em>) &#8211; list of neighbors preflagged as valid</li>
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; hyper-parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">weights_list</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_weight_neighbors</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normweight_fn</span> <span class="o">=</span> <span class="n">lnbnn_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights_list1</span><span class="p">,</span> <span class="n">normk_list1</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">nn_normalized_weight</span><span class="p">(</span><span class="n">normweight_fn</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights1</span> <span class="o">=</span> <span class="n">weights_list1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn_normonly_weight</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">NN_WEIGHT_FUNC_DICT</span><span class="p">[</span><span class="s">&#39;lnbnn&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights_list2</span><span class="p">,</span> <span class="n">normk_list2</span> <span class="o">=</span> <span class="n">nn_normonly_weight</span><span class="p">(</span><span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights2</span> <span class="o">=</span> <span class="n">weights_list2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">weights1</span> <span class="o">==</span> <span class="n">weights2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">weights1</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_weight_neighbors</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normweight_fn</span> <span class="o">=</span> <span class="n">ratio_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights_list1</span><span class="p">,</span> <span class="n">normk_list1</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">nn_normalized_weight</span><span class="p">(</span><span class="n">normweight_fn</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights1</span> <span class="o">=</span> <span class="n">weights_list1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn_normonly_weight</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">NN_WEIGHT_FUNC_DICT</span><span class="p">[</span><span class="s">&#39;ratio&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights_list2</span><span class="p">,</span> <span class="n">normk_list2</span> <span class="o">=</span> <span class="n">nn_normonly_weight</span><span class="p">(</span><span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights2</span> <span class="o">=</span> <span class="n">weights_list2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">weights1</span> <span class="o">==</span> <span class="n">weights2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">weights1</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="mi">2700</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.normonly_fn">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">normonly_fn</code><span class="sig-paren">(</span><em>vdist</em>, <em>ndist</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#normonly_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.normonly_fn" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist</span><span class="p">,</span> <span class="n">ndist</span> <span class="o">=</span> <span class="n">testdata_vn_dists</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">normonly_fn</span><span class="p">(</span><span class="n">vdist</span><span class="p">,</span> <span class="n">ndist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[ 0.62,  0.62,  0.62],</span>
<span class="go">          [ 0.52,  0.52,  0.52],</span>
<span class="go">          [ 1.  ,  1.  ,  1.  ],</span>
<span class="go">          [ 0.79,  0.79,  0.79],</span>
<span class="go">          [ 0.77,  0.77,  0.77]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.ratio_fn">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">ratio_fn</code><span class="sig-paren">(</span><em>vdist</em>, <em>ndist</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#ratio_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.ratio_fn" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vdist</strong> (<em>ndarray</em>) &#8211; voting array</li>
<li><strong>ndist</strong> (<em>ndarray</em>) &#8211; normalizing array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">out</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist</span><span class="p">,</span> <span class="n">ndist</span> <span class="o">=</span> <span class="n">testdata_vn_dists</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">ratio_fn</span><span class="p">(</span><span class="n">vdist</span><span class="p">,</span> <span class="n">ndist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hz_str</span><span class="p">(</span><span class="s">&#39;ratio = &#39;</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">ratio = np.array([[ 0.  ,  0.65,  0.95],</span>
<span class="go">                  [ 0.33,  0.58,  0.98],</span>
<span class="go">                  [ 0.13,  0.42,  0.73],</span>
<span class="go">                  [ 0.15,  0.47,  0.68],</span>
<span class="go">                  [ 0.23,  0.61,  0.65]])</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.test_all_normalized_weights">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">test_all_normalized_weights</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#test_all_normalized_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.test_all_normalized_weights" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.nn_weights --exec-test_all_normalized_weights
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_all_normalized_weights</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.nn_weights.testdata_vn_dists">
<code class="descclassname">ibeis.algo.hots.nn_weights.</code><code class="descname">testdata_vn_dists</code><span class="sig-paren">(</span><em>nfeats=5</em>, <em>K=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/nn_weights.html#testdata_vn_dists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.nn_weights.testdata_vn_dists" title="Permalink to this definition">¶</a></dt>
<dd><p>Test voting and normalizing distances</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(vdist, ndist) - test voting distances and normalizer distances</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist</span><span class="p">,</span> <span class="n">ndist</span> <span class="o">=</span> <span class="n">testdata_vn_dists</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">hz_str</span><span class="p">(</span><span class="s">&#39;vdist = &#39;</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">vdist</span><span class="p">)))</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">hz_str</span><span class="p">(</span><span class="s">&#39;ndist = &#39;</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">ndist</span><span class="p">)))</span>
<span class="go">vdist = np.array([[ 0.  ,  0.4 ,  0.59],</span>
<span class="go">                  [ 0.17,  0.3 ,  0.51],</span>
<span class="go">                  [ 0.13,  0.42,  0.73],</span>
<span class="go">                  [ 0.12,  0.37,  0.54],</span>
<span class="go">                  [ 0.18,  0.47,  0.5 ]])</span>
<span class="go">ndist = np.array([[ 0.62],</span>
<span class="go">                  [ 0.52],</span>
<span class="go">                  [ 1.  ],</span>
<span class="go">                  [ 0.79],</span>
<span class="go">                  [ 0.77]])</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.old_chip_match">
<span id="ibeis-algo-hots-old-chip-match-module"></span><h2>ibeis.algo.hots.old_chip_match module<a class="headerlink" href="#module-ibeis.algo.hots.old_chip_match" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-ibeis.algo.hots.pgm_ext">
<span id="ibeis-algo-hots-pgm-ext-module"></span><h2>ibeis.algo.hots.pgm_ext module<a class="headerlink" href="#module-ibeis.algo.hots.pgm_ext" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibeis.algo.hots.pgm_ext.ApproximateFactor">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.pgm_ext.</code><code class="descname">ApproximateFactor</code><span class="sig-paren">(</span><em>state_idxs</em>, <em>weights</em>, <em>variables</em>, <em>statename_dict=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#ApproximateFactor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.ApproximateFactor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Instead of holding a weight for all possible states, an approximate factor
simply lists a set of (potentially duplicate) states. Each state has a
weight that is approximately proportional to the probability of that state.</p>
<p>The main difference is that the cardinality are implicit and the row labels
are explicit. In a normal factor it is reversed.</p>
<p>Maybe rename to sparse factor?</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pgm_ext --exec-ApproximateFactor --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pgm_ext</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_idxs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;v1&#39;</span><span class="p">,</span> <span class="s">&#39;v2&#39;</span><span class="p">,</span> <span class="s">&#39;v3&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ApproximateFactor</span><span class="p">(</span><span class="n">state_idxs</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">variables</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="ibeis.algo.hots.pgm_ext.ApproximateFactor.cardinality">
<code class="descname">cardinality</code><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.ApproximateFactor.cardinality" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.pgm_ext.ApproximateFactor.consolidate">
<code class="descname">consolidate</code><span class="sig-paren">(</span><em>inplace=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#ApproximateFactor.consolidate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.ApproximateFactor.consolidate" title="Permalink to this definition">¶</a></dt>
<dd><p>removes duplicate entries</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pgm_ext</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_idxs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;v1&#39;</span><span class="p">,</span> <span class="s">&#39;v2&#39;</span><span class="p">,</span> <span class="s">&#39;v3&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ApproximateFactor</span><span class="p">(</span><span class="n">state_idxs</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">variables</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inplace</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consolidate</span><span class="p">(</span><span class="n">inplace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">+------+------+------+-----------------------+</span>
<span class="go">| v1   | v2   | v3   |   \hat{phi}(v1,v2,v3) |</span>
<span class="go">|------+------+------+-----------------------|</span>
<span class="go">| v1_1 | v2_0 | v3_1 |                0.3000 |</span>
<span class="go">| v1_1 | v2_0 | v3_2 |                0.1000 |</span>
<span class="go">+------+------+------+-----------------------+</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.pgm_ext.ApproximateFactor.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#ApproximateFactor.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.ApproximateFactor.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the factor.</p>
</dd></dl>

<dl class="classmethod">
<dt id="ibeis.algo.hots.pgm_ext.ApproximateFactor.from_sampled">
<em class="property">classmethod </em><code class="descname">from_sampled</code><span class="sig-paren">(</span><em>sampled</em>, <em>variables=None</em>, <em>statename_dict=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#ApproximateFactor.from_sampled"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.ApproximateFactor.from_sampled" title="Permalink to this definition">¶</a></dt>
<dd><p>convert sampled states into an approximate factor</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.pgm_ext.ApproximateFactor.get_sparse_values">
<code class="descname">get_sparse_values</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#ApproximateFactor.get_sparse_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.ApproximateFactor.get_sparse_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.pgm_ext.ApproximateFactor.marginalize">
<code class="descname">marginalize</code><span class="sig-paren">(</span><em>variables</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#ApproximateFactor.marginalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.ApproximateFactor.marginalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Modifies the factor with marginalized values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>variables</strong> (<em>list, array-like</em>) &#8211; List of variables over which to marginalize.</li>
<li><strong>inplace</strong> (<em>bool</em>) &#8211; If inplace=True it will modify the factor itself, else would
return a new factor.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">if inplace=True (default) returns None
if inplace=False returns a new <cite>Factor</cite> instance.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Factor or None</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pgm_ext</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_idxs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;v1&#39;</span><span class="p">,</span> <span class="s">&#39;v2&#39;</span><span class="p">,</span> <span class="s">&#39;v3&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ApproximateFactor</span><span class="p">(</span><span class="n">state_idxs</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">variables</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;v2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inplace</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">marginalize</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="go">+------+------+--------------------+</span>
<span class="go">| v1   | v3   |   \hat{phi}(v1,v3) |</span>
<span class="go">|------+------+--------------------|</span>
<span class="go">| v1_1 | v3_1 |             0.3000 |</span>
<span class="go">| v1_2 | v3_2 |             0.1000 |</span>
<span class="go">+------+------+--------------------+</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.pgm_ext.ApproximateFactor.normalize">
<code class="descname">normalize</code><span class="sig-paren">(</span><em>inplace=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#ApproximateFactor.normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.ApproximateFactor.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizes the weights of factor so that they sum to 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>inplace</strong> (<em>bool</em>) &#8211; (default = True)</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pgm_ext --exec-normalize
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pgm_ext</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_idxs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;v1&#39;</span><span class="p">,</span> <span class="s">&#39;v2&#39;</span><span class="p">,</span> <span class="s">&#39;v3&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ApproximateFactor</span><span class="p">(</span><span class="n">state_idxs</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">variables</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">inplace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">+------+------+------+-----------------------+</span>
<span class="go">| v1   | v2   | v3   |   \hat{phi}(v1,v2,v3) |</span>
<span class="go">|------+------+------+-----------------------|</span>
<span class="go">| v1_0 | v2_0 | v3_1 |                0.2500 |</span>
<span class="go">| v1_1 | v2_0 | v3_1 |                0.5000 |</span>
<span class="go">| v1_2 | v2_0 | v3_2 |                0.2500 |</span>
<span class="go">+------+------+------+-----------------------+</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.pgm_ext.ApproximateFactor.reorder">
<code class="descname">reorder</code><span class="sig-paren">(</span><em>order=None</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#ApproximateFactor.reorder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.ApproximateFactor.reorder" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes internal variable ordering</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pgm_ext --exec-reorder
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pgm_ext</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_idxs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;v1&#39;</span><span class="p">,</span> <span class="s">&#39;v2&#39;</span><span class="p">,</span> <span class="s">&#39;v3&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">ApproximateFactor</span><span class="p">(</span><span class="n">state_idxs</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">variables</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">reorder</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">+------+------+------+-----------------------+</span>
<span class="go">| v3   | v1   | v2   |   \hat{phi}(v3,v1,v2) |</span>
<span class="go">|------+------+------+-----------------------|</span>
<span class="go">| v3_1 | v1_0 | v2_0 |                0.1000 |</span>
<span class="go">| v3_1 | v1_1 | v2_0 |                0.2000 |</span>
<span class="go">| v3_2 | v1_2 | v2_0 |                0.1000 |</span>
<span class="go">+------+------+------+-----------------------+</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.pgm_ext.ApproximateFactor.scope">
<code class="descname">scope</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#ApproximateFactor.scope"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.ApproximateFactor.scope" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.pgm_ext.ApproximateFactor.values">
<code class="descname">values</code><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.ApproximateFactor.values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ibeis.algo.hots.pgm_ext.TemplateCPD">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.pgm_ext.</code><code class="descname">TemplateCPD</code><span class="sig-paren">(</span><em>ttype</em>, <em>basis</em>, <em>varpref=None</em>, <em>evidence_ttypes=None</em>, <em>pmf_func=None</em>, <em>special_basis_pool=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#TemplateCPD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.TemplateCPD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Factory for templated cpds</p>
<dl class="method">
<dt id="ibeis.algo.hots.pgm_ext.TemplateCPD.example_cpd">
<code class="descname">example_cpd</code><span class="sig-paren">(</span><em>id_=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#TemplateCPD.example_cpd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.TemplateCPD.example_cpd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.pgm_ext.TemplateCPD.new_cpd">
<code class="descname">new_cpd</code><span class="sig-paren">(</span><em>parents=None</em>, <em>pmf_func=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#TemplateCPD.new_cpd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.TemplateCPD.new_cpd" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a new random variable that is an instance of this tempalte</p>
<p>parents : only used to define the name of this node.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_ext.coin_example">
<code class="descclassname">ibeis.algo.hots.pgm_ext.</code><code class="descname">coin_example</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#coin_example"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.coin_example" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple example of conditional independence.</p>
<p class="rubric">Notes</p>
<p>We are given a coin.
We do not know if it is fair or unfair.
There is an equal chance of either.
(If it is unfair it has a a 9-to-1 odds).
Initially, the results a coin toss are initially conditionally</p>
<blockquote>
<div>independant of any other toss.</div></blockquote>
<dl class="docutils">
<dt>However, if we observe a heads on the first toss the chance of heads</dt>
<dd>on the second toss will increase.</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pgm_ext --exec-coin_example
python -m ibeis.algo.hots.pgm_ext --exec-coin_example --show
python -m ibeis.algo.hots.pgm_ext --exec-coin_example --show --cmd
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pgm_ext</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">coin_example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_templates</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_priors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;T02&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infr</span> <span class="o">=</span> <span class="n">pgmpy</span><span class="o">.</span><span class="n">inference</span><span class="o">.</span><span class="n">VariableElimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Inference (1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;(1.a) Observe nothing&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evidence1</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor_list1</span> <span class="o">=</span> <span class="n">infr</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query_vars</span><span class="p">,</span> <span class="n">evidence1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_factors</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">factor_list1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;(1.b)  nothing changes&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Inference (2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;(2.a) Observe that toss 1 was heads&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evidence2</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_ensure_internal_evidence</span><span class="p">({</span><span class="s">&#39;T01&#39;</span><span class="p">:</span> <span class="s">&#39;heads&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor_list2</span> <span class="o">=</span> <span class="n">infr</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query_vars</span><span class="p">,</span> <span class="n">evidence2</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_factors</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">factor_list2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi1</span> <span class="o">=</span> <span class="n">factor_list1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi2</span> <span class="o">=</span> <span class="n">factor_list2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">phi2</span><span class="p">[</span><span class="s">&#39;heads&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">phi1</span><span class="p">[</span><span class="s">&#39;heads&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;(2.b) Slightly more likely to see heads in the second coin toss&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># print(&#39;Observe that toss 1 was tails&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># evidence = model._ensure_internal_evidence({&#39;T01&#39;: &#39;tails&#39;})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># factor_list2 = infr.query(query_vars, evidence).values()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># print_factors(model, factor_list2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots</span> <span class="kn">import</span> <span class="n">bayes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kw</span> <span class="o">=</span> <span class="n">bayes</span><span class="o">.</span><span class="n">cluster_query</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">query_vars</span><span class="p">,</span><span class="n">evidence2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                         <span class="n">method</span><span class="o">=</span><span class="s">&#39;bp&#39;</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="s">&#39;marginalize&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#model.show_model(fnum=1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#model.show_model(fnum=2, evidence=evidence2, factor_list=factor_list2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_model</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="n">evidence2</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_markov_model</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="n">evidence2</span><span class="p">,</span> <span class="n">factor_list</span><span class="o">=</span><span class="n">factor_list2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_junction_tree</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="n">evidence2</span><span class="p">,</span> <span class="n">factor_list</span><span class="o">=</span><span class="n">factor_list2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#netx.draw_graphviz(model, with_labels=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_ext.customize_model">
<code class="descclassname">ibeis.algo.hots.pgm_ext.</code><code class="descname">customize_model</code><span class="sig-paren">(</span><em>model</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#customize_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.customize_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_ext.define_model">
<code class="descclassname">ibeis.algo.hots.pgm_ext.</code><code class="descname">define_model</code><span class="sig-paren">(</span><em>cpd_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#define_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.define_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Custom extensions of pgmpy modl</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_ext.map_example">
<code class="descclassname">ibeis.algo.hots.pgm_ext.</code><code class="descname">map_example</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#map_example"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.map_example" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pgm_ext --exec-map_example --show
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="https://class.coursera.org/pgm-003/lecture/44">https://class.coursera.org/pgm-003/lecture/44</a></p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pgm_ext</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">map_example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#netx.draw_graphviz(model, with_labels=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pgm_viz</span><span class="o">.</span><span class="n">show_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_ext.mustbe_example">
<code class="descclassname">ibeis.algo.hots.pgm_ext.</code><code class="descname">mustbe_example</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#mustbe_example"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.mustbe_example" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple example where observing F0 forces N0 to take on a value.</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pgm_ext --exec-mustbe_example --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># UNSTABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pgm_ext</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">mustbe_example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_templates</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_priors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#infr = pgmpy.inference.VariableElimination(model)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infr</span> <span class="o">=</span> <span class="n">pgmpy</span><span class="o">.</span><span class="n">inference</span><span class="o">.</span><span class="n">BeliefPropagation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Observe: &#39;</span> <span class="o">+</span> <span class="s">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">pretty_evidence</span><span class="p">({})))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor_list1</span> <span class="o">=</span> <span class="n">infr</span><span class="o">.</span><span class="n">query</span><span class="p">([</span><span class="s">&#39;N0&#39;</span><span class="p">],</span> <span class="p">{})</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">map1</span> <span class="o">=</span> <span class="n">infr</span><span class="o">.</span><span class="n">map_query</span><span class="p">([</span><span class="s">&#39;N0&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;map1 = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">map1</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_factors</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">factor_list1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evidence</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_ensure_internal_evidence</span><span class="p">({</span><span class="s">&#39;F0&#39;</span><span class="p">:</span> <span class="s">&#39;true&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Observe: &#39;</span> <span class="o">+</span> <span class="s">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">pretty_evidence</span><span class="p">(</span><span class="n">evidence</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor_list2</span> <span class="o">=</span> <span class="n">infr</span><span class="o">.</span><span class="n">query</span><span class="p">([</span><span class="s">&#39;N0&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">map2</span> <span class="o">=</span> <span class="n">infr</span><span class="o">.</span><span class="n">map_query</span><span class="p">([</span><span class="s">&#39;N0&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;map2 = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">map2</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_factors</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">factor_list2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evidence</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_ensure_internal_evidence</span><span class="p">({</span><span class="s">&#39;F0&#39;</span><span class="p">:</span> <span class="s">&#39;false&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Observe: &#39;</span> <span class="o">+</span> <span class="s">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">pretty_evidence</span><span class="p">(</span><span class="n">evidence</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor_list3</span> <span class="o">=</span> <span class="n">infr</span><span class="o">.</span><span class="n">query</span><span class="p">([</span><span class="s">&#39;N0&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">map3</span> <span class="o">=</span> <span class="n">infr</span><span class="o">.</span><span class="n">map_query</span><span class="p">([</span><span class="s">&#39;N0&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;map3 = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">map3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_factors</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">factor_list3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi1</span> <span class="o">=</span> <span class="n">factor_list1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi2</span> <span class="o">=</span> <span class="n">factor_list2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">phi1</span><span class="p">[</span><span class="s">&#39;fred&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">phi1</span><span class="p">[</span><span class="s">&#39;sue&#39;</span><span class="p">],</span> <span class="s">&#39;should be uniform&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">phi2</span><span class="p">[</span><span class="s">&#39;fred&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;should be 1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#netx.draw_graphviz(model, with_labels=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pgm_viz</span><span class="o">.</span><span class="n">show_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pgm_viz</span><span class="o">.</span><span class="n">show_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="n">evidence</span><span class="p">,</span> <span class="n">factor_list</span><span class="o">=</span><span class="n">factor_list2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_ext.print_factors">
<code class="descclassname">ibeis.algo.hots.pgm_ext.</code><code class="descname">print_factors</code><span class="sig-paren">(</span><em>model</em>, <em>factor_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#print_factors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.print_factors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_ext.test_markovmodel">
<code class="descclassname">ibeis.algo.hots.pgm_ext.</code><code class="descname">test_markovmodel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_ext.html#test_markovmodel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_ext.test_markovmodel" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pgm_ext</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.pgm_viz">
<span id="ibeis-algo-hots-pgm-viz-module"></span><h2>ibeis.algo.hots.pgm_viz module<a class="headerlink" href="#module-ibeis.algo.hots.pgm_viz" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.algo.hots.pgm_viz.draw_bayesian_model">
<code class="descclassname">ibeis.algo.hots.pgm_viz.</code><code class="descname">draw_bayesian_model</code><span class="sig-paren">(</span><em>model</em>, <em>evidence={}</em>, <em>soft_evidence={}</em>, <em>fnum=None</em>, <em>pnum=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_viz.html#draw_bayesian_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_viz.draw_bayesian_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_viz.draw_junction_tree">
<code class="descclassname">ibeis.algo.hots.pgm_viz.</code><code class="descname">draw_junction_tree</code><span class="sig-paren">(</span><em>model</em>, <em>fnum=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_viz.html#draw_junction_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_viz.draw_junction_tree" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_viz.draw_map_histogram">
<code class="descclassname">ibeis.algo.hots.pgm_viz.</code><code class="descname">draw_map_histogram</code><span class="sig-paren">(</span><em>top_assignments</em>, <em>fnum=None</em>, <em>pnum=(1</em>, <em>1</em>, <em>1)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_viz.html#draw_map_histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_viz.draw_map_histogram" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_viz.draw_markov_model">
<code class="descclassname">ibeis.algo.hots.pgm_viz.</code><code class="descname">draw_markov_model</code><span class="sig-paren">(</span><em>model</em>, <em>fnum=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_viz.html#draw_markov_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_viz.draw_markov_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_viz.get_bayesnet_layout">
<code class="descclassname">ibeis.algo.hots.pgm_viz.</code><code class="descname">get_bayesnet_layout</code><span class="sig-paren">(</span><em>model</em>, <em>name_nodes=None</em>, <em>prog=u'dot'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_viz.html#get_bayesnet_layout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_viz.get_bayesnet_layout" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures ordering of layers is in order of addition via templates</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_viz.get_node_viz_attrs">
<code class="descclassname">ibeis.algo.hots.pgm_viz.</code><code class="descname">get_node_viz_attrs</code><span class="sig-paren">(</span><em>model</em>, <em>evidence</em>, <em>soft_evidence</em>, <em>factor_list</em>, <em>ttype_colors</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_viz.html#get_node_viz_attrs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_viz.get_node_viz_attrs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_viz.make_colorcodes">
<code class="descclassname">ibeis.algo.hots.pgm_viz.</code><code class="descname">make_colorcodes</code><span class="sig-paren">(</span><em>model</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_viz.html#make_colorcodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_viz.make_colorcodes" title="Permalink to this definition">¶</a></dt>
<dd><p>python -m ibeis.algo.hots.bayes &#8211;exec-make_name_model &#8211;show
python -m ibeis.algo.hots.bayes &#8211;exec-cluster_query &#8211;show
python -m ibeis &#8211;tf demo_bayesnet &#8211;ev :nA=4,nS=2,Na=n0,rand_scores=True &#8211;show &#8211;verbose
python -m ibeis &#8211;tf demo_bayesnet &#8211;ev :nA=4,nS=3,Na=n0,rand_scores=True &#8211;show &#8211;verbose</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_viz.make_factor_text">
<code class="descclassname">ibeis.algo.hots.pgm_viz.</code><code class="descname">make_factor_text</code><span class="sig-paren">(</span><em>factor</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_viz.html#make_factor_text"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_viz.make_factor_text" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_viz.print_ascii_graph">
<code class="descclassname">ibeis.algo.hots.pgm_viz.</code><code class="descname">print_ascii_graph</code><span class="sig-paren">(</span><em>model_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_viz.html#print_ascii_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_viz.print_ascii_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>pip install img2txt.py</p>
<p>python -c</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_viz.show_bayesian_model">
<code class="descclassname">ibeis.algo.hots.pgm_viz.</code><code class="descname">show_bayesian_model</code><span class="sig-paren">(</span><em>model</em>, <em>evidence={}</em>, <em>soft_evidence={}</em>, <em>fnum=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_viz.html#show_bayesian_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_viz.show_bayesian_model" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/22207802/networkx-node-level-or-layer">http://stackoverflow.com/questions/22207802/networkx-node-level-or-layer</a></p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pgm_viz --exec-show_model --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pgm_viz</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evidence</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">soft_evidence</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">show_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">evidence</span><span class="p">,</span> <span class="n">soft_evidence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_viz.show_junction_tree">
<code class="descclassname">ibeis.algo.hots.pgm_viz.</code><code class="descname">show_junction_tree</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_viz.html#show_junction_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_viz.show_junction_tree" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_viz.show_markov_model">
<code class="descclassname">ibeis.algo.hots.pgm_viz.</code><code class="descname">show_markov_model</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_viz.html#show_markov_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_viz.show_markov_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pgm_viz.show_model">
<code class="descclassname">ibeis.algo.hots.pgm_viz.</code><code class="descname">show_model</code><span class="sig-paren">(</span><em>model</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pgm_viz.html#show_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pgm_viz.show_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.pipeline">
<span id="ibeis-algo-hots-pipeline-module"></span><h2>ibeis.algo.hots.pipeline module<a class="headerlink" href="#module-ibeis.algo.hots.pipeline" title="Permalink to this headline">¶</a></h2>
<p>Hotspotter pipeline module</p>
<dl class="docutils">
<dt>Module Notation and Concepts::</dt>
<dd><p class="first">PREFIXES:
qaid2_XXX - prefix mapping query chip index to
qfx2_XXX  - prefix mapping query chip feature index to</p>
<blockquote>
<div><ul class="simple">
<li>nns    - a (qfx2_idx, qfx2_dist) tuple</li>
<li>idx    - the index into the nnindexers descriptors</li>
<li>qfx    - query feature index wrt the query chip</li>
<li>dfx    - query feature index wrt the database chip</li>
<li>dist   - the distance to a corresponding feature</li>
<li>fm     - a list of feature match pairs / correspondences (qfx, dfx)</li>
<li>fsv    - a score vector of a corresponding feature</li>
<li>valid  - a valid bit for a corresponding feature</li>
</ul>
</div></blockquote>
<p>PIPELINE_VARS::
nns_list - maping from query chip index to nns</p>
<blockquote>
<div><ul class="simple">
<li>qfx2_idx   - ranked list of query feature indexes to database feature indexes</li>
<li>qfx2_dist - ranked list of query feature indexes to database feature indexes</li>
</ul>
</div></blockquote>
<ul class="last">
<li><dl class="first docutils">
<dt>qaid2_norm_weight - mapping from qaid to (qfx2_normweight, qfx2_selnorm)</dt>
<dd><p class="first last">= qaid2_nnfiltagg[qaid]</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>To see the ouput of a <span class="nb">complete </span>pipeline run use

<span class="c"># Set to whichever database you like</span>
python main.py --db PZ_MTEST --setdb
python main.py --db NAUT_test --setdb
python main.py --db testdb1 --setdb

<span class="c"># Then run whichever configuration you like</span>
python main.py --query <span class="m">1</span> --yes --noqcache -t default:codename<span class="o">=</span>vsone
python main.py --query <span class="m">1</span> --yes --noqcache -t default:codename<span class="o">=</span>vsone_norm
python main.py --query <span class="m">1</span> --yes --noqcache -t default:codename<span class="o">=</span>vsmany
python main.py --query <span class="m">1</span> --yes --noqcache -t default:codename<span class="o">=</span>vsmany_nsum
</pre></div>
</div>
<dl class="docutils">
<dt>TODO:</dt>
<dd><ul class="first simple">
<li>Don&#8217;t preload the nn-indexer in case the nearest neighbors have already</li>
</ul>
<p class="last">been computed?</p>
</dd>
</dl>
<dl class="attribute">
<dt id="ibeis.algo.hots.pipeline.ValidMatchTup_">
<code class="descclassname">ibeis.algo.hots.pipeline.</code><code class="descname">ValidMatchTup_</code><a class="headerlink" href="#ibeis.algo.hots.pipeline.ValidMatchTup_" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">vmt</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.pipeline.WeightRet_">
<code class="descclassname">ibeis.algo.hots.pipeline.</code><code class="descname">WeightRet_</code><a class="headerlink" href="#ibeis.algo.hots.pipeline.WeightRet_" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">weight_ret</span></code></p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pipeline.baseline_neighbor_filter">
<code class="descclassname">ibeis.algo.hots.pipeline.</code><code class="descname">baseline_neighbor_filter</code><span class="sig-paren">(</span><em>qreq_</em>, <em>nns_list</em>, <em>impossible_daids_list</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pipeline.html#baseline_neighbor_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pipeline.baseline_neighbor_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes matches to self, the same image, or the same name.</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pipeline --test-baseline_neighbor_filter
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">impossible_daids_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_baselinefilter</span><span class="p">(</span><span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsmany&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnvalid0_list</span> <span class="o">=</span> <span class="n">baseline_neighbor_filter</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">impossible_daids_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nnvalid0_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#ut.assert_eq(nnvalid0_list[0].shape[1], qreq_.qparams.K, &#39;does not match k&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#ut.assert_eq(qreq_.qparams.K, 4, &#39;k is not 4&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">nnvalid0_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="p">(</span>
<span class="gp">... </span>   <span class="s">&#39;first col should be all invalid because of self match&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">nnvalid0_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span>
<span class="gp">... </span>   <span class="s">&#39;second col should have some good matches&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">nnvalid0_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="mi">1900</span><span class="p">,</span> <span class="mi">3500</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">impossible_daids_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_baselinefilter</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnvalid0_list</span> <span class="o">=</span> <span class="n">baseline_neighbor_filter</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">impossible_daids_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nnvalid0_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_daids</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">K</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;k is not 1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">nnvalid0_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">K</span><span class="p">,</span> <span class="s">&#39;does not match k&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">nnvalid0_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;no self matches&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">nnvalid0_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1100</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pipeline.build_chipmatches">
<code class="descclassname">ibeis.algo.hots.pipeline.</code><code class="descname">build_chipmatches</code><span class="sig-paren">(</span><em>qreq_</em>, <em>nns_list</em>, <em>nnvalid0_list</em>, <em>filtkey_list</em>, <em>filtweights_list</em>, <em>filtvalids_list</em>, <em>filtnormks_list</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pipeline.html#build_chipmatches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pipeline.build_chipmatches" title="Permalink to this definition">¶</a></dt>
<dd><p>pipeline step 4 - builds sparse chipmatches</p>
<p>Takes the dense feature matches from query feature to (what could be any)
database features and builds sparse matching pairs for each annotation to
annotation match.</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis --tf build_chipmatches
python -m ibeis --tf build_chipmatches:0 --show
python -m ibeis --tf build_chipmatches:1 --show
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre</span><span class="p">(</span><span class="s">&#39;build_chipmatches&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:codename=vsmany&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span><span class="p">,</span> <span class="n">filtkey_list</span><span class="p">,</span> <span class="n">filtweights_list</span><span class="p">,</span> <span class="n">filtvalids_list</span><span class="p">,</span> <span class="n">filtnormks_list</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list</span> <span class="o">=</span> <span class="n">build_chipmatches</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">assert_self</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span> <span class="k">for</span> <span class="n">cm</span> <span class="ow">in</span> <span class="n">cm_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">fm_list</span><span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">daid2_idx</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_matches</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;vsone num_matches = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">num_matches</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">num_matches</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="s">&#39;vsmany nmatches out of bounds&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show_single_annotmatch</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre</span><span class="p">(</span><span class="s">&#39;build_chipmatches&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:codename=vsone,sqrd_dist_on=True&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span><span class="p">,</span> <span class="n">filtkey_list</span><span class="p">,</span> <span class="n">filtweights_list</span><span class="p">,</span> <span class="n">filtvalids_list</span><span class="p">,</span> <span class="n">filtnormks_list</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list</span> <span class="o">=</span> <span class="n">build_chipmatches</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">assert_self</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span> <span class="k">for</span> <span class="n">cm</span> <span class="ow">in</span> <span class="n">cm_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">fm_list</span><span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">daid2_idx</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_matches</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;vsone num_matches = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">num_matches</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">num_matches</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="s">&#39;vsone nmatches out of bounds&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">show_single_annotmatch</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">daid</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pipeline.build_impossible_daids_list">
<code class="descclassname">ibeis.algo.hots.pipeline.</code><code class="descname">build_impossible_daids_list</code><span class="sig-paren">(</span><em>qreq_</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pipeline.html#build_impossible_daids_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pipeline.build_impossible_daids_list" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pipeline --test-build_impossible_daids_list
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">species</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">TEST_SPECIES</span><span class="o">.</span><span class="n">ZEB_PLAIN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">species</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">species</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                              <span class="n">cfgdict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsmany&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                           <span class="n">use_k_padding</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                           <span class="n">can_match_sameimg</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                           <span class="n">can_match_samename</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">impossible_daids_list</span><span class="p">,</span> <span class="n">Kpad_list</span> <span class="o">=</span> <span class="n">build_impossible_daids_list</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">impossible_daids_list</span><span class="p">,</span> <span class="n">Kpad_list</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">([array([1]), array([2, 3]), array([2, 3]), array([4]), array([5, 6]), array([5, 6])], [1, 2, 2, 1, 2, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pipeline.cachemiss_nn_compute_fn">
<code class="descclassname">ibeis.algo.hots.pipeline.</code><code class="descname">cachemiss_nn_compute_fn</code><span class="sig-paren">(</span><em>flags_list</em>, <em>qreq_</em>, <em>Kpad_list</em>, <em>K</em>, <em>Knorm</em>, <em>verbose</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pipeline.html#cachemiss_nn_compute_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pipeline.cachemiss_nn_compute_fn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pipeline.compute_matching_dlen_extent">
<code class="descclassname">ibeis.algo.hots.pipeline.</code><code class="descname">compute_matching_dlen_extent</code><span class="sig-paren">(</span><em>qreq_</em>, <em>fm_list</em>, <em>kpts_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pipeline.html#compute_matching_dlen_extent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pipeline.compute_matching_dlen_extent" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for spatial verification, computes the squared diagonal length of
matching chips</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pipeline --test-compute_matching_dlen_extent
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_sver</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">set_cannonical_annot_score</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">get_num_matches_list</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">sortself</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm_list</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">fm_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts_list</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_kpts</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">daid_list</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_data_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topx2_dlen_sqrd</span> <span class="o">=</span> <span class="n">compute_matching_dlen_extent</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">fm_list</span><span class="p">,</span> <span class="n">kpts_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">topx2_dlen_sqrd</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pipeline.get_sparse_matchinfo_nonagg">
<code class="descclassname">ibeis.algo.hots.pipeline.</code><code class="descname">get_sparse_matchinfo_nonagg</code><span class="sig-paren">(</span><em>qreq_</em>, <em>qfx2_idx</em>, <em>qfx2_valid0</em>, <em>qfx2_score_list</em>, <em>qfx2_valid_list</em>, <em>qfx2_normk_list</em>, <em>Knorm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pipeline.html#get_sparse_matchinfo_nonagg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pipeline.get_sparse_matchinfo_nonagg" title="Permalink to this definition">¶</a></dt>
<dd><p>builds sparse iterator that generates feature match pairs, scores, and ranks</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">vmt a tuple of corresponding lists. Each item in the
list corresponds to a daid, dfx, scorevec, rank, norm_aid, norm_fx...</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a href="#id15"><span class="problematic" id="id16">ValidMatchTup_</span></a></td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pipeline --test-get_sparse_matchinfo_nonagg:0 --show
python -m ibeis.algo.hots.pipeline --test-get_sparse_matchinfo_nonagg:1 --show

utprof.py -m ibeis.algo.hots.pipeline --test-get_sparse_matchinfo_nonagg
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">daid</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_sparse_matchinfo_nonagg</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:codename=vsone&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_valid0</span><span class="p">,</span> <span class="n">qfx2_score_list</span><span class="p">,</span> <span class="n">qfx2_valid_list</span><span class="p">,</span> <span class="n">qfx2_normk_list</span><span class="p">,</span> <span class="n">Knorm</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vmt</span> <span class="o">=</span> <span class="n">get_sparse_matchinfo_nonagg</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># check results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">ut</span><span class="o">.</span><span class="n">allsame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">vmt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]))),</span> <span class="s">&#39;need same num rows&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">vmt</span><span class="o">.</span><span class="n">dfx</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_num_feats</span><span class="p">(</span><span class="n">qaid</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">vmt</span><span class="o">.</span><span class="n">qfx</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_num_feats</span><span class="p">(</span><span class="n">daid</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">daid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vmt_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">vmt</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">chip_match</span><span class="o">.</span><span class="n">ChipMatch</span><span class="o">.</span><span class="n">from_vsone_match_tup</span><span class="p">(</span><span class="n">vmt_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="o">=</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">qaid</span><span class="o">=</span><span class="n">qaid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">assert_self</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">show_single_annotmatch</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">daid</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_sparse_matchinfo_nonagg</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:Knorm=3,normalizer_rule=name,const_on=True,ratio_thresh=.2,sqrd_dist_on=True&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_valid0</span><span class="p">,</span> <span class="n">qfx2_score_list</span><span class="p">,</span> <span class="n">qfx2_valid_list</span><span class="p">,</span> <span class="n">qfx2_normk_list</span><span class="p">,</span> <span class="n">Knorm</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vmt</span> <span class="o">=</span> <span class="n">get_sparse_matchinfo_nonagg</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># check results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">ut</span><span class="o">.</span><span class="n">allsame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">vmt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]))),</span> <span class="s">&#39;need same num rows&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">vmt</span><span class="o">.</span><span class="n">qfx</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_num_feats</span><span class="p">(</span><span class="n">qaid</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">vmt</span><span class="o">.</span><span class="n">dfx</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_num_feats</span><span class="p">(</span><span class="n">vmt</span><span class="o">.</span><span class="n">daid</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">chip_match</span><span class="o">.</span><span class="n">ChipMatch</span><span class="o">.</span><span class="n">from_vsmany_match_tup</span><span class="p">(</span><span class="n">vmt</span><span class="p">,</span> <span class="n">qaid</span><span class="o">=</span><span class="n">qaid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">assert_self</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">show_single_annotmatch</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pipeline.nearest_neighbor_cacheid2">
<code class="descclassname">ibeis.algo.hots.pipeline.</code><code class="descname">nearest_neighbor_cacheid2</code><span class="sig-paren">(</span><em>qreq_</em>, <em>Kpad_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pipeline.html#nearest_neighbor_cacheid2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pipeline.nearest_neighbor_cacheid2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a hacky cacheid for neighbor configs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</li>
<li><strong>Kpad_list</strong> (<em>list</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(nn_mid_cacheid_list, nn_cachedir)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pipeline --exec-nearest_neighbor_cacheid2
python -m ibeis.algo.hots.pipeline --exec-nearest_neighbor_cacheid2 --superstrict
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">Knorm</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">use_k_padding</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="s">&#39;default&#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_cfg_lbl</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="n">p</span><span class="p">],</span> <span class="n">qaid_override</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">daid_override</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;nearest_neighbors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Kpad_list</span><span class="p">,</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_take</span><span class="p">(</span><span class="n">locals_</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;Kpad_list&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">nearest_neighbor_cacheid2</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">Kpad_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">nn_cachedir</span><span class="p">,</span> <span class="n">nn_mid_cacheid_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s">&#39;nn_mid_cacheid_list = &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">nn_mid_cacheid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">nn_mid_cacheid_list = [</span>
<span class="go">    &#39;8687dcb6-1f1f-fdd3-8b72-8f36f9f41905_DVUUIDS((5)oavtblnlrtocnrpm)_NN(single,cks800)_FEAT(hesaff+sift_)_CHIP(sz450)_FLANN(8_kdtrees)_truek6&#39;,</span>
<span class="go">    &#39;a2aef668-20c1-1897-d8f3-09a47a73f26a_DVUUIDS((5)oavtblnlrtocnrpm)_NN(single,cks800)_FEAT(hesaff+sift_)_CHIP(sz450)_FLANN(8_kdtrees)_truek6&#39;,</span>
<span class="go">]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>nn_mid_cacheid_list = [</dt>
<dd>&#8216;8687dcb6-1f1f-fdd3-8b72-8f36f9f41905_DVUUIDS((5)oavtblnlrtocnrpm)_NN(single,K4+1,padk=False,last,cks800)_FEAT(<a href="#id17"><span class="problematic" id="id18">hesaff+sift_</span></a>)_CHIP(sz450)_FLANN(8_kdtrees)_1&#8217;,
&#8216;a2aef668-20c1-1897-d8f3-09a47a73f26a_DVUUIDS((5)oavtblnlrtocnrpm)_NN(single,K4+1,padk=False,last,cks800)_FEAT(<a href="#id19"><span class="problematic" id="id20">hesaff+sift_</span></a>)_CHIP(sz450)_FLANN(8_kdtrees)_1&#8217;,</dd>
</dl>
<p>]</p>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">Knorm</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">use_k_padding</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="s">&#39;default&#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_cfg_lbl</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="n">p</span><span class="p">],</span> <span class="n">qaid_override</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">daid_override</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;nearest_neighbors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Kpad_list</span><span class="p">,</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_take</span><span class="p">(</span><span class="n">locals_</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;Kpad_list&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">nearest_neighbor_cacheid2</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">Kpad_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">nn_cachedir</span><span class="p">,</span> <span class="n">nn_mid_cacheid_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s">&#39;nn_mid_cacheid_list = &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">nn_mid_cacheid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">nn_mid_cacheid_list = [</span>
<span class="go">    &#39;8687dcb6-1f1f-fdd3-8b72-8f36f9f41905_DVUUIDS((5)oavtblnlrtocnrpm)_NN(single,cks800)_FEAT(hesaff+sift_)_CHIP(sz450)_FLANN(8_kdtrees)_truek6&#39;,</span>
<span class="go">    &#39;a2aef668-20c1-1897-d8f3-09a47a73f26a_DVUUIDS((5)oavtblnlrtocnrpm)_NN(single,cks800)_FEAT(hesaff+sift_)_CHIP(sz450)_FLANN(8_kdtrees)_truek6&#39;,</span>
<span class="go">]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>nn_mid_cacheid_list = [</dt>
<dd>&#8216;8687dcb6-1f1f-fdd3-8b72-8f36f9f41905_DVUUIDS((5)oavtblnlrtocnrpm)_NN(single,K4+1,padk=False,last,cks800)_FEAT(<a href="#id21"><span class="problematic" id="id22">hesaff+sift_</span></a>)_CHIP(sz450)_FLANN(8_kdtrees)_1&#8217;,
&#8216;a2aef668-20c1-1897-d8f3-09a47a73f26a_DVUUIDS((5)oavtblnlrtocnrpm)_NN(single,K4+1,padk=False,last,cks800)_FEAT(<a href="#id23"><span class="problematic" id="id24">hesaff+sift_</span></a>)_CHIP(sz450)_FLANN(8_kdtrees)_1&#8217;,</dd>
</dl>
<p class="last">]</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pipeline.nearest_neighbors">
<code class="descclassname">ibeis.algo.hots.pipeline.</code><code class="descname">nearest_neighbors</code><span class="sig-paren">(</span><em>qreq_</em>, <em>Kpad_list</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pipeline.html#nearest_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pipeline.nearest_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Plain Nearest Neighbors</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pipeline --test-nearest_neighbors
python -m ibeis.algo.hots.pipeline --test-nearest_neighbors --db PZ_MTEST --qaids<span class="o">=</span>1:100
utprof.py -m ibeis.algo.hots.pipeline --test-nearest_neighbors --db PZ_MTEST --qaids<span class="o">=</span>1:100
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">qaid_override</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;nearest_neighbors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Kpad_list</span><span class="p">,</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_take</span><span class="p">(</span><span class="n">locals_</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;Kpad_list&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn_list</span> <span class="o">=</span> <span class="n">nearest_neighbors</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">Kpad_list</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">nn_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_neighbors</span> <span class="o">=</span> <span class="n">Kpad_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">K</span> <span class="o">+</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">Knorm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Assert nns tuple is valid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">qfx2_idx</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">qfx2_idx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num_neighbors</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">qfx2_idx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pipeline.nearest_neighbors_withcache">
<code class="descclassname">ibeis.algo.hots.pipeline.</code><code class="descname">nearest_neighbors_withcache</code><span class="sig-paren">(</span><em>qreq_</em>, <em>Kpad_list</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pipeline.html#nearest_neighbors_withcache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pipeline.nearest_neighbors_withcache" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to load nearest neighbors from a cache instead of recomputing them.</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pipeline.request_ibeis_query_L0">
<code class="descclassname">ibeis.algo.hots.pipeline.</code><code class="descname">request_ibeis_query_L0</code><span class="sig-paren">(</span><em>ibs</em>, <em>qreq_</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pipeline.html#request_ibeis_query_L0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pipeline.request_ibeis_query_L0" title="Permalink to this definition">¶</a></dt>
<dd><p>Driver logic of query pipeline</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Make sure _pipeline_helpres.testrun_pipeline_upto reflects what happens
in this function.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs</strong> (<em>ibeis.IBEISController</em>) &#8211; IBEIS database object to be queried.
technically this object already lives inside of <a href="#id25"><span class="problematic" id="id26">qreq_</span></a>.</li>
<li><strong>qreq</strong> (<em>ibeis.QueryRequest</em>) &#8211; hyper-parameters. use
<code class="docutils literal"><span class="pre">ibs.new_query_request</span></code> to create one</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">cm_list containing <code class="docutils literal"><span class="pre">ibeis.ChipMatch</span></code> objects</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pipeline --test-request_ibeis_query_L0:0 --show
python -m ibeis.algo.hots.pipeline --test-request_ibeis_query_L0:1 --show

python -m ibeis.algo.hots.pipeline --test-request_ibeis_query_L0:0 --db testdb1 --qaid 325
python -m ibeis.algo.hots.pipeline --test-request_ibeis_query_L0:0 --db testdb3 --qaid 325
<span class="c"># background match</span>
python -m ibeis.algo.hots.pipeline --test-request_ibeis_query_L0:0 --db NNP_Master3 --qaid 12838

python -m ibeis.algo.hots.pipeline --test-request_ibeis_query_L0:0
python -m ibeis.algo.hots.pipeline --test-request_ibeis_query_L0:0 --db PZ_MTEST -a timectrl:qindex<span class="o">=</span>0:256
python    -m ibeis.algo.hots.pipeline --test-request_ibeis_query_L0:0 --db PZ_Master1 -a timectrl:qindex<span class="o">=</span>0:256
utprof.py -m ibeis.algo.hots.pipeline --test-request_ibeis_query_L0:0 --db PZ_Master1 -a timectrl:qindex<span class="o">=</span>0:256
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># one-vs-many:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">main_helpers</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:qindex=0:2,dindex=0:10&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list</span> <span class="o">=</span> <span class="n">request_ibeis_query_L0</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">ishow_analysis</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">make_figtitle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># one-vs-one:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">,</span> <span class="n">sv_on</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="s">&#39;default&#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_cfg_lbl</span><span class="p">(</span><span class="n">cfgdict1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_1</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="n">p</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs1</span> <span class="o">=</span> <span class="n">qreq_1</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qreq_1</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list1</span> <span class="o">=</span> <span class="n">request_ibeis_query_L0</span><span class="p">(</span><span class="n">ibs1</span><span class="p">,</span> <span class="n">qreq_1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm1</span> <span class="o">=</span> <span class="n">cm_list1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm1</span><span class="o">.</span><span class="n">ishow_analysis</span><span class="p">(</span><span class="n">qreq_1</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">make_figtitle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pipeline.spatial_verification">
<code class="descclassname">ibeis.algo.hots.pipeline.</code><code class="descname">spatial_verification</code><span class="sig-paren">(</span><em>qreq_</em>, <em>cm_list_FILT</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pipeline.html#spatial_verification"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pipeline.spatial_verification" title="Permalink to this definition">¶</a></dt>
<dd><p>pipeline step 5 - spatially verify feature matches</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">cm_listSVER - new list of spatially verified chipmatches</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pipeline --test-spatial_verification --show
python -m ibeis.algo.hots.pipeline --test-spatial_verification --show --qaid 1
python -m ibeis.algo.hots.pipeline --test-spatial_verification:0
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_sver</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scoring</span><span class="o">.</span><span class="n">score_chipmatch_list</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span><span class="p">,</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">prescore_method</span><span class="p">)</span>  <span class="c"># HACK</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top_nids</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_top_nids</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list_SVER</span> <span class="o">=</span> <span class="n">spatial_verification</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Test Results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmSV</span> <span class="o">=</span> <span class="n">cm_list_SVER</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scoring</span><span class="o">.</span><span class="n">score_chipmatch_list</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list_SVER</span><span class="p">,</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">score_method</span><span class="p">)</span>  <span class="c"># HACK</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top_nids_SV</span> <span class="o">=</span> <span class="n">cmSV</span><span class="o">.</span><span class="n">get_top_nids</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">print_csv</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmSV</span><span class="o">.</span><span class="n">print_csv</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt_daids</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">get_groundtruth_daids</span><span class="p">(),</span> <span class="n">cmSV</span><span class="o">.</span><span class="n">get_groundtruth_daids</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm_list</span>   <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_annot_fm</span><span class="p">(</span><span class="n">gt_daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fmSV_list</span> <span class="o">=</span> <span class="n">cmSV</span><span class="o">.</span><span class="n">get_annot_fm</span><span class="p">(</span><span class="n">gt_daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maplen</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">list_</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">list_</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">gt_daids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;ground truth did not survive&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_lessthan</span><span class="p">(</span><span class="n">maplen</span><span class="p">(</span><span class="n">fmSV_list</span><span class="p">),</span> <span class="n">maplen</span><span class="p">(</span><span class="n">fm_list</span><span class="p">)),</span> <span class="s">&#39;feature matches were not filtered&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmSV</span><span class="o">.</span><span class="n">show_daids_matches</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">gt_daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#homog_tup = (refined_inliers, H)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#aff_tup = (aff_inliers, Aff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#pt.draw_sv.show_sv(rchip1, rchip2, kpts1, kpts2, fm, aff_tup=aff_tup, homog_tup=homog_tup, refine_method=refine_method)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pipeline.sver_single_chipmatch">
<code class="descclassname">ibeis.algo.hots.pipeline.</code><code class="descname">sver_single_chipmatch</code><span class="sig-paren">(</span><em>qreq_</em>, <em>cm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pipeline.html#sver_single_chipmatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pipeline.sver_single_chipmatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatially verifies a shortlist of a single chipmatch</p>
<p>TODO: move to chip match?</p>
<p>loops over a shortlist of results for a specific query annotation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</li>
<li><strong>cm</strong> (<a class="reference internal" href="#ibeis.algo.hots.chip_match.ChipMatch" title="ibeis.algo.hots.chip_match.ChipMatch"><em>ChipMatch</em></a>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">cmSV</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ibeis.ChipMatch</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis --tf draw_rank_cdf --db PZ_Master1 --show <span class="se">\</span>
    -t best:refine_method<span class="o">=[</span>homog,affine,cv2-homog,cv2-ransac-homog,cv2-lmeds-homog<span class="o">]</span> <span class="se">\</span>
    -a timectrlhard ---acfginfo --veryverbtd

python -m ibeis --tf draw_rank_cdf --db PZ_Master1 --show <span class="se">\</span>
    -t best:refine_method<span class="o">=[</span>homog,cv2-lmeds-homog<span class="o">]</span>,full_homog_checks<span class="o">=[</span>True,False<span class="o">]</span> <span class="se">\</span>
    -a timectrlhard ---acfginfo --veryverbtd

python -m ibeis --tf sver_single_chipmatch --show <span class="se">\</span>
    -t default:full_homog_checks<span class="o">=</span>True -a default --qaid 18

python -m ibeis --tf sver_single_chipmatch --show <span class="se">\</span>
    -t default:refine_method<span class="o">=</span>affine -a default --qaid 18

python -m ibeis --tf sver_single_chipmatch --show <span class="se">\</span>
    -t default:refine_method<span class="o">=</span>cv2-homog -a default --qaid 18

python -m ibeis --tf sver_single_chipmatch --show <span class="se">\</span>
    -t default:refine_method<span class="o">=</span>cv2-homog,full_homog_checks<span class="o">=</span>True -a default --qaid 18

python -m ibeis --tf sver_single_chipmatch --show <span class="se">\</span>
    -t default:refine_method<span class="o">=</span>cv2-homog,full_homog_checks<span class="o">=</span>False -a default --qaid 18

python -m ibeis --tf sver_single_chipmatch --show <span class="se">\</span>
    -t default:refine_method<span class="o">=</span>cv2-lmeds-homog,full_homog_checks<span class="o">=</span>False -a default --qaid 18

python -m ibeis --tf sver_single_chipmatch --show <span class="se">\</span>
    -t default:refine_method<span class="o">=</span>cv2-ransac-homog,full_homog_checks<span class="o">=</span>False -a default --qaid 18

python -m ibeis --tf sver_single_chipmatch --show <span class="se">\</span>
    -t default:full_homog_checks<span class="o">=</span>False -a default --qaid 18

python -m ibeis --tf sver_single_chipmatch --show --qaid<span class="o">=</span><span class="m">18</span> --y<span class="o">=</span>0
python -m ibeis --tf sver_single_chipmatch --show --qaid<span class="o">=</span><span class="m">18</span> --y<span class="o">=</span>1
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Visualization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre</span><span class="p">(</span><span class="s">&#39;spatial_verification&#39;</span><span class="p">,</span> <span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>  <span class="c">#, qaid_list=[18])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">cm_list_FILT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scoring</span><span class="o">.</span><span class="n">score_chipmatch_list</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span><span class="p">,</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">prescore_method</span><span class="p">)</span>  <span class="c"># HACK</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#locals_ = ut.exec_func_src(sver_single_chipmatch, key_list=[&#39;svtup_list&#39;], sentinal=&#39;# &lt;SENTINAL&gt;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#svtup_list1, = locals_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_func_sourcecode</span><span class="p">(</span><span class="n">sver_single_chipmatch</span><span class="p">,</span> <span class="n">stripdef</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">strip_docstr</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">replace_between_tags</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;# &lt;SENTINAL&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;# &lt;/SENTINAL&gt;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">globals_</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">exec</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">globals_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svtup_list</span> <span class="o">=</span> <span class="n">globals_</span><span class="p">[</span><span class="s">&#39;svtup_list&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt_daids</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_groundtruth_daids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--y&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#print(&#39;x = %r&#39; % (x,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#daid = daids[x % len(daids)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">notnone_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">not_list</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">flag_None_items</span><span class="p">(</span><span class="n">svtup_list</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">valid_idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">notnone_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">valid_daids</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">daid_list</span><span class="p">[</span><span class="n">valid_idxs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_daids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;cannot spatially verify&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">valid_gt_daids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">gt_daids</span><span class="p">,</span> <span class="n">valid_daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#assert len(valid_gt_daids) == 0, &#39;no sver groundtruth&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid</span> <span class="o">=</span> <span class="n">valid_gt_daids</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_gt_daids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">valid_daids</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">daid2_idx</span><span class="p">[</span><span class="n">daid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svtup</span> <span class="o">=</span> <span class="n">svtup_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">svtup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;SV TUP IS NONE&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">refined_errors</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">svtup</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_inliers</span><span class="p">,</span> <span class="n">aff_errors</span><span class="p">,</span> <span class="n">Aff</span> <span class="o">=</span> <span class="n">svtup</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homog_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">refined_inliers</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aff_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">aff_inliers</span><span class="p">,</span> <span class="n">Aff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">fm_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid1</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">qaid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid2</span> <span class="o">=</span> <span class="n">daid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip1</span><span class="p">,</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_chips</span><span class="p">([</span><span class="n">aid1</span><span class="p">],</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_query_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span><span class="p">,</span>  <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_kpts</span><span class="p">([</span><span class="n">aid1</span><span class="p">],</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_query_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip2</span><span class="p">,</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_chips</span><span class="p">([</span><span class="n">aid2</span><span class="p">],</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_data_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts2</span><span class="p">,</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_kpts</span><span class="p">([</span><span class="n">aid2</span><span class="p">],</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_data_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_aff</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--noaff&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">draw_sv</span><span class="o">.</span><span class="n">show_sv</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">aff_tup</span><span class="o">=</span><span class="n">aff_tup</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">homog_tup</span><span class="o">=</span><span class="n">homog_tup</span><span class="p">,</span> <span class="n">show_aff</span><span class="o">=</span><span class="n">show_aff</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">refine_method</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">refine_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pipeline.vsone_reranking">
<code class="descclassname">ibeis.algo.hots.pipeline.</code><code class="descname">vsone_reranking</code><span class="sig-paren">(</span><em>qreq_</em>, <em>cm_list_SVER</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pipeline.html#vsone_reranking"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pipeline.vsone_reranking" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pipeline --test-vsone_reranking
python -m ibeis.algo.hots.pipeline --test-vsone_reranking --show
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST (IMPORTANT)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">prescore_method</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">,</span> <span class="n">score_method</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">,</span> <span class="n">vsone_reranking</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="s">&#39;default&#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_cfg_lbl</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="n">p</span><span class="p">],</span> <span class="n">qaid_override</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;vsone_reranking&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;cm_list_SVER&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list_VSONE</span> <span class="o">=</span> <span class="n">vsone_reranking</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots</span> <span class="kn">import</span> <span class="n">vsone_pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># NOTE: the aid2_score field must have been hacked</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vsone_pipeline</span><span class="o">.</span><span class="n">show_top_chipmatches</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">cm_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="s">&#39;prescore&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vsone_pipeline</span><span class="o">.</span><span class="n">show_top_chipmatches</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">cm_list_VSONE</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;vsone-reranked&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.pipeline.weight_neighbors">
<code class="descclassname">ibeis.algo.hots.pipeline.</code><code class="descname">weight_neighbors</code><span class="sig-paren">(</span><em>qreq_</em>, <em>nns_list</em>, <em>nnvalid0_list</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/pipeline.html#weight_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.pipeline.weight_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>pipeline step 3 -
assigns weights to feature matches based on the active filter list</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.pipeline --test-weight_neighbors
python -m ibeis.algo.hots.pipeline --test-weight_neighbors:0 --verbose --verbtd --ainfo --nocache --veryverbose
python -m ibeis.algo.hots.pipeline --test-weight_neighbors:0 --show
python -m ibeis.algo.hots.pipeline --test-weight_neighbors:1 --show

python -m ibeis.algo.hots.pipeline --test-weight_neighbors:0 --show -t default:lnbnn_normer<span class="o">=</span>lnbnn_fg_0.9__featscore,lnbnn_norm_thresh<span class="o">=</span>.9
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre</span><span class="p">(</span><span class="s">&#39;weight_neighbors&#39;</span><span class="p">,</span> <span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                               <span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:qindex=0:3,dindex=0:5,hackerrors=False&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                               <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:codename=vsmany,bar_l2_on=True,fg_on=False&#39;</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weight_ret</span> <span class="o">=</span> <span class="n">weight_neighbors</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtkey_list</span><span class="p">,</span> <span class="n">filtweights_list</span><span class="p">,</span> <span class="n">filtvalids_list</span><span class="p">,</span> <span class="n">filtnormks_list</span> <span class="o">=</span> <span class="n">weight_ret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list</span> <span class="o">=</span> <span class="n">build_chipmatches</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span><span class="p">,</span> <span class="n">filtkey_list</span><span class="p">,</span> <span class="n">filtweights_list</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">filtvalids_list</span><span class="p">,</span> <span class="n">filtnormks_list</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">score_nsum</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">ishow_analysis</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre</span><span class="p">(</span><span class="s">&#39;weight_neighbors&#39;</span><span class="p">,</span> <span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                               <span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:qindex=0:3,dindex=0:5,hackerrors=False&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                               <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:codename=vsmany,bar_l2_on=True,fg_on=False&#39;</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weight_ret</span> <span class="o">=</span> <span class="n">weight_neighbors</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtkey_list</span><span class="p">,</span> <span class="n">filtweights_list</span><span class="p">,</span> <span class="n">filtvalids_list</span><span class="p">,</span> <span class="n">filtnormks_list</span> <span class="o">=</span> <span class="n">weight_ret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nInternAids</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nFiltKeys</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtkey_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtweight_depth</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">depth_profile</span><span class="p">(</span><span class="n">filtweights_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtvalid_depth</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">depth_profile</span><span class="p">(</span><span class="n">filtvalids_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">nInternAids</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtweights_list</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">nInternAids</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtvalids_list</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_list_column</span><span class="p">(</span><span class="n">filtweight_depth</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">[</span><span class="n">nFiltKeys</span><span class="p">]</span> <span class="o">*</span> <span class="n">nInternAids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">filtvalid_depth</span><span class="p">,</span> <span class="p">(</span><span class="n">nInternAids</span><span class="p">,</span> <span class="n">nFiltKeys</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">filtvalids_list</span><span class="p">,</span> <span class="p">[[</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">filtkey_list</span><span class="p">,</span> <span class="p">[</span><span class="n">hstypes</span><span class="o">.</span><span class="n">FiltKeys</span><span class="o">.</span><span class="n">LNBNN</span><span class="p">,</span> <span class="n">hstypes</span><span class="o">.</span><span class="n">FiltKeys</span><span class="o">.</span><span class="n">BARL2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list</span> <span class="o">=</span> <span class="n">build_chipmatches</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span><span class="p">,</span> <span class="n">filtkey_list</span><span class="p">,</span> <span class="n">filtweights_list</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">filtvalids_list</span><span class="p">,</span> <span class="n">filtnormks_list</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">score_nsum</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">ishow_analysis</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre</span><span class="p">(</span><span class="s">&#39;weight_neighbors&#39;</span><span class="p">,</span> <span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                               <span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:qindex=0:1,dindex=0:5,hackerrors=False&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                               <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:codename=vsone,fg_on=False,ratio_thresh=.625&#39;</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weight_ret</span> <span class="o">=</span> <span class="n">weight_neighbors</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtkey_list</span><span class="p">,</span> <span class="n">filtweights_list</span><span class="p">,</span> <span class="n">filtvalids_list</span><span class="p">,</span> <span class="n">filtnormks_list</span> <span class="o">=</span> <span class="n">weight_ret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nFiltKeys</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtkey_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nInternAids</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtweight_depth</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">depth_profile</span><span class="p">(</span><span class="n">filtweights_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtvalid_depth</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">depth_profile</span><span class="p">(</span><span class="n">filtvalids_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">nInternAids</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtweights_list</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">nInternAids</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtvalids_list</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="n">nFiltKeys</span><span class="p">]</span> <span class="o">*</span> <span class="n">nInternAids</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_list_column</span><span class="p">(</span><span class="n">filtweight_depth</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">target</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_eq</span><span class="p">(</span><span class="n">filtkey_list</span><span class="p">,</span> <span class="p">[</span><span class="n">hstypes</span><span class="o">.</span><span class="n">FiltKeys</span><span class="o">.</span><span class="n">RATIO</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">filtvalids_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list</span> <span class="o">=</span> <span class="n">build_chipmatches</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">qreq_</span><span class="p">,</span> <span class="n">nns_list</span><span class="p">,</span> <span class="n">nnvalid0_list</span><span class="p">,</span> <span class="n">filtkey_list</span><span class="p">,</span> <span class="n">filtweights_list</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">filtvalids_list</span><span class="p">,</span> <span class="n">filtnormks_list</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">score_nsum</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">ishow_analysis</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.precision_recall">
<span id="ibeis-algo-hots-precision-recall-module"></span><h2>ibeis.algo.hots.precision_recall module<a class="headerlink" href="#module-ibeis.algo.hots.precision_recall" title="Permalink to this headline">¶</a></h2>
<p>TODO: DEPRICATE WITH QRES</p>
<p>IBEIS AGNOSTIC DEFINITIONS ARE NOW IN VTOOL</p>
<dl class="function">
<dt id="ibeis.algo.hots.precision_recall.draw_precision_recall_curve_">
<code class="descclassname">ibeis.algo.hots.precision_recall.</code><code class="descname">draw_precision_recall_curve_</code><span class="sig-paren">(</span><em>recall_range_</em>, <em>p_interp_curve</em>, <em>title_pref=None</em>, <em>fnum=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/precision_recall.html#draw_precision_recall_curve_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.precision_recall.draw_precision_recall_curve_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.precision_recall.get_average_percision_">
<code class="descclassname">ibeis.algo.hots.precision_recall.</code><code class="descname">get_average_percision_</code><span class="sig-paren">(</span><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/precision_recall.html#get_average_percision_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.precision_recall.get_average_percision_" title="Permalink to this definition">¶</a></dt>
<dd><p>gets average percision using the PASCAL definition</p>
<p>FIXME: Use only the groundtruth that could have been matched in the
database. (shouldn&#8217;t be an issue until we start using daid subsets)</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval">http://en.wikipedia.org/wiki/Information_retrieval</a></p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.precision_recall.get_interpolated_precision_vs_recall_">
<code class="descclassname">ibeis.algo.hots.precision_recall.</code><code class="descname">get_interpolated_precision_vs_recall_</code><span class="sig-paren">(</span><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/precision_recall.html#get_interpolated_precision_vs_recall_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.precision_recall.get_interpolated_precision_vs_recall_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.precision_recall.get_nFalseNegative">
<code class="descclassname">ibeis.algo.hots.precision_recall.</code><code class="descname">get_nFalseNegative</code><span class="sig-paren">(</span><em>TP</em>, <em>atrank</em>, <em>nGroundTruth</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/precision_recall.html#get_nFalseNegative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.precision_recall.get_nFalseNegative" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of documents we should have retrieved but didn&#8217;t</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.precision_recall.get_nFalsePositive">
<code class="descclassname">ibeis.algo.hots.precision_recall.</code><code class="descname">get_nFalsePositive</code><span class="sig-paren">(</span><em>TP</em>, <em>atrank</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/precision_recall.html#get_nFalsePositive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.precision_recall.get_nFalsePositive" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of documents we should not have retrieved</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.precision_recall.get_nTruePositive">
<code class="descclassname">ibeis.algo.hots.precision_recall.</code><code class="descname">get_nTruePositive</code><span class="sig-paren">(</span><em>atrank</em>, <em>was_retrieved</em>, <em>gt_ranks</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/precision_recall.html#get_nTruePositive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.precision_recall.get_nTruePositive" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of documents we got right</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.precision_recall.get_precision">
<code class="descclassname">ibeis.algo.hots.precision_recall.</code><code class="descname">get_precision</code><span class="sig-paren">(</span><em>TP</em>, <em>FP</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/precision_recall.html#get_precision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.precision_recall.get_precision" title="Permalink to this definition">¶</a></dt>
<dd><p>precision positive predictive value</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.precision_recall.get_precision_recall_curve_">
<code class="descclassname">ibeis.algo.hots.precision_recall.</code><code class="descname">get_precision_recall_curve_</code><span class="sig-paren">(</span><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/precision_recall.html#get_precision_recall_curve_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.precision_recall.get_precision_recall_curve_" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.precision_recall --test-get_precision_recall_curve_ --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.hots_query_result</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()[</span><span class="mi">14</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">query_chips</span><span class="p">(</span><span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt_aids</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atrank</span>  <span class="o">=</span> <span class="mi">18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nSamples</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ofrank_curve</span><span class="p">,</span> <span class="n">precision_curve</span><span class="p">,</span> <span class="n">recall_curve</span> <span class="o">=</span> <span class="n">qres</span><span class="o">.</span><span class="n">get_precision_recall_curve</span><span class="p">(</span><span class="n">ibs</span><span class="o">=</span><span class="n">ibs</span><span class="p">,</span> <span class="n">gt_aids</span><span class="o">=</span><span class="n">gt_aids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recall_range_</span><span class="p">,</span> <span class="n">p_interp_curve</span> <span class="o">=</span> <span class="n">interpolate_precision_recall_</span><span class="p">(</span><span class="n">precision_curve</span><span class="p">,</span> <span class="n">recall_curve</span><span class="p">,</span> <span class="n">nSamples</span><span class="o">=</span><span class="n">nSamples</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">((</span><span class="n">recall_range_</span><span class="p">,</span> <span class="n">p_interp_curve</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_precision_recall_curve_</span><span class="p">(</span><span class="n">recall_range_</span><span class="p">,</span> <span class="n">p_interp_curve</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Precision_and_recall">http://en.wikipedia.org/wiki/Precision_and_recall</a></p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.precision_recall.get_recall">
<code class="descclassname">ibeis.algo.hots.precision_recall.</code><code class="descname">get_recall</code><span class="sig-paren">(</span><em>TP</em>, <em>FN</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/precision_recall.html#get_recall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.precision_recall.get_recall" title="Permalink to this definition">¶</a></dt>
<dd><p>recall, true positive rate, sensitivity, hit rate</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.precision_recall.interpolate_precision_recall_">
<code class="descclassname">ibeis.algo.hots.precision_recall.</code><code class="descname">interpolate_precision_recall_</code><span class="sig-paren">(</span><em>precision_curve</em>, <em>recall_curve</em>, <em>nSamples=11</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/precision_recall.html#interpolate_precision_recall_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.precision_recall.interpolate_precision_recall_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.precision_recall.show_precision_recall_curve_">
<code class="descclassname">ibeis.algo.hots.precision_recall.</code><code class="descname">show_precision_recall_curve_</code><span class="sig-paren">(</span><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em>, <em>fnum=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/precision_recall.html#show_precision_recall_curve_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.precision_recall.show_precision_recall_curve_" title="Permalink to this definition">¶</a></dt>
<dd><p>CHANGE NAME TO REFERENCE QRES</p>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.qt_inc_automatch">
<span id="ibeis-algo-hots-qt-inc-automatch-module"></span><h2>ibeis.algo.hots.qt_inc_automatch module<a class="headerlink" href="#module-ibeis.algo.hots.qt_inc_automatch" title="Permalink to this headline">¶</a></h2>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>&gt;&gt;&gt; <span class="c"># Profile</span>
utprof.py -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:3 --num-init <span class="m">5000</span> --stateful-query
utprof.py -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:0

python -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:3 --ia 0
python -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:3 --ia <span class="m">0</span> --force-serial
</pre></div>
</div>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>&gt;&gt;&gt; <span class="c"># Autonomous Test</span>
python -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:0
</pre></div>
</div>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>&gt;&gt;&gt; <span class="c"># Interactive Test</span>
python -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:1 --ia <span class="m">0</span> --aid_order<span class="o">=</span>same
python -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:0 --ia 0
</pre></div>
</div>
<dl class="docutils">
<dt>TODO:</dt>
<dd><ul class="first last">
<li><p class="first">spatially constrained matching</p>
</li>
<li><p class="first">benchmarks for reconstruction
vs addition.</p>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt>accuracy</dt>
<dd><p class="first last">compares percent of correct
error = (qfx2_idx_reindex != qfx2_idx_append).sum()</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>time</dt>
<dd><dl class="first docutils">
<dt>compares time of</dt>
<dd><ul class="first last simple">
<li>addition</li>
<li>reindex</li>
<li>multindex search</li>
<li>regular search</li>
</ul>
</dd>
</dl>
<p class="last">error = (qfx2_idx_reindex != qfx2_idx_append).sum()</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</li>
</ul>
</dd>
</dl>
<p>#import numpy as np
#import sys
#from ibeis.algo.hots import automated_oracle as ao
#from ibeis.algo.hots import automated_helpers as ah
#from ibeis.algo.hots import special_query   *</p>
<dl class="class">
<dt id="ibeis.algo.hots.qt_inc_automatch.IncQueryHarness">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.qt_inc_automatch.</code><code class="descname">IncQueryHarness</code><a class="reference internal" href="_modules/ibeis/algo/hots/qt_inc_automatch.html#IncQueryHarness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.qt_inc_automatch.IncQueryHarness" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">PyQt4.QtCore.QObject</span></code></p>
<p>Provides incremental and interactive query with a way to work around hitting
the recusion limit.</p>
<p>TODO: maybe abstract this into a interuptable loop harness</p>
<dl class="method">
<dt id="ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.begin_incremental_query">
<code class="descname">begin_incremental_query</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid_list</em>, <em>back=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/qt_inc_automatch.html#IncQueryHarness.begin_incremental_query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.begin_incremental_query" title="Permalink to this definition">¶</a></dt>
<dd><p>runs incremental query in live mode</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.exemplar_decision_signal">
<code class="descname">exemplar_decision_signal</code><a class="headerlink" href="#ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.exemplar_decision_signal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.exemplar_decision_slot">
<code class="descname">exemplar_decision_slot</code><span class="sig-paren">(</span><em>exemplar_decision</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/qt_inc_automatch.html#IncQueryHarness.exemplar_decision_slot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.exemplar_decision_slot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.name_decision_signal">
<code class="descname">name_decision_signal</code><a class="headerlink" href="#ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.name_decision_signal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.name_decision_slot">
<code class="descname">name_decision_slot</code><span class="sig-paren">(</span><em>chosen_names</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/qt_inc_automatch.html#IncQueryHarness.name_decision_slot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.name_decision_slot" title="Permalink to this definition">¶</a></dt>
<dd><p>the name decision signal was emited</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.next_query_signal">
<code class="descname">next_query_signal</code><a class="headerlink" href="#ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.next_query_signal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.next_query_slot">
<code class="descname">next_query_slot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/qt_inc_automatch.html#IncQueryHarness.next_query_slot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.next_query_slot" title="Permalink to this definition">¶</a></dt>
<dd><p>callback used when all interactions are completed.
Generates the next incremental query and then tries
the automatic interactions</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.setup_back_callbacks">
<code class="descname">setup_back_callbacks</code><span class="sig-paren">(</span><em>back</em>, <em>incinfo</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/qt_inc_automatch.html#IncQueryHarness.setup_back_callbacks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.setup_back_callbacks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.test_incremental_query">
<code class="descname">test_incremental_query</code><span class="sig-paren">(</span><em>ibs_gt</em>, <em>ibs</em>, <em>aid_list1</em>, <em>aid1_to_aid2</em>, <em>num_initial=0</em>, <em>interactive_after=None</em>, <em>back=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/qt_inc_automatch.html#IncQueryHarness.test_incremental_query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.qt_inc_automatch.IncQueryHarness.test_incremental_query" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds and queries new annotations one at a time with oracle guidance</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.qt_inc_automatch.exec_interactive_incremental_queries">
<code class="descclassname">ibeis.algo.hots.qt_inc_automatch.</code><code class="descname">exec_interactive_incremental_queries</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid_list</em>, <em>back=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/qt_inc_automatch.html#exec_interactive_incremental_queries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.qt_inc_automatch.exec_interactive_incremental_queries" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.qt_inc_automatch.incremental_test_qt">
<code class="descclassname">ibeis.algo.hots.qt_inc_automatch.</code><code class="descname">incremental_test_qt</code><span class="sig-paren">(</span><em>ibs</em>, <em>num_initial=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/qt_inc_automatch.html#incremental_test_qt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.qt_inc_automatch.incremental_test_qt" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.qt_inc_automatch --test-incremental_test_qt
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.qt_inc_automatch</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">main_locals</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">main_locals</span><span class="p">[</span><span class="s">&#39;ibs&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">back</span> <span class="o">=</span> <span class="n">main_locals</span><span class="p">[</span><span class="s">&#39;back&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#num_initial = 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_initial</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">incremental_test_qt</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">num_initial</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">present</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">execstr</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">main_loop</span><span class="p">(</span><span class="n">main_locals</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">execstr</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.qt_inc_automatch.test_inc_query">
<code class="descclassname">ibeis.algo.hots.qt_inc_automatch.</code><code class="descname">test_inc_query</code><span class="sig-paren">(</span><em>ibs_gt</em>, <em>num_initial=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/qt_inc_automatch.html#test_inc_query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.qt_inc_automatch.test_inc_query" title="Permalink to this definition">¶</a></dt>
<dd><p>entry point for interactive query tests
test_interactive_incremental_queries</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ibs</strong> (<em>list</em>) &#8211; IBEISController object</li>
<li><strong>qaid_list</strong> (<em>list</em>) &#8211; list of annotation-ids to query</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python dev.py -t inc --db PZ_MTEST --qaid 1:30:3 --cmd
python dev.py --db PZ_MTEST --allgt --cmd
python dev.py --db PZ_MTEST --allgt -t inc
python dev.py --db PZ_MTEST --allgt -t inc
</pre></div>
</div>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:0  --interact-after <span class="m">444440</span> --noqcache
python -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:1  --interact-after <span class="m">444440</span> --noqcache

python -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:0
python -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:1
python -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:2
python -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:3

utprof.py -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:3 --ninit 5000
utprof.py -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:0

<span class="c"># Writes out test script</span>
python -c <span class="s2">&quot;import utool as ut; ut.write_modscript_alias(&#39;Tinc.sh&#39;, &#39;ibeis.algo.hots.qt_inc_automatch&#39;)&quot;</span>

sh Tinc.sh --test-test_inc_query:0
sh Tinc.sh --test-test_inc_query:1
sh Tinc.sh --test-test_inc_query:2
sh Tinc.sh --test-test_inc_query:3

utprof.py -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:3 --num-init 5000

sh Tinc.sh --test-test_inc_query:0 --ninit 10
sh Tinc.sh --test-test_inc_query:0 --ninit <span class="m">10</span> --verbose-debug --verbose-helpful

python -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:0 --ia 10

<span class="c"># Runs into a merge case</span>
python -m ibeis.algo.hots.qt_inc_automatch --test-test_inc_query:0 --ia 30
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs_gt</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_inc_query</span><span class="p">(</span><span class="n">ibs_gt</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs_gt</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_inc_query</span><span class="p">(</span><span class="n">ibs_gt</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs_gt</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;GZ_ALL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_inc_query</span><span class="p">(</span><span class="n">ibs_gt</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example3:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs_gt</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_Master0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_inc_query</span><span class="p">(</span><span class="n">ibs_gt</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.query_params">
<span id="ibeis-algo-hots-query-params-module"></span><h2>ibeis.algo.hots.query_params module<a class="headerlink" href="#module-ibeis.algo.hots.query_params" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibeis.algo.hots.query_params.QueryParams">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.query_params.</code><code class="descname">QueryParams</code><span class="sig-paren">(</span><em>qparams</em>, <em>query_cfg=None</em>, <em>cfgdict=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_params.html#QueryParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_params.QueryParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">_abcoll.Mapping</span></code></p>
<dl class="method">
<dt id="ibeis.algo.hots.query_params.QueryParams.__getstate__">
<code class="descname">__getstate__</code><span class="sig-paren">(</span><em>qparams</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_params.html#QueryParams.__getstate__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_params.QueryParams.__getstate__" title="Permalink to this definition">¶</a></dt>
<dd><p>Make QueryRequest pickleable</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.query_params</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">six.moves</span> <span class="kn">import</span> <span class="n">cPickle</span> <span class="k">as</span> <span class="n">pickle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qparams</span> <span class="o">=</span> <span class="n">testdata_queryparams</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qparams_dump</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">qparams</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qparams2</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">qparams_dump</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_params.QueryParams.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>qparams</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_params.html#QueryParams.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_params.QueryParams.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_params.QueryParams.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>qparams</em>, <em>key</em>, <em>*d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_params.html#QueryParams.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_params.QueryParams.get" title="Permalink to this definition">¶</a></dt>
<dd><p>get a paramater value by string</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_params.QueryParams.get_postsver_filtkey_list">
<code class="descname">get_postsver_filtkey_list</code><span class="sig-paren">(</span><em>qparams</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_params.html#QueryParams.get_postsver_filtkey_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_params.QueryParams.get_postsver_filtkey_list" title="Permalink to this definition">¶</a></dt>
<dd><p>HACK: gets columns of fsv post spatial verification.  This will
eventually be incorporated into cmtup_old instead and will not be
dependant on specifically where you are in the pipeline</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.query_params.testdata_queryparams">
<code class="descclassname">ibeis.algo.hots.query_params.</code><code class="descname">testdata_queryparams</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_params.html#testdata_queryparams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_params.testdata_queryparams" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.query_request">
<span id="ibeis-algo-hots-query-request-module"></span><h2>ibeis.algo.hots.query_request module<a class="headerlink" href="#module-ibeis.algo.hots.query_request" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>TODO:</dt>
<dd>replace with dtool
Rename to IdentifyRequest</dd>
</dl>
<dl class="class">
<dt id="ibeis.algo.hots.query_request.QueryRequest">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.query_request.</code><code class="descname">QueryRequest</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Request object for pipline paramter run</p>
<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.__getstate__">
<code class="descname">__getstate__</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.__getstate__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.__getstate__" title="Permalink to this definition">¶</a></dt>
<dd><p>Make QueryRequest pickleable</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.dev -t candidacy --db testdb1
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">six.moves</span> <span class="kn">import</span> <span class="n">cPickle</span> <span class="k">as</span> <span class="n">pickle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">testdata_qreq</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_dump</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq2_</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">qreq_dump</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.add_internal_daids">
<code class="descname">add_internal_daids</code><span class="sig-paren">(</span><em>qreq_</em>, <em>new_daids</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.add_internal_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.add_internal_daids" title="Permalink to this definition">¶</a></dt>
<dd><p>State Modification: add new daid to query request. Should only be
done between query pipeline runs</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.assert_self">
<code class="descname">assert_self</code><span class="sig-paren">(</span><em>qreq_</em>, <em>ibs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.assert_self"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.assert_self" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.query_request.QueryRequest.daids">
<code class="descname">daids</code><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.daids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.ensure_chips">
<code class="descname">ensure_chips</code><span class="sig-paren">(</span><em>qreq_</em>, <em>verbose=True</em>, <em>extra_tries=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.ensure_chips"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.ensure_chips" title="Permalink to this definition">¶</a></dt>
<dd><p>ensure chips are computed (used in expt, not used in pipeline)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>verbose</strong> (<em>bool</em>) &#8211; verbosity flag(default = True)</li>
<li><strong>extra_tries</strong> (<em>int</em>) &#8211; (default = 0)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.query_request --test-ensure_chips
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extra_tries</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qchip_fpaths</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_chip_fpath</span><span class="p">(</span><span class="n">qaids</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">extern_query_config2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dchip_fpaths</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_chip_fpath</span><span class="p">(</span><span class="n">daids</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">extern_data_config2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">remove_file_list</span><span class="p">(</span><span class="n">qchip_fpaths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">remove_file_list</span><span class="p">(</span><span class="n">dchip_fpaths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ensure_chips</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="n">extra_tries</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.ensure_features">
<code class="descname">ensure_features</code><span class="sig-paren">(</span><em>qreq_</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.ensure_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.ensure_features" title="Permalink to this definition">¶</a></dt>
<dd><p>ensure features are computed
:param verbose: verbosity flag(default = True)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.query_request --test-ensure_features
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="o">.</span><span class="n">delete_annot_feats</span><span class="p">(</span><span class="n">qaids</span><span class="p">,</span>  <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_query_config2</span><span class="p">())</span>  <span class="c"># Remove the chips</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">remove_file_list</span><span class="p">(</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_chip_fpath</span><span class="p">(</span><span class="n">qaids</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_query_config2</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ensure_features</span><span class="p">(</span><span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.ensure_featweights">
<code class="descname">ensure_featweights</code><span class="sig-paren">(</span><em>qreq_</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.ensure_featweights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.ensure_featweights" title="Permalink to this definition">¶</a></dt>
<dd><p>ensure feature weights are computed</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.execute">
<code class="descname">execute</code><span class="sig-paren">(</span><em>qreq_</em>, <em>qaids=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.execute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.execute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.execute_subset">
<code class="descname">execute_subset</code><span class="sig-paren">(</span><em>qreq_</em>, <em>qaids=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.execute_subset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.execute_subset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.query_request.QueryRequest.extern_data_config2">
<code class="descname">extern_data_config2</code><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.extern_data_config2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.query_request.QueryRequest.extern_query_config2">
<code class="descname">extern_query_config2</code><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.extern_query_config2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_cfgstr">
<code class="descname">get_cfgstr</code><span class="sig-paren">(</span><em>qreq_</em>, <em>with_input=False</em>, <em>with_data=True</em>, <em>with_pipe=True</em>, <em>hash_pipe=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd><p>main cfgstring used to identify the &#8216;querytype&#8217;
FIXME: name params + data</p>
<dl class="docutils">
<dt>TODO:</dt>
<dd>rename query_cfgstr to pipe_cfgstr or pipeline_cfgstr EVERYWHERE</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>with_input</strong> (<em>bool</em>) &#8211; (default = False)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">cfgstr</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.query_request --exec-get_cfgstr
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">species</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">TEST_SPECIES</span><span class="o">.</span><span class="n">ZEB_PLAIN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">species</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">species</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">with_input</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgstr</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_cfgstr</span><span class="p">(</span><span class="n">with_input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;cfgstr = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cfgstr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_chipmatch_fpaths">
<code class="descname">get_chipmatch_fpaths</code><span class="sig-paren">(</span><em>qreq_</em>, <em>qaid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_chipmatch_fpaths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_chipmatch_fpaths" title="Permalink to this definition">¶</a></dt>
<dd><p>Efficient function to get a list of chipmatch paths</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_data_hashid">
<code class="descname">get_data_hashid</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_data_hashid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_data_hashid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_external_daids">
<code class="descname">get_external_daids</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_external_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_external_daids" title="Permalink to this definition">¶</a></dt>
<dd><p>These are the users daids in vsone mode</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_external_data_config2">
<code class="descname">get_external_data_config2</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_external_data_config2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_external_data_config2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_external_duuids">
<code class="descname">get_external_duuids</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_external_duuids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_external_duuids" title="Permalink to this definition">¶</a></dt>
<dd><p>These are the users qauuids in vsone mode</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_external_qaids">
<code class="descname">get_external_qaids</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_external_qaids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_external_qaids" title="Permalink to this definition">¶</a></dt>
<dd><p>These are the users qaids in vsone mode</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_external_query_config2">
<code class="descname">get_external_query_config2</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_external_query_config2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_external_query_config2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_external_query_groundtruth">
<code class="descname">get_external_query_groundtruth</code><span class="sig-paren">(</span><em>qreq_</em>, <em>qaids</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_external_query_groundtruth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_external_query_groundtruth" title="Permalink to this definition">¶</a></dt>
<dd><p>gets groundtruth that are accessible via this query</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_external_quuids">
<code class="descname">get_external_quuids</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_external_quuids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_external_quuids" title="Permalink to this definition">¶</a></dt>
<dd><p>These are the users qauuids in vsone mode</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_full_cfgstr">
<code class="descname">get_full_cfgstr</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_full_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_full_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd><p>main cfgstring used to identify the &#8216;querytype&#8217;
FIXME: name
params + data + query</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_infostr">
<code class="descname">get_infostr</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_infostr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_infostr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_internal_daids">
<code class="descname">get_internal_daids</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_internal_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_internal_daids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_internal_data_config2">
<code class="descname">get_internal_data_config2</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_internal_data_config2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_internal_data_config2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_internal_data_hashid">
<code class="descname">get_internal_data_hashid</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_internal_data_hashid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_internal_data_hashid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_internal_duuids">
<code class="descname">get_internal_duuids</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_internal_duuids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_internal_duuids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_internal_qaids">
<code class="descname">get_internal_qaids</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_internal_qaids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_internal_qaids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_internal_query_config2">
<code class="descname">get_internal_query_config2</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_internal_query_config2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_internal_query_config2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_internal_query_hashid">
<code class="descname">get_internal_query_hashid</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_internal_query_hashid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_internal_query_hashid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_internal_quuids">
<code class="descname">get_internal_quuids</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_internal_quuids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_internal_quuids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_pipe_cfgstr">
<code class="descname">get_pipe_cfgstr</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_pipe_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_pipe_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd><p>FIXME: name
params only</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_pipe_hashid">
<code class="descname">get_pipe_hashid</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_pipe_hashid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_pipe_hashid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_qresdir">
<code class="descname">get_qresdir</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_qresdir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_qresdir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_query_hashid">
<code class="descname">get_query_hashid</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_query_hashid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_query_hashid" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.query_request --exec-QueryRequest.get_query_hashid --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query_hashid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_query_hashid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;query_hashid = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">query_hashid</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_result_fnames">
<code class="descname">get_result_fnames</code><span class="sig-paren">(</span><em>qreq_</em>, <em>qaid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_result_fnames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_result_fnames" title="Permalink to this definition">¶</a></dt>
<dd><p>Efficient function to get a list of chipmatch paths</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_shortinfo_cfgstr">
<code class="descname">get_shortinfo_cfgstr</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_shortinfo_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_shortinfo_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_shortinfo_parts">
<code class="descname">get_shortinfo_parts</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_shortinfo_parts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_shortinfo_parts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.get_unique_species">
<code class="descname">get_unique_species</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.get_unique_species"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.get_unique_species" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.lazy_load">
<code class="descname">lazy_load</code><span class="sig-paren">(</span><em>qreq_</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.lazy_load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.lazy_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs preloading of all data needed for a batch of queries</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.lazy_preload">
<code class="descname">lazy_preload</code><span class="sig-paren">(</span><em>qreq_</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.lazy_preload"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.lazy_preload" title="Permalink to this definition">¶</a></dt>
<dd><p>feature weights and normalizers should be loaded before vsone queries
are issued. They do not depened only on qparams</p>
<p>Load non-query specific normalizers / weights</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.load_distinctiveness_normalizer">
<code class="descname">load_distinctiveness_normalizer</code><span class="sig-paren">(</span><em>qreq_</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.load_distinctiveness_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.load_distinctiveness_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots</span> <span class="kn">import</span> <span class="n">distinctiveness_normalizer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.load_indexer">
<code class="descname">load_indexer</code><span class="sig-paren">(</span><em>qreq_</em>, <em>verbose=True</em>, <em>force=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.load_indexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.load_indexer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.load_lnbnn_normalizer">
<code class="descname">load_lnbnn_normalizer</code><span class="sig-paren">(</span><em>qreq_</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.load_lnbnn_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.load_lnbnn_normalizer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.load_score_normalizer">
<code class="descname">load_score_normalizer</code><span class="sig-paren">(</span><em>qreq_</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.load_score_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.load_score_normalizer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.make_empty_chip_matches">
<code class="descname">make_empty_chip_matches</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.make_empty_chip_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.make_empty_chip_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>returns empty query results for each external qaid
:returns: cm_list
:rtype: list</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.query_request --exec-make_empty_chip_matches
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">main_helpers</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">make_empty_chip_matches</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">print_rawinfostr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;cm_list = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm_list</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="ibeis.algo.hots.query_request.QueryRequest.new_query_request">
<em class="property">classmethod </em><code class="descname">new_query_request</code><span class="sig-paren">(</span><em>qaid_list</em>, <em>daid_list</em>, <em>qparams</em>, <em>qresdir</em>, <em>ibs</em>, <em>_indexer_request_params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.new_query_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.new_query_request" title="Permalink to this definition">¶</a></dt>
<dd><p>old way of calling new</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qaid_list</strong> (<em>list</em>) &#8211; </li>
<li><strong>daid_list</strong> (<em>list</em>) &#8211; </li>
<li><strong>qparams</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_params.QueryParams" title="ibeis.algo.hots.query_params.QueryParams"><em>QueryParams</em></a>) &#8211; query hyper-parameters</li>
<li><strong>qresdir</strong> (<em>str</em>) &#8211; </li>
<li><strong>ibs</strong> (<em>ibeis.IBEISController</em>) &#8211; image analysis api</li>
<li><strong>_indexer_request_params</strong> (<em>dict</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">ibeis.QueryRequest</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.query_request.QueryRequest.qaids">
<code class="descname">qaids</code><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.qaids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.remove_internal_daids">
<code class="descname">remove_internal_daids</code><span class="sig-paren">(</span><em>qreq_</em>, <em>remove_daids</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.remove_internal_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.remove_internal_daids" title="Permalink to this definition">¶</a></dt>
<dd><p>State Modification: remove daids from the query request.  Do not call
this function often. It invalidates the indexer, which is very slow to
rebuild.  Should only be done between query pipeline runs.</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.query_request --test-remove_internal_daids
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">species</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">TEST_SPECIES</span><span class="o">.</span><span class="n">ZEB_PLAIN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">species</span><span class="p">,</span> <span class="n">is_exemplar</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">species</span><span class="p">,</span> <span class="n">is_exemplar</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">remove_daids</span> <span class="o">=</span> <span class="n">daids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">internal_daids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;bad setup data&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="o">.</span><span class="n">remove_internal_daids</span><span class="p">(</span><span class="n">remove_daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">internal_daids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;did not remove&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.rrr">
<code class="descname">rrr</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.set_external_daids">
<code class="descname">set_external_daids</code><span class="sig-paren">(</span><em>qreq_</em>, <em>daid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.set_external_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.set_external_daids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.set_external_qaid_mask">
<code class="descname">set_external_qaid_mask</code><span class="sig-paren">(</span><em>qreq_</em>, <em>masked_qaid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.set_external_qaid_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.set_external_qaid_mask" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qaid_list</strong> (<em>list</em>) &#8211; </td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.query_request --test-set_external_qaid_mask
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masked_qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="o">.</span><span class="n">set_external_qaid_mask</span><span class="p">(</span><span class="n">masked_qaid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[1 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.set_external_qaids">
<code class="descname">set_external_qaids</code><span class="sig-paren">(</span><em>qreq_</em>, <em>qaid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.set_external_qaids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.set_external_qaids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.set_internal_daids">
<code class="descname">set_internal_daids</code><span class="sig-paren">(</span><em>qreq_</em>, <em>daid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.set_internal_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.set_internal_daids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.set_internal_masked_daids">
<code class="descname">set_internal_masked_daids</code><span class="sig-paren">(</span><em>qreq_</em>, <em>masked_daid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.set_internal_masked_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.set_internal_masked_daids" title="Permalink to this definition">¶</a></dt>
<dd><p>used by the pipeline to execute a subset of the query request
without modifying important state</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.set_internal_masked_qaids">
<code class="descname">set_internal_masked_qaids</code><span class="sig-paren">(</span><em>qreq_</em>, <em>masked_qaid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.set_internal_masked_qaids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.set_internal_masked_qaids" title="Permalink to this definition">¶</a></dt>
<dd><p>used by the pipeline to execute a subset of the query request
without modifying important state</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">qaid_override</span><span class="o">=</span><span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_override</span><span class="o">=</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s">&#39;default:codename=vsone,sv_on=True&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_lists_eq</span><span class="p">(</span><span class="n">qaid_list</span><span class="p">,</span> <span class="n">qaids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masked_qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="o">.</span><span class="n">set_internal_masked_qaids</span><span class="p">(</span><span class="n">masked_qaid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_internal_aids</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_lists_eq</span><span class="p">(</span><span class="n">new_internal_aids</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.set_internal_qaids">
<code class="descname">set_internal_qaids</code><span class="sig-paren">(</span><em>qreq_</em>, <em>qaid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.set_internal_qaids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.set_internal_qaids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.set_internal_unmasked_qaids">
<code class="descname">set_internal_unmasked_qaids</code><span class="sig-paren">(</span><em>qreq_</em>, <em>unmasked_qaid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.set_internal_unmasked_qaids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.set_internal_unmasked_qaids" title="Permalink to this definition">¶</a></dt>
<dd><p>used by the pipeline to execute a subset of the query request
without modifying important state</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">qaid_override</span><span class="o">=</span><span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_override</span><span class="o">=</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s">&#39;default:codename=vsone,sv_on=True&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_lists_eq</span><span class="p">(</span><span class="n">qaid_list</span><span class="p">,</span> <span class="n">qaids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unmasked_qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="o">.</span><span class="n">set_internal_unmasked_qaids</span><span class="p">(</span><span class="n">unmasked_qaid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_internal_aids</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_lists_eq</span><span class="p">(</span><span class="n">new_internal_aids</span><span class="p">,</span> <span class="n">unmasked_qaid_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.query_request.QueryRequest.shallowcopy">
<code class="descname">shallowcopy</code><span class="sig-paren">(</span><em>qreq_</em>, <em>qaids=None</em>, <em>qx=None</em>, <em>dx=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#QueryRequest.shallowcopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.QueryRequest.shallowcopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a copy of qreq with the same qparams object and a subset of the
qx and dx objects.  used to generate chunks of vsone and vsmany queries</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.query_request --exec-shallowcopy
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">testdata_qreq</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq2_</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">shallowcopy</span><span class="p">(</span><span class="n">qx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_daids</span><span class="p">()</span> <span class="ow">is</span> <span class="n">qreq2_</span><span class="o">.</span><span class="n">get_external_daids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">())</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qreq2_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#assert qreq_.metadata is not qreq2_.metadata</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.query_request.apply_species_with_detector_hack">
<code class="descclassname">ibeis.algo.hots.query_request.</code><code class="descname">apply_species_with_detector_hack</code><span class="sig-paren">(</span><em>ibs</em>, <em>cfgdict</em>, <em>qaids</em>, <em>daids</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#apply_species_with_detector_hack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.apply_species_with_detector_hack" title="Permalink to this definition">¶</a></dt>
<dd><p>HACK turns of featweights if they cannot be applied</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.query_request.new_ibeis_query_request">
<code class="descclassname">ibeis.algo.hots.query_request.</code><code class="descname">new_ibeis_query_request</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid_list</em>, <em>daid_list</em>, <em>cfgdict=None</em>, <em>verbose=True</em>, <em>unique_species=None</em>, <em>use_memcache=True</em>, <em>query_cfg=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#new_ibeis_query_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.new_ibeis_query_request" title="Permalink to this definition">¶</a></dt>
<dd><p>ibeis entry point to create a new query request object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">ibeis.QueryRequest</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.query_request --test-new_ibeis_query_request
python -m ibeis.algo.hots.query_request --test-new_ibeis_query_request:2
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span> <span class="o">=</span> <span class="n">testdata_newqreq</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_species</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">NOT_QUIET</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;sv_on&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;fg_on&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>  <span class="c"># &#39;featweight_detector&#39;: &#39;rf&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Execute test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">new_ibeis_query_request</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Check Results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">sv_on</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">,</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;qreq_.qparams.sv_on = </span><span class="si">%r</span><span class="s"> &#39;</span> <span class="o">%</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">sv_on</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_dbname</span><span class="p">()</span> <span class="o">+</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_data_hashid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">PZ_MTEST_DSUUIDS((5)kmptegpfuwaibfvt)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span> <span class="o">=</span> <span class="n">testdata_newqreq</span><span class="p">(</span><span class="s">&#39;NAUT_test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_species</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">NOT_QUIET</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;sv_on&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">&#39;fg_on&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Execute test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">new_ibeis_query_request</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Check Results.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Featweight should be off because there is no Naut detector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">sv_on</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">,</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;qreq_.qparams.sv_on = </span><span class="si">%r</span><span class="s"> &#39;</span> <span class="o">%</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">sv_on</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_dbname</span><span class="p">()</span> <span class="o">+</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_data_hashid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">NAUT_test_DSUUIDS((5)tklzzeuqjqxfbayo)</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span> <span class="o">=</span> <span class="n">testdata_newqreq</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_species</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">NOT_QUIET</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;sv_on&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;augment_queryside_hack&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Execute test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">new_ibeis_query_request</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Check Results.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Featweight should be off because there is no Naut detector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">sv_on</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">,</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;qreq_.qparams.sv_on = </span><span class="si">%r</span><span class="s"> &#39;</span> <span class="o">%</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">sv_on</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_dbname</span><span class="p">()</span> <span class="o">+</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_data_hashid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">PZ_MTEST_DSUUIDS((5)kmptegpfuwaibfvt)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.query_request.test_cfg_deepcopy">
<code class="descclassname">ibeis.algo.hots.query_request.</code><code class="descname">test_cfg_deepcopy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#test_cfg_deepcopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.test_cfg_deepcopy" title="Permalink to this definition">¶</a></dt>
<dd><p>TESTING FUNCTION</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">test_cfg_deepcopy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.query_request.testdata_newqreq">
<code class="descclassname">ibeis.algo.hots.query_request.</code><code class="descname">testdata_newqreq</code><span class="sig-paren">(</span><em>defaultdb</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#testdata_newqreq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.testdata_newqreq" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(ibeis.IBEISController, list, list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.query_request.testdata_qreq">
<code class="descclassname">ibeis.algo.hots.query_request.</code><code class="descname">testdata_qreq</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/query_request.html#testdata_qreq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.query_request.testdata_qreq" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(ibeis.QueryRequest, ibeis.IBEISController)</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.scorenorm">
<span id="ibeis-algo-hots-scorenorm-module"></span><h2>ibeis.algo.hots.scorenorm module<a class="headerlink" href="#module-ibeis.algo.hots.scorenorm" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>GOALS:</dt>
<dd><ol class="first arabic simple">
<li>vsmany
* works resaonable for very few and very many
* stars with small k and then k becomes a percent or log percent
* distinctiveness from different location</li>
<li>1-vs-1
* uses distinctiveness and foreground when available
* start with ratio test and ransac</li>
<li>First N decision are interactive until we learn a good threshold</li>
</ol>
<p>4) Always show numbers between 0 and 1 spatial verification is based on
single best exemplar</p>
<blockquote>
<div>x - build encoder
x - test encoder
x - monotonicity (both nondecreasing and strictly increasing)
x - cache encoder
x - cache maitainance (deleters and listers)
o - Incemental learning
o - Spceies sensitivity</div></blockquote>
<ul class="last simple">
<li>Add ability for user to relearn encoder from labeled database.</li>
</ul>
</dd>
<dt>TODO:</dt>
<dd><ul class="first last simple">
<li>One class SVM <a class="reference external" href="http://scikit-learn.org/stable/auto_examples/svm/plot_oneclass.html">http://scikit-learn.org/stable/auto_examples/svm/plot_oneclass.html</a></li>
</ul>
</dd>
</dl>
<dl class="class">
<dt id="ibeis.algo.hots.scorenorm.NormFeatScoreConfig">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.scorenorm.</code><code class="descname">NormFeatScoreConfig</code><span class="sig-paren">(</span><em>cfg</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scorenorm.html#NormFeatScoreConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scorenorm.NormFeatScoreConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dtool.base.Config</span></code></p>
</dd></dl>

<dl class="exception">
<dt id="ibeis.algo.hots.scorenorm.UnbalancedExampleException">
<em class="property">exception </em><code class="descclassname">ibeis.algo.hots.scorenorm.</code><code class="descname">UnbalancedExampleException</code><a class="reference internal" href="_modules/ibeis/algo/hots/scorenorm.html#UnbalancedExampleException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scorenorm.UnbalancedExampleException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scorenorm.compare_featscores">
<code class="descclassname">ibeis.algo.hots.scorenorm.</code><code class="descname">compare_featscores</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scorenorm.html#compare_featscores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scorenorm.compare_featscores" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>ibeis --tf compare_featscores  --db PZ_MTEST             --nfscfg :disttype<span class="o">=[</span>L2_sift,lnbnn<span class="o">]</span>,top_percent<span class="o">=[</span>None,.5,.1<span class="o">]</span> -a timectrl             -p default:K<span class="o">=[</span>1,2<span class="o">]</span>,normalizer_rule<span class="o">=</span>name             --save featscore<span class="o">{</span>db<span class="o">}</span>.png --figsize<span class="o">=</span>13,20 --diskshow

ibeis --tf compare_featscores  --db PZ_MTEST             --nfscfg :disttype<span class="o">=[</span>L2_sift,normdist,lnbnn<span class="o">]</span>,top_percent<span class="o">=[</span>None,.5<span class="o">]</span> -a timectrl             -p default:K<span class="o">=[</span>1<span class="o">]</span>,normalizer_rule<span class="o">=</span>name,sv_on<span class="o">=[</span>True,False<span class="o">]</span>             --save featscore<span class="o">{</span>db<span class="o">}</span>.png --figsize<span class="o">=</span>13,10 --diskshow

ibeis --tf compare_featscores --nfscfg :disttype<span class="o">=[</span>L2_sift,normdist,lnbnn<span class="o">]</span>             -a timectrl -p default:K<span class="o">=</span>1,normalizer_rule<span class="o">=</span>name --db PZ_Master1             --save featscore<span class="o">{</span>db<span class="o">}</span>.png  --figsize<span class="o">=</span>13,13 --diskshow

ibeis --tf compare_featscores --nfscfg :disttype<span class="o">=[</span>L2_sift,normdist,lnbnn<span class="o">]</span>             -a timectrl -p default:K<span class="o">=</span>1,normalizer_rule<span class="o">=</span>name --db GZ_ALL             --save featscore<span class="o">{</span>db<span class="o">}</span>.png  --figsize<span class="o">=</span>13,13 --diskshow

ibeis --tf compare_featscores  --db GIRM_Master1             --nfscfg <span class="s1">&#39;:disttype=fg,L2_sift,normdist,lnbnn&#39;</span>             -a timectrl -p default:K<span class="o">=</span>1,normalizer_rule<span class="o">=</span>name             --save featscore<span class="o">{</span>db<span class="o">}</span>.png  --figsize<span class="o">=</span>13,13

ibeis --tf compare_featscores --nfscfg :disttype<span class="o">=[</span>L2_sift,normdist,lnbnn<span class="o">]</span>             -a timectrl -p default:K<span class="o">=[</span>1,2,3<span class="o">]</span>,normalizer_rule<span class="o">=</span>name,sv_on<span class="o">=</span>False             --db PZ_Master1 --save featscore<span class="o">{</span>db<span class="o">}</span>.png                  --dpi<span class="o">=</span><span class="m">128</span> --figsize<span class="o">=</span>15,20 --diskshow

ibeis --tf compare_featscores --show --nfscfg :disttype<span class="o">=[</span>L2_sift,normdist<span class="o">]</span> -a timectrl -p :K<span class="o">=</span><span class="m">1</span> --db PZ_MTEST
ibeis --tf compare_featscores --show --nfscfg :disttype<span class="o">=[</span>L2_sift,normdist<span class="o">]</span> -a timectrl -p :K<span class="o">=</span><span class="m">1</span> --db GZ_ALL
ibeis --tf compare_featscores --show --nfscfg :disttype<span class="o">=[</span>L2_sift,normdist<span class="o">]</span> -a timectrl -p :K<span class="o">=</span><span class="m">1</span> --db PZ_Master1
ibeis --tf compare_featscores --show --nfscfg :disttype<span class="o">=[</span>L2_sift,normdist<span class="o">]</span> -a timectrl -p :K<span class="o">=</span><span class="m">1</span> --db GIRM_Master1

ibeis --tf compare_featscores  --db PZ_MTEST             --nfscfg :disttype<span class="o">=[</span>L2_sift,normdist,lnbnn<span class="o">]</span>,top_percent<span class="o">=[</span>None,.5,.2<span class="o">]</span> -a timectrl             -p default:K<span class="o">=[</span>1<span class="o">]</span>,normalizer_rule<span class="o">=</span>name             --save featscore<span class="o">{</span>db<span class="o">}</span>.png --figsize<span class="o">=</span>13,20 --diskshow

ibeis --tf compare_featscores  --db PZ_MTEST             --nfscfg :disttype<span class="o">=[</span>L2_sift,normdist,lnbnn<span class="o">]</span>,top_percent<span class="o">=[</span>None,.5,.2<span class="o">]</span> -a timectrl             -p default:K<span class="o">=[</span>1<span class="o">]</span>,normalizer_rule<span class="o">=</span>name             --save featscore<span class="o">{</span>db<span class="o">}</span>.png --figsize<span class="o">=</span>13,20 --diskshow
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scorenorm</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">compare_featscores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scorenorm.get_topannot_training_idxs">
<code class="descclassname">ibeis.algo.hots.scorenorm.</code><code class="descname">get_topannot_training_idxs</code><span class="sig-paren">(</span><em>cm</em>, <em>num=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scorenorm.html#get_topannot_training_idxs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scorenorm.get_topannot_training_idxs" title="Permalink to this definition">¶</a></dt>
<dd><p>top annots version</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cm</strong> (<em>ibeis.ChipMatch</em>) &#8211; object of feature correspondences and scores</li>
<li><strong>num</strong> (<em>int</em>) &#8211; number of top annots per TP/TN (default = 2)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.scorenorm --exec-get_topannot_training_idxs --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scorenorm</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cm</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">score_csum</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">tp_idxs</span><span class="p">,</span> <span class="n">tn_idxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_topannot_training_idxs</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;(tp_idxs, tn_idxs) = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">tp_idxs</span><span class="p">,</span> <span class="n">tn_idxs</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(tp_idxs, tn_idxs) = (</span>
<span class="go">    np.array([0, 1], dtype=np.int64),</span>
<span class="go">    np.array([3, 4], dtype=np.int64),</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scorenorm.get_topname_training_idxs">
<code class="descclassname">ibeis.algo.hots.scorenorm.</code><code class="descname">get_topname_training_idxs</code><span class="sig-paren">(</span><em>cm</em>, <em>num=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scorenorm.html#get_topname_training_idxs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scorenorm.get_topname_training_idxs" title="Permalink to this definition">¶</a></dt>
<dd><p>gets the index of the annots in the top groundtrue name and the top
groundfalse names.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cm</strong> (<em>ibeis.ChipMatch</em>) &#8211; object of feature correspondences and scores</li>
<li><strong>num</strong> (<em>int</em>) &#8211; number of false names (default = 5)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>(tp_idxs, tn_idxs)
cm.daid_list[tp_idxs] are all of the</p>
<blockquote>
<div><p>annotations in the correct name.</p>
</div></blockquote>
<dl class="docutils">
<dt>cm.daid_list[tn_idxs] are all of the</dt>
<dd><p class="first last">annotations in the top <cite>num_false</cite> incorrect names.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis --tf get_topname_training_idxs --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scorenorm</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cm</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="s">&#39;default:dindex=0:10,qindex=0:1&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">tp_idxs</span><span class="p">,</span> <span class="n">tn_idxs</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_topname_training_idxs</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;(tp_idxs, tn_idxs) = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">tp_idxs</span><span class="p">,</span> <span class="n">tn_idxs</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(tp_idxs, tn_idxs) = (</span>
<span class="go">    np.array([0, 1, 2], dtype=np.int64),</span>
<span class="go">    [3, 4, 5, 6],</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scorenorm.get_training_annotscores">
<code class="descclassname">ibeis.algo.hots.scorenorm.</code><code class="descname">get_training_annotscores</code><span class="sig-paren">(</span><em>qreq_</em>, <em>cm_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scorenorm.html#get_training_annotscores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scorenorm.get_training_annotscores" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the annotation scores between each query and the correct groundtruth
annotations as well as the top scoring false annotations.</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scorenorm.get_training_desc_dist">
<code class="descclassname">ibeis.algo.hots.scorenorm.</code><code class="descname">get_training_desc_dist</code><span class="sig-paren">(</span><em>cm</em>, <em>qreq_</em>, <em>fsv_col_lbls=[]</em>, <em>namemode=True</em>, <em>top_percent=None</em>, <em>data_annots=None</em>, <em>query_annots=None</em>, <em>num=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scorenorm.html#get_training_desc_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scorenorm.get_training_desc_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>computes custom distances on prematched descriptors</p>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd><p class="first">python -m ibeis &#8211;tf learn_featscore_normalizer &#8211;show &#8211;disttype=ratio</p>
<p>python -m ibeis &#8211;tf learn_featscore_normalizer &#8211;show &#8211;disttype=normdist -a timectrl -t default:K=1 &#8211;db PZ_Master1 &#8211;save pzmaster_normdist.png
python -m ibeis &#8211;tf learn_featscore_normalizer &#8211;show &#8211;disttype=normdist -a timectrl -t default:K=1 &#8211;db PZ_MTEST &#8211;save pzmtest_normdist.png
python -m ibeis &#8211;tf learn_featscore_normalizer &#8211;show &#8211;disttype=normdist -a timectrl -t default:K=1 &#8211;db GZ_ALL</p>
<p>python -m ibeis &#8211;tf learn_featscore_normalizer &#8211;show &#8211;disttype=L2_sift -a timectrl -t default:K=1 &#8211;db PZ_MTEST
python -m ibeis &#8211;tf learn_featscore_normalizer &#8211;show &#8211;disttype=L2_sift -a timectrl -t default:K=1 &#8211;db PZ_Master1</p>
<p class="last">python -m ibeis &#8211;tf compare_featscores &#8211;show &#8211;disttype=L2_sift,normdist -a timectrl -t default:K=1 &#8211;db GZ_ALL</p>
</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.scorenorm --exec-get_training_desc_dist
python -m ibeis.algo.hots.scorenorm --exec-get_training_desc_dist:1
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scorenorm</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cm</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsv_col_lbls</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;ratio&#39;</span><span class="p">,</span> <span class="s">&#39;lnbnn&#39;</span><span class="p">,</span> <span class="s">&#39;L2_sift&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">namemode</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">tp_fsv</span><span class="p">,</span> <span class="n">tn_fsv</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_training_desc_dist</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">fsv_col_lbls</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                          <span class="n">namemode</span><span class="o">=</span><span class="n">namemode</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">tp_fsv</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">tn_fsv</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scorenorm</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cm</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsv_col_lbls</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">fsv_col_lbls</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">namemode</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top_percent</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_annots</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">tp_fsv1</span><span class="p">,</span> <span class="n">tn_fsv1</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_training_fsv</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">namemode</span><span class="o">=</span><span class="n">namemode</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                      <span class="n">top_percent</span><span class="o">=</span><span class="n">top_percent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">tp_fsv</span><span class="p">,</span> <span class="n">tn_fsv</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_training_desc_dist</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">fsv_col_lbls</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                          <span class="n">namemode</span><span class="o">=</span><span class="n">namemode</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                          <span class="n">top_percent</span><span class="o">=</span><span class="n">top_percent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">asserteq</span><span class="p">(</span><span class="n">tp_fsv1</span><span class="p">,</span> <span class="n">tp_fsv</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">asserteq</span><span class="p">(</span><span class="n">tn_fsv1</span><span class="p">,</span> <span class="n">tn_fsv</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scorenorm.get_training_featscores">
<code class="descclassname">ibeis.algo.hots.scorenorm.</code><code class="descname">get_training_featscores</code><span class="sig-paren">(</span><em>qreq_</em>, <em>cm_list</em>, <em>disttype=None</em>, <em>namemode=True</em>, <em>fsvx=slice(None</em>, <em>None</em>, <em>None)</em>, <em>threshx=None</em>, <em>thresh=0.9</em>, <em>num=None</em>, <em>top_percent=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scorenorm.html#get_training_featscores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scorenorm.get_training_featscores" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the flattened set of feature scores between each query and the
correct groundtruth annotations as well as the top scoring false
annotations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qreq</strong> (<em>ibeis.QueryRequest</em>) &#8211; query request object with hyper-parameters</li>
<li><strong>cm_list</strong> (<em>list</em>) &#8211; </li>
<li><strong>disttype</strong> (<em>None</em>) &#8211; (default = None)</li>
<li><strong>namemode</strong> (<em>bool</em>) &#8211; (default = True)</li>
<li><strong>fsvx</strong> (<em>slice</em>) &#8211; (default = slice(None, None, None))</li>
<li><strong>threshx</strong> (<em>None</em>) &#8211; (default = None)</li>
<li><strong>thresh</strong> (<em>float</em>) &#8211; only used if threshx is specified (default = 0.9)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>TestResult.draw_feat_scoresep</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(tp_scores, tn_scores, scorecfg)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.scorenorm --exec-get_training_featscores
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scorenorm</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cmlist</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default:qsize=10&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disttype</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">namemode</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsvx</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">threshx</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thresh</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">tp_scores</span><span class="p">,</span> <span class="n">tn_scores</span><span class="p">,</span> <span class="n">scorecfg</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_training_featscores</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span><span class="p">,</span> <span class="n">disttype</span><span class="p">,</span> <span class="n">namemode</span><span class="p">,</span> <span class="n">fsvx</span><span class="p">,</span> <span class="n">threshx</span><span class="p">,</span> <span class="n">thresh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">scorecfg</span><span class="p">)</span>
<span class="go">lnbnn*fg[fg &gt; 0.5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scorenorm.get_training_fsv">
<code class="descclassname">ibeis.algo.hots.scorenorm.</code><code class="descname">get_training_fsv</code><span class="sig-paren">(</span><em>cm</em>, <em>namemode=True</em>, <em>num=None</em>, <em>top_percent=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scorenorm.html#get_training_fsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scorenorm.get_training_fsv" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.scorenorm --exec-get_training_fsv --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scorenorm</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_cm</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="s">&#39;default:dindex=0:10,qindex=0:1&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">tp_fsv</span><span class="p">,</span> <span class="n">tn_fsv</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_training_fsv</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">namemode</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;(tp_fsv, tn_fsv) = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">((</span><span class="n">tp_fsv</span><span class="p">,</span> <span class="n">tn_fsv</span><span class="p">),</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scorenorm.learn_annotscore_normalizer">
<code class="descclassname">ibeis.algo.hots.scorenorm.</code><code class="descname">learn_annotscore_normalizer</code><span class="sig-paren">(</span><em>qreq_</em>, <em>learnkw={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scorenorm.html#learn_annotscore_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scorenorm.learn_annotscore_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the result of queries and trains a score encoder</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<em>ibeis.QueryRequest</em>) &#8211; query request object with hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">encoder</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">vtool.ScoreNormalizer</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis --tf learn_annotscore_normalizer --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scorenorm</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default&#39;</span><span class="p">],</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">learn_annotscore_normalizer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">figtitle</span><span class="o">=</span><span class="n">encoder</span><span class="o">.</span><span class="n">get_cfgstr</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scorenorm.learn_featscore_normalizer">
<code class="descclassname">ibeis.algo.hots.scorenorm.</code><code class="descname">learn_featscore_normalizer</code><span class="sig-paren">(</span><em>qreq_</em>, <em>datakw={}</em>, <em>learnkw={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scorenorm.html#learn_featscore_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scorenorm.learn_featscore_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the result of queries and trains a score encoder</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<em>ibeis.QueryRequest</em>) &#8211; query request object with hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">encoder</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">vtool.ScoreNormalizer</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis --tf learn_featscore_normalizer --show -t default:
python -m ibeis --tf learn_featscore_normalizer --show --fsvx<span class="o">=</span><span class="m">0</span> --threshx<span class="o">=</span><span class="m">1</span> --show
python -m ibeis --tf learn_featscore_normalizer --show -a default:size<span class="o">=</span><span class="m">40</span> -t default:fg_on<span class="o">=</span>False,lnbnn_on<span class="o">=</span>False,ratio_thresh<span class="o">=</span>1.0,K<span class="o">=</span>1,Knorm<span class="o">=</span>6,sv_on<span class="o">=</span>False,normalizer_rule<span class="o">=</span>name --fsvx<span class="o">=</span><span class="m">0</span> --threshx<span class="o">=</span><span class="m">1</span> --show

python -m ibeis --tf learn_featscore_normalizer --show --disttype<span class="o">=</span>ratio
python -m ibeis --tf learn_featscore_normalizer --show --disttype<span class="o">=</span>lnbnn
python -m ibeis --tf learn_featscore_normalizer --show --disttype<span class="o">=</span>L2_sift -t default:K<span class="o">=</span>1

python -m ibeis --tf learn_featscore_normalizer --show --disttype<span class="o">=</span>L2_sift -a timectrl -t default:K<span class="o">=</span><span class="m">1</span> --db PZ_Master1
python -m ibeis --tf learn_featscore_normalizer --show --disttype<span class="o">=</span>ratio -a timectrl -t default:K<span class="o">=</span><span class="m">1</span> --db PZ_Master1
python -m ibeis --tf learn_featscore_normalizer --show --disttype<span class="o">=</span>lnbnn -a timectrl -t default:K<span class="o">=</span><span class="m">1</span> --db PZ_Master1

<span class="c"># LOOK AT THIS</span>
python -m ibeis --tf learn_featscore_normalizer --show --disttype<span class="o">=</span>normdist -a timectrl -t default:K<span class="o">=</span><span class="m">1</span> --db PZ_Master1
<span class="c">#python -m ibeis --tf learn_featscore_normalizer --show --disttype=parzen -a timectrl -t default:K=1 --db PZ_Master1</span>
<span class="c">#python -m ibeis --tf learn_featscore_normalizer --show --disttype=norm_parzen -a timectrl -t default:K=1 --db PZ_Master1</span>

python -m ibeis --tf learn_featscore_normalizer --show --disttype<span class="o">=</span>lnbnn --db PZ_Master1 -a timectrl -t best
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scorenorm</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">learnkw</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datakw</span> <span class="o">=</span> <span class="n">NormFeatScoreConfig</span><span class="o">.</span><span class="n">from_argv_dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default&#39;</span><span class="p">],</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;default&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">learn_featscore_normalizer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">datakw</span><span class="p">,</span> <span class="n">learnkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">figtitle</span><span class="o">=</span><span class="n">encoder</span><span class="o">.</span><span class="n">get_cfgstr</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scorenorm.load_featscore_normalizer">
<code class="descclassname">ibeis.algo.hots.scorenorm.</code><code class="descname">load_featscore_normalizer</code><span class="sig-paren">(</span><em>normer_cfgstr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scorenorm.html#load_featscore_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scorenorm.load_featscore_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>normer_cfgstr</strong> &#8211; </td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.scorenorm --exec-load_featscore_normalizer --show
python -m ibeis.algo.hots.scorenorm --exec-load_featscore_normalizer --show --cfgstr<span class="o">=</span>featscore
python -m ibeis.algo.hots.scorenorm --exec-load_featscore_normalizer --show --cfgstr<span class="o">=</span>lovb
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scorenorm</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normer_cfgstr</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--cfgstr&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;featscore&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">load_featscore_normalizer</span><span class="p">(</span><span class="n">normer_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">figtitle</span><span class="o">=</span><span class="n">encoder</span><span class="o">.</span><span class="n">get_cfgstr</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scorenorm.train_featscore_normalizer">
<code class="descclassname">ibeis.algo.hots.scorenorm.</code><code class="descname">train_featscore_normalizer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scorenorm.html#train_featscore_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scorenorm.train_featscore_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis --tf train_featscore_normalizer --show

<span class="c"># Write Encoder</span>
python -m ibeis --tf train_featscore_normalizer --db PZ_MTEST -t best -a default --fsvx<span class="o">=</span><span class="m">0</span> --threshx<span class="o">=</span><span class="m">1</span> --show

<span class="c"># Visualize encoder score adjustment</span>
python -m ibeis --tf TestResult.draw_feat_scoresep --db PZ_MTEST -a timectrl -t best:lnbnn_normer<span class="o">=</span>lnbnn_fg_featscore --show --nocache --nocache-hs

<span class="c"># Compare ranking with encoder vs without</span>
python -m ibeis --tf draw_rank_cdf --db PZ_MTEST -a timectrl -t best:lnbnn_normer<span class="o">=[</span>None,wulu<span class="o">]</span> --show
python -m ibeis --tf draw_rank_cdf --db PZ_MTEST -a default  -t best:lnbnn_normer<span class="o">=[</span>None,wulu<span class="o">]</span> --show

<span class="c"># Compare in ipynb</span>
python -m ibeis --tf autogen_ipynb --ipynb --db PZ_MTEST -a default -t best:lnbnn_normer<span class="o">=[</span>None,lnbnn_fg_0.9__featscore<span class="o">]</span>

<span class="c"># Big Test</span>
python -m ibeis --tf draw_rank_cdf --db PZ_Master1 -a timectrl -t best:lnbnn_normer<span class="o">=[</span>None,lovb<span class="o">]</span>,lnbnn_norm_thresh<span class="o">=</span>.5 --show
python -m ibeis --tf draw_rank_cdf --db PZ_Master1 -a timectrl -t best:lnbnn_normer<span class="o">=[</span>None,jypz<span class="o">]</span>,lnbnn_norm_thresh<span class="o">=</span>.1 --show
python -m ibeis --tf draw_rank_cdf --db PZ_Master1 -a timectrl -t best:lnbnn_normer<span class="o">=[</span>None,jypz<span class="o">]</span>,lnbnn_norm_thresh<span class="o">=</span><span class="m">0</span> --show


<span class="c"># Big Train</span>
python -m ibeis --tf learn_featscore_normalizer --db PZ_Master1 -a timectrl -t best:K<span class="o">=</span><span class="m">1</span> --fsvx<span class="o">=</span><span class="m">0</span> --threshx<span class="o">=</span><span class="m">1</span> --show
python -m ibeis --tf train_featscore_normalizer --db PZ_Master1 -a timectrl:has_none<span class="o">=</span>photobomb -t best:K<span class="o">=</span><span class="m">1</span> --fsvx<span class="o">=</span><span class="m">0</span> --threshx<span class="o">=</span><span class="m">1</span> --show --ainfo
python -m ibeis --tf train_featscore_normalizer --db PZ_Master1 -a timectrl:has_none<span class="o">=</span>photobomb -t best:K<span class="o">=</span><span class="m">1</span> --fsvx<span class="o">=</span><span class="m">0</span> --threshx<span class="o">=</span><span class="m">1</span> --show
python -m ibeis --tf train_featscore_normalizer --db PZ_Master1 -a timectrl:has_none<span class="o">=</span>photobomb -t best:K<span class="o">=</span><span class="m">3</span> --fsvx<span class="o">=</span><span class="m">0</span> --threshx<span class="o">=</span><span class="m">1</span> --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scorenorm</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">train_featscore_normalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">figtitle</span><span class="o">=</span><span class="n">encoder</span><span class="o">.</span><span class="n">get_cfgstr</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.scoring">
<span id="ibeis-algo-hots-scoring-module"></span><h2>ibeis.algo.hots.scoring module<a class="headerlink" href="#module-ibeis.algo.hots.scoring" title="Permalink to this headline">¶</a></h2>
<p>TODO:
optional symetric and asymmetric search</p>
<dl class="function">
<dt id="ibeis.algo.hots.scoring.compute_annot_coverage_score">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">compute_annot_coverage_score</code><span class="sig-paren">(</span><em>qreq_</em>, <em>cm</em>, <em>config={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#compute_annot_coverage_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.compute_annot_coverage_score" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.scoring --test-compute_annot_coverage_score:0
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_scoring</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span><span class="p">,</span> <span class="n">score_list</span> <span class="o">=</span> <span class="n">compute_annot_coverage_score</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">score_list</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">eq</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">score_list</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.compute_csum_score">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">compute_csum_score</code><span class="sig-paren">(</span><em>cm</em>, <em>qreq_=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#compute_csum_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.compute_csum_score" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.scoring --test-compute_csum_score
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_sver</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">evaluate_dnids</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">qnid</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c"># Hack for testdb1 names</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt_flags</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_groundtruth_flags</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot_score_list</span> <span class="o">=</span> <span class="n">compute_csum_score</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">annot_score_list</span><span class="p">[</span><span class="n">gt_flags</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">annot_score_list</span><span class="p">[</span><span class="o">~</span><span class="n">gt_flags</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">annot_score_list</span><span class="p">[</span><span class="n">gt_flags</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">10.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.compute_general_matching_coverage_mask">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">compute_general_matching_coverage_mask</code><span class="sig-paren">(</span><em>make_mask_func</em>, <em>chipsize</em>, <em>fm</em>, <em>fs</em>, <em>qkpts</em>, <em>qweights</em>, <em>cov_cfg</em>, <em>out=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#compute_general_matching_coverage_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.compute_general_matching_coverage_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.compute_name_coverage_score">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">compute_name_coverage_score</code><span class="sig-paren">(</span><em>qreq_</em>, <em>cm</em>, <em>config={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#compute_name_coverage_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.compute_name_coverage_score" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.scoring --test-compute_name_coverage_score:0
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (IMPORTANT)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_scoring</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">evaluate_dnids</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dnid_list</span><span class="p">,</span> <span class="n">score_list</span> <span class="o">=</span> <span class="n">compute_name_coverage_score</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">score_list</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">eq</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_str</span><span class="p">(</span><span class="n">score_list</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.evaluate_masks_iter">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">evaluate_masks_iter</code><span class="sig-paren">(</span><em>masks_iter</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#evaluate_masks_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.evaluate_masks_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>save evaluation of a masks iter</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.general_annot_coverage_mask_generator">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">general_annot_coverage_mask_generator</code><span class="sig-paren">(</span><em>make_mask_func</em>, <em>qreq_</em>, <em>cm</em>, <em>config</em>, <em>cov_cfg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#general_annot_coverage_mask_generator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.general_annot_coverage_mask_generator" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Yeilds:</dt>
<dd>daid, weight_mask_m, weight_mask</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.scoring --test-general_annot_coverage_mask_generator --show
python -m ibeis.algo.hots.scoring --test-general_annot_coverage_mask_generator --show --qaid 18
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Evaluate output one at a time or it will get clobbered</p>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (IMPORTANT)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_scoring</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">make_mask_func</span><span class="p">,</span> <span class="n">cov_cfg</span> <span class="o">=</span> <span class="n">get_mask_func</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masks_iter</span> <span class="o">=</span> <span class="n">general_annot_coverage_mask_generator</span><span class="p">(</span><span class="n">make_mask_func</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">cov_cfg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span><span class="p">,</span> <span class="n">score_list</span><span class="p">,</span> <span class="n">masks_list</span> <span class="o">=</span> <span class="n">evaluate_masks_iter</span><span class="p">(</span><span class="n">masks_iter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#assert daid_list[idx] ==</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">score_list</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="p">[</span><span class="n">daid_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid</span><span class="p">,</span> <span class="n">weight_mask_m</span><span class="p">,</span> <span class="n">weight_mask</span> <span class="o">=</span> <span class="n">masks_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_single_coverage_mask</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">weight_mask_m</span><span class="p">,</span> <span class="n">weight_mask</span><span class="p">,</span> <span class="n">daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.general_coverage_mask_generator">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">general_coverage_mask_generator</code><span class="sig-paren">(</span><em>make_mask_func</em>, <em>qreq_</em>, <em>qaid</em>, <em>id_list</em>, <em>fm_list</em>, <em>fs_list</em>, <em>config</em>, <em>cov_cfg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#general_coverage_mask_generator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.general_coverage_mask_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>agnostic to whether or not the id/fm/fs lists are name or annotation groups</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.general_name_coverage_mask_generator">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">general_name_coverage_mask_generator</code><span class="sig-paren">(</span><em>make_mask_func</em>, <em>qreq_</em>, <em>cm</em>, <em>config</em>, <em>cov_cfg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#general_name_coverage_mask_generator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.general_name_coverage_mask_generator" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Yeilds:</dt>
<dd>nid, weight_mask_m, weight_mask</dd>
</dl>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.scoring --test-general_name_coverage_mask_generator --show
python -m ibeis.algo.hots.scoring --test-general_name_coverage_mask_generator --show --qaid 18
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Evaluate output one at a time or it will get clobbered</p>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (IMPORTANT)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_scoring</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">make_mask_func</span><span class="p">,</span> <span class="n">cov_cfg</span> <span class="o">=</span> <span class="n">get_mask_func</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masks_iter</span> <span class="o">=</span> <span class="n">general_name_coverage_mask_generator</span><span class="p">(</span><span class="n">make_mask_func</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">cov_cfg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dnid_list</span><span class="p">,</span> <span class="n">score_list</span><span class="p">,</span> <span class="n">masks_list</span> <span class="o">=</span> <span class="n">evaluate_masks_iter</span><span class="p">(</span><span class="n">masks_iter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">dnid_list</span> <span class="o">==</span> <span class="n">cm</span><span class="o">.</span><span class="n">qnid</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_groundtruth_daids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dnid</span><span class="p">,</span> <span class="n">weight_mask_m</span><span class="p">,</span> <span class="n">weight_mask</span> <span class="o">=</span> <span class="n">masks_list</span><span class="p">[</span><span class="n">nidx</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_single_coverage_mask</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">weight_mask_m</span><span class="p">,</span> <span class="n">weight_mask</span><span class="p">,</span> <span class="n">daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.get_annot_kpts_baseline_weights">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">get_annot_kpts_baseline_weights</code><span class="sig-paren">(</span><em>ibs</em>, <em>aid_list</em>, <em>config2_=None</em>, <em>config={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#get_annot_kpts_baseline_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.get_annot_kpts_baseline_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns weights based on distinctiveness and/or features score / or ones.  Customized based on config.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</li>
<li><strong>aid_list</strong> (<em>int</em>) &#8211; list of annotation ids</li>
<li><strong>config</strong> (<em>dict</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">weights_list</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.scoring --test-get_annot_kpts_baseline_weights
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_scoring</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid_list</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">daid_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config2_</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts_list</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_kpts</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">config2_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights_list</span> <span class="o">=</span> <span class="n">get_annot_kpts_baseline_weights</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">config2_</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">depth1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_list_column</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">depth_profile</span><span class="p">(</span><span class="n">kpts_list</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">depth2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">depth_profile</span><span class="p">(</span><span class="n">weights_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">depth1</span> <span class="o">==</span> <span class="n">depth2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">depth1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">depth2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.get_kpts_distinctiveness">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">get_kpts_distinctiveness</code><span class="sig-paren">(</span><em>ibs</em>, <em>aid_list</em>, <em>config2_=None</em>, <em>config={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#get_kpts_distinctiveness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.get_kpts_distinctiveness" title="Permalink to this definition">¶</a></dt>
<dd><p>per-species disinctivness wrapper around ibeis cached function</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.get_mask_func">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">get_mask_func</code><span class="sig-paren">(</span><em>config</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#get_mask_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.get_mask_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.get_masks">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">get_masks</code><span class="sig-paren">(</span><em>qreq_</em>, <em>cm</em>, <em>config={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#get_masks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.get_masks" title="Permalink to this definition">¶</a></dt>
<dd><p>testing function</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># SHOW THE BASELINE AND MATCHING MASKS</span>
python -m ibeis.algo.hots.scoring --test-get_masks
python -m ibeis.algo.hots.scoring --test-get_masks <span class="se">\</span>
    --maskscore_mode<span class="o">=</span>kpts --show --prior_coeff<span class="o">=</span>.5 --unconstrained_coeff<span class="o">=</span>.3 --constrained_coeff<span class="o">=</span>.2
python -m ibeis.algo.hots.scoring --test-get_masks <span class="se">\</span>
    --maskscore_mode<span class="o">=</span>grid --show --prior_coeff<span class="o">=</span>.5 --unconstrained_coeff<span class="o">=</span><span class="m">0</span> --constrained_coeff<span class="o">=</span>.5
python -m ibeis.algo.hots.scoring --test-get_masks --qaid 4<span class="se">\</span>
    --maskscore_mode<span class="o">=</span>grid --show --prior_coeff<span class="o">=</span>.5 --unconstrained_coeff<span class="o">=</span><span class="m">0</span> --constrained_coeff<span class="o">=</span>.5
python -m ibeis.algo.hots.scoring --test-get_masks --qaid 86<span class="se">\</span>
    --maskscore_mode<span class="o">=</span>grid --show --prior_coeff<span class="o">=</span>.5 --unconstrained_coeff<span class="o">=</span><span class="m">0</span> --constrained_coeff<span class="o">=</span>.5 --grid_scale_factor<span class="o">=</span>.5

python -m ibeis.algo.hots.scoring --test-get_masks --show --db PZ_MTEST --qaid 18
python -m ibeis.algo.hots.scoring --test-get_masks --show --db PZ_MTEST --qaid 1
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (IMPORTANT)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_scoring</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">id_list</span><span class="p">,</span> <span class="n">score_list</span><span class="p">,</span> <span class="n">masks_list</span> <span class="o">=</span> <span class="n">get_masks</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_coverage_mask</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">masks_list</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">score_list</span><span class="o">.</span><span class="n">argmax</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.get_name_shortlist_aids">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">get_name_shortlist_aids</code><span class="sig-paren">(</span><em>daid_list</em>, <em>dnid_list</em>, <em>annot_score_list</em>, <em>name_score_list</em>, <em>nid2_nidx</em>, <em>nNameShortList</em>, <em>nAnnotPerName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#get_name_shortlist_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.get_name_shortlist_aids" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.scoring --test-get_name_shortlist_aids
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dnid_list</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot_score_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">6</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_score_list</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nid2_nidx</span>        <span class="o">=</span> <span class="p">{</span><span class="mi">21</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="mi">22</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="mi">23</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">24</span><span class="p">:</span><span class="mi">3</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nNameShortList</span><span class="p">,</span> <span class="n">nAnnotPerName</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">daid_list</span><span class="p">,</span> <span class="n">dnid_list</span><span class="p">,</span> <span class="n">annot_score_list</span><span class="p">,</span> <span class="n">name_score_list</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">nid2_nidx</span><span class="p">,</span> <span class="n">nNameShortList</span><span class="p">,</span> <span class="n">nAnnotPerName</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top_daids</span> <span class="o">=</span> <span class="n">get_name_shortlist_aids</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">top_daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[15, 14, 11, 13, 16]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.make_chipmatch_shortlists">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">make_chipmatch_shortlists</code><span class="sig-paren">(</span><em>qreq_</em>, <em>cm_list</em>, <em>nNameShortList</em>, <em>nAnnotPerName</em>, <em>score_method=u'nsum'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#make_chipmatch_shortlists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.make_chipmatch_shortlists" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes shortlists for reranking</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.scoring --test-make_chipmatch_shortlists --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_sver</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_method</span>    <span class="o">=</span> <span class="s">&#39;nsum&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nNameShortList</span>  <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nAnnotPerName</span>   <span class="o">=</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># apply scores</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_chipmatch_list</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span><span class="p">,</span> <span class="n">score_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_input</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#assert cm_input.dnid_list.take(cm_input.argsort())[0] == cm_input.qnid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_shortlist</span> <span class="o">=</span> <span class="n">make_chipmatch_shortlists</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span><span class="p">,</span> <span class="n">nNameShortList</span><span class="p">,</span> <span class="n">nAnnotPerName</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_input</span><span class="o">.</span><span class="n">print_rawinfostr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_shortlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">print_rawinfostr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># should be sorted already from the shortlist take</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top_nid_list</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">dnid_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top_aid_list</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">daid_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qnid</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">qnid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;top_aid_list = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">top_aid_list</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;top_nid_list = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">top_nid_list</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;qnid = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">qnid</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rankx</span> <span class="o">=</span> <span class="n">top_nid_list</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">qnid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">rankx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;qnid=</span><span class="si">%r</span><span class="s"> should be first rank, not rankx=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">qnid</span><span class="p">,</span> <span class="n">rankx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_num_rerank</span> <span class="o">=</span> <span class="n">nNameShortList</span> <span class="o">*</span> <span class="n">nAnnotPerName</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_num_rerank</span> <span class="o">=</span> <span class="n">nNameShortList</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">assert_inbounds</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">top_nid_list</span><span class="p">),</span> <span class="n">min_num_rerank</span><span class="p">,</span> <span class="n">max_num_rerank</span><span class="p">,</span> <span class="s">&#39;incorrect number in shortlist&#39;</span><span class="p">,</span> <span class="n">eq</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">show_single_annotmatch</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">daid</span><span class="o">=</span><span class="n">top_aid_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.score_chipmatch_list">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">score_chipmatch_list</code><span class="sig-paren">(</span><em>qreq_</em>, <em>cm_list</em>, <em>score_method</em>, <em>progkw=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#score_chipmatch_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.score_chipmatch_list" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.scoring --test-score_chipmatch_list
python -m ibeis.algo.hots.scoring --test-score_chipmatch_list:1
python -m ibeis.algo.hots.scoring --test-score_chipmatch_list:0 --show
</pre></div>
</div>
<dl class="docutils">
<dt>Example0:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (IMPORTANT)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_sver</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_method</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">prescore_method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_chipmatch_list</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span><span class="p">,</span> <span class="n">score_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">cm</span><span class="o">.</span><span class="n">score_list</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">show_single_annotmatch</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (IMPORTANT)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_post_sver</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_method</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">score_method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_chipmatch_list</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list</span><span class="p">,</span> <span class="n">score_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">cm</span><span class="o">.</span><span class="n">score_list</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">show_single_annotmatch</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.score_masks">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">score_masks</code><span class="sig-paren">(</span><em>masks_iter</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#score_masks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.score_masks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.score_matching_mask">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">score_matching_mask</code><span class="sig-paren">(</span><em>weight_mask_m</em>, <em>weight_mask</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#score_matching_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.score_matching_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.show_annot_weights">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">show_annot_weights</code><span class="sig-paren">(</span><em>qreq_</em>, <em>aid</em>, <em>config={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#show_annot_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.show_annot_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>DEMO FUNC</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.scoring --test-show_annot_weights --show --db GZ_ALL --aid <span class="m">1</span> --maskscore_mode<span class="o">=</span><span class="s1">&#39;grid&#39;</span>
python -m ibeis.algo.hots.scoring --test-show_annot_weights --show --db GZ_ALL --aid <span class="m">1</span> --maskscore_mode<span class="o">=</span><span class="s1">&#39;kpts&#39;</span>
python -m ibeis.algo.hots.scoring --test-show_annot_weights --show --db PZ_Master0 --aid 1
python -m ibeis.algo.hots.scoring --test-show_annot_weights --show --db PZ_MTEST --aid 1
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.scoring</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_annot_weights</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">aid</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.show_coverage_mask">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">show_coverage_mask</code><span class="sig-paren">(</span><em>qreq_</em>, <em>cm</em>, <em>masks_list</em>, <em>index=0</em>, <em>fnum=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#show_coverage_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.show_coverage_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.show_single_coverage_mask">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">show_single_coverage_mask</code><span class="sig-paren">(</span><em>qreq_</em>, <em>cm</em>, <em>weight_mask_m</em>, <em>weight_mask</em>, <em>daids</em>, <em>fnum=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#show_single_coverage_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.show_single_coverage_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.scoring.sift_selectivity_score">
<code class="descclassname">ibeis.algo.hots.scoring.</code><code class="descname">sift_selectivity_score</code><span class="sig-paren">(</span><em>vecs1_m</em>, <em>vecs2_m</em>, <em>cos_power=3.0</em>, <em>dtype=&lt;type 'float'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/scoring.html#sift_selectivity_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.scoring.sift_selectivity_score" title="Permalink to this definition">¶</a></dt>
<dd><p>applies selectivity score from SMK paper
Take componentwise dot produt and divide by 512**2 because of the
sift descriptor uint8 trick</p>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.special_query">
<span id="ibeis-algo-hots-special-query-module"></span><h2>ibeis.algo.hots.special_query module<a class="headerlink" href="#module-ibeis.algo.hots.special_query" title="Permalink to this headline">¶</a></h2>
<p>TODO: DEPRICATE</p>
<p>handles the &#8220;special&#8221; more complex vs-one re-ranked query</p>
<p># Write some alias for ourselves
python -c &#8220;import utool as ut; ut.write_modscript_alias( &#8216;Tinc.sh&#8217;, &#8216;ibeis.algo.hots.qt_inc_automatch&#8217;)&#8221;
python -c &#8220;import utool as ut; ut.write_modscript_alias(&#8216;pTinc.sh&#8217;, &#8216;ibeis.algo.hots.qt_inc_automatch&#8217;, &#8216;utprof.py&#8217;)&#8221;</p>
<p># PROFILE PZ_Master0 With lots of preadded data
sh pTinc.sh &#8211;test-test_inc_query:3 &#8211;num-init 7500 &#8211;test-title &#8220;ProfileIncPZMaster0&#8221;</p>
<p>sh pTinc.sh &#8211;test-test_inc_query:3 &#8211;num-init 8690
sh pTinc.sh &#8211;test-test_inc_query:0
sh pTinc.sh &#8211;test-test_inc_query:3 &#8211;num-init 5000 &#8211;devcache &#8211;vsone-errs</p>
<p>sh Tinc.sh &#8211;test-test_inc_query:2 &#8211;num-init 100 &#8211;devcache &#8211;vsone-errs</p>
<p># Interactive GZ Test
sh Tinc.sh &#8211;test-test_inc_query:2 &#8211;num-init 100 &#8211;devcache &#8211;no-normcache &#8211;vsone-errs &#8211;ia 10  &#8211;test-title &#8220;GZ_Inc_Errors&#8221;</p>
<p># Automatic GZ Test
sh Tinc.sh &#8211;test-test_inc_query:2 &#8211;num-init 100 &#8211;devcache &#8211;no-normcache &#8211;vsone-errs  &#8211;test-title &#8220;GZ_Inc_Errors&#8221;</p>
<p># AUTOMATIC PZ_MTEST
sh Tinc.sh &#8211;test-test_inc_query:1 &#8211;num-init 0 &#8211;devcache &#8211;no-normcache &#8211;vsone-errs  &#8211;test-title &#8220;PZ_Inc_Errors&#8221;
# No testing
sh Tinc.sh &#8211;test-test_inc_query:1 &#8211;num-init 0 &#8211;no-normcache &#8211;test-title &#8220;PZ_Inc_Errors&#8221;</p>
<p># Automatic GZ Test Small
sh Tinc.sh &#8211;test-test_inc_query:2 &#8211;num-init 0 &#8211;devcache &#8211;no-normcache &#8211;vsone-errs &#8211;test-title &#8220;GZ_DEV&#8221; &#8211;gzdev &#8211;ninit 34 &#8211;naac &#8211;interupt-case
sh Tinc.sh &#8211;test-test_inc_query:2 &#8211;num-init 0 &#8211;devcache &#8211;no-normcache &#8211;vsone-errs &#8211;test-title &#8220;GZ_DEV&#8221; &#8211;gzdev &#8211;ninit 47 &#8211;naac &#8211;interupt-case</p>
<dl class="class">
<dt id="ibeis.algo.hots.special_query.TestTup">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.special_query.</code><code class="descname">TestTup</code><span class="sig-paren">(</span><em>qaid_t</em>, <em>qaid</em>, <em>vsmany_rank</em>, <em>vsone_rank</em><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.special_query.TestTup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></p>
<dl class="method">
<dt id="ibeis.algo.hots.special_query.TestTup.__getnewargs__">
<code class="descname">__getnewargs__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.special_query.TestTup.__getnewargs__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return self as a plain tuple.  Used by copy and pickle.</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.special_query.TestTup.__getstate__">
<code class="descname">__getstate__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.special_query.TestTup.__getstate__" title="Permalink to this definition">¶</a></dt>
<dd><p>Exclude the OrderedDict from pickling</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.special_query.TestTup.__repr__">
<code class="descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.special_query.TestTup.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a nicely formatted representation string</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.special_query.TestTup.qaid">
<code class="descname">qaid</code><a class="headerlink" href="#ibeis.algo.hots.special_query.TestTup.qaid" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.special_query.TestTup.qaid_t">
<code class="descname">qaid_t</code><a class="headerlink" href="#ibeis.algo.hots.special_query.TestTup.qaid_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.special_query.TestTup.vsmany_rank">
<code class="descname">vsmany_rank</code><a class="headerlink" href="#ibeis.algo.hots.special_query.TestTup.vsmany_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="ibeis.algo.hots.special_query.TestTup.vsone_rank">
<code class="descname">vsone_rank</code><a class="headerlink" href="#ibeis.algo.hots.special_query.TestTup.vsone_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.special_query.apply_new_qres_filter_scores">
<code class="descclassname">ibeis.algo.hots.special_query.</code><code class="descname">apply_new_qres_filter_scores</code><span class="sig-paren">(</span><em>qreq_vsone_</em>, <em>qres_vsone</em>, <em>newfsv_list</em>, <em>newscore_aids</em>, <em>filtkey</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/special_query.html#apply_new_qres_filter_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.special_query.apply_new_qres_filter_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>applies the new filter scores vectors to a query result and updates other
scores</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qres_vsone</strong> (<em>QueryResult</em>) &#8211; object of feature correspondences and scores</li>
<li><strong>newfsv_list</strong> (<em>list</em>) &#8211; </li>
<li><strong>newscore_aids</strong> &#8211; </li>
<li><strong>filtkey</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.special_query --test-apply_new_qres_filter_scores
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.special_query</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">valid_aids</span> <span class="o">=</span> <span class="n">testdata_special_query</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qaids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtkey</span> <span class="o">=</span> <span class="n">hstypes</span><span class="o">.</span><span class="n">FiltKeys</span><span class="o">.</span><span class="n">DISTINCTIVENESS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres_vsmany</span><span class="p">,</span> <span class="n">qreq_vsmany_</span> <span class="o">=</span> <span class="n">query_vsmany_initial</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vsone_query_pairs</span> <span class="o">=</span> <span class="n">build_vsone_shortlist</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid2_qres_vsmany</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres_vsone</span><span class="p">,</span> <span class="n">qreq_vsone_</span> <span class="o">=</span> <span class="n">query_vsone_pairs</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">vsone_query_pairs</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_vsone_</span><span class="o">.</span><span class="n">load_score_normalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres_vsone</span> <span class="o">=</span> <span class="n">qaid2_qres_vsone</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres_vsmany</span> <span class="o">=</span> <span class="n">qaid2_qres_vsmany</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top_aids</span> <span class="o">=</span> <span class="n">vsone_query_pairs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newfsv_list</span><span class="p">,</span> <span class="n">newscore_aids</span> <span class="o">=</span> <span class="n">get_new_qres_distinctiveness</span><span class="p">(</span><span class="n">qres_vsone</span><span class="p">,</span> <span class="n">qres_vsmany</span><span class="p">,</span> <span class="n">top_aids</span><span class="p">,</span> <span class="n">filtkey</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apply_new_qres_filter_scores</span><span class="p">(</span><span class="n">qreq_vsone_</span><span class="p">,</span> <span class="n">qres_vsone</span><span class="p">,</span> <span class="n">newfsv_list</span><span class="p">,</span> <span class="n">newscore_aids</span><span class="p">,</span> <span class="n">filtkey</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.special_query.augment_vsone_with_vsmany">
<code class="descclassname">ibeis.algo.hots.special_query.</code><code class="descname">augment_vsone_with_vsmany</code><span class="sig-paren">(</span><em>vsone_query_pairs</em>, <em>qaid2_qres_vsone</em>, <em>qaid2_qres_vsmany</em>, <em>qreq_vsone_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/special_query.html#augment_vsone_with_vsmany"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.special_query.augment_vsone_with_vsmany" title="Permalink to this definition">¶</a></dt>
<dd><p>AUGMENT VSONE QUERIES (BIG HACKS AFTER THIS POINT)
Apply vsmany distinctiveness scores to vsone</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>vsone_query_pairs</strong> &#8211; </li>
<li><strong>qaid2_qres_vsone</strong> (<em>dict</em>) &#8211; dict of query result objects</li>
<li><strong>qaid2_qres_vsmany</strong> (<em>dict</em>) &#8211; dict of query result objects</li>
<li><strong>qreq_vsone</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.special_query --test-augment_vsone_with_vsmany
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.special_query</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">valid_aids</span> <span class="o">=</span> <span class="n">testdata_special_query</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qaids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres_vsmany</span><span class="p">,</span> <span class="n">qreq_vsmany_</span> <span class="o">=</span> <span class="n">query_vsmany_initial</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">ibs</span><span class="p">,</span> <span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">,</span> <span class="n">use_cache</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">save_qcache</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">qreq_vsmany_</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vsone_query_pairs</span> <span class="o">=</span> <span class="n">build_vsone_shortlist</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid2_qres_vsmany</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres_vsone</span><span class="p">,</span> <span class="n">qreq_vsone_</span> <span class="o">=</span> <span class="n">query_vsone_pairs</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">vsone_query_pairs</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">qreq_vsone_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">score_normalization</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">qreq_vsone_</span><span class="o">.</span><span class="n">load_score_normalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">augment_vsone_with_vsmany</span><span class="p">(</span><span class="n">vsone_query_pairs</span><span class="p">,</span> <span class="n">qaid2_qres_vsone</span><span class="p">,</span> <span class="n">qaid2_qres_vsmany</span><span class="p">,</span> <span class="n">qreq_vsone_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">qaid2_qres_vsone</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">inbounds</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">aid2_fsv</span><span class="p">[</span><span class="n">daids</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">eq</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">inbounds</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">aid2_score</span><span class="p">[</span><span class="n">daids</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">eq</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.special_query.build_vsone_shortlist">
<code class="descclassname">ibeis.algo.hots.special_query.</code><code class="descname">build_vsone_shortlist</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid2_qres_vsmany</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/special_query.html#build_vsone_shortlist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.special_query.build_vsone_shortlist" title="Permalink to this definition">¶</a></dt>
<dd><p>looks that the top N names in a vsmany query to apply vsone reranking</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; ibeis controller object</li>
<li><strong>qaid2_qres_vsmany</strong> (<em>dict</em>) &#8211; dict of query result objects</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">vsone_query_pairs</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.special_query --test-build_vsone_shortlist
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.special_query</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">valid_aids</span> <span class="o">=</span> <span class="n">testdata_special_query</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres_vsmany</span><span class="p">,</span> <span class="n">qreq_vsmany_</span> <span class="o">=</span> <span class="n">query_vsmany_initial</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vsone_query_pairs</span> <span class="o">=</span> <span class="n">build_vsone_shortlist</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid2_qres_vsmany</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span><span class="p">,</span> <span class="n">top_aid_list</span> <span class="o">=</span> <span class="n">vsone_query_pairs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top_nid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_rowids</span><span class="p">(</span><span class="n">top_aid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">top_nid_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;name 1 should be rank 1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">top_nid_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;should have 3 names and up to 2 image per name&#39;</span>
</pre></div>
</div>
<p>[(1, [3, 2, 6, 5, 4])]
[(1, [2, 3, 6, 5, 4])]</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.special_query.get_extern_distinctiveness">
<code class="descclassname">ibeis.algo.hots.special_query.</code><code class="descname">get_extern_distinctiveness</code><span class="sig-paren">(</span><em>qreq_</em>, <em>cm</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/special_query.html#get_extern_distinctiveness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.special_query.get_extern_distinctiveness" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses distinctivness normalizer class (which uses predownloaded models)
to normalize the distinctivness of a keypoint for query points.</p>
<dl class="docutils">
<dt>IDEA:</dt>
<dd>because we have database points as well we can use the distance between
normalizer of the query point and the normalizer of the database point.
They should have a similar normalizer if they are a correct match AND
nondistinctive.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</li>
<li><strong>cm</strong> (<em>QueryResult</em>) &#8211; object of feature correspondences and scores</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(new_fsv_list, daid_list)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.special_query --test-get_extern_distinctiveness
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.special_query</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="n">ibeis</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">TEST_SPECIES</span><span class="o">.</span><span class="n">ZEB_PLAIN</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">daids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone_unnorm_dist_ratio_extern_distinctiveness&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">(</span><span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#qreq_.lazy_load()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">query_chips</span><span class="p">(</span><span class="n">qreq_</span><span class="o">=</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">use_cache</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">save_qcache</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">return_cm</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">new_fsv_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_extern_distinctiveness</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">fsv</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">filtkey_list</span><span class="p">)</span> <span class="k">for</span> <span class="n">fsv</span> <span class="ow">in</span> <span class="n">new_fsv_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">fsv</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">fsv</span> <span class="ow">in</span> <span class="n">new_fsv_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">fsv</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">fsv</span> <span class="ow">in</span> <span class="n">new_fsv_list</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.special_query.get_new_qres_distinctiveness">
<code class="descclassname">ibeis.algo.hots.special_query.</code><code class="descname">get_new_qres_distinctiveness</code><span class="sig-paren">(</span><em>qres_vsone</em>, <em>qres_vsmany</em>, <em>top_aids</em>, <em>filtkey</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/special_query.html#get_new_qres_distinctiveness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.special_query.get_new_qres_distinctiveness" title="Permalink to this definition">¶</a></dt>
<dd><p>gets the distinctiveness score from vsmany and applies it to vsone</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.special_query --exec-get_new_qres_distinctiveness
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.special_query</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">valid_aids</span> <span class="o">=</span> <span class="n">testdata_special_query</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qaids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtkey</span> <span class="o">=</span> <span class="n">hstypes</span><span class="o">.</span><span class="n">FiltKeys</span><span class="o">.</span><span class="n">DISTINCTIVENESS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres_vsmany</span><span class="p">,</span> <span class="n">qreq_vsmany_</span> <span class="o">=</span> <span class="n">query_vsmany_initial</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vsone_query_pairs</span> <span class="o">=</span> <span class="n">build_vsone_shortlist</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid2_qres_vsmany</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres_vsone</span><span class="p">,</span> <span class="n">qreq_vsone_</span> <span class="o">=</span> <span class="n">query_vsone_pairs</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">vsone_query_pairs</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_vsone_</span><span class="o">.</span><span class="n">load_score_normalizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres_vsone</span> <span class="o">=</span> <span class="n">qaid2_qres_vsone</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres_vsmany</span> <span class="o">=</span> <span class="n">qaid2_qres_vsmany</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top_aids</span> <span class="o">=</span> <span class="n">vsone_query_pairs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newfsv_list</span><span class="p">,</span> <span class="n">newscore_aids</span> <span class="o">=</span> <span class="n">get_new_qres_distinctiveness</span><span class="p">(</span><span class="n">qres_vsone</span><span class="p">,</span> <span class="n">qres_vsmany</span><span class="p">,</span> <span class="n">top_aids</span><span class="p">,</span> <span class="n">filtkey</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.special_query.new_feature_score_dimension">
<code class="descclassname">ibeis.algo.hots.special_query.</code><code class="descname">new_feature_score_dimension</code><span class="sig-paren">(</span><em>cm</em>, <em>daid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/special_query.html#new_feature_score_dimension"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.special_query.new_feature_score_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>returns new fsv vectors but does not apply them</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.special_query.product_scoring">
<code class="descclassname">ibeis.algo.hots.special_query.</code><code class="descname">product_scoring</code><span class="sig-paren">(</span><em>new_fsv_vsone</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/special_query.html#product_scoring"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.special_query.product_scoring" title="Permalink to this definition">¶</a></dt>
<dd><p>product of all weights</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.special_query.query_vsmany_initial">
<code class="descclassname">ibeis.algo.hots.special_query.</code><code class="descname">query_vsmany_initial</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaids</em>, <em>daids</em>, <em>use_cache=False</em>, <em>qreq_vsmany_=None</em>, <em>save_qcache=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/special_query.html#query_vsmany_initial"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.special_query.query_vsmany_initial" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; ibeis controller object</li>
<li><strong>qaids</strong> (<em>list</em>) &#8211; query annotation ids</li>
<li><strong>daids</strong> (<em>list</em>) &#8211; database annotation ids</li>
<li><strong>use_cache</strong> (<em>bool</em>) &#8211; turns on disk based caching</li>
<li><strong>qreq_vsmany</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; persistant vsmany query request</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(newfsv_list, newscore_aids)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.special_query --test-query_vsmany_initial
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.special_query</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">valid_aids</span> <span class="o">=</span> <span class="n">testdata_special_query</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres_vsmany</span><span class="p">,</span> <span class="n">qreq_vsmany_</span> <span class="o">=</span> <span class="n">query_vsmany_initial</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres_vsmany</span> <span class="o">=</span> <span class="n">qaid2_qres_vsmany</span><span class="p">[</span><span class="n">qaids</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">qres_vsmany</span><span class="o">.</span><span class="n">get_top_aids</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[2, 6, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.special_query.query_vsone_pairs">
<code class="descclassname">ibeis.algo.hots.special_query.</code><code class="descname">query_vsone_pairs</code><span class="sig-paren">(</span><em>ibs</em>, <em>vsone_query_pairs</em>, <em>use_cache=False</em>, <em>save_qcache=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/special_query.html#query_vsone_pairs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.special_query.query_vsone_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>does vsone queries to rerank the top few vsmany querys</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">qaid2_qres_vsone, <a href="#id27"><span class="problematic" id="id28">qreq_vsone_</span></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.special_query --test-query_vsone_pairs
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.special_query</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">valid_aids</span> <span class="o">=</span> <span class="n">testdata_special_query</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qaids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtkey</span> <span class="o">=</span> <span class="n">hstypes</span><span class="o">.</span><span class="n">FiltKeys</span><span class="o">.</span><span class="n">DISTINCTIVENESS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_qcache</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres_vsmany</span><span class="p">,</span> <span class="n">qreq_vsmany_</span> <span class="o">=</span> <span class="n">query_vsmany_initial</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vsone_query_pairs</span> <span class="o">=</span> <span class="n">build_vsone_shortlist</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid2_qres_vsmany</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres_vsone</span><span class="p">,</span> <span class="n">qreq_vsone_</span> <span class="o">=</span> <span class="n">query_vsone_pairs</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">vsone_query_pairs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres_vsone</span> <span class="o">=</span> <span class="n">qaid2_qres_vsone</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top_namescore_aids</span> <span class="o">=</span> <span class="n">qres_vsone</span><span class="o">.</span><span class="n">get_top_aids</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">top_namescore_aids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top_namescore_names</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_names</span><span class="p">(</span><span class="n">top_namescore_aids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">top_namescore_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;easy&#39;</span><span class="p">,</span> <span class="s">&#39;top_namescore_names[0]=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">top_namescore_names</span><span class="p">[</span><span class="mi">0</span><span class="p">],)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.special_query.query_vsone_verified">
<code class="descclassname">ibeis.algo.hots.special_query.</code><code class="descname">query_vsone_verified</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaids</em>, <em>daids</em>, <em>qreq_vsmany__=None</em>, <em>incinfo=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/special_query.html#query_vsone_verified"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.special_query.query_vsone_verified" title="Permalink to this definition">¶</a></dt>
<dd><p>main special query entry point</p>
<p>A hacked in vsone-reranked pipeline
Actually just two calls to the pipeline</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; ibeis controller object</li>
<li><strong>qaids</strong> (<em>list</em>) &#8211; query annotation ids</li>
<li><strong>daids</strong> (<em>list</em>) &#8211; database annotation ids</li>
<li><strong>qreq_vsmany</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; used for persitant QueryRequest objects
if None creates new query request otherwise</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">qaid2_qres, <a href="#id29"><span class="problematic" id="id30">qreq_</span></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.special_query --test-query_vsone_verified
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.special_query</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">valid_aids</span> <span class="o">=</span> <span class="n">testdata_special_query</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">valid_aids</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qaids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qreq_vsmany_</span> <span class="o">=</span> <span class="n">query_vsone_verified</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">qaid2_qres</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.special_query.test_vsone_errors">
<code class="descclassname">ibeis.algo.hots.special_query.</code><code class="descname">test_vsone_errors</code><span class="sig-paren">(</span><em>ibs</em>, <em>daids</em>, <em>qaid2_qres_vsmany</em>, <em>qaid2_qres_vsone</em>, <em>incinfo</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/special_query.html#test_vsone_errors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.special_query.test_vsone_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>ibs1 = ibs_gt
ibs2 = ibs (the current test database, sorry for the backwardness)
aid1_to_aid2 - maps annots from ibs1 to ibs2</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.special_query.test_vsone_verified">
<code class="descclassname">ibeis.algo.hots.special_query.</code><code class="descname">test_vsone_verified</code><span class="sig-paren">(</span><em>ibs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/special_query.html#test_vsone_verified"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.special_query.test_vsone_verified" title="Permalink to this definition">¶</a></dt>
<dd><p>hack in vsone-reranking</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.all_imports</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#reload_all()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_vsone_verified</span><span class="p">(</span><span class="n">ibs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.special_query.testdata_special_query">
<code class="descclassname">ibeis.algo.hots.special_query.</code><code class="descname">testdata_special_query</code><span class="sig-paren">(</span><em>dbname=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/special_query.html#testdata_special_query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.special_query.testdata_special_query" title="Permalink to this definition">¶</a></dt>
<dd><p>test data for special query doctests</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.special_query.verbose_report_results">
<code class="descclassname">ibeis.algo.hots.special_query.</code><code class="descname">verbose_report_results</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaids</em>, <em>qaid2_qres_vsone</em>, <em>qaid2_qres_vsmany</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/special_query.html#verbose_report_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.special_query.verbose_report_results" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.tmp_cluster">
<span id="ibeis-algo-hots-tmp-cluster-module"></span><h2>ibeis.algo.hots.tmp_cluster module<a class="headerlink" href="#module-ibeis.algo.hots.tmp_cluster" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.algo.hots.tmp_cluster.flow">
<code class="descclassname">ibeis.algo.hots.tmp_cluster.</code><code class="descname">flow</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/tmp_cluster.html#flow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.tmp_cluster.flow" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pmneila.github.io/PyMaxflow/maxflow.html#maxflow-fastmin">http://pmneila.github.io/PyMaxflow/maxflow.html#maxflow-fastmin</a></p>
<p>pip install PyMaxFlow
pip install pystruct
pip install hdbscan</p>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.user_dialogs">
<span id="ibeis-algo-hots-user-dialogs-module"></span><h2>ibeis.algo.hots.user_dialogs module<a class="headerlink" href="#module-ibeis.algo.hots.user_dialogs" title="Permalink to this headline">¶</a></h2>
<p>Depricate</p>
<dl class="function">
<dt id="ibeis.algo.hots.user_dialogs.convert_name_suggestion_to_aids">
<code class="descclassname">ibeis.algo.hots.user_dialogs.</code><code class="descname">convert_name_suggestion_to_aids</code><span class="sig-paren">(</span><em>ibs</em>, <em>choicetup</em>, <em>name_suggest_tup</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/user_dialogs.html#convert_name_suggestion_to_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.user_dialogs.convert_name_suggestion_to_aids" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.user_dialogs</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">comp_aids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">comp_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;fred&#39;</span><span class="p">,</span> <span class="s">&#39;sue&#39;</span><span class="p">,</span> <span class="s">&#39;alice&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chosen_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;fred&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">convert_name_suggestion_to_aids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">choicetup</span><span class="p">,</span> <span class="n">name_suggest_tup</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.user_dialogs.wait_for_user_exemplar_decision">
<code class="descclassname">ibeis.algo.hots.user_dialogs.</code><code class="descname">wait_for_user_exemplar_decision</code><span class="sig-paren">(</span><em>autoexemplar_msg</em>, <em>exemplar_decision</em>, <em>exemplar_condience</em>, <em>incinfo=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/user_dialogs.html#wait_for_user_exemplar_decision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.user_dialogs.wait_for_user_exemplar_decision" title="Permalink to this definition">¶</a></dt>
<dd><p>hooks into to some method of getting user input for exemplars</p>
<p>TODO: really good interface</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>autoexemplar_msg</strong> &#8211; </li>
<li><strong>exemplar_decision</strong> &#8211; </li>
<li><strong>exemplar_condience</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">True</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><p>?</p>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.automated_matcher --test-get_user_exemplar_decision
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">autoexemplar_msg</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exemplar_decision</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exemplar_condience</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_user_exemplar_decision</span><span class="p">(</span><span class="n">autoexemplar_msg</span><span class="p">,</span> <span class="n">exemplar_decision</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                           <span class="n">exemplar_condience</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.user_dialogs.wait_for_user_name_decision">
<code class="descclassname">ibeis.algo.hots.user_dialogs.</code><code class="descname">wait_for_user_name_decision</code><span class="sig-paren">(</span><em>ibs</em>, <em>cm</em>, <em>qreq_</em>, <em>choicetup</em>, <em>name_suggest_tup</em>, <em>incinfo=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/user_dialogs.html#wait_for_user_name_decision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.user_dialogs.wait_for_user_name_decision" title="Permalink to this definition">¶</a></dt>
<dd><p>Prompts the user for input
hooks into to some method of getting user input for names</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; </li>
<li><strong>cm</strong> (<em>QueryResult</em>) &#8211; object of feature correspondences and scores</li>
<li><strong>autoname_func</strong> (<em>function</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.user_dialogs --test-wait_for_user_name_decision --show
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.user_dialogs</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">query_chips</span><span class="p">(</span><span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">return_request</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">return_cm</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">choicetup</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name_suggest_tup</span> <span class="o">=</span> <span class="s">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">incinfo</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">wait_for_user_name_decision</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">choicetup</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">name_suggest_tup</span><span class="p">,</span> <span class="n">incinfo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.vsone_pipeline">
<span id="ibeis-algo-hots-vsone-pipeline-module"></span><h2>ibeis.algo.hots.vsone_pipeline module<a class="headerlink" href="#module-ibeis.algo.hots.vsone_pipeline" title="Permalink to this headline">¶</a></h2>
<p>special pipeline for vsone specific functions</p>
<dl class="docutils">
<dt>Current Issues:</dt>
<dd><ul class="first last simple">
<li>getting feature distinctiveness is too slow, we can either try a different
model, or precompute feature distinctiveness.<ul>
<li>we can reduce the size of the vsone shortlist</li>
</ul>
</li>
</ul>
</dd>
<dt>TODOLIST:</dt>
<dd><ul class="first simple">
<li>Unconstrained is a terrible name. It is constrianed by the ratio</li>
<li>Precompute distinctivness</li>
</ul>
<p>#* keep feature matches from vsmany (allow fm_B)
#* Each keypoint gets
#  - foregroundness
#  - global distinctivness (databasewide) LNBNN
#  - local distinctivness (imagewide) RATIO
#  - regional match quality (descriptor based) COS
* Asymetric weight scoring</p>
<ul class="simple">
<li>FIX BUGS IN score_chipmatch_nsum FIRST THING TOMORROW.</li>
</ul>
<blockquote>
<div>dict keys / vals are being messed up. very inoccuous</div></blockquote>
<p class="last">Visualization to &#8220;prove&#8221; that vsone works</p>
</dd>
<dt>TestCases:</dt>
<dd>PZ_Master0 - aids 1801, 4792 - near-miss</dd>
<dt>TestFuncs:</dt>
<dd><div class="first highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># VsMany Only</span>
<span class="go">python -m ibeis.algo.hots.vsone_pipeline --test-show_post_vsmany_vser --show</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># VsOne Only</span>
<span class="go">python -m ibeis.algo.hots.vsone_pipeline --test-vsone_reranking --show --no-vsmany_coeff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># VsOne + VsMany</span>
<span class="go">python -m ibeis.algo.hots.vsone_pipeline --test-vsone_reranking --show</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Rerank Vsone Test Harness</span>
<span class="go">python -c &quot;import utool as ut; ut.write_modscript_alias(&#39;Tvs1RR.sh&#39;, &#39;dev.py&#39;, &#39;--allgt  --db PZ_MTEST --index 1:40:2&#39;)&quot;  # NOQA</span>
<span class="go">sh Tvs1RR.sh -t custom:rrvsone_on=True custom custom:rrvsone_on=True</span>
<span class="go">sh Tvs1RR.sh -t custom custom:rrvsone_on=True --print-scorediff-mat-stats</span>
<span class="go">sh Tvs1RR.sh -t custom:rrvsone_on=True custom:rrvsone_on=True, --print-confusion-stats --print-scorediff-mat-stats</span>
</pre></div>
</div>
<p class="last">&#8211;print-scorediff-mat-stats &#8211;print-confusion-stats</p>
</dd>
</dl>
<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.compute_query_constrained_matches">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">compute_query_constrained_matches</code><span class="sig-paren">(</span><em>qreq_</em>, <em>qaid</em>, <em>daid_list</em>, <em>H_list</em>, <em>config</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#compute_query_constrained_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.compute_query_constrained_matches" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.vsone_pipeline --test-compute_query_constrained_matches --show
python -m ibeis.algo.hots.vsone_pipeline --test-compute_query_constrained_matches --show --shownorm
python -m ibeis.algo.hots.vsone_pipeline --test-compute_query_constrained_matches --show --shownorm --homog
python -m ibeis.algo.hots.vsone_pipeline --test-compute_query_constrained_matches --show --homog
python -m ibeis.algo.hots.vsone_pipeline --test-compute_query_constrained_matches --show --homog --index 2
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (IMPORTANT)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.vsone_pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">prior_cm</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_matching</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">H_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_take</span><span class="p">(</span><span class="n">prior_cm</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;qaid&#39;</span><span class="p">,</span> <span class="s">&#39;daid_list&#39;</span><span class="p">,</span> <span class="s">&#39;H_list&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_results</span> <span class="o">=</span> <span class="n">compute_query_constrained_matches</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">H_list</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm_SCR_list</span><span class="p">,</span> <span class="n">fs_SCR_list</span><span class="p">,</span> <span class="n">fm_norm_SCR_list</span> <span class="o">=</span> <span class="n">match_results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">listfind</span><span class="p">(</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_nids</span><span class="p">(</span><span class="n">daid_list</span><span class="p">),</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_nids</span><span class="p">(</span><span class="n">qaid</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--index&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">fm_SCR_list</span><span class="p">,</span> <span class="n">fs_SCR_list</span><span class="p">,</span> <span class="n">fm_norm_SCR_list</span><span class="p">,</span> <span class="n">H_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_single_match</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;constrained&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.compute_query_unconstrained_matches">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">compute_query_unconstrained_matches</code><span class="sig-paren">(</span><em>qreq_</em>, <em>qaid</em>, <em>daid_list</em>, <em>config</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#compute_query_unconstrained_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.compute_query_unconstrained_matches" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.vsone_pipeline --test-compute_query_unconstrained_matches --show
python -m ibeis.algo.hots.vsone_pipeline --test-compute_query_unconstrained_matches --show --shownorm
python -m ibeis.algo.hots.vsone_pipeline --test-compute_query_unconstrained_matches --show --shownorm --homog
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (IMPORTANT)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.vsone_pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">prior_cm</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_matching</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">H_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_take</span><span class="p">(</span><span class="n">prior_cm</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;qaid&#39;</span><span class="p">,</span> <span class="s">&#39;daid_list&#39;</span><span class="p">,</span> <span class="s">&#39;H_list&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_results</span> <span class="o">=</span> <span class="n">compute_query_unconstrained_matches</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm_RAT_list</span><span class="p">,</span> <span class="n">fs_RAT_list</span><span class="p">,</span> <span class="n">fm_norm_RAT_list</span> <span class="o">=</span> <span class="n">match_results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">listfind</span><span class="p">(</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_nids</span><span class="p">(</span><span class="n">daid_list</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_nids</span><span class="p">(</span><span class="n">qaid</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">fm_RAT_list</span><span class="p">,</span> <span class="n">fs_RAT_list</span><span class="p">,</span> <span class="n">fm_norm_RAT_list</span><span class="p">,</span> <span class="n">H_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_single_match</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;unconstrained&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.extract_aligned_parts">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">extract_aligned_parts</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid</em>, <em>daid</em>, <em>qreq_=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#extract_aligned_parts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.extract_aligned_parts" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; ibeis controller object</li>
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation id</li>
<li><strong>daid</strong> &#8211; </li>
<li><strong>H1</strong> &#8211; </li>
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.vsone_pipeline --exec-extract_aligned_parts:0 --show --db testdb1
python -m ibeis.algo.hots.vsone_pipeline --exec-extract_aligned_parts:1 --show
python -m ibeis.algo.hots.vsone_pipeline --exec-extract_aligned_parts:1 --show  -t default:AI<span class="o">=</span>False  <span class="c"># see x 11</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ipy:</dt>
<dd>ibs.get_annot_chip_fpath([qaid, daid])</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.vsone_pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_FlankHack&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#nid_list = ibs.get_valid_nids(min_pername=2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#nid_list = nid_list[1:2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#qaid, daid = ibs.get_name_aids(nid_list)[0][0:2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span><span class="p">,</span> <span class="n">daid</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matches</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">extract_aligned_parts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">daid</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip1_crop</span><span class="p">,</span> <span class="n">rchip2_crop</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s">&#39;rchip1_crop&#39;</span><span class="p">],</span> <span class="n">metadata</span><span class="p">[</span><span class="s">&#39;rchip2_crop&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#pt.imshow(vt.stack_images(rchip1_, rchip2)[0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">doclf</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blend</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">blend_images</span><span class="p">(</span><span class="n">rchip1_crop</span><span class="p">,</span> <span class="n">rchip2_crop</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">show_matching_dict</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">stack_images</span><span class="p">(</span><span class="n">rchip1_crop</span><span class="p">,</span> <span class="n">rchip2_crop</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">blend</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.vsone_pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_FlankHack&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_nids</span><span class="p">(</span><span class="n">min_pername</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pcfgdict</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">main_helpers</span><span class="o">.</span><span class="n">testdata_pipecfg</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_actions</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s">&#39;present&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;s&#39;</span><span class="p">],</span> <span class="s">&#39;present&#39;</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">present</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">InteractiveIter</span><span class="p">(</span><span class="n">nid_list</span><span class="p">,</span> <span class="n">custom_actions</span><span class="o">=</span><span class="n">custom_actions</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">nid_list</span> <span class="o">=</span> <span class="n">nid_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">qaid</span><span class="p">,</span> <span class="n">daid</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_name_aids</span><span class="p">(</span><span class="n">nid</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">([</span><span class="n">qaid</span><span class="p">],</span> <span class="p">[</span><span class="n">daid</span><span class="p">],</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">pcfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">matches</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">extract_aligned_parts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">daid</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">if</span> <span class="n">matches</span><span class="p">[</span><span class="s">&#39;RAT+SV&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Not enough matches&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">continue</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">rchip1_crop</span><span class="p">,</span> <span class="n">rchip2_crop</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s">&#39;rchip1_crop&#39;</span><span class="p">],</span> <span class="n">metadata</span><span class="p">[</span><span class="s">&#39;rchip2_crop&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">vt</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">show_matching_dict</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">blend</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">blend_images</span><span class="p">(</span><span class="n">rchip1_crop</span><span class="p">,</span> <span class="n">rchip2_crop</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vt</span><span class="o">.</span><span class="n">stack_images</span><span class="p">(</span><span class="n">rchip1_crop</span><span class="p">,</span> <span class="n">rchip2_crop</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">blend</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.get_normalized_score_column">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">get_normalized_score_column</code><span class="sig-paren">(</span><em>fsv</em>, <em>colx</em>, <em>min_</em>, <em>max_</em>, <em>power</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#get_normalized_score_column"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.get_normalized_score_column" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.get_selectivity_score_list">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">get_selectivity_score_list</code><span class="sig-paren">(</span><em>qreq_</em>, <em>qaid</em>, <em>daid_list</em>, <em>fm_list</em>, <em>cos_power</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#get_selectivity_score_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.get_selectivity_score_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.gridsearch_constrained_matches">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">gridsearch_constrained_matches</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#gridsearch_constrained_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.gridsearch_constrained_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Search spatially constrained matches</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.vsone_pipeline --test-gridsearch_constrained_matches --show
python -m ibeis.algo.hots.vsone_pipeline --test-gridsearch_constrained_matches --show --qaid 41
python -m ibeis.algo.hots.vsone_pipeline --test-gridsearch_constrained_matches --show --testindex 2
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.vsone_pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_constrained_matches</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.gridsearch_single_vsone_rerank">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">gridsearch_single_vsone_rerank</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#gridsearch_single_vsone_rerank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.gridsearch_single_vsone_rerank" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.vsone_pipeline --test-gridsearch_single_vsone_rerank --show
python -m ibeis.algo.hots.vsone_pipeline --test-gridsearch_single_vsone_rerank --show --testindex 2
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.vsone_pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_single_vsone_rerank</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.gridsearch_unconstrained_matches">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">gridsearch_unconstrained_matches</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#gridsearch_unconstrained_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.gridsearch_unconstrained_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Search unconstrained ratio test vsone match</p>
<p>This still works</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.vsone_pipeline --test-gridsearch_unconstrained_matches --show
python -m ibeis.algo.hots.vsone_pipeline --test-gridsearch_unconstrained_matches --show --qaid 27
python -m ibeis.algo.hots.vsone_pipeline --test-gridsearch_unconstrained_matches --show --qaid <span class="m">41</span> --daid_list 39
python -m ibeis.algo.hots.vsone_pipeline --test-gridsearch_unconstrained_matches --show --qaid <span class="m">40</span> --daid_list 39
python -m ibeis.algo.hots.vsone_pipeline --test-gridsearch_unconstrained_matches --show --testindex 2


python -m ibeis.algo.hots.vsone_pipeline --test-gridsearch_unconstrained_matches --show --qaid <span class="m">117</span> --daid_list <span class="m">118</span> --db PZ_Master0
python -m ibeis.algo.hots.vsone_pipeline --test-gridsearch_unconstrained_matches --show --qaid <span class="m">117</span> --daid_list <span class="m">118</span> --db PZ_Master0 --rotation_invariance
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.vsone_pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gridsearch_unconstrained_matches</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.marge_matches_lists">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">marge_matches_lists</code><span class="sig-paren">(</span><em>fmfs_A</em>, <em>fmfs_B</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#marge_matches_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.marge_matches_lists" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.prepare_vsmany_chipmatch">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">prepare_vsmany_chipmatch</code><span class="sig-paren">(</span><em>qreq_</em>, <em>cm_list_SVER</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#prepare_vsmany_chipmatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.prepare_vsmany_chipmatch" title="Permalink to this definition">¶</a></dt>
<dd><p>gets normalized vsmany priors</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (IMPORTANT)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.vsone_pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list_SVER</span><span class="p">,</span> <span class="n">qaid_list</span>  <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_vsonerr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prepare_vsmany_chipmatch</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list_SVER</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.quick_vsone_flann">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">quick_vsone_flann</code><span class="sig-paren">(</span><em>flann_cachedir</em>, <em>qvecs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#quick_vsone_flann"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.quick_vsone_flann" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.refine_matches">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">refine_matches</code><span class="sig-paren">(</span><em>qreq_</em>, <em>prior_cm</em>, <em>config={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#refine_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.refine_matches" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.vsone_pipeline --test-refine_matches --show
python -m ibeis.algo.hots.vsone_pipeline --test-refine_matches --show --homog
python -m ibeis.algo.hots.vsone_pipeline --test-refine_matches --show --homog --sver_unconstrained
python -m ibeis.algo.hots.vsone_pipeline --test-refine_matches --show --homog --sver_constrained<span class="p">&amp;</span>
python -m ibeis.algo.hots.vsone_pipeline --test-refine_matches --show --homog --sver_constrained --sver_unconstrained<span class="p">&amp;</span>

<span class="c"># CONTROLLED EXAMPLES</span>
python -m ibeis.algo.hots.vsone_pipeline --exec-refine_matches --show --qaid <span class="m">1801</span> --controlled_daids --db PZ_Master0 --sv_on<span class="o">=</span>False --present

<span class="c"># WITH DEV HARNESS</span>
python dev.py -t custom:rrvsone_on<span class="o">=</span>True --allgt --index 0:40 --db PZ_MTEST --print-confusion-stats --print-scorediff-mat-stats
python dev.py -t custom:rrvsone_on<span class="o">=</span>True custom --allgt --index 0:40 --db PZ_MTEST --print-confusion-stats --print-scorediff-mat-stats

python dev.py -t custom:rrvsone_on<span class="o">=</span>True,constrained_coeff<span class="o">=</span><span class="m">0</span> custom --qaid <span class="m">12</span> --db PZ_MTEST <span class="se">\</span>
    --print-confusion-stats --print-scorediff-mat-stats --show --va

python dev.py -t custom:rrvsone_on<span class="o">=</span>True,constrained_coeff<span class="o">=</span>0,maskscore_mode<span class="o">=</span>kpts --qaid <span class="m">12</span> --db PZ_MTEST  <span class="se">\</span>
    --print-confusion-stats --print-scorediff-mat-stats --show --va

python dev.py -t custom:rrvsone_on<span class="o">=</span>True,maskscore_mode<span class="o">=</span>kpts --qaid <span class="m">12</span> --db PZ_MTEST <span class="se">\</span>
        --print-confusion-stats --print-scorediff-mat-stats --show --va


use_kptscov_scoring
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (IMPORTANT)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.vsone_pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">prior_cm</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_matching</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unscored_cm</span> <span class="o">=</span> <span class="n">refine_matches</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">prior_cm</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unscored_cm</span><span class="o">.</span><span class="n">print_csv</span><span class="p">(</span><span class="n">ibs</span><span class="o">=</span><span class="n">ibs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prior_cm</span><span class="o">.</span><span class="n">print_csv</span><span class="p">(</span><span class="n">ibs</span><span class="o">=</span><span class="n">ibs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prior_cm</span><span class="o">.</span><span class="n">show_ranked_matches</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.scr_constraint_func">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">scr_constraint_func</code><span class="sig-paren">(</span><em>cfg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#scr_constraint_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.scr_constraint_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.show_all_ranked_matches">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">show_all_ranked_matches</code><span class="sig-paren">(</span><em>qreq_</em>, <em>cm_list</em>, <em>fnum_offset=0</em>, <em>figtitle=u''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#show_all_ranked_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.show_all_ranked_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>helper</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.show_matches">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">show_matches</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid</em>, <em>daid</em>, <em>fm</em>, <em>fs=None</em>, <em>fm_norm=None</em>, <em>H1=None</em>, <em>fnum=None</em>, <em>pnum=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#show_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.show_matches" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.show_post_vsmany_vser">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">show_post_vsmany_vser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#show_post_vsmany_vser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.show_post_vsmany_vser" title="Permalink to this definition">¶</a></dt>
<dd><p>TESTFUNC just show the input data</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.vsone_pipeline --test-show_post_vsmany_vser --show --homog
python -m ibeis.algo.hots.vsone_pipeline --test-show_post_vsmany_vser --show --csum --homog
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.vsone_pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_post_vsmany_vser</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.show_ranked_matches">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">show_ranked_matches</code><span class="sig-paren">(</span><em>ibs</em>, <em>cm</em>, <em>fnum=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#show_ranked_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.show_ranked_matches" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.show_single_match">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">show_single_match</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid</em>, <em>daid_list</em>, <em>fm_list</em>, <em>fs_list</em>, <em>fm_norm_list=None</em>, <em>H_list=None</em>, <em>index=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#show_single_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.show_single_match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.single_vsone_rerank">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">single_vsone_rerank</code><span class="sig-paren">(</span><em>qreq_</em>, <em>prior_cm</em>, <em>config={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#single_vsone_rerank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.single_vsone_rerank" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a single vsone-pair (query, daid_list)</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.vsone_pipeline --test-single_vsone_rerank
python -m ibeis.algo.hots.vsone_pipeline --test-single_vsone_rerank --show
python -m ibeis.algo.hots.vsone_pipeline --test-single_vsone_rerank --show --qaid 18
python -m ibeis.algo.hots.vsone_pipeline --test-single_vsone_rerank --show --qaid 18
python -m ibeis.algo.hots.vsone_pipeline --test-single_vsone_rerank --show --qaid <span class="m">1801</span> --db PZ_Master0 --controlled --verb-testdata
python -m ibeis.algo.hots.vsone_pipeline --test-single_vsone_rerank --show --qaid <span class="m">1801</span> --controlled_daids --db PZ_Master0 --verb-testdata

python -m ibeis.algo.hots.vsone_pipeline --exec-single_vsone_rerank --show --qaid <span class="m">1801</span> --controlled_daids --db PZ_Master0 --verb-testdata
python -m ibeis.algo.hots.vsone_pipeline --exec-single_vsone_rerank --show --qaid <span class="m">1801</span> --controlled_daids --db PZ_Master0 --verb-testdata --sv_on<span class="o">=</span>False --present
python -m ibeis.algo.hots.vsone_pipeline --exec-single_vsone_rerank --show --qaid <span class="m">1801</span> --controlled_daids --db PZ_Master0 --verb-testdata --sv_on<span class="o">=</span>False --present --affine-invariance<span class="o">=</span>False
python -m ibeis.algo.hots.vsone_pipeline --exec-single_vsone_rerank --show --qaid <span class="m">1801</span> --controlled_daids --db PZ_Master0 --verb-testdata --sv_on<span class="o">=</span>False --present --affine-invariance<span class="o">=</span>False --rotation-invariant<span class="o">=</span>True
</pre></div>
</div>
<dl class="docutils">
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (IMPORTANT)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.vsone_pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">prior_cm</span> <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_matching</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rerank_cm</span> <span class="o">=</span> <span class="n">single_vsone_rerank</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">prior_cm</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#rerank_cm.print_rawinfostr()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rerank_cm</span><span class="o">.</span><span class="n">print_csv</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">rerank_cm</span><span class="o">.</span><span class="n">score_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prior_cm</span><span class="o">.</span><span class="n">score_nsum</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prior_cm</span><span class="o">.</span><span class="n">show_ranked_matches</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="s">&#39;prior&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rerank_cm</span><span class="o">.</span><span class="n">show_ranked_matches</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="s">&#39;rerank&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.sver_fmfs_merge">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">sver_fmfs_merge</code><span class="sig-paren">(</span><em>qreq_</em>, <em>qaid</em>, <em>daid_list</em>, <em>fmfs_merge</em>, <em>config={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#sver_fmfs_merge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.sver_fmfs_merge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.unsupervised_similarity">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">unsupervised_similarity</code><span class="sig-paren">(</span><em>ibs</em>, <em>aids</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#unsupervised_similarity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.unsupervised_similarity" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://repository.upenn.edu/cgi/viewcontent.cgi?article=1101&amp;context=cis_papers">http://repository.upenn.edu/cgi/viewcontent.cgi?article=1101&amp;context=cis_papers</a></p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.vsone_independant">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">vsone_independant</code><span class="sig-paren">(</span><em>qreq_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#vsone_independant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.vsone_independant" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>./dev.py -t custom --db PZ_Master0 --allgt --species<span class="o">=</span>zebra_plains

python -m ibeis.algo.hots.vsone_pipeline --test-vsone_independant --show

python -m ibeis.control.manual_annot_funcs --test-get_annot_groundtruth:0 --db<span class="o">=</span>PZ_Master0 --aids<span class="o">=</span><span class="m">117</span> --exec-mode  <span class="c"># NOQA</span>

python -m ibeis.algo.hots.vsone_pipeline --test-vsone_independant --qaid_list<span class="o">=</span><span class="m">97</span> --daid_list<span class="o">=</span>all --db PZ_Master0 --species<span class="o">=</span>zebra_plains
python -m ibeis.viz.viz_name --test-show_multiple_chips --show --db PZ_Master0 --aids<span class="o">=</span>118,117

python -m ibeis.algo.hots.pipeline --test-request_ibeis_query_L0:0 --show --db PZ_Master0 --qaid_list<span class="o">=</span><span class="m">97</span> --daid-list<span class="o">=</span>4813,4815
--daid_list<span class="o">=</span>all
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots</span> <span class="kn">import</span> <span class="n">_pipeline_helpers</span> <span class="k">as</span> <span class="n">plh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">pipeline_root</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">,</span> <span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">,</span> <span class="n">fg_on</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="s">&#39;default&#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_cfg_lbl</span><span class="p">(</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">qaid_override</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">qaid_override</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">vsone_independant</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.vsone_independant_pair_hack">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">vsone_independant_pair_hack</code><span class="sig-paren">(</span><em>ibs</em>, <em>aid1</em>, <em>aid2</em>, <em>qreq_=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#vsone_independant_pair_hack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.vsone_independant_pair_hack" title="Permalink to this definition">¶</a></dt>
<dd><p>simple hack convinience func
Uses vsmany qreq to build a &#8220;similar&#8221; vsone qreq</p>
<dl class="docutils">
<dt>TODO:</dt>
<dd>in the context menu let me change preferences for running vsone</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ibs</strong> (<a class="reference internal" href="ibeis.control.html#ibeis.control.IBEISControl.IBEISController" title="ibeis.control.IBEISControl.IBEISController"><em>IBEISController</em></a>) &#8211; ibeis controller object</li>
<li><strong>aid1</strong> (<em>int</em>) &#8211; annotation id</li>
<li><strong>aid2</strong> (<em>int</em>) &#8211; annotation id</li>
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters(default = None)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.vsone_pipeline --exec-vsone_independant_pair_hack --show --db PZ_MTEST
python -m ibeis.algo.hots.vsone_pipeline --exec-vsone_independant_pair_hack --show --qaid<span class="o">=</span><span class="m">1</span> --daid<span class="o">=</span>4
--cmd
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.vsone_pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid1</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--qaid&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--daid&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">vsone_independant_pair_hack</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid1</span><span class="p">,</span> <span class="n">aid2</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.vsone_name_independant_hack">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">vsone_name_independant_hack</code><span class="sig-paren">(</span><em>ibs</em>, <em>nids</em>, <em>qreq_=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#vsone_name_independant_hack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.vsone_name_independant_hack" title="Permalink to this definition">¶</a></dt>
<dd><p>show grid of aids with matches inside and between names
:param ibs: ibeis controller object
:type ibs: IBEISController
:param nid:
:type nid: ?
:param <a href="#id31"><span class="problematic" id="id32">qreq_</span></a>: query request object with hyper-parameters(default = None)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.vsone_pipeline --exec-vsone_name_independant_hack --db PZ_MTEST --show
python -m ibeis.algo.hots.vsone_pipeline --exec-vsone_name_independant_hack --db PZ_Master1 --show --nids<span class="o">=</span>5099,5181
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.vsone_pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># TODO: testdata_qparams?</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">testdata_qreq_</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nids</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s">&#39;--nids&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">vsone_name_independant_hack</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="p">,</span> <span class="n">nids</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.vsone_reranking">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">vsone_reranking</code><span class="sig-paren">(</span><em>qreq_</em>, <em>cm_list_SVER</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#vsone_reranking"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.vsone_reranking" title="Permalink to this definition">¶</a></dt>
<dd><p>Driver function</p>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.vsone_pipeline --test-vsone_reranking --show

python -m ibeis.algo.hots.vsone_pipeline --test-vsone_reranking --show

python -m ibeis.algo.hots.vsone_pipeline --test-vsone_reranking
utprof.py -m ibeis.algo.hots.vsone_pipeline --test-vsone_reranking
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># (IMPORTANT)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.vsone_pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list_SVER</span><span class="p">,</span> <span class="n">qaid_list</span>  <span class="o">=</span> <span class="n">plh</span><span class="o">.</span><span class="n">testdata_pre_vsonerr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">rrvsone_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># cm_list_SVER = ut.dict_subset(cm_list_SVER, [6])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm_list_VSONE</span> <span class="o">=</span> <span class="n">vsone_reranking</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list_SVER</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#cm_list = cm_list_VSONE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">figtitle</span> <span class="o">=</span> <span class="s">&#39;FIXME USE SUBSET OF CFGDICT&#39;</span>  <span class="c"># ut.dict_str(rrvsone_cfgdict, newlines=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_all_ranked_matches</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">cm_list_VSONE</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="n">figtitle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.vsone_single">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">vsone_single</code><span class="sig-paren">(</span><em>qaid</em>, <em>daid</em>, <em>qreq_</em>, <em>use_ibscache=False</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#vsone_single"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.vsone_single" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation id</li>
<li><strong>daid</strong> &#8211; </li>
<li><strong>qreq</strong> (<a class="reference internal" href="#ibeis.algo.hots.query_request.QueryRequest" title="ibeis.algo.hots.query_request.QueryRequest"><em>QueryRequest</em></a>) &#8211; query request object with hyper-parameters</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">CommandLine:</p>
<div class="highlight-bash"><div class="highlight"><pre>python -m ibeis.algo.hots.vsone_pipeline --exec-vsone_single --show

python -m ibeis.algo.hots.vsone_pipeline --test-vsone_single
python -m ibeis.algo.hots.vsone_pipeline --test-vsone_single --nocache
python -m ibeis.algo.hots.vsone_pipeline --test-vsone_single --nocache --show
python -m ibeis.algo.hots.vsone_pipeline --test-vsone_single --show -t default:AI<span class="o">=</span>False
</pre></div>
</div>
<dl class="docutils">
<dt>SeeAlso:</dt>
<dd>python -m ibeis.algo.hots.vsone_pipeline &#8211;exec-extract_aligned_parts:1 &#8211;show  -t default:AI=False  # see x 11</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.vsone_pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s">&#39;PZ_FlankHack&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pcfgdict</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">main_helpers</span><span class="o">.</span><span class="n">testdata_pipecfg</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span><span class="p">,</span> <span class="n">daid</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_name_aids</span><span class="p">(</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_nids</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">new_query_request</span><span class="p">([</span><span class="n">qaid</span><span class="p">],</span> <span class="p">[</span><span class="n">daid</span><span class="p">],</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">pcfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_ibscache</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--noibscache&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matches</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">vsone_single</span><span class="p">(</span><span class="n">qaid</span><span class="p">,</span> <span class="n">daid</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">use_ibscache</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H1</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s">&#39;H_RAT&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">matching</span><span class="o">.</span><span class="n">show_matching_dict</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.vsone_pipeline.vsone_single2">
<code class="descclassname">ibeis.algo.hots.vsone_pipeline.</code><code class="descname">vsone_single2</code><span class="sig-paren">(</span><em>ibs</em>, <em>qaid</em>, <em>daid</em>, <em>qconfig2_</em>, <em>dconfig2_</em>, <em>use_ibscache</em>, <em>verbose</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/vsone_pipeline.html#vsone_single2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.vsone_pipeline.vsone_single2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots.word_index">
<span id="ibeis-algo-hots-word-index-module"></span><h2>ibeis.algo.hots.word_index module<a class="headerlink" href="#module-ibeis.algo.hots.word_index" title="Permalink to this headline">¶</a></h2>
<p>TODO: DEPRICATE OR REFACTOR INTO SMK</p>
<p>python -c &#8220;import doctest, ibeis; print(doctest.testmod(ibeis.algo.hots.word_index))&#8221;
python -m doctest -v ibeis/algo/hots/word_index.py
python -m doctest ibeis/algo/hots/word_index.py</p>
<dl class="class">
<dt id="ibeis.algo.hots.word_index.NeighborAssignment">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.word_index.</code><code class="descname">NeighborAssignment</code><span class="sig-paren">(</span><em>asgn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/word_index.html#NeighborAssignment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.word_index.NeighborAssignment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="ibeis.algo.hots.word_index.WordIndex">
<em class="property">class </em><code class="descclassname">ibeis.algo.hots.word_index.</code><code class="descname">WordIndex</code><span class="sig-paren">(</span><em>windex</em>, <em>ax2_aid</em>, <em>idx2_vec</em>, <em>idx2_ax</em>, <em>idx2_fx</em>, <em>flann</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/word_index.html#WordIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.word_index.WordIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Abstract wrapper around flann</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.word_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windex</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_windex</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="ibeis.algo.hots.word_index.WordIndex.add_points">
<code class="descname">add_points</code><span class="sig-paren">(</span><em>windex</em>, <em>new_aid_list</em>, <em>new_vecs_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/word_index.html#WordIndex.add_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.word_index.WordIndex.add_points" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.word_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windex</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_windex</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_aid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_query_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_vecs_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="n">new_aid_list</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_data_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checks</span> <span class="o">=</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx1</span><span class="p">,</span> <span class="n">qfx2_dist1</span><span class="p">)</span> <span class="o">=</span> <span class="n">windex</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windex</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">new_aid_list</span><span class="p">,</span> <span class="n">new_vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx2</span><span class="p">,</span> <span class="n">qfx2_dist2</span><span class="p">)</span> <span class="o">=</span> <span class="n">windex</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qfx2_idx2</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">qfx2_idx1</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.word_index.WordIndex.empty_words">
<code class="descname">empty_words</code><span class="sig-paren">(</span><em>K</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/word_index.html#WordIndex.empty_words"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.word_index.WordIndex.empty_words" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.word_index.WordIndex.get_nn_aids">
<code class="descname">get_nn_aids</code><span class="sig-paren">(</span><em>windex</em>, <em>qfx2_nnidx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/word_index.html#WordIndex.get_nn_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.word_index.WordIndex.get_nn_aids" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_nnidx</strong> (<em>ndarray</em>) &#8211; (N x K) qfx2_idx[n][k] is the index of the kth
approximate nearest data vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qfx2_aid - (N x K) qfx2_fx[n][k] is the annotation id index
of the kth approximate nearest data vector</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.word_index.WordIndex.get_nn_axs">
<code class="descname">get_nn_axs</code><span class="sig-paren">(</span><em>windex</em>, <em>qfx2_nnidx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/word_index.html#WordIndex.get_nn_axs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.word_index.WordIndex.get_nn_axs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.word_index.WordIndex.get_nn_featxs">
<code class="descname">get_nn_featxs</code><span class="sig-paren">(</span><em>windex</em>, <em>qfx2_nnidx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/word_index.html#WordIndex.get_nn_featxs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.word_index.WordIndex.get_nn_featxs" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_nnidx</strong> (<em>ndarray</em>) &#8211; (N x K) qfx2_idx[n][k] is the index of the kth
approximate nearest data vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qfx2_fx - (N x K) qfx2_fx[n][k] is the feature index (w.r.t
the source annotation) of the kth approximate nearest data vector</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.word_index.WordIndex.knn">
<code class="descname">knn</code><span class="sig-paren">(</span><em>windex</em>, <em>qfx2_vec</em>, <em>K</em>, <em>checks=1028</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/word_index.html#WordIndex.knn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.word_index.WordIndex.knn" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qfx2_vec</strong> (<em>ndarray</em>) &#8211; (N x D) array of N, D-dimensional query vectors</li>
<li><strong>K</strong> (<em>int</em>) &#8211; number of approximate nearest words to find</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>tuple of (qfx2_idx, qfx2_dist)</p>
<dl class="docutils">
<dt>qfx2_idx (ndarray):  (N x K) qfx2_idx[n][k] is the index of the kth</dt>
<dd><p class="first last">approximate nearest data vector w.r.t qfx2_vec[n]</p>
</dd>
<dt>qfx2_dist (ndarray): (N x K) qfx2_dist[n][k] is the distance to the kth</dt>
<dd><p class="first last">approximate nearest data vector w.r.t. qfx2_vec[n]</p>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.word_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windex</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_windex</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_aid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_query_config2</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checks</span> <span class="o">=</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">windex</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.word_index.WordIndex.num_indexed_annots">
<code class="descname">num_indexed_annots</code><span class="sig-paren">(</span><em>windex</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/word_index.html#WordIndex.num_indexed_annots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.word_index.WordIndex.num_indexed_annots" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.word_index.WordIndex.num_indexed_vecs">
<code class="descname">num_indexed_vecs</code><span class="sig-paren">(</span><em>windex</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/word_index.html#WordIndex.num_indexed_vecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.word_index.WordIndex.num_indexed_vecs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.algo.hots.word_index.WordIndex.rrr">
<code class="descname">rrr</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.word_index.WordIndex.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.word_index.invert_index">
<code class="descclassname">ibeis.algo.hots.word_index.</code><code class="descname">invert_index</code><span class="sig-paren">(</span><em>vecs_list</em>, <em>ax_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/word_index.html#invert_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.word_index.invert_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregates descriptors of input annotations and returns inverted information</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.word_index.new_ibeis_windex">
<code class="descclassname">ibeis.algo.hots.word_index.</code><code class="descname">new_ibeis_windex</code><span class="sig-paren">(</span><em>ibs</em>, <em>daid_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/word_index.html#new_ibeis_windex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.word_index.new_ibeis_windex" title="Permalink to this definition">¶</a></dt>
<dd><p>IBEIS interface into word_index</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.algo.hots.word_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windex</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_windex</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.word_index.new_word_index">
<code class="descclassname">ibeis.algo.hots.word_index.</code><code class="descname">new_word_index</code><span class="sig-paren">(</span><em>aid_list=[]</em>, <em>vecs_list=[]</em>, <em>flann_params={}</em>, <em>flann_cachedir=None</em>, <em>indexer_cfgstr=''</em>, <em>hash_rowids=True</em>, <em>use_cache=True</em>, <em>use_params_hash=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/word_index.html#new_word_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.word_index.new_word_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.word_index.test_windex">
<code class="descclassname">ibeis.algo.hots.word_index.</code><code class="descname">test_windex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/word_index.html#test_windex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.word_index.test_windex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.word_index.vlad">
<code class="descclassname">ibeis.algo.hots.word_index.</code><code class="descname">vlad</code><span class="sig-paren">(</span><em>qfx2_vec</em>, <em>qfx2_cvec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots/word_index.html#vlad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.word_index.vlad" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.algo.hots">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ibeis.algo.hots" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.algo.hots.reload_subs">
<code class="descclassname">ibeis.algo.hots.</code><code class="descname">reload_subs</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibeis/algo/hots.html#reload_subs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.algo.hots.reload_subs" title="Permalink to this definition">¶</a></dt>
<dd><p>Reloads ibeis.algo.hots and submodules</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.algo.hots.rrrr">
<code class="descclassname">ibeis.algo.hots.</code><code class="descname">rrrr</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#ibeis.algo.hots.rrrr" title="Permalink to this definition">¶</a></dt>
<dd><p>Reloads ibeis.algo.hots and submodules</p>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ibeis.algo.hots.smk.html" class="btn btn-neutral float-right" title="ibeis.algo.hots.smk package" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ibeis.algo.detect.html" class="btn btn-neutral" title="ibeis.algo.detect package" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Jon Crall.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.5.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>