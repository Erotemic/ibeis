<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ibeis.model.hots package &mdash; ibeis 0.1.0.dev1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0.dev1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ibeis 0.1.0.dev1 documentation" href="index.html" />
    <link rel="up" title="ibeis.model package" href="ibeis.model.html" />
    <link rel="next" title="ibeis.model.hots.smk package" href="ibeis.model.hots.smk.html" />
    <link rel="prev" title="ibeis.model.detect package" href="ibeis.model.detect.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ibeis.model.hots.smk.html" title="ibeis.model.hots.smk package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ibeis.model.detect.html" title="ibeis.model.detect package"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">ibeis 0.1.0.dev1 documentation</a> &raquo;</li>
          <li><a href="ibeis.html" >ibeis package</a> &raquo;</li>
          <li><a href="ibeis.model.html" accesskey="U">ibeis.model package</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="ibeis-model-hots-package">
<h1>ibeis.model.hots package<a class="headerlink" href="#ibeis-model-hots-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="ibeis.model.hots.smk.html">ibeis.model.hots.smk package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.smk_core">ibeis.model.hots.smk.smk_core module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.smk_debug">ibeis.model.hots.smk.smk_debug module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.smk_index">ibeis.model.hots.smk.smk_index module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.smk_match">ibeis.model.hots.smk.smk_match module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.smk_plots">ibeis.model.hots.smk.smk_plots module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.smk_repr">ibeis.model.hots.smk.smk_repr module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.smk_residuals">ibeis.model.hots.smk.smk_residuals module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.smk_scoring">ibeis.model.hots.smk.smk_scoring module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk.tmp">ibeis.model.hots.smk.tmp module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibeis.model.hots.smk.html#module-ibeis.model.hots.smk">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-ibeis.model.hots.automated_matcher">
<span id="ibeis-model-hots-automated-matcher-module"></span><h2>ibeis.model.hots.automated_matcher module<a class="headerlink" href="#module-ibeis.model.hots.automated_matcher" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.add_annot_chunk">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">add_annot_chunk</tt><big>(</big><em>ibs1</em>, <em>ibs2</em>, <em>aids_chunk1</em>, <em>aid1_to_aid2</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#add_annot_chunk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.add_annot_chunk" title="Permalink to this definition">¶</a></dt>
<dd><p>aids_chunk1 = aid_list1</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.assert_annot_consistency">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">assert_annot_consistency</tt><big>(</big><em>ibs1</em>, <em>ibs2</em>, <em>aid_list1</em>, <em>aid_list2</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#assert_annot_consistency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.assert_annot_consistency" title="Permalink to this definition">¶</a></dt>
<dd><p>just tests uuids</p>
<dl class="docutils">
<dt>if anything goes wrong this should fix it:</dt>
<dd>ibs1.update_annot_visual_uuids(aid_list1)
ibs2.update_annot_visual_uuids(aid_list2)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.autodecide_match">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">autodecide_match</tt><big>(</big><em>ibs2</em>, <em>aid</em>, <em>nid</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#autodecide_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.autodecide_match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.autodecide_newname">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">autodecide_newname</tt><big>(</big><em>ibs2</em>, <em>aid</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#autodecide_newname"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.autodecide_newname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.ensure_clean_data">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">ensure_clean_data</tt><big>(</big><em>ibs1</em>, <em>ibs2</em>, <em>aid_list1</em>, <em>aid_list2</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#ensure_clean_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.ensure_clean_data" title="Permalink to this definition">¶</a></dt>
<dd><p>removes previously set names and exemplars</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.incremental_test">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">incremental_test</tt><big>(</big><em>ibs1</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#incremental_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.incremental_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the scores/ranks of correct matches while varying the size of the
database.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ibs</strong> (<em>list</em>) &#8211; IBEISController object</li>
<li><strong>qaid_list</strong> (<em>list</em>) &#8211; list of annotation-ids to query</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd><p class="first">python dev.py -t inc &#8211;db PZ_MTEST &#8211;qaid 1:30:3 &#8211;cmd</p>
<p>python dev.py &#8211;db PZ_MTEST &#8211;allgt &#8211;cmd</p>
<p class="last">python dev.py &#8211;db PZ_MTEST &#8211;allgt -t inc</p>
</dd>
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.automated_matcher &#8211;test-incremental_test</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.all_imports</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.automated_matcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs1</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">incremental_test</span><span class="p">(</span><span class="n">ibs1</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Have:</dt>
<dd><ul class="first last simple">
<li>semantic and visual uuids</li>
<li>Test that accepts unknown annotations one at a time and
for each runs query, makes decision about name, and executes decision.</li>
<li>As a placeholder for exemplar decisions  an exemplar is added if
number of exemplars per name is less than threshold.</li>
</ul>
</dd>
<dt>TODO:</dt>
<dd><ul class="first last simple">
<li></li>
<li>vs-one score normalizer ~~/ score normalizer for different values of K * / different params~~
vs-many score normalization doesnt actually matter. We just need the ranking.</li>
<li>~~Remember confidence of decisions for manual review~~
Defer</li>
<li>need a vs-one reranking pipeline node</li>
<li>need to add in the multi-indexer code into the pipeline. Need to
decide which subindexers to load given a set of daids</li>
<li>need to use set query as an exemplar if its vs-one reranking scores
are below a threshold</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.make_decision">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">make_decision</tt><big>(</big><em>ibs2</em>, <em>qaid</em>, <em>qres</em>, <em>threshold</em>, <em>interactive=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#make_decision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.make_decision" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.make_incremental_test_database">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">make_incremental_test_database</tt><big>(</big><em>ibs1</em>, <em>aid_list1</em>, <em>reset</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#make_incremental_test_database"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.make_incremental_test_database" title="Permalink to this definition">¶</a></dt>
<dd><p>makes test db</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.automated_matcher.register_annot_mapping">
<tt class="descclassname">ibeis.model.hots.automated_matcher.</tt><tt class="descname">register_annot_mapping</tt><big>(</big><em>aids_chunk1</em>, <em>aids_chunk2</em>, <em>aid1_to_aid2</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/automated_matcher.html#register_annot_mapping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.automated_matcher.register_annot_mapping" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.exceptions">
<span id="ibeis-model-hots-exceptions-module"></span><h2>ibeis.model.hots.exceptions module<a class="headerlink" href="#module-ibeis.model.hots.exceptions" title="Permalink to this headline">¶</a></h2>
<dl class="exception">
<dt id="ibeis.model.hots.exceptions.HotsCacheMissError">
<em class="property">exception </em><tt class="descclassname">ibeis.model.hots.exceptions.</tt><tt class="descname">HotsCacheMissError</tt><a class="reference internal" href="_modules/ibeis/model/hots/exceptions.html#HotsCacheMissError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.exceptions.HotsCacheMissError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></tt></p>
</dd></dl>

<dl class="exception">
<dt id="ibeis.model.hots.exceptions.HotsNeedsRecomputeError">
<em class="property">exception </em><tt class="descclassname">ibeis.model.hots.exceptions.</tt><tt class="descname">HotsNeedsRecomputeError</tt><a class="reference internal" href="_modules/ibeis/model/hots/exceptions.html#HotsNeedsRecomputeError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.exceptions.HotsNeedsRecomputeError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></tt></p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.exceptions.NoDescriptorsException">
<tt class="descclassname">ibeis.model.hots.exceptions.</tt><tt class="descname">NoDescriptorsException</tt><big>(</big><em>ibs</em>, <em>qaid</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/exceptions.html#NoDescriptorsException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.exceptions.NoDescriptorsException" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="exception">
<dt id="ibeis.model.hots.exceptions.QueryException">
<em class="property">exception </em><tt class="descclassname">ibeis.model.hots.exceptions.</tt><tt class="descname">QueryException</tt><big>(</big><em>msg</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/exceptions.html#QueryException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.exceptions.QueryException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></tt></p>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.hots_query_result">
<span id="ibeis-model-hots-hots-query-result-module"></span><h2>ibeis.model.hots.hots_query_result module<a class="headerlink" href="#module-ibeis.model.hots.hots_query_result" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibeis.model.hots.hots_query_result.QueryResult">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.hots_query_result.</tt><tt class="descname">QueryResult</tt><big>(</big><em>qres</em>, <em>qaid</em>, <em>qauuid</em>, <em>cfgstr</em>, <em>daids</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.__eq__">
<tt class="descname">__eq__</tt><big>(</big><em>other</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.__eq__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.__eq__" title="Permalink to this definition">¶</a></dt>
<dd><p>For testing. Do not use</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.cache_bytes">
<tt class="descname">cache_bytes</tt><big>(</big><em>qres</em>, <em>qresdir</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.cache_bytes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.cache_bytes" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of the cached query result on disk</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_aid_ranks">
<tt class="descname">get_aid_ranks</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_aid_ranks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_aid_ranks" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapped function wrp_noexectb(get_aid_ranks)</p>
<p>orig_argspec = ArgSpec(args=[&#8216;qres&#8217;, &#8216;aid_arr&#8217;, &#8216;fillvalue&#8217;], varargs=None, keywords=None, defaults=(None,))</p>
<p>orig_docstr =  get ranks of annotation ids</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_aid_scores">
<tt class="descname">get_aid_scores</tt><big>(</big><em>qres</em>, <em>aid_arr</em>, <em>fillvalue=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_aid_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_aid_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_aid_truth">
<tt class="descname">get_aid_truth</tt><big>(</big><em>qres</em>, <em>ibs</em>, <em>aid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_aid_truth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_aid_truth" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_aids_and_scores">
<tt class="descname">get_aids_and_scores</tt><big>(</big><em>qres</em>, <em>name_scoring=False</em>, <em>ibs=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_aids_and_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_aids_and_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a chip index list and associated score list</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_average_percision">
<tt class="descname">get_average_percision</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_average_percision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_average_percision" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_best_gt_rank">
<tt class="descname">get_best_gt_rank</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_best_gt_rank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_best_gt_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the best rank over all the groundtruth</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_classified_pos">
<tt class="descname">get_classified_pos</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_classified_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_classified_pos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_daids">
<tt class="descname">get_daids</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_daids" title="Permalink to this definition">¶</a></dt>
<dd><p>returns database annotation ids this query was run with</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_fmatch_index">
<tt class="descname">get_fmatch_index</tt><big>(</big><em>qres</em>, <em>aid</em>, <em>qfx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_fmatch_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_fmatch_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the feature index in aid matching the query&#8217;s qfx-th feature
(if it exists)</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_fname">
<tt class="descname">get_fname</tt><big>(</big><em>qres</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_fname"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_fname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_fpath">
<tt class="descname">get_fpath</tt><big>(</big><em>qres</em>, <em>qresdir</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_fpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_gf_scores">
<tt class="descname">get_gf_scores</tt><big>(</big><em>qres</em>, <em>gf_aids=None</em>, <em>ibs=None</em>, <em>return_gfaids=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_gf_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_gf_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>returns groundfalse scores</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_groundfalse_aids">
<tt class="descname">get_groundfalse_aids</tt><big>(</big><em>qres</em>, <em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_groundfalse_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_groundfalse_aids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_groundtruth_aids">
<tt class="descname">get_groundtruth_aids</tt><big>(</big><em>qres</em>, <em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_groundtruth_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_groundtruth_aids" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the groundtruth with respect to what could have been matched for
this query</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_gt_ranks">
<tt class="descname">get_gt_ranks</tt><big>(</big><em>qres</em>, <em>gt_aids=None</em>, <em>ibs=None</em>, <em>return_gtaids=False</em>, <em>fillvalue=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_gt_ranks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_gt_ranks" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the 0 indexed ranking of each groundtruth chip</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_gt_scores">
<tt class="descname">get_gt_scores</tt><big>(</big><em>qres</em>, <em>gt_aids=None</em>, <em>ibs=None</em>, <em>return_gtaids=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_gt_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_gt_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>returns groundfalse scores</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_inspect_str">
<tt class="descname">get_inspect_str</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>name_scoring=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_inspect_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_inspect_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_interpolated_precision_vs_recall">
<tt class="descname">get_interpolated_precision_vs_recall</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_interpolated_precision_vs_recall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_interpolated_precision_vs_recall" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_match_tbldata">
<tt class="descname">get_match_tbldata</tt><big>(</big><em>qres</em>, <em>ranks_lt=5</em>, <em>name_scoring=False</em>, <em>ibs=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_match_tbldata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_match_tbldata" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns matchinfo in table format (qaids, aids, scores, ranks)</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_matching_keypoints">
<tt class="descname">get_matching_keypoints</tt><big>(</big><em>qres</em>, <em>ibs</em>, <em>aid2_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_matching_keypoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_matching_keypoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_name_decisiontup">
<tt class="descname">get_name_decisiontup</tt><big>(</big><em>qres</em>, <em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_name_decisiontup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_name_decisiontup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_nscoretup">
<tt class="descname">get_nscoretup</tt><big>(</big><em>qres</em>, <em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_nscoretup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_nscoretup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_precision_recall_curve">
<tt class="descname">get_precision_recall_curve</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_precision_recall_curve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_precision_recall_curve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_qaid">
<tt class="descname">get_qaid</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_qaid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_qaid" title="Permalink to this definition">¶</a></dt>
<dd><p>returns query database annotation id</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_sorted_nids_and_scores">
<tt class="descname">get_sorted_nids_and_scores</tt><big>(</big><em>qres</em>, <em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_sorted_nids_and_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_sorted_nids_and_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_top_aids">
<tt class="descname">get_top_aids</tt><big>(</big><em>qres</em>, <em>num=None</em>, <em>name_scoring=False</em>, <em>ibs=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_top_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_top_aids" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a ranked list of chip indexes</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.get_worse_possible_rank">
<tt class="descname">get_worse_possible_rank</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.get_worse_possible_rank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.get_worse_possible_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>a good non None value to use for None ranks</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.has_cache">
<tt class="descname">has_cache</tt><big>(</big><em>qres</em>, <em>qresdir</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.has_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.has_cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.is_nsum">
<tt class="descname">is_nsum</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.is_nsum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.is_nsum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.ishow_top">
<tt class="descname">ishow_top</tt><big>(</big><em>qres</em>, <em>ibs</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.ishow_top"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.ishow_top" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.load">
<tt class="descname">load</tt><big>(</big><em>qres</em>, <em>qresdir</em>, <em>verbose=False</em>, <em>force_miss=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the result from the given database</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.make_smaller_title">
<tt class="descname">make_smaller_title</tt><big>(</big><em>qres</em>, <em>remove_daids=True</em>, <em>remove_chip=True</em>, <em>remove_feat=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.make_smaller_title"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.make_smaller_title" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.make_title">
<tt class="descname">make_title</tt><big>(</big><em>qres</em>, <em>pack=False</em>, <em>remove_daids=False</em>, <em>remove_chip=False</em>, <em>remove_feat=False</em>, <em>textwidth=80</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.make_title"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.make_title" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.qt_inspect_gui">
<tt class="descname">qt_inspect_gui</tt><big>(</big><em>qres</em>, <em>ibs</em>, <em>ranks_lt=5</em>, <em>name_scoring=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.qt_inspect_gui"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.qt_inspect_gui" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.rrr">
<tt class="descname">rrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.save">
<tt class="descname">save</tt><big>(</big><em>qres</em>, <em>qresdir</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.save" title="Permalink to this definition">¶</a></dt>
<dd><p>saves query result to directory</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.show">
<tt class="descname">show</tt><big>(</big><em>qres</em>, <em>ibs</em>, <em>type_</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.show"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.show_analysis">
<tt class="descname">show_analysis</tt><big>(</big><em>qres</em>, <em>ibs</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.show_analysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.show_analysis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.show_precision_recall_curve">
<tt class="descname">show_precision_recall_curve</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em>, <em>fnum=1</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.show_precision_recall_curve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.show_precision_recall_curve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.hots_query_result.QueryResult.show_top">
<tt class="descname">show_top</tt><big>(</big><em>qres</em>, <em>ibs</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#QueryResult.show_top"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.QueryResult.show_top" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.hots_query_result.assert_qres">
<tt class="descclassname">ibeis.model.hots.hots_query_result.</tt><tt class="descname">assert_qres</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#assert_qres"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.assert_qres" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.hots_query_result.get_num_chip_matches">
<tt class="descclassname">ibeis.model.hots.hots_query_result.</tt><tt class="descname">get_num_chip_matches</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#get_num_chip_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.get_num_chip_matches" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.hots_query_result.get_num_feats_in_matches">
<tt class="descclassname">ibeis.model.hots.hots_query_result.</tt><tt class="descname">get_num_feats_in_matches</tt><big>(</big><em>qres</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#get_num_feats_in_matches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.get_num_feats_in_matches" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.hots_query_result.qres_get_matching_keypoints">
<tt class="descclassname">ibeis.model.hots.hots_query_result.</tt><tt class="descname">qres_get_matching_keypoints</tt><big>(</big><em>qres</em>, <em>ibs</em>, <em>aid2_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#qres_get_matching_keypoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.qres_get_matching_keypoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.hots_query_result.query_result_fname">
<tt class="descclassname">ibeis.model.hots.hots_query_result.</tt><tt class="descname">query_result_fname</tt><big>(</big><em>qaid</em>, <em>qauuid</em>, <em>cfgstr</em>, <em>ext='.npz'</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#query_result_fname"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.query_result_fname" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a filename for a queryresult</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation rowid</li>
<li><strong>qauuid</strong> (<em>uuid.UUID</em>) &#8211; query annotation unique universal id</li>
<li><strong>cfgstr</strong> (<em>str</em>) &#8211; query parameter configuration string</li>
<li><strong>ext</strong> (<em>str</em>) &#8211; filetype extension</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.hots_query_result.query_result_fpath">
<tt class="descclassname">ibeis.model.hots.hots_query_result.</tt><tt class="descname">query_result_fpath</tt><big>(</big><em>qresdir</em>, <em>qaid</em>, <em>qauuid</em>, <em>cfgstr</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#query_result_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.query_result_fpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.hots_query_result.remove_corrupted_queries">
<tt class="descclassname">ibeis.model.hots.hots_query_result.</tt><tt class="descname">remove_corrupted_queries</tt><big>(</big><em>qresdir</em>, <em>qres</em>, <em>dryrun=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/hots_query_result.html#remove_corrupted_queries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.hots_query_result.remove_corrupted_queries" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.hstypes">
<span id="ibeis-model-hots-hstypes-module"></span><h2>ibeis.model.hots.hstypes module<a class="headerlink" href="#module-ibeis.model.hots.hstypes" title="Permalink to this headline">¶</a></h2>
<p>hstypes
Todo:
* SIFT: Root_SIFT -&gt; L2 normalized -&gt; Centering.
# <a class="reference external" href="http://hal.archives-ouvertes.fr/docs/00/84/07/21/PDF/RR-8325.pdf">http://hal.archives-ouvertes.fr/docs/00/84/07/21/PDF/RR-8325.pdf</a>
The devil is in the deatails
<a class="reference external" href="http://www.robots.ox.ac.uk/~vilem/bmvc2011.pdf">http://www.robots.ox.ac.uk/~vilem/bmvc2011.pdf</a>
This says dont clip, do rootsift instead
# <a class="reference external" href="http://hal.archives-ouvertes.fr/docs/00/68/81/69/PDF/hal_v1.pdf">http://hal.archives-ouvertes.fr/docs/00/68/81/69/PDF/hal_v1.pdf</a>
* Quantization of residual vectors
* Burstiness normalization for N-SMK
* Implemented A-SMK
* Incorporate Spatial Verification
* Implement correct cfgstrs based on algorithm input
for cached computations.
* Color by word
* Profile on hyrule
* Train vocab on paris
* Remove self matches.
* New SIFT parameters for pyhesaff (root, powerlaw, meanwhatever, output_dtype)</p>
<p>Issues:
* 10GB are in use when performing query on Oxford 5K
* errors when there is a word without any database vectors.
currently a weight of zero is hacked in</p>
</div>
<div class="section" id="module-ibeis.model.hots.match_chips4">
<span id="ibeis-model-hots-match-chips4-module"></span><h2>ibeis.model.hots.match_chips4 module<a class="headerlink" href="#module-ibeis.model.hots.match_chips4" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>DoctestCMD:</dt>
<dd>python -c &#8220;import doctest, ibeis; print(doctest.testmod(ibeis.model.hots.match_chips4))&#8221;</dd>
</dl>
<dl class="function">
<dt id="ibeis.model.hots.match_chips4.execute_query_and_save_L1">
<tt class="descclassname">ibeis.model.hots.match_chips4.</tt><tt class="descname">execute_query_and_save_L1</tt><big>(</big><em>ibs</em>, <em>qreq_</em>, <em>use_cache=True</em>, <em>save_cache=True</em>, <em>chunksize=4</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/match_chips4.html#execute_query_and_save_L1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.match_chips4.execute_query_and_save_L1" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">qaid2_qres</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.match_chips4</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">,</span> <span class="n">sv_on</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chunksize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict1</span><span class="p">,</span> <span class="n">qaid_list</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_cache</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres_hit</span> <span class="o">=</span> <span class="n">execute_query_and_save_L1</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">,</span> <span class="n">save_cache</span><span class="p">,</span> <span class="n">chunksize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qaid2_qres_hit</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.match_chips4.generate_vsone_qreqs">
<tt class="descclassname">ibeis.model.hots.match_chips4.</tt><tt class="descname">generate_vsone_qreqs</tt><big>(</big><em>ibs</em>, <em>qreq_</em>, <em>qaid_list</em>, <em>chunksize</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/match_chips4.html#generate_vsone_qreqs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.match_chips4.generate_vsone_qreqs" title="Permalink to this definition">¶</a></dt>
<dd><p>helper</p>
<p>Generate vsone quries one at a time, but create shallow qreqs in chunks.</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.match_chips4.submit_query_request">
<tt class="descclassname">ibeis.model.hots.match_chips4.</tt><tt class="descname">submit_query_request</tt><big>(</big><em>ibs</em>, <em>qaid_list</em>, <em>daid_list</em>, <em>use_cache=None</em>, <em>use_bigcache=None</em>, <em>return_request=False</em>, <em>cfgdict=None</em>, <em>qreq_=None</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/match_chips4.html#submit_query_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.match_chips4.submit_query_request" title="Permalink to this definition">¶</a></dt>
<dd><p>The standard query interface.</p>
<p>Checks a big cache for qaid2_qres.  If cache miss, tries to load each qres
individually.  On an individual cache miss, it preforms the query.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs</strong> (<em>IBEISController</em>) &#8211; ibeis control object</li>
<li><strong>qaid_list</strong> (<em>list</em>) &#8211; query annotation ids</li>
<li><strong>daid_list</strong> (<em>list</em>) &#8211; database annotation ids</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>qaid2_qres</strong> &#8211;
dict of QueryResult objects</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.match_chips4</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_bigcache</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_cache</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span> <span class="o">=</span> <span class="n">submit_query_request</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">use_cache</span><span class="p">,</span> <span class="n">use_bigcache</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">submit_query_request</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.multi_index">
<span id="ibeis-model-hots-multi-index-module"></span><h2>ibeis.model.hots.multi_index module<a class="headerlink" href="#module-ibeis.model.hots.multi_index" title="Permalink to this headline">¶</a></h2>
<p>python -c &#8220;import doctest, ibeis; print(doctest.testmod(ibeis.model.hots.multi_index))&#8221;
python -m doctest -v ibeis/model/hots/multi_index.py
python -m doctest ibeis/model/hots/multi_index.py</p>
<dl class="class">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.multi_index.</tt><tt class="descname">MultiNeighborIndex</tt><big>(</big><em>mxer</em>, <em>nn_indexer_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Generalization of a NeighborIndex
More abstract wrapper around flann</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.add_points">
<tt class="descname">add_points</tt><big>(</big><em>mxer</em>, <em>new_aid_list</em>, <em>new_vecs_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.add_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.add_points" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.get_nIndexed_list">
<tt class="descname">get_nIndexed_list</tt><big>(</big><em>mxer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.get_nIndexed_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.get_nIndexed_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.get_nn_aids">
<tt class="descname">get_nn_aids</tt><big>(</big><em>mxer</em>, <em>qfx2_imx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.get_nn_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.get_nn_aids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.get_nn_featxs">
<tt class="descname">get_nn_featxs</tt><big>(</big><em>mxer</em>, <em>qfx2_imx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.get_nn_featxs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.get_nn_featxs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.get_offsets">
<tt class="descname">get_offsets</tt><big>(</big><em>mxer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.get_offsets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.get_offsets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.knn">
<tt class="descname">knn</tt><big>(</big><em>mxer</em>, <em>qfx2_vec</em>, <em>K</em>, <em>checks</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.knn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.knn" title="Permalink to this definition">¶</a></dt>
<dd><p>Polymorphic interface to knn, but uses the multindex backend</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checks</span> <span class="o">=</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.knn2">
<tt class="descname">knn2</tt><big>(</big><em>mxer</em>, <em>qfx2_vec</em>, <em>K</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.knn2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.knn2" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_dist_</span><span class="p">,</span> <span class="n">qfx2_idx_</span><span class="p">,</span>  <span class="n">qfx2_fx_</span><span class="p">,</span> <span class="n">qfx2_ax_</span><span class="p">,</span> <span class="n">qfx2_rankx_</span><span class="p">,</span> <span class="n">qfx2_treex_</span><span class="p">,)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn2</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.multi_knn">
<tt class="descname">multi_knn</tt><big>(</big><em>mxer</em>, <em>qfx2_vec</em>, <em>K</em>, <em>checks</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.multi_knn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.multi_knn" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checks</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx_list</span><span class="p">,</span> <span class="n">qfx2_dist_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">multi_knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.num_indexed_annots">
<tt class="descname">num_indexed_annots</tt><big>(</big><em>mxer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.num_indexed_annots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.num_indexed_annots" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">num_indexed_annots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">53</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.num_indexed_vecs">
<tt class="descname">num_indexed_vecs</tt><big>(</big><em>mxer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.num_indexed_vecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.num_indexed_vecs" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">num_indexed_vecs</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">54244</span>
</pre></div>
</div>
<p>54200 on win32</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.rrr">
<tt class="descname">rrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.multi_index.MultiNeighborIndex.split_imxs_gen">
<tt class="descname">split_imxs_gen</tt><big>(</big><em>mxer</em>, <em>qfx2_imx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#MultiNeighborIndex.split_imxs_gen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.MultiNeighborIndex.split_imxs_gen" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checks</span> <span class="o">=</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_imx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">mxer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.multi_index.new_ibeis_mindexer">
<tt class="descclassname">ibeis.model.hots.multi_index.</tt><tt class="descname">new_ibeis_mindexer</tt><big>(</big><em>qreq_</em>, <em>num_indexers=8</em>, <em>split_method='name'</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#new_ibeis_mindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.new_ibeis_mindexer" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mxer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_mindexer</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.multi_index.test_mindexer">
<tt class="descclassname">ibeis.model.hots.multi_index.</tt><tt class="descname">test_mindexer</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/multi_index.html#test_mindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.multi_index.test_mindexer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.name_scoring">
<span id="ibeis-model-hots-name-scoring-module"></span><h2>ibeis.model.hots.name_scoring module<a class="headerlink" href="#module-ibeis.model.hots.name_scoring" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.model.hots.name_scoring.get_one_score_per_name">
<tt class="descclassname">ibeis.model.hots.name_scoring.</tt><tt class="descname">get_one_score_per_name</tt><big>(</big><em>ibs</em>, <em>aid_list</em>, <em>score_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/name_scoring.html#get_one_score_per_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.name_scoring.get_one_score_per_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts annotation scores to name scores</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.hots_query_result</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.dev</span> <span class="kn">import</span> <span class="n">results_all</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_list</span> <span class="o">=</span> <span class="n">daid_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">results_all</span><span class="o">.</span><span class="n">get_qres_and_qreq_</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span> <span class="o">=</span> <span class="n">qaid2_qres</span><span class="p">[</span><span class="n">qaid_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid_list</span><span class="p">,</span> <span class="n">score_list</span> <span class="o">=</span> <span class="n">qres</span><span class="o">.</span><span class="n">get_aids_and_scores</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nscoretup</span> <span class="o">=</span> <span class="n">get_one_score_per_name</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">score_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">sorted_nids</span><span class="p">,</span> <span class="n">sorted_nscore</span><span class="p">,</span> <span class="n">sorted_aids</span><span class="p">,</span> <span class="n">sorted_scores</span><span class="p">)</span> <span class="o">=</span> <span class="n">nscoretup</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.neighbor_index">
<span id="ibeis-model-hots-neighbor-index-module"></span><h2>ibeis.model.hots.neighbor_index module<a class="headerlink" href="#module-ibeis.model.hots.neighbor_index" title="Permalink to this headline">¶</a></h2>
<p>python -c &#8220;import doctest, ibeis; print(doctest.testmod(ibeis.model.hots.neighbor_index))&#8221;
python -m doctest -v ibeis/model/hots/neighbor_index.py
python -m doctest ibeis/model/hots/neighbor_index.py</p>
<dl class="class">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">NeighborIndex</tt><big>(</big><em>nnindexer</em>, <em>ax2_aid</em>, <em>idx2_vec</em>, <em>idx2_fgw</em>, <em>idx2_ax</em>, <em>idx2_fx</em>, <em>flann</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Abstract wrapper around flann</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.add_points">
<tt class="descname">add_points</tt><big>(</big><em>nnindexer</em>, <em>new_aid_list</em>, <em>new_vecs_list</em>, <em>new_fgws_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.add_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.add_points" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_aid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_vecs_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="n">new_aid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checks</span> <span class="o">=</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx1</span><span class="p">,</span> <span class="n">qfx2_dist1</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">new_aid_list</span><span class="p">,</span> <span class="n">new_vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx2</span><span class="p">,</span> <span class="n">qfx2_dist2</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qfx2_idx2</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">qfx2_idx1</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.empty_neighbors">
<tt class="descname">empty_neighbors</tt><big>(</big><em>nnindexer</em>, <em>K</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.empty_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.empty_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_aids">
<tt class="descname">get_nn_aids</tt><big>(</big><em>nnindexer</em>, <em>qfx2_nnidx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.get_nn_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_aids" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_nnidx</strong> &#8211; (N x K) qfx2_idx[n][k] is the index of the kth
approximate nearest data vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(N x K) qfx2_fx[n][k] is the annotation id index of the
kth approximate nearest data vector</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">qfx2_aid</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;testdb1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">dbname</span><span class="o">=</span><span class="n">dbname</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">indexer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_internal_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_neighbors</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checks</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_nnidx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">num_neighbors</span><span class="p">,</span> <span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_aid</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">get_nn_aids</span><span class="p">(</span><span class="n">qfx2_nnidx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">qfx2_aid</span><span class="o">.</span><span class="n">shape</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(1257, 4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_axs">
<tt class="descname">get_nn_axs</tt><big>(</big><em>nnindexer</em>, <em>qfx2_nnidx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.get_nn_axs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_axs" title="Permalink to this definition">¶</a></dt>
<dd><p>gets matching internal annotation indicies</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_featxs">
<tt class="descname">get_nn_featxs</tt><big>(</big><em>nnindexer</em>, <em>qfx2_nnidx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.get_nn_featxs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_featxs" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_nnidx</strong> &#8211; (N x K) qfx2_idx[n][k] is the index of the kth
approximate nearest data vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(N x K) qfx2_fx[n][k] is the feature index (w.r.t the
source annotation) of the kth approximate
nearest data vector</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">qfx2_fx</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_fgws">
<tt class="descname">get_nn_fgws</tt><big>(</big><em>nnindexer</em>, <em>qfx2_nnidx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.get_nn_fgws"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_fgws" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_nnidx</strong> &#8211; (N x K) qfx2_idx[n][k] is the index of the kth
approximate nearest data vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(N x K) qfx2_fgw[n][k] is the annotation id index of the
kth forground weight</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">qfx2_fgw</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">()</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_nnidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_fgw</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">get_nn_fgws</span><span class="p">(</span><span class="n">qfx2_nnidx</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_vecs">
<tt class="descname">get_nn_vecs</tt><big>(</big><em>nnindexer</em>, <em>qfx2_nnidx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.get_nn_vecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.get_nn_vecs" title="Permalink to this definition">¶</a></dt>
<dd><p>gets matching vectors</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.knn">
<tt class="descname">knn</tt><big>(</big><em>nnindexer</em>, <em>qfx2_vec</em>, <em>K</em>, <em>checks=1028</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.knn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.knn" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qfx2_vec</strong> &#8211; (N x D) an array of N, D-dimensional query vectors</li>
<li><strong>K</strong> &#8211; number of approximate nearest neighbors to find</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Returns: tuple of (qfx2_idx, qfx2_dist)</dt>
<dd><dl class="first last docutils">
<dt>qfx2_idx <span class="classifier-delimiter">:</span> <span class="classifier">(N x K) qfx2_idx[n][k] is the index of the kth</span></dt>
<dd>approximate nearest data vector w.r.t qfx2_vec[n]</dd>
<dt>qfx2_dist <span class="classifier-delimiter">:</span> <span class="classifier">(N x K) qfx2_dist[n][k] is the distance to the kth</span></dt>
<dd>approximate nearest data vector w.r.t. qfx2_vec[n]</dd>
</dl>
</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_aid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_vecs_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="n">new_aid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checks</span> <span class="o">=</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">nnindexer</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.num_indexed_annots">
<tt class="descname">num_indexed_annots</tt><big>(</big><em>nnindexer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.num_indexed_annots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.num_indexed_annots" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.num_indexed_vecs">
<tt class="descname">num_indexed_vecs</tt><big>(</big><em>nnindexer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#NeighborIndex.num_indexed_vecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.num_indexed_vecs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.neighbor_index.NeighborIndex.rrr">
<tt class="descname">rrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#ibeis.model.hots.neighbor_index.NeighborIndex.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.neighbor_index.invert_index">
<tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">invert_index</tt><big>(</big><em>vecs_list</em>, <em>ax_list</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#invert_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.invert_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregates descriptors of input annotations and returns inverted information</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.neighbor_index.new_ibeis_nnindexer">
<tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">new_ibeis_nnindexer</tt><big>(</big><em>qreq_</em>, <em>_internal_daids=None</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#new_ibeis_nnindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.new_ibeis_nnindexer" title="Permalink to this definition">¶</a></dt>
<dd><p>CALLED BY QUERYREQUST::LOAD_INDEXER</p>
<p>TODO: naming convetion of <a href="#id1"><span class="problematic" id="id2">new_</span></a> sucks. use <a href="#id3"><span class="problematic" id="id4">request_</span></a> or
anything else.</p>
<p>FIXME: and use params from qparams instead of ibs.cfg</p>
<p>IBEIS interface into neighbor_index</p>
<p>new_ibeis_nnindexer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</li>
<li><strong>_aids</strong> (<em>list</em>) &#8211; for multiindexer use only
lets multindexer avoid shallow copies</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">nnindexer</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span> <span class="o">=</span> <span class="n">new_ibeis_nnindexer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.neighbor_index.new_neighbor_indexer">
<tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">new_neighbor_indexer</tt><big>(</big><em>aid_list=[]</em>, <em>vecs_list=[]</em>, <em>fgws_list=None</em>, <em>flann_params={}</em>, <em>flann_cachedir=None</em>, <em>indexer_cfgstr=''</em>, <em>hash_rowids=True</em>, <em>use_cache=True</em>, <em>use_params_hash=True</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#new_neighbor_indexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.new_neighbor_indexer" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">nnindexer</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.neighbor_index.rrr">
<tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">rrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#rrr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.neighbor_index.test_nnindexer">
<tt class="descclassname">ibeis.model.hots.neighbor_index.</tt><tt class="descname">test_nnindexer</tt><big>(</big><em>with_indexer=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/neighbor_index.html#test_nnindexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.neighbor_index.test_nnindexer" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.neighbor_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nnindexer</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_nnindexer</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.nn_weights">
<span id="ibeis-model-hots-nn-weights-module"></span><h2>ibeis.model.hots.nn_weights module<a class="headerlink" href="#module-ibeis.model.hots.nn_weights" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.model.hots.nn_weights.apply_normweight">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">apply_normweight</tt><big>(</big><em>normweight_fn</em>, <em>qaid</em>, <em>qfx2_idx</em>, <em>qfx2_dist</em>, <em>rule</em>, <em>K</em>, <em>Knorm</em>, <em>qreq_</em>, <em>with_metadata</em>, <em>metakey_metadata</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#apply_normweight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.apply_normweight" title="Permalink to this definition">¶</a></dt>
<dd><p>helper: applies the normalized weight function to one query annotation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>normweight_fn</strong> (<em>func</em>) &#8211; chosen weight function e.g. lnbnn</li>
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation id</li>
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">qfx2_normweight</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># SLOW_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;K&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s">&#39;Knorm&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;normalizer_rule&#39;</span><span class="p">:</span> <span class="s">&#39;name&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">testdata_nn_weights</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt0</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">K</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">Knorm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normweight_fn</span> <span class="o">=</span> <span class="n">lnbnn_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rule</span>  <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">normalizer_rule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">qaid2_nns</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">with_metadata</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metakey_metadata</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_normweight</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">apply_normweight</span><span class="p">(</span><span class="n">normweight_fn</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">qfx2_idx</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">qfx2_dist</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">Knorm</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">with_metadata</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">metakey_metadata</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Timeits:</dt>
<dd>%timeit qfx2_dist.T[0:K].T
%timeit qfx2_dist[:, 0:K]</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.componentwise_uint8_dot">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">componentwise_uint8_dot</tt><big>(</big><em>qfx2_qvec</em>, <em>qfx2_dvec</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#componentwise_uint8_dot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.componentwise_uint8_dot" title="Permalink to this definition">¶</a></dt>
<dd><p>a dot product is a componentwise multiplication of
two vector and then a sum. Do that for arbitary vectors.
Remember to cast uint8 to float32 and then divide by 255**2.
BUT THESE ARE SIFT DESCRIPTORS WHICH USE THE SMALL UINT8 TRICK
DIVIDE BY 512**2 instead</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.cos_match_weighter">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">cos_match_weighter</tt><big>(</big><em>qaid2_nns</em>, <em>qaid2_nnfilt0</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#cos_match_weighter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.cos_match_weighter" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">cos_weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">Knorm</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">testdata_nn_weights</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt0</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">cos_weight</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;bug setting custom params cos_weight&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_cos_weight</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">cos_match_weighter</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt0</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Dev::</dt>
<dd><p class="first">qnid = ibs.get_annot_name_rowids(qaid)
qfx2_nids = ibs.get_annot_name_rowids(<a href="#id5"><span class="problematic" id="id6">qreq_</span></a>.indexer.get_nn_aids(qfx2_idx.T[0:K].T))</p>
<p># remove first match
<a href="#id7"><span class="problematic" id="id8">qfx2_nids_</span></a> = qfx2_nids.T[1:].T
<a href="#id9"><span class="problematic" id="id10">qfx2_cos_</span></a>  = qfx2_cos.T[1:].T</p>
<p># flags of unverified &#8216;correct&#8217; matches
qfx2_samename = <a href="#id11"><span class="problematic" id="id12">qfx2_nids_</span></a> == qnid</p>
<dl class="last docutils">
<dt>for k in [1, None]:</dt>
<dd><dl class="first last docutils">
<dt>for alpha in [.01, .1, 1, 3, 10, 20, 50]:</dt>
<dd><p class="first">print(&#8216;&#8212;&#8212;-&#8216;)
print(&#8216;alpha = %r&#8217; % alpha)
print(&#8216;k = %r&#8217; % k)
qfx2_cosweight = np.multiply(np.sign(<a href="#id13"><span class="problematic" id="id14">qfx2_cos_</span></a>), np.power(<a href="#id15"><span class="problematic" id="id16">qfx2_cos_</span></a>, alpha))
if k is None:</p>
<blockquote>
<div>qfx2_weight = qfx2_cosweight
flag = qfx2_samename</div></blockquote>
<dl class="docutils">
<dt>else:</dt>
<dd>qfx2_weight = qfx2_cosweight.T[0:k].T
flag = qfx2_samename.T[0:k].T</dd>
</dl>
<p class="last">#print(qfx2_weight)
#print(flag)
<a href="#id17"><span class="problematic" id="id18">good_stats_</span></a> = ut.get_stats(qfx2_weight[flag])
<a href="#id19"><span class="problematic" id="id20">bad_stats_</span></a> = ut.get_stats(qfx2_weight[~flag])
print(&#8216;good_matches = &#8216; + ut.dict_str(<a href="#id21"><span class="problematic" id="id22">good_stats_</span></a>))
print(&#8216;bad_matchees = &#8216; + ut.dict_str(<a href="#id23"><span class="problematic" id="id24">bad_stats_</span></a>))
print(&#8216;diff_mean = &#8216; + str(good_stats_[&#8216;mean&#8217;] - bad_stats_[&#8216;mean&#8217;]))</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.dupvote_match_weighter">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">dupvote_match_weighter</tt><big>(</big><em>qaid2_nns</em>, <em>qaid2_nnfilt0</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#dupvote_match_weighter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.dupvote_match_weighter" title="Permalink to this definition">¶</a></dt>
<dd><p>dupvotes gives duplicate name votes a weight close to 0.</p>
<p>Each query feature is only allowed to vote for each name at most once.
IE: a query feature can vote for multiple names, but it cannot vote
for the same name twice.</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python dev.py &#8211;allgt -t best &#8211;db PZ_MTEST
python dev.py &#8211;allgt -t nsum &#8211;db PZ_MTEST
python dev.py &#8211;allgt -t dupvote &#8211;db PZ_MTEST</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#tup = nn_weights.testdata_nn_weights(&#39;testdb1&#39;, slice(0, 1), slice(0, 11))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;testdb1&#39;</span>  <span class="c"># &#39;GZ_ALL&#39;  # &#39;testdb1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">Knorm</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">codename</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">testdata_nn_weights</span><span class="p">(</span><span class="n">dbname</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt0</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Test Function Call</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_dupvote_weight</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">dupvote_match_weighter</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt0</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Check consistency</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags</span> <span class="o">=</span> <span class="n">qaid2_dupvote_weight</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_topnid</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_rowids</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">indexer</span><span class="o">.</span><span class="n">get_nn_aids</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">[</span><span class="n">qaid</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isunique_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">isunique</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">flag</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">flag</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">qfx2_topnid</span><span class="p">,</span> <span class="n">flags</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">isunique_list</span><span class="p">),</span> <span class="s">&#39;dupvote should only allow one vote per name&#39;</span>
</pre></div>
</div>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>./dev.py -t nsum &#8211;db GZ_ALL &#8211;show &#8211;va -w &#8211;qaid 1032
./dev.py -t nsum_nosv &#8211;db GZ_ALL &#8211;show &#8211;va -w &#8211;qaid 1032</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.fg_match_weighter">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">fg_match_weighter</tt><big>(</big><em>qaid2_nns</em>, <em>qaid2_nnfilt0</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#fg_match_weighter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.fg_match_weighter" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">featweight_on</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fg_weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">testdata_nn_weights</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt0</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">__dict__</span><span class="p">,</span> <span class="n">sorted_</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">featweight_on</span> <span class="o">==</span> <span class="bp">True</span><span class="p">,</span> <span class="s">&#39;bug setting custom params featweight_on&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">fg_weight</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;bug setting custom params fg_weight&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_fgvote_weight</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">fg_match_weighter</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt0</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.get_name_normalizers">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">get_name_normalizers</tt><big>(</big><em>qaid</em>, <em>qreq_</em>, <em>K</em>, <em>Knorm</em>, <em>qfx2_idx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#get_name_normalizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.get_name_normalizers" title="Permalink to this definition">¶</a></dt>
<dd><p>helper: normalizers for &#8216;name&#8217; rule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation id</li>
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">qfx2_normk</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">testdata_nn_weights</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt0</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_daids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">query_cfg</span><span class="o">.</span><span class="n">nn_cfg</span><span class="o">.</span><span class="n">K</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Knorm</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">query_cfg</span><span class="o">.</span><span class="n">nn_cfg</span><span class="o">.</span><span class="n">Knorm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normweight_fn</span> <span class="o">=</span> <span class="n">lnbnn_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">qaid2_nns</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_nndist</span> <span class="o">=</span> <span class="n">qfx2_dist</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">K</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.lnbnn_fn">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">lnbnn_fn</tt><big>(</big><em>vdist</em>, <em>ndist</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#lnbnn_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.lnbnn_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Locale Naive Bayes Nearest Neighbor weighting</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>  <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndist</span> <span class="o">=</span> <span class="n">ndists</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>  <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist1</span> <span class="o">=</span> <span class="n">vdist</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist2</span> <span class="o">=</span> <span class="n">vdist</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist3</span> <span class="o">=</span> <span class="n">vdist</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdist4</span> <span class="o">=</span> <span class="n">vdist</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">lnbnn_fn</span><span class="p">(</span><span class="n">vdist1</span><span class="p">,</span> <span class="n">ndist</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">lnbnn_fn</span><span class="p">(</span><span class="n">vdist2</span><span class="p">,</span> <span class="n">ndist</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">lnbnn_fn</span><span class="p">(</span><span class="n">vdist3</span><span class="p">,</span> <span class="n">ndist</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">lnbnn_fn</span><span class="p">(</span><span class="n">vdist4</span><span class="p">,</span> <span class="n">ndist</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.loglnbnn_fn">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">loglnbnn_fn</tt><big>(</big><em>vdist</em>, <em>ndist</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#loglnbnn_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.loglnbnn_fn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.logratio_fn">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">logratio_fn</tt><big>(</big><em>vdist</em>, <em>ndist</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#logratio_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.logratio_fn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.mark_name_valid_normalizers">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">mark_name_valid_normalizers</tt><big>(</big><em>qfx2_normnid</em>, <em>qfx2_topnid</em>, <em>qnid=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#mark_name_valid_normalizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.mark_name_valid_normalizers" title="Permalink to this definition">¶</a></dt>
<dd><p>helper: Allows matches only to the first result of a given name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qnid</strong> (<em>int</em>) &#8211; query name id</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qfx2_selnorm - index of the selected normalizer for each query feature</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.nn_normalized_weight">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">nn_normalized_weight</tt><big>(</big><em>normweight_fn</em>, <em>qaid2_nns</em>, <em>qaid2_nnfilt0</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#nn_normalized_weight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.nn_normalized_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Weights nearest neighbors using the chosen function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>normweight_fn</strong> (<em>func</em>) &#8211; chosen weight function e.g. lnbnn</li>
<li><strong>qaid2_nns</strong> (<em>dict</em>) &#8211; query descriptor nearest neighbors and distances. qaid -&gt; (qfx2_nnx, qfx2_dist)</li>
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">qaid2_weight</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.nn_weights</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">nn_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;PZ_MTEST&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">testdata_nn_weights</span><span class="p">(</span><span class="n">dbname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt0</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_daids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normweight_fn</span> <span class="o">=</span> <span class="n">lnbnn_fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_weight1</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">nn_normalized_weight</span><span class="p">(</span><span class="n">normweight_fn</span><span class="p">,</span> <span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt0</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights1</span> <span class="o">=</span> <span class="n">qaid2_weight1</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn_normonly_weight</span> <span class="o">=</span> <span class="n">nn_weights</span><span class="o">.</span><span class="n">NN_WEIGHT_FUNC_DICT</span><span class="p">[</span><span class="s">&#39;lnbnn&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_weight2</span> <span class="o">=</span> <span class="n">nn_normonly_weight</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt0</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights2</span> <span class="o">=</span> <span class="n">qaid2_weight2</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">weights1</span> <span class="o">==</span> <span class="n">weights2</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Ignore:</dt>
<dd>#from ibeis.model.hots import neighbor_index as hsnbrx
#nnindexer = hsnbrx.new_ibeis_nnindexer(<a href="#id25"><span class="problematic" id="id26">qreq_</span></a>)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.normonly_fn">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">normonly_fn</tt><big>(</big><em>vdist</em>, <em>ndist</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#normonly_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.normonly_fn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.ratio_fn">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">ratio_fn</tt><big>(</big><em>vdist</em>, <em>ndist</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#ratio_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.ratio_fn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.test_all_normalized_weights">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">test_all_normalized_weights</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#test_all_normalized_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.test_all_normalized_weights" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_all_normalized_weights</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.nn_weights.testdata_nn_weights">
<tt class="descclassname">ibeis.model.hots.nn_weights.</tt><tt class="descname">testdata_nn_weights</tt><big>(</big><em>dbname='testdb1'</em>, <em>qaid_list=None</em>, <em>daid_list=None</em>, <em>cfgdict={}</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/nn_weights.html#testdata_nn_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.nn_weights.testdata_nn_weights" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;testdb1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;fg_weight&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.pipeline">
<span id="ibeis-model-hots-pipeline-module"></span><h2>ibeis.model.hots.pipeline module<a class="headerlink" href="#module-ibeis.model.hots.pipeline" title="Permalink to this headline">¶</a></h2>
<p>Hotspotter pipeline module</p>
<p>Module Concepts:</p>
<div class="highlight-python"><div class="highlight"><pre>PREFIXES:
qaid2_XXX - prefix mapping query chip index to
qfx2_XXX  - prefix mapping query chip feature index to

TUPLES::
 * nns    - a (qfx2_idx, qfx2_dist) tuple
 * nnfilt - a (qfx2_fs, qfx2_valid) tuple

SCALARS::
 * idx    - the index into the nnindexers descriptors
 * dist   - the distance to a corresponding feature
 * fs     - a score of a corresponding feature
 * valid  - a valid bit for a corresponding feature

PIPELINE_VARS::
qaid2_nns - maping from query chip index to nns
{
 * qfx2_idx   - ranked list of query feature indexes to database feature indexes
 * qfx2_dist - ranked list of query feature indexes to database feature indexes
}

* qaid2_norm_weight - mapping from qaid to (qfx2_normweight, qfx2_selnorm)
         = qaid2_nnfilt[qaid]
</pre></div>
</div>
<dl class="function">
<dt id="ibeis.model.hots.pipeline.assert_qaid2_chipmatch">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">assert_qaid2_chipmatch</tt><big>(</big><em>ibs</em>, <em>qreq_</em>, <em>qaid2_chipmatch</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#assert_qaid2_chipmatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.assert_qaid2_chipmatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs consistency check</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.baseline_neighbor_filter">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">baseline_neighbor_filter</tt><big>(</big><em>qaid2_nns</em>, <em>qreq_</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#baseline_neighbor_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.baseline_neighbor_filter" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mapping from qaid to (qfx2_valid, qfx2_score) tuple</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">qaid2_nnfilt0</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;testdb1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">dbname</span><span class="o">=</span><span class="n">dbname</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pipeline</span><span class="o">.</span><span class="n">test_pipeline_upto</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">stop_node</span><span class="o">=</span><span class="s">&#39;baseline_neighbor_filter&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;baseline_neighbor_filter&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">locals_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;qaid2_nns&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nnfilt0</span> <span class="o">=</span> <span class="n">baseline_neighbor_filter</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
<p>Removes matches to self, the same image, or the same name.</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.build_chipmatches">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">build_chipmatches</tt><big>(</big><em>qaid2_nns</em>, <em>qaid2_nnfilt</em>, <em>qreq_</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#build_chipmatches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.build_chipmatches" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qaid2_nns</strong> &#8211; dict of assigned nearest features (only indexes are used here)</li>
<li><strong>qaid2_nnfilt</strong> &#8211; dict of (featmatch_scores, featmatch_mask)
where the scores and matches correspond to the assigned
nearest features</li>
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">feat match, feat score, feat rank</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">qaid2_chipmatch</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The prefix <tt class="docutils literal"><span class="pre">qaid2_</span></tt> denotes a mapping where keys are query-annotation-id</p>
<p>vsmany/vsone counts here. also this is where the filter
weights and thershold are applied to the matches. Essientally
nearest neighbors are converted into weighted assignments</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dupvote_weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="s">&#39;NAUT_test&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;build_chipmatches&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt</span> <span class="o">=</span> <span class="p">[</span><span class="n">locals_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;qaid2_nns&#39;</span><span class="p">,</span> <span class="s">&#39;qaid2_nnfilt&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">build_chipmatches</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.chipmatch_to_resdict">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">chipmatch_to_resdict</tt><big>(</big><em>qaid2_chipmatch</em>, <em>qreq_</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#chipmatch_to_resdict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.chipmatch_to_resdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a dictionary of chipmatch tuples into a dictionary of query results</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</li>
<li><strong>qaid2_scores</strong> (<em>dict</em>) &#8211; optional</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">qaid2_qres</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dupvote_weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">prescore_method</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">,</span> <span class="n">score_method</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;chipmatch_to_resdict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;qaid2_chipmatch_SVER&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">chipmatch_to_resdict</span><span class="p">(</span><span class="n">qaid2_chipmatch</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span> <span class="o">=</span> <span class="n">qaid2_qres</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.filter_neighbors">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">filter_neighbors</tt><big>(</big><em>qaid2_nns</em>, <em>qaid2_nnfilt0</em>, <em>filt2_weights</em>, <em>qreq_</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#filter_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.filter_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qaid2_nnfilt</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pipeline</span><span class="o">.</span><span class="n">rrr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dupvote_weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;filter_neighbors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">locals_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;qaid2_nns&#39;</span><span class="p">,</span> <span class="s">&#39;qaid2_nnfilt0&#39;</span><span class="p">,</span> <span class="s">&#39;filt2_weights&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt0</span><span class="p">,</span> <span class="n">filt2_weights</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nnfilt</span> <span class="o">=</span> <span class="n">filter_neighbors</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt0</span><span class="p">,</span> <span class="n">filt2_weights</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.get_pipeline_testdata">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">get_pipeline_testdata</tt><big>(</big><em>dbname=None</em>, <em>cfgdict={}</em>, <em>qaid_list=None</em>, <em>daid_list=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#get_pipeline_testdata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.get_pipeline_testdata" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">pipeline_root</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">,</span> <span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.get_prescore_shortlist">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">get_prescore_shortlist</tt><big>(</big><em>qaid</em>, <em>chipmatch</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#get_prescore_shortlist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.get_prescore_shortlist" title="Permalink to this definition">¶</a></dt>
<dd><p>computes which of the annotations should continue in the next pipeline step</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.identity_filter">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">identity_filter</tt><big>(</big><em>qaid2_nns</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#identity_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.identity_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>testing function returns unfiltered nearest neighbors
this does check that you are not matching yourself</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.nearest_neighbors">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">nearest_neighbors</tt><big>(</big><em>qreq_</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#nearest_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.nearest_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Plain Nearest Neighbors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qaid2_nnds - a dict mapping query annnotation-ids to a nearest
neighbor tuple (indexes, dists). indexes and dist have the shape
(nDesc x K) where nDesc is the number of descriptors in the
annotation, and K is the number of approximate nearest neighbors.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pipeline</span><span class="o">.</span><span class="n">rrr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#cfgdict = dict(codename=&#39;vsone&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;testdb1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">dbname</span><span class="o">=</span><span class="n">dbname</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nns</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">nearest_neighbors</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Asserts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.new_fmfsfk">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">new_fmfsfk</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#new_fmfsfk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.new_fmfsfk" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.precompute_topx2_dlen_sqrd">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">precompute_topx2_dlen_sqrd</tt><big>(</big><em>qreq_</em>, <em>aid2_fm</em>, <em>topx2_aid</em>, <em>topx2_kpts</em>, <em>nRerank</em>, <em>use_chip_extent</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#precompute_topx2_dlen_sqrd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.precompute_topx2_dlen_sqrd" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for spatial verification, computes the squared diagonal length of
matching chips</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">topx2_dlen_sqrd</td>
</tr>
</tbody>
</table>
<p># TODO: decouple example</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;spatial_verification&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;qaid2_chipmatch_FILT&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipmatch</span> <span class="o">=</span> <span class="n">qaid2_chipmatch</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topx2_aid</span><span class="p">,</span> <span class="n">nRerank</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_prescore_shortlist</span><span class="p">(</span><span class="n">qaid</span><span class="p">,</span> <span class="n">chipmatch</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">daid2_fm</span><span class="p">,</span> <span class="n">daid2_fs</span><span class="p">,</span> <span class="n">daid2_fk</span><span class="p">)</span> <span class="o">=</span> <span class="n">chipmatch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kpts1</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_kpts</span><span class="p">(</span><span class="n">qaid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topx2_kpts</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_kpts</span><span class="p">(</span><span class="n">topx2_aid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_chip_extent</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topx2_dlen_sqrd</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">precompute_topx2_dlen_sqrd</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="n">daid2_fm</span><span class="p">,</span> <span class="n">topx2_aid</span><span class="p">,</span> <span class="n">topx2_kpts</span><span class="p">,</span> <span class="n">nRerank</span><span class="p">,</span> <span class="n">use_chip_extent</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.prescore_nsum">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">prescore_nsum</tt><big>(</big><em>qreq_</em>, <em>daid2_prescore</em>, <em>nShortlist</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#prescore_nsum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.prescore_nsum" title="Permalink to this definition">¶</a></dt>
<dd><p># TODO : rectify with code in hots_query_result</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.remove_impossible_votes">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">remove_impossible_votes</tt><big>(</big><em>qaid</em>, <em>qfx2_nnidx</em>, <em>qreq_</em>, <em>cant_match_self</em>, <em>cant_match_sameimg</em>, <em>cant_match_samename</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#remove_impossible_votes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.remove_impossible_votes" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove matches to self or same image</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.request_ibeis_query_L0">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">request_ibeis_query_L0</tt><big>(</big><em>ibs</em>, <em>qreq_</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#request_ibeis_query_L0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.request_ibeis_query_L0" title="Permalink to this definition">¶</a></dt>
<dd><p>Driver logic of query pipeline</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ibs</strong> (<em>IBEISController</em>) &#8211; IBEIS database object to be queried</li>
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters. use <tt class="docutils literal"><span class="pre">prep_qreq</span></tt> to create one</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(dict of QueryResult): qaid2_qres mapping from query indexes to Query Result Objects</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># one-vs-many:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsmany&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">request_ibeis_query_L0</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span> <span class="o">=</span> <span class="n">qaid2_qres</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">qaid2_qres</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--show&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">qres</span><span class="o">.</span><span class="n">show_analysis</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">make_figtitle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qres</span><span class="o">.</span><span class="n">get_inspect_str</span><span class="p">())</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># one-vs-one:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># pipeline.rrr()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;vsone&#39;</span><span class="p">,</span> <span class="n">sv_on</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs1</span><span class="p">,</span> <span class="n">qreq_1</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qreq_1</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres1</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">request_ibeis_query_L0</span><span class="p">(</span><span class="n">ibs1</span><span class="p">,</span> <span class="n">qreq_1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres1</span> <span class="o">=</span> <span class="n">qaid2_qres1</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">qaid2_qres1</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s">&#39;--show&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ut</span><span class="o">.</span><span class="n">inIPython</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">qres1</span><span class="o">.</span><span class="n">show_analysis</span><span class="p">(</span><span class="n">ibs1</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">make_figtitle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qres1</span><span class="o">.</span><span class="n">get_inspect_str</span><span class="p">())</span>
</pre></div>
</div>
<p>python -m ibeis.model.hots.pipeline &#8211;test-request_ibeis_query_L0</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.save_resdict">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">save_resdict</tt><big>(</big><em>qreq_</em>, <em>qaid2_qres</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#save_resdict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.save_resdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a dictionary of query results to disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.score_chipmatch">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">score_chipmatch</tt><big>(</big><em>qaid</em>, <em>chipmatch</em>, <em>score_method</em>, <em>qreq_</em>, <em>isprescore</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#score_chipmatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.score_chipmatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns scores to database annotation ids for a particualry query&#8217;s
chipmatch</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qaid</strong> (<em>int</em>) &#8211; query annotation id</li>
<li><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</li>
<li><strong>isprescore</strong> (<em>bool</em>) &#8211; flag</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">scores for each database id w.r.t. a single query</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">daid2_score</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.pipeline</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># PRESCORE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;spatial_verification&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;qaid2_chipmatch_FILT&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipmatch</span> <span class="o">=</span> <span class="n">qaid2_chipmatch</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_method</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">prescore_method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isprescore</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid2_score_pre</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">score_chipmatch</span><span class="p">(</span><span class="n">qaid</span><span class="p">,</span> <span class="n">chipmatch</span><span class="p">,</span> <span class="n">score_method</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">isprescore</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># POSTSCORE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">utool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;chipmatch_to_resdict&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;qaid2_chipmatch_SVER&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chipmatch</span> <span class="o">=</span> <span class="n">qaid2_chipmatch</span><span class="p">[</span><span class="n">qaid</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_method</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">score_method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isprescore</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid2_score_post</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">score_chipmatch</span><span class="p">(</span><span class="n">qaid</span><span class="p">,</span> <span class="n">chipmatch</span><span class="p">,</span> <span class="n">score_method</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">isprescore</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.spatial_verification">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">spatial_verification</tt><big>(</big><em>qaid2_chipmatch</em>, <em>qreq_</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#spatial_verification"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.spatial_verification" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dict or tuple(dict, dict)</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dupvote_weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">prescore_method</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">,</span> <span class="n">score_method</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;spatial_verification&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_chipmatch</span> <span class="o">=</span> <span class="n">locals_</span><span class="p">[</span><span class="s">&#39;qaid2_chipmatch_FILT&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spatial_verification</span><span class="p">(</span><span class="n">qaid2_chipmatch</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.testrun_pipeline_upto">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">testrun_pipeline_upto</tt><big>(</big><em>qreq_</em>, <em>stop_node=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#testrun_pipeline_upto"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.testrun_pipeline_upto" title="Permalink to this definition">¶</a></dt>
<dd><p>convinience: runs pipeline for tests</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.try_load_resdict">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">try_load_resdict</tt><big>(</big><em>qreq_</em>, <em>force_miss=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#try_load_resdict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.try_load_resdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Try and load the result structures for each query.
returns a list of failed qaids</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(qaid2_qres_hit, cachemiss_qaids)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.pipeline.weight_neighbors">
<tt class="descclassname">ibeis.model.hots.pipeline.</tt><tt class="descname">weight_neighbors</tt><big>(</big><em>qaid2_nns</em>, <em>qaid2_nnfilt0</em>, <em>qreq_</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/pipeline.html#weight_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.pipeline.weight_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>PIPELINE NODE 3</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qreq</strong> (<em>QueryRequest</em>) &#8211; hyper-parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">filt2_weights</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pipeline</span><span class="o">.</span><span class="n">rrr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#cfgdict = dict(codename=&#39;vsone&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;nsum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># dbname = &#39;GZ_ALL&#39;  # &#39;testdb1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;testdb1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">get_pipeline_testdata</span><span class="p">(</span><span class="n">dbname</span><span class="o">=</span><span class="n">dbname</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">testrun_pipeline_upto</span><span class="p">(</span><span class="n">qreq_</span><span class="p">,</span> <span class="s">&#39;weight_neighbors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">locals_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;qaid2_nns&#39;</span><span class="p">,</span> <span class="s">&#39;qaid2_nnfilt0&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt0</span>  <span class="o">=</span> <span class="n">args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filt2_weights</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">weight_neighbors</span><span class="p">(</span><span class="n">qaid2_nns</span><span class="p">,</span> <span class="n">qaid2_nnfilt0</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.precision_recall">
<span id="ibeis-model-hots-precision-recall-module"></span><h2>ibeis.model.hots.precision_recall module<a class="headerlink" href="#module-ibeis.model.hots.precision_recall" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.model.hots.precision_recall.get_average_percision_">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">get_average_percision_</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#get_average_percision_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.get_average_percision_" title="Permalink to this definition">¶</a></dt>
<dd><p>gets average percision using the PASCAL definition</p>
<p>FIXME: Use only the groundtruth that could have been matched in the
database. (shouldn&#8217;t be an issue until we start using daid subsets)</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Information_retrieval">http://en.wikipedia.org/wiki/Information_retrieval</a></p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.precision_recall.get_interpolated_precision_vs_recall_">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">get_interpolated_precision_vs_recall_</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#get_interpolated_precision_vs_recall_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.get_interpolated_precision_vs_recall_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.precision_recall.get_nFalseNegative">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">get_nFalseNegative</tt><big>(</big><em>TP</em>, <em>atrank</em>, <em>nGroundTruth</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#get_nFalseNegative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.get_nFalseNegative" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of documents we should have retrieved but didn&#8217;t</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.precision_recall.get_nFalsePositive">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">get_nFalsePositive</tt><big>(</big><em>TP</em>, <em>atrank</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#get_nFalsePositive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.get_nFalsePositive" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of documents we should not have retrieved</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.precision_recall.get_nTruePositive">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">get_nTruePositive</tt><big>(</big><em>atrank</em>, <em>was_retrieved</em>, <em>gt_ranks</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#get_nTruePositive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.get_nTruePositive" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of documents we got right</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.precision_recall.get_precision">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">get_precision</tt><big>(</big><em>TP</em>, <em>FP</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#get_precision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.get_precision" title="Permalink to this definition">¶</a></dt>
<dd><p>precision positive predictive value</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.precision_recall.get_precision_recall_curve_">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">get_precision_recall_curve_</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#get_precision_recall_curve_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.get_precision_recall_curve_" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.hots_query_result</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()[</span><span class="mi">14</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid2_qres</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">_query_chips4</span><span class="p">(</span><span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres</span> <span class="o">=</span> <span class="n">qaid2_qres</span><span class="p">[</span><span class="n">qaids</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt_aids</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atrank</span>  <span class="o">=</span> <span class="mi">18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">precision_curve</span><span class="p">,</span> <span class="n">recall_curve</span> <span class="o">=</span> <span class="n">qres</span><span class="o">.</span><span class="n">get_precision_recall_curve</span><span class="p">(</span><span class="n">ibs</span><span class="o">=</span><span class="n">ibs</span><span class="p">,</span> <span class="n">gt_aids</span><span class="o">=</span><span class="n">gt_aids</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Precision_and_recall">http://en.wikipedia.org/wiki/Precision_and_recall</a></p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.precision_recall.get_recall">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">get_recall</tt><big>(</big><em>TP</em>, <em>FN</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#get_recall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.get_recall" title="Permalink to this definition">¶</a></dt>
<dd><p>recall, true positive rate, sensitivity, hit rate</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.precision_recall.show_precision_recall_curve_">
<tt class="descclassname">ibeis.model.hots.precision_recall.</tt><tt class="descname">show_precision_recall_curve_</tt><big>(</big><em>qres</em>, <em>ibs=None</em>, <em>gt_aids=None</em>, <em>fnum=1</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/precision_recall.html#show_precision_recall_curve_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.precision_recall.show_precision_recall_curve_" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.hots_query_result</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.query_helpers">
<span id="ibeis-model-hots-query-helpers-module"></span><h2>ibeis.model.hots.query_helpers module<a class="headerlink" href="#module-ibeis.model.hots.query_helpers" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.model.hots.query_helpers.check_sift_desc">
<tt class="descclassname">ibeis.model.hots.query_helpers.</tt><tt class="descname">check_sift_desc</tt><big>(</big><em>desc</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_helpers.html#check_sift_desc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_helpers.check_sift_desc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.query_helpers.data_index_integrity">
<tt class="descclassname">ibeis.model.hots.query_helpers.</tt><tt class="descname">data_index_integrity</tt><big>(</big><em>ibs</em>, <em>qreq</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_helpers.html#data_index_integrity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_helpers.data_index_integrity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.query_helpers.get_query_components">
<tt class="descclassname">ibeis.model.hots.query_helpers.</tt><tt class="descname">get_query_components</tt><big>(</big><em>ibs</em>, <em>qaids</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_helpers.html#get_query_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_helpers.get_query_components" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.query_request">
<span id="ibeis-model-hots-query-request-module"></span><h2>ibeis.model.hots.query_request module<a class="headerlink" href="#module-ibeis.model.hots.query_request" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibeis.model.hots.query_request.QueryParams">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.query_request.</tt><tt class="descname">QueryParams</tt><big>(</big><em>qparams</em>, <em>cfg</em>, <em>cfgdict=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<blockquote>
<div><p>Structure to store static query pipeline parameters
parses nested config structure into this flat one</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.query_request &#8211;test-QueryParams</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">query_request</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">query_cfg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#cfg.pipeline_root = &#39;asmk&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;pipeline_root&#39;</span><span class="p">:</span> <span class="s">&#39;asmk&#39;</span><span class="p">,</span> <span class="s">&#39;sv_on&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
<span class="gp">... </span>           <span class="s">&#39;fg_weight&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s">&#39;featweight_on&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qparams</span> <span class="o">=</span> <span class="n">query_request</span><span class="o">.</span><span class="n">QueryParams</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qparams</span><span class="o">.</span><span class="n">fg_weight</span> <span class="o">==</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qparams</span><span class="o">.</span><span class="n">pipeline_root</span> <span class="o">==</span> <span class="s">&#39;smk&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qparams</span><span class="o">.</span><span class="n">featweight_on</span> <span class="ow">is</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;)_</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt>&#8216;.join(result.split(&#8216;)_&#8217;)))</dt>
<dd>_smk_SMK(agg=True,t=0.0,a=3.0,idf)_
VocabAssign(nAssign=10,a=1.2,s=None,eqw=T)_
VocabTrain(nWords=8000,init=akmeans++,nIters=128,taids=all)_
SV(OFF)_
FEATWEIGHT(ON,uselabel,rf)_
FEAT(<a href="#id27"><span class="problematic" id="id28">hesaff+sift_</span></a>)_
CHIP(sz450)</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="ibeis.model.hots.query_request.QueryRequest">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.query_request.</tt><tt class="descname">QueryRequest</tt><big>(</big><em>qreq_</em>, <em>qaid_list</em>, <em>quuid_list</em>, <em>daid_list</em>, <em>duuid_list</em>, <em>qparams</em>, <em>qresdir</em>, <em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.assert_self">
<tt class="descname">assert_self</tt><big>(</big><em>qreq_</em>, <em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.assert_self"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.assert_self" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.ensure_featweights">
<tt class="descname">ensure_featweights</tt><big>(</big><em>qreq_</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.ensure_featweights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.ensure_featweights" title="Permalink to this definition">¶</a></dt>
<dd><p>ensure feature weights are computed</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_cfgstr">
<tt class="descname">get_cfgstr</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_data_hashid">
<tt class="descname">get_data_hashid</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_data_hashid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_data_hashid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_external_daids">
<tt class="descname">get_external_daids</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_external_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_external_daids" title="Permalink to this definition">¶</a></dt>
<dd><p>These are the users daids in vsone mode</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_external_duuids">
<tt class="descname">get_external_duuids</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_external_duuids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_external_duuids" title="Permalink to this definition">¶</a></dt>
<dd><p>These are the users qauuids in vsone mode</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_external_qaids">
<tt class="descname">get_external_qaids</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_external_qaids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_external_qaids" title="Permalink to this definition">¶</a></dt>
<dd><p>These are the users qaids in vsone mode</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_external_quuids">
<tt class="descname">get_external_quuids</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_external_quuids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_external_quuids" title="Permalink to this definition">¶</a></dt>
<dd><p>These are the users qauuids in vsone mode</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_internal_daids">
<tt class="descname">get_internal_daids</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_internal_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_internal_daids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_internal_data_hashid">
<tt class="descname">get_internal_data_hashid</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_internal_data_hashid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_internal_data_hashid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_internal_duuids">
<tt class="descname">get_internal_duuids</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_internal_duuids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_internal_duuids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_internal_qaids">
<tt class="descname">get_internal_qaids</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_internal_qaids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_internal_qaids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_internal_quuids">
<tt class="descname">get_internal_quuids</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_internal_quuids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_internal_quuids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_qresdir">
<tt class="descname">get_qresdir</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_qresdir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_qresdir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_query_hashid">
<tt class="descname">get_query_hashid</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_query_hashid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_query_hashid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.get_unique_species">
<tt class="descname">get_unique_species</tt><big>(</big><em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.get_unique_species"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.get_unique_species" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.lazy_load">
<tt class="descname">lazy_load</tt><big>(</big><em>qreq_</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.lazy_load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.lazy_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs preloading of all data needed for a batch of queries</p>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.load_indexer">
<tt class="descname">load_indexer</tt><big>(</big><em>qreq_</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.load_indexer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.load_indexer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.load_score_normalizer">
<tt class="descname">load_score_normalizer</tt><big>(</big><em>qreq_</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.load_score_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.load_score_normalizer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.rrr">
<tt class="descname">rrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.set_external_daids">
<tt class="descname">set_external_daids</tt><big>(</big><em>qreq_</em>, <em>daid_list</em>, <em>duuid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.set_external_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.set_external_daids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.set_external_qaids">
<tt class="descname">set_external_qaids</tt><big>(</big><em>qreq_</em>, <em>qaid_list</em>, <em>quuid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.set_external_qaids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.set_external_qaids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.set_internal_daids">
<tt class="descname">set_internal_daids</tt><big>(</big><em>qreq_</em>, <em>daid_list</em>, <em>duuid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.set_internal_daids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.set_internal_daids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.set_internal_qaids">
<tt class="descname">set_internal_qaids</tt><big>(</big><em>qreq_</em>, <em>qaid_list</em>, <em>quuid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.set_internal_qaids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.set_internal_qaids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.query_request.QueryRequest.shallowcopy">
<tt class="descname">shallowcopy</tt><big>(</big><em>qreq_</em>, <em>qx=None</em>, <em>dx=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#QueryRequest.shallowcopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.QueryRequest.shallowcopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a copy of qreq with the same qparams object and a subset of the qx
and dx objects.
used to generate chunks of vsone queries</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">get_test_qreq</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq2_</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">shallowcopy</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_daids</span><span class="p">()</span> <span class="ow">is</span> <span class="n">qreq2_</span><span class="o">.</span><span class="n">get_external_daids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">())</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qreq2_</span><span class="o">.</span><span class="n">get_external_qaids</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">qreq2_</span><span class="o">.</span><span class="n">metadata</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.query_request.apply_species_with_detector_hack">
<tt class="descclassname">ibeis.model.hots.query_request.</tt><tt class="descname">apply_species_with_detector_hack</tt><big>(</big><em>ibs</em>, <em>cfgdict</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#apply_species_with_detector_hack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.apply_species_with_detector_hack" title="Permalink to this definition">¶</a></dt>
<dd><p>HACK turns of featweights if they cannot be applied</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.query_request.get_test_qreq">
<tt class="descclassname">ibeis.model.hots.query_request.</tt><tt class="descname">get_test_qreq</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#get_test_qreq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.get_test_qreq" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.query_request.new_ibeis_query_request">
<tt class="descclassname">ibeis.model.hots.query_request.</tt><tt class="descname">new_ibeis_query_request</tt><big>(</big><em>ibs</em>, <em>qaid_list</em>, <em>daid_list</em>, <em>cfgdict=None</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#new_ibeis_query_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.new_ibeis_query_request" title="Permalink to this definition">¶</a></dt>
<dd><p>ibeis entry point to create a new query request object</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python -m ibeis.model.hots.query_request &#8211;test-new_ibeis_query_request</dd>
<dt>Example1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;sv_on&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;fg_weight&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s">&#39;featweight_on&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Execute test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">new_ibeis_query_request</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Check Results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">fg_weight</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span>
<span class="gp">... </span>   <span class="s">&#39;qreq_.qparams.fg_weight = </span><span class="si">%r</span><span class="s"> &#39;</span> <span class="o">%</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">fg_weight</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">sv_on</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">,</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;qreq_.qparams.sv_on = </span><span class="si">%r</span><span class="s"> &#39;</span> <span class="o">%</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">sv_on</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datahashid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_data_hashid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_dbname</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">dbname</span> <span class="o">+</span> <span class="n">datahashid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">PZ_MTEST_DUUIDS((5)q87ho9a0@9s02imh)</span>
</pre></div>
</div>
</dd>
<dt>Example2:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;NAUT_test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;sv_on&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">&#39;fg_weight&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s">&#39;featweight_on&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Execute test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">new_ibeis_query_request</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaids</span><span class="p">,</span> <span class="n">daids</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Check Results.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Featweight should be off because there is no Naut detector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">query_cfgstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">fg_weight</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">,</span> <span class="p">(</span>
<span class="gp">... </span>   <span class="s">&#39;qreq_.qparams.fg_weight = </span><span class="si">%r</span><span class="s"> &#39;</span> <span class="o">%</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">fg_weight</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">sv_on</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">,</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;qreq_.qparams.sv_on = </span><span class="si">%r</span><span class="s"> &#39;</span> <span class="o">%</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">qparams</span><span class="o">.</span><span class="n">sv_on</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datahashid</span> <span class="o">=</span> <span class="n">qreq_</span><span class="o">.</span><span class="n">get_data_hashid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_dbname</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">dbname</span> <span class="o">+</span> <span class="n">datahashid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">NAUT_test_DUUIDS((5)4e972cjxcj30a8u1)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.query_request.test_cfg_deepcopy">
<tt class="descclassname">ibeis.model.hots.query_request.</tt><tt class="descname">test_cfg_deepcopy</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/query_request.html#test_cfg_deepcopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.query_request.test_cfg_deepcopy" title="Permalink to this definition">¶</a></dt>
<dd><p>TESTING FUNCTION</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.query_request</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">test_cfg_deepcopy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.score_normalization">
<span id="ibeis-model-hots-score-normalization-module"></span><h2>ibeis.model.hots.score_normalization module<a class="headerlink" href="#module-ibeis.model.hots.score_normalization" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>GOALS:</dt>
<dd><ol class="first arabic simple">
<li>vsmany
* works resaonable for very few and very many
* stars with small k and then k becomes a percent or log percent
* distinctiveness from different location</li>
<li>1-vs-1
* uses distinctivness and foreground when available
* start with ratio test and ransac</li>
<li>First N decision are interactive until we learn a good threshold</li>
</ol>
<p>4) Always show numbers between 0 and 1 spatial verification is based on
single best exemplar</p>
<blockquote>
<div>x - build normalizer
x - test normalizer
x - monotonicity (both nondecreasing and strictly increasing)
x - cache normalizer
x - cache maitainance (deleters and listers)
o - Incemental learning
o - Spceies sensitivity</div></blockquote>
<ol class="arabic simple" start="5">
<li>Add exemplars that are distinct from exiting (matches below threshold)</li>
</ol>
<p class="last">(no rebuilding ing kd-tree for each image)</p>
</dd>
</dl>
<dl class="class">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">ScoreNormalizer</tt><big>(</big><em>normalizer</em>, <em>cfgstr=None</em>, <em>score_domain=None</em>, <em>p_tp_given_score=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">utool.util_cache.Cachable</span></tt></p>
<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.get_cfgstr">
<tt class="descname">get_cfgstr</tt><big>(</big><em>normalizer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer.get_cfgstr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.get_cfgstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.get_prefix">
<tt class="descname">get_prefix</tt><big>(</big><em>normalizer</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer.get_prefix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.get_prefix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.normalize_score">
<tt class="descname">normalize_score</tt><big>(</big><em>normalizer</em>, <em>score</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer.normalize_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.normalize_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.normalize_score_list">
<tt class="descname">normalize_score_list</tt><big>(</big><em>normalizer</em>, <em>score_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer.normalize_score_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.normalize_score_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.prefix">
<tt class="descname">prefix</tt><em class="property"> = 'normalizer_'</em><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.prefix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.rrr">
<tt class="descname">rrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.set_values">
<tt class="descname">set_values</tt><big>(</big><em>normalizer</em>, <em>score_domain</em>, <em>p_tp_given_score</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer.set_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.set_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.score_normalization.ScoreNormalizer.visualize">
<tt class="descname">visualize</tt><big>(</big><em>normalizer</em>, <em>update=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#ScoreNormalizer.visualize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.ScoreNormalizer.visualize" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalizer</span> <span class="o">=</span> <span class="n">load_precomputed_normalizer</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalizer</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.cached_ibeis_score_normalizer">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">cached_ibeis_score_normalizer</tt><big>(</big><em>ibs</em>, <em>qaid_list</em>, <em>qres_list</em>, <em>use_cache=True</em>, <em>**learnkw</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#cached_ibeis_score_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.cached_ibeis_score_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qaid2_qres</strong> (<em>int</em>) &#8211; query annotation id</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;PZ_MTEST&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">dbname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_list</span> <span class="o">=</span> <span class="n">daid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s">&#39;nsum_unnorm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qres_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">query_chips</span><span class="p">(</span><span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_normalizer</span> <span class="o">=</span> <span class="n">cached_ibeis_score_normalizer</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">qres_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">score_normalizer</span><span class="o">.</span><span class="n">get_fname</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">normalizer_PZ_MTEST_UUIDS((9)t4g!b5zov%chc%+v).cPkl</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.delete_all_learned_normalizers">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">delete_all_learned_normalizers</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#delete_all_learned_normalizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.delete_all_learned_normalizers" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python ibeis/model/hots/score_normalization.py &#8211;test-delete_all_learned_normalizers &#8211;enableall</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">score_normalization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score_normalization</span><span class="o">.</span><span class="n">delete_all_learned_normalizers</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.find_score_maxclip">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">find_score_maxclip</tt><big>(</big><em>truepos_scores</em>, <em>trueneg_scores</em>, <em>clip_factor=2.6180339887499997</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#find_score_maxclip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.find_score_maxclip" title="Permalink to this definition">¶</a></dt>
<dd><p>returns score to clip true positives past.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">clip_score</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">truepos_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">50000</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trueneg_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">110</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clip_score</span> <span class="o">=</span> <span class="n">find_score_maxclip</span><span class="p">(</span><span class="n">truepos_scores</span><span class="p">,</span> <span class="n">trueneg_scores</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">clip_score</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">287.983738762</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.get_ibeis_score_training_data">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">get_ibeis_score_training_data</tt><big>(</big><em>ibs</em>, <em>qaid_list</em>, <em>qres_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#get_ibeis_score_training_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.get_ibeis_score_training_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns &#8220;good&#8221; taining examples</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.inspect_pdfs">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">inspect_pdfs</tt><big>(</big><em>trueneg_scores</em>, <em>truepos_scores</em>, <em>score_domain</em>, <em>p_tp_given_score</em>, <em>p_tn_given_score</em>, <em>p_score_given_tp</em>, <em>p_score_given_tn</em>, <em>p_score</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#inspect_pdfs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.inspect_pdfs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.learn_ibeis_score_normalizer">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">learn_ibeis_score_normalizer</tt><big>(</big><em>ibs</em>, <em>qaid_list</em>, <em>qres_list</em>, <em>cfgstr</em>, <em>**learnkw</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#learn_ibeis_score_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.learn_ibeis_score_normalizer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.learn_score_normalization">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">learn_score_normalization</tt><big>(</big><em>truepos_scores</em>, <em>trueneg_scores</em>, <em>gridsize=1024</em>, <em>adjust=8</em>, <em>return_all=False</em>, <em>monotonize=True</em>, <em>clip_factor=2.6180339887499997</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#learn_score_normalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.learn_score_normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes collected data and applys parzen window density estimation and bayes rule.</p>
<p>learn_score_normalization</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gridsize</strong> (<em>int</em>) &#8211; default 512</li>
<li><strong>adjust</strong> (<em>int</em>) &#8211; default 8</li>
<li><strong>return_all</strong> (<em>bool</em>) &#8211; default False</li>
<li><strong>monotonize</strong> (<em>bool</em>) &#8211; default True</li>
<li><strong>clip_factor</strong> (<em>float</em>) &#8211; default phi ** 2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(score_domain, p_tp_given_score, p_tn_given_score, p_score_given_tp, p_score_given_tn, p_score, clip_score)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">truepos_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trueneg_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">score_domain</span><span class="p">,</span> <span class="n">p_tp_given_score</span><span class="p">)</span> <span class="o">=</span> <span class="n">learn_score_normalization</span><span class="p">(</span><span class="n">truepos_scores</span><span class="p">,</span> <span class="n">trueneg_scores</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p_tp_given_score</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">92</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.list_available_score_normalizers">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">list_available_score_normalizers</tt><big>(</big><em>with_global=True</em>, <em>with_local=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#list_available_score_normalizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.list_available_score_normalizers" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python ibeis/model/hots/score_normalization.py &#8211;test-list_available_score_normalizers &#8211;enableall</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">local_normalizers_fpaths</span> <span class="o">=</span> <span class="n">list_available_score_normalizers</span><span class="p">(</span><span class="n">with_global</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">global_normalizers_fpaths</span> <span class="o">=</span> <span class="n">list_available_score_normalizers</span><span class="p">(</span><span class="n">with_local</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># quote them</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># local_normalizers_fpaths = [&#39;&quot;%s&quot;&#39; % fpath for fpath in local_normalizers_fpaths]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># global_normalizers_fpaths = [&#39;&quot;%s&quot;&#39; % fpath for fpath in global_normalizers_fpaths]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Available LOCAL normalizers: &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">indentjoin</span><span class="p">(</span><span class="n">local_normalizers_fpaths</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">  &#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;Available GLOBAL normalizers: &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">indentjoin</span><span class="p">(</span><span class="n">global_normalizers_fpaths</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">  &#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#  [ut.delete(fpath) for fpath in local_normalizers_fpaths]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#  [ut.delete(fpath) for fpath in global_normalizers_fpaths]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.load_precomputed_normalizer">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">load_precomputed_normalizer</tt><big>(</big><em>ibs</em>, <em>choice</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#load_precomputed_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.load_precomputed_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalizer</span> <span class="o">=</span> <span class="n">load_precomputed_normalizer</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.parse_available_normalizers">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">parse_available_normalizers</tt><big>(</big><em>ibs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#parse_available_normalizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.parse_available_normalizers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.request_ibeis_normalizer">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">request_ibeis_normalizer</tt><big>(</big><em>qreq_</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#request_ibeis_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.request_ibeis_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">query_request</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s">&#39;PZ_MTEST&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qaid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">daid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="n">n</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfgdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;codename&#39;</span><span class="p">:</span> <span class="s">&#39;nsum_unnorm&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qreq_</span> <span class="o">=</span> <span class="n">query_request</span><span class="o">.</span><span class="n">new_ibeis_query_request</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">qaid_list</span><span class="p">,</span> <span class="n">daid_list</span><span class="p">,</span> <span class="n">cfgdict</span><span class="o">=</span><span class="n">cfgdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalizer</span> <span class="o">=</span> <span class="n">request_ibeis_normalizer</span><span class="p">(</span><span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.test">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">test</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.test" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.test_score_normalization">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">test_score_normalization</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#test_score_normalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.test_score_normalization" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>CommandLine:</dt>
<dd>python ibeis/model/hots/score_normalization.py &#8211;test-test_score_normalization &#8211;enableall</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#from ibeis.model.hots import score_normalization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#score_normalization.rrr()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>   <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locals_</span> <span class="o">=</span> <span class="n">test_score_normalization</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">execstr</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">execstr_dict</span><span class="p">(</span><span class="n">locals_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#print(execstr)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">exec</span><span class="p">(</span><span class="n">execstr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">exec</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">present</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.train_baseline_for_all_dbs">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">train_baseline_for_all_dbs</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#train_baseline_for_all_dbs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.train_baseline_for_all_dbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs unnormalized queries to compute normalized queries</p>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python ibeis/model/hots/score_normalization.py &#8211;test-train_baseline_for_all_dbs &#8211;enableall</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_baseline_for_all_dbs</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.score_normalization.train_baseline_ibeis_normalizer">
<tt class="descclassname">ibeis.model.hots.score_normalization.</tt><tt class="descname">train_baseline_ibeis_normalizer</tt><big>(</big><em>ibs</em>, <em>use_cache=True</em>, <em>**learnkw</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/score_normalization.html#train_baseline_ibeis_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.score_normalization.train_baseline_ibeis_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs unnormalized queries to compute normalized queries</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">normalizer</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ScoreNormalizer</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python ibeis/model/hots/score_normalization.py &#8211;test-train_baseline_ibeis_normalizer &#8211;enableall
python ibeis/model/hots/score_normalization.py &#8211;test-train_baseline_ibeis_normalizer &#8211;enableall &#8211;noshow</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.score_normalization</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.all_imports</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ibeis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots</span> <span class="kn">import</span> <span class="n">score_normalization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#score_normalization.rrr()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;GZ_ALL&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;PZ_MTEST&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">dbname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">learnkw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalizer</span> <span class="o">=</span> <span class="n">score_normalization</span><span class="o">.</span><span class="n">train_baseline_ibeis_normalizer</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">use_cache</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">learnkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalizer</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">normalizer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">exec</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">present</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.voting_rules2">
<span id="ibeis-model-hots-voting-rules2-module"></span><h2>ibeis.model.hots.voting_rules2 module<a class="headerlink" href="#module-ibeis.model.hots.voting_rules2" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.enforce_one_name">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">enforce_one_name</tt><big>(</big><em>ibs</em>, <em>aid2_score</em>, <em>chipmatch=None</em>, <em>aid2_chipscore=None</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#enforce_one_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.enforce_one_name" title="Permalink to this definition">¶</a></dt>
<dd><p>this is a hack to make the same name only show up once in the top ranked
list</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.get_chipmatch_testdata">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">get_chipmatch_testdata</tt><big>(</big><em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#get_chipmatch_testdata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.get_chipmatch_testdata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.get_scores_from_altx2_score">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">get_scores_from_altx2_score</tt><big>(</big><em>ibs</em>, <em>qcx</em>, <em>altx2_prob</em>, <em>altx2_tnx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#get_scores_from_altx2_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.get_scores_from_altx2_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.positional_scoring_rule">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">positional_scoring_rule</tt><big>(</big><em>qfx2_utilities</em>, <em>rule</em>, <em>isWeighted</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#positional_scoring_rule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.positional_scoring_rule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.score_chipmatch_PL">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">score_chipmatch_PL</tt><big>(</big><em>ibs</em>, <em>qcx</em>, <em>chipmatch</em>, <em>qreq</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#score_chipmatch_PL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.score_chipmatch_PL" title="Permalink to this definition">¶</a></dt>
<dd><p>chipmatch = qcx2_chipmatch[qcx]</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.score_chipmatch_csum">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">score_chipmatch_csum</tt><big>(</big><em>qaid</em>, <em>chipmatch</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#score_chipmatch_csum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.score_chipmatch_csum" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">aid_list, score_list</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.voting_rules2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">chipmatch</span> <span class="o">=</span> <span class="n">get_chipmatch_testdata</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">score_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">score_chipmatch_csum</span><span class="p">(</span><span class="n">qaid</span><span class="p">,</span> <span class="n">chipmatch</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">score_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.score_chipmatch_nsum">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">score_chipmatch_nsum</tt><big>(</big><em>qaid</em>, <em>chipmatch</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#score_chipmatch_nsum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.score_chipmatch_nsum" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">nid2_score</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>CommandLine:</dt>
<dd>python dev.py -t nsum_nosv &#8211;db GZ_ALL &#8211;allgt &#8211;noqcache
python dev.py -t nsum &#8211;db GZ_ALL &#8211;show &#8211;va -w &#8211;qaid 1032 &#8211;noqcache
python dev.py -t nsum_nosv &#8211;db GZ_ALL &#8211;show &#8211;va -w &#8211;qaid 1032 &#8211;noqcache
qaid=1032_res_gooc+f4msr4ouy9t_quuid=c4f78a6d.npz
qaid=1032_res_5ujbs8h&amp;%vw1olnx_quuid=c4f78a6d.npz</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.voting_rules2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">qaid</span><span class="p">,</span> <span class="n">chipmatch</span> <span class="o">=</span> <span class="n">get_chipmatch_testdata</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">score_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">score_chipmatch_nsum</span><span class="p">(</span><span class="n">qaid</span><span class="p">,</span> <span class="n">chipmatch</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.score_chipmatch_nunique">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">score_chipmatch_nunique</tt><big>(</big><em>ibs</em>, <em>qaid</em>, <em>chipmatch</em>, <em>qreq</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#score_chipmatch_nunique"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.score_chipmatch_nunique" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.score_chipmatch_pos">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">score_chipmatch_pos</tt><big>(</big><em>ibs</em>, <em>qcx</em>, <em>chipmatch</em>, <em>qreq</em>, <em>rule='borda'</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#score_chipmatch_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.score_chipmatch_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Positional Scoring Rule</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.voting_rules2.score_chipmatch_true_nsum">
<tt class="descclassname">ibeis.model.hots.voting_rules2.</tt><tt class="descname">score_chipmatch_true_nsum</tt><big>(</big><em>qaid</em>, <em>chipmatch</em>, <em>qreq_</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/voting_rules2.html#score_chipmatch_true_nsum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.voting_rules2.score_chipmatch_true_nsum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots.word_index">
<span id="ibeis-model-hots-word-index-module"></span><h2>ibeis.model.hots.word_index module<a class="headerlink" href="#module-ibeis.model.hots.word_index" title="Permalink to this headline">¶</a></h2>
<p>python -c &#8220;import doctest, ibeis; print(doctest.testmod(ibeis.model.hots.word_index))&#8221;
python -m doctest -v ibeis/model/hots/word_index.py
python -m doctest ibeis/model/hots/word_index.py</p>
<dl class="class">
<dt id="ibeis.model.hots.word_index.NeighborAssignment">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.word_index.</tt><tt class="descname">NeighborAssignment</tt><big>(</big><em>asgn</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#NeighborAssignment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.NeighborAssignment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="ibeis.model.hots.word_index.WordIndex">
<em class="property">class </em><tt class="descclassname">ibeis.model.hots.word_index.</tt><tt class="descname">WordIndex</tt><big>(</big><em>windex</em>, <em>ax2_aid</em>, <em>idx2_vec</em>, <em>idx2_ax</em>, <em>idx2_fx</em>, <em>flann</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Abstract wrapper around flann</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.word_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windex</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_windex</span><span class="p">()</span>  
</pre></div>
</div>
<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.add_points">
<tt class="descname">add_points</tt><big>(</big><em>windex</em>, <em>new_aid_list</em>, <em>new_vecs_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex.add_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.add_points" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.word_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windex</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_windex</span><span class="p">()</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_aid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_vecs_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="n">new_aid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checks</span> <span class="o">=</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx1</span><span class="p">,</span> <span class="n">qfx2_dist1</span><span class="p">)</span> <span class="o">=</span> <span class="n">windex</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windex</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">new_aid_list</span><span class="p">,</span> <span class="n">new_vecs_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx2</span><span class="p">,</span> <span class="n">qfx2_dist2</span><span class="p">)</span> <span class="o">=</span> <span class="n">windex</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">qfx2_idx2</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">qfx2_idx1</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.empty_words">
<tt class="descname">empty_words</tt><big>(</big><em>K</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex.empty_words"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.empty_words" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.get_nn_aids">
<tt class="descname">get_nn_aids</tt><big>(</big><em>windex</em>, <em>qfx2_nnidx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex.get_nn_aids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.get_nn_aids" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_nnidx</strong> (<em>ndarray</em>) &#8211; (N x K) qfx2_idx[n][k] is the index of the kth
approximate nearest data vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qfx2_aid - (N x K) qfx2_fx[n][k] is the annotation id index
of the kth approximate nearest data vector</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.get_nn_axs">
<tt class="descname">get_nn_axs</tt><big>(</big><em>windex</em>, <em>qfx2_nnidx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex.get_nn_axs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.get_nn_axs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.get_nn_featxs">
<tt class="descname">get_nn_featxs</tt><big>(</big><em>windex</em>, <em>qfx2_nnidx</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex.get_nn_featxs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.get_nn_featxs" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>qfx2_nnidx</strong> (<em>ndarray</em>) &#8211; (N x K) qfx2_idx[n][k] is the index of the kth
approximate nearest data vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">qfx2_fx - (N x K) qfx2_fx[n][k] is the feature index (w.r.t
the source annotation) of the kth approximate nearest data vector</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.knn">
<tt class="descname">knn</tt><big>(</big><em>windex</em>, <em>qfx2_vec</em>, <em>K</em>, <em>checks=1028</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex.knn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.knn" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qfx2_vec</strong> (<em>ndarray</em>) &#8211; (N x D) array of N, D-dimensional query vectors</li>
<li><strong>K</strong> (<em>int</em>) &#8211; number of approximate nearest words to find</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>tuple of (qfx2_idx, qfx2_dist)</p>
<dl class="docutils">
<dt>qfx2_idx (ndarray):  (N x K) qfx2_idx[n][k] is the index of the kth</dt>
<dd><p class="first last">approximate nearest data vector w.r.t qfx2_vec[n]</p>
</dd>
<dt>qfx2_dist (ndarray): (N x K) qfx2_dist[n][k] is the distance to the kth</dt>
<dd><p class="first last">approximate nearest data vector w.r.t. qfx2_vec[n]</p>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.word_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windex</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_windex</span><span class="p">()</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_aid_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qfx2_vec</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_vecs_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_vecs</span><span class="p">(</span><span class="n">new_aid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checks</span> <span class="o">=</span> <span class="mi">1028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">qfx2_idx</span><span class="p">,</span> <span class="n">qfx2_dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">windex</span><span class="o">.</span><span class="n">knn</span><span class="p">(</span><span class="n">qfx2_vec</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.num_indexed_annots">
<tt class="descname">num_indexed_annots</tt><big>(</big><em>windex</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex.num_indexed_annots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.num_indexed_annots" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.num_indexed_vecs">
<tt class="descname">num_indexed_vecs</tt><big>(</big><em>windex</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#WordIndex.num_indexed_vecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.num_indexed_vecs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibeis.model.hots.word_index.WordIndex.rrr">
<tt class="descname">rrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#ibeis.model.hots.word_index.WordIndex.rrr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.word_index.invert_index">
<tt class="descclassname">ibeis.model.hots.word_index.</tt><tt class="descname">invert_index</tt><big>(</big><em>vecs_list</em>, <em>ax_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#invert_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.invert_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregates descriptors of input annotations and returns inverted information</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.word_index.new_ibeis_windex">
<tt class="descclassname">ibeis.model.hots.word_index.</tt><tt class="descname">new_ibeis_windex</tt><big>(</big><em>ibs</em>, <em>daid_list</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#new_ibeis_windex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.new_ibeis_windex" title="Permalink to this definition">¶</a></dt>
<dd><p>IBEIS interface into word_index</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ibeis.model.hots.word_index</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windex</span><span class="p">,</span> <span class="n">qreq_</span><span class="p">,</span> <span class="n">ibs</span> <span class="o">=</span> <span class="n">test_windex</span><span class="p">()</span> 
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.word_index.new_word_index">
<tt class="descclassname">ibeis.model.hots.word_index.</tt><tt class="descname">new_word_index</tt><big>(</big><em>aid_list=[]</em>, <em>vecs_list=[]</em>, <em>flann_params={}</em>, <em>flann_cachedir=None</em>, <em>indexer_cfgstr=''</em>, <em>hash_rowids=True</em>, <em>use_cache=True</em>, <em>use_params_hash=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#new_word_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.new_word_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.word_index.test_windex">
<tt class="descclassname">ibeis.model.hots.word_index.</tt><tt class="descname">test_windex</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#test_windex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.test_windex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.word_index.vlad">
<tt class="descclassname">ibeis.model.hots.word_index.</tt><tt class="descname">vlad</tt><big>(</big><em>qfx2_vec</em>, <em>qfx2_cvec</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots/word_index.html#vlad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.word_index.vlad" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ibeis.model.hots">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ibeis.model.hots" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ibeis.model.hots.reload_subs">
<tt class="descclassname">ibeis.model.hots.</tt><tt class="descname">reload_subs</tt><big>(</big><em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/ibeis/model/hots.html#reload_subs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibeis.model.hots.reload_subs" title="Permalink to this definition">¶</a></dt>
<dd><p>Reloads ibeis.model.hots and submodules</p>
</dd></dl>

<dl class="function">
<dt id="ibeis.model.hots.rrrr">
<tt class="descclassname">ibeis.model.hots.</tt><tt class="descname">rrrr</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#ibeis.model.hots.rrrr" title="Permalink to this definition">¶</a></dt>
<dd><p>Reloads ibeis.model.hots and submodules</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">ibeis.model.hots package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.automated_matcher">ibeis.model.hots.automated_matcher module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.exceptions">ibeis.model.hots.exceptions module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.hots_query_result">ibeis.model.hots.hots_query_result module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.hstypes">ibeis.model.hots.hstypes module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.match_chips4">ibeis.model.hots.match_chips4 module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.multi_index">ibeis.model.hots.multi_index module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.name_scoring">ibeis.model.hots.name_scoring module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.neighbor_index">ibeis.model.hots.neighbor_index module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.nn_weights">ibeis.model.hots.nn_weights module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.pipeline">ibeis.model.hots.pipeline module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.precision_recall">ibeis.model.hots.precision_recall module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.query_helpers">ibeis.model.hots.query_helpers module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.query_request">ibeis.model.hots.query_request module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.score_normalization">ibeis.model.hots.score_normalization module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.voting_rules2">ibeis.model.hots.voting_rules2 module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots.word_index">ibeis.model.hots.word_index module</a></li>
<li><a class="reference internal" href="#module-ibeis.model.hots">Module contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ibeis.model.detect.html"
                        title="previous chapter">ibeis.model.detect package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ibeis.model.hots.smk.html"
                        title="next chapter">ibeis.model.hots.smk package</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/ibeis.model.hots.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ibeis.model.hots.smk.html" title="ibeis.model.hots.smk package"
             >next</a> |</li>
        <li class="right" >
          <a href="ibeis.model.detect.html" title="ibeis.model.detect package"
             >previous</a> |</li>
        <li><a href="index.html">ibeis 0.1.0.dev1 documentation</a> &raquo;</li>
          <li><a href="ibeis.html" >ibeis package</a> &raquo;</li>
          <li><a href="ibeis.model.html" >ibeis.model package</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Jon Crall.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>